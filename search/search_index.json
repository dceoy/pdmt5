{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"pdmt5 API Documentation","text":"<p>Pandas-based data handler for MetaTrader 5 trading platform.</p>"},{"location":"#overview","title":"Overview","text":"<p>pdmt5 is a Python library that provides a pandas-based interface for handling MetaTrader 5 trading data. It simplifies data manipulation and analysis tasks for financial trading applications.</p>"},{"location":"#features","title":"Features","text":"<ul> <li>MetaTrader 5 Integration: Direct connection to MetaTrader 5 platform (Windows only)</li> <li>Pandas-based: Leverages pandas for efficient data manipulation</li> <li>Type Safety: Built with pydantic for robust data validation</li> <li>Financial Focus: Designed specifically for trading and financial data analysis</li> </ul>"},{"location":"#installation","title":"Installation","text":"<pre><code>pip install pdmt5\n</code></pre>"},{"location":"#quick-start","title":"Quick Start","text":"<pre><code>from pdmt5 import Mt5Client, Mt5Config, Mt5DataClient, Mt5TradingClient\nimport MetaTrader5 as mt5\nfrom datetime import datetime\n\n# Configure connection\nconfig = Mt5Config(\n    login=12345678,\n    password=\"your_password\",\n    server=\"YourBroker-Server\",\n    timeout=60000,\n    portable=False\n)\n\n# Low-level API access with context manager\nwith Mt5Client() as client:\n    client.initialize()\n    client.login(config.login, config.password, config.server)\n    account = client.account_info()\n    rates = client.copy_rates_from(\"EURUSD\", mt5.TIMEFRAME_H1, datetime.now(), 100)\n\n# Pandas-friendly interface with automatic initialization\nwith Mt5DataClient(config=config) as client:\n    # Get symbol information as DataFrame\n    symbols_df = client.get_symbols_as_df()\n    # Get OHLCV data as DataFrame\n    rates_df = client.copy_rates_from_as_df(\n        \"EURUSD\", mt5.TIMEFRAME_H1, datetime.now(), 100\n    )\n    # Get account info as DataFrame\n    account_df = client.get_account_info_as_df()\n\n# Trading operations with dry run support\nwith Mt5TradingClient(config=config, dry_run=True) as client:\n    # Check open positions as DataFrame\n    positions_df = client.get_positions_as_df()\n    # Close positions for specific symbol (dry run)\n    results = client.close_open_positions(\"EURUSD\")\n</code></pre>"},{"location":"#requirements","title":"Requirements","text":"<ul> <li>Python 3.11+</li> <li>Windows OS (MetaTrader 5 requirement)</li> <li>MetaTrader 5 platform</li> </ul>"},{"location":"#api-reference","title":"API Reference","text":"<p>Browse the API documentation to learn about available modules and functions:</p> <ul> <li>Mt5Client - Base client for low-level MT5 API access with context manager support</li> <li>Mt5DataClient &amp; Mt5Config - Pandas-friendly data client with DataFrame conversions</li> <li>Mt5TradingClient - Advanced trading operations with position management</li> <li>Utility Functions - Helper decorators and functions for data processing</li> </ul>"},{"location":"#development","title":"Development","text":"<p>This project follows strict code quality standards:</p> <ul> <li>Type hints required (strict mode)</li> <li>Comprehensive linting with Ruff</li> <li>Test coverage tracking</li> <li>Google-style docstrings</li> </ul>"},{"location":"#license","title":"License","text":"<p>MIT License - see LICENSE file for details.</p>"},{"location":"api/","title":"API Reference","text":"<p>This section contains the complete API documentation for pdmt5.</p>"},{"location":"api/#modules","title":"Modules","text":"<p>The pdmt5 package consists of the following modules:</p>"},{"location":"api/#mt5client","title":"Mt5Client","text":"<p>Base client class for MetaTrader 5 operations with connection management, low-level API access, and error handling (<code>Mt5RuntimeError</code>).</p>"},{"location":"api/#mt5dataclient-mt5config","title":"Mt5DataClient &amp; Mt5Config","text":"<p>Core data client functionality and configuration, providing pandas-friendly interface to MetaTrader 5.</p>"},{"location":"api/#mt5tradingclient","title":"Mt5TradingClient","text":"<p>Advanced trading operations including position management, order analysis, and trading performance metrics with dry run support.</p>"},{"location":"api/#rest-api","title":"REST API","text":"<p>FastAPI-based REST API that exposes read-only MT5 data over HTTP with JSON and Parquet support.</p>"},{"location":"api/#deployment","title":"Deployment","text":"<p>Windows service deployment guide for hosting the REST API alongside MetaTrader 5.</p>"},{"location":"api/#architecture-overview","title":"Architecture Overview","text":"<p>The package follows a layered architecture:</p> <ol> <li>Base Layer (<code>mt5.py</code>): Provides the base <code>Mt5Client</code> class with low-level MT5 API access and <code>Mt5RuntimeError</code> exception</li> <li>Data Layer (<code>dataframe.py</code>): Extends <code>Mt5Client</code> with configuration (<code>Mt5Config</code>) and pandas-friendly <code>Mt5DataClient</code> class</li> <li>Trading Layer (<code>trading.py</code>): Extends <code>Mt5DataClient</code> with advanced trading operations and <code>Mt5TradingError</code> exception</li> <li>Utilities (<code>utils.py</code>): Helper functions for time conversion and DataFrame manipulation</li> </ol>"},{"location":"api/#usage-guidelines","title":"Usage Guidelines","text":"<p>All modules follow these conventions:</p> <ul> <li>Type Safety: All functions include comprehensive type hints</li> <li>Error Handling: Centralized through <code>Mt5RuntimeError</code> with meaningful error messages</li> <li>Documentation: Google-style docstrings with examples</li> <li>Validation: Pydantic models for data validation and configuration</li> <li>pandas Integration: All data returns as DataFrames with proper datetime indexing</li> </ul>"},{"location":"api/#quick-start","title":"Quick Start","text":"<pre><code>from pdmt5 import Mt5Client, Mt5Config, Mt5DataClient, Mt5TradingClient\nimport MetaTrader5 as mt5\nfrom datetime import datetime\n\n# Low-level API access with Mt5Client\nwith Mt5Client(mt5=mt5) as client:\n    client.initialize()\n    account = client.account_info()\n    rates = client.copy_rates_from(\"EURUSD\", mt5.TIMEFRAME_H1, datetime.now(), 100)\n\n# Pandas-friendly interface with Mt5DataClient and configuration\nconfig = Mt5Config(login=12345, password=\"pass\", server=\"MetaQuotes-Demo\")\nwith Mt5DataClient(mt5=mt5, config=config) as client:\n    symbols_df = client.symbols_get_as_df()\n    rates_df = client.copy_rates_from_as_df(\"EURUSD\", mt5.TIMEFRAME_H1, datetime.now(), 100)\n\n# Advanced trading operations with Mt5TradingClient\nwith Mt5TradingClient(mt5=mt5, config=config, dry_run=True) as client:\n    # Close all positions for a symbol\n    results = client.close_open_positions(\"EURUSD\")\n</code></pre>"},{"location":"api/#examples","title":"Examples","text":"<p>See individual module pages for detailed usage examples and code samples.</p>"},{"location":"api/dataframe/","title":"DataFrame","text":""},{"location":"api/dataframe/#pdmt5.dataframe","title":"pdmt5.dataframe","text":"<p>MetaTrader5 data client with pandas DataFrame conversion.</p>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config","title":"Mt5Config","text":"<p>               Bases: <code>BaseModel</code></p> <p>Configuration for MetaTrader5 connection.</p>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.login","title":"login  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>login: int | None = Field(\n    default=None, description=\"Trading account login\"\n)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.model_config","title":"model_config  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>model_config = ConfigDict(frozen=True)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.password","title":"password  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>password: str | None = Field(\n    default=None, description=\"Trading account password\"\n)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.path","title":"path  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>path: str | None = Field(\n    default=None,\n    description=\"Path to MetaTrader5 terminal EXE file\",\n)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.server","title":"server  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>server: str | None = Field(\n    default=None, description=\"Trading server name\"\n)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.timeout","title":"timeout  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>timeout: int | None = Field(\n    default=None,\n    description=\"Connection timeout in milliseconds\",\n)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient","title":"Mt5DataClient","text":"<p>               Bases: <code>Mt5Client</code></p> <p>MetaTrader5 data client with pandas DataFrame and dictionary conversion.</p> <p>This class provides a pandas-friendly interface to MetaTrader5 functions, converting native MetaTrader5 data structures to pandas DataFrames with pydantic validation.</p>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.config","title":"config  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>config: Mt5Config = Field(\n    default_factory=Mt5Config,\n    description=\"MetaTrader5 connection configuration\",\n)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.model_config","title":"model_config  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>model_config = ConfigDict(arbitrary_types_allowed=True)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.retry_count","title":"retry_count  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>retry_count: int = Field(\n    default=3,\n    ge=0,\n    description=\"Number of retry attempts for connection initialization\",\n)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.account_info_as_df","title":"account_info_as_df","text":"<pre><code>account_info_as_df(\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get info on the current account as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with account information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\ndef account_info_as_df(self, index_keys: str | None = None) -&gt; pd.DataFrame:  # noqa: ARG002\n    \"\"\"Get info on the current account as a data frame.\n\n    Args:\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with account information.\n    \"\"\"\n    return pd.DataFrame([self.account_info_as_dict()])\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.account_info_as_dict","title":"account_info_as_dict","text":"<pre><code>account_info_as_dict() -&gt; dict[str, Any]\n</code></pre> <p>Get info on the current account as a dictionary.</p> <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dictionary with account information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def account_info_as_dict(self) -&gt; dict[str, Any]:\n    \"\"\"Get info on the current account as a dictionary.\n\n    Returns:\n        Dictionary with account information.\n    \"\"\"\n    return self.account_info()._asdict()\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_from_as_df","title":"copy_rates_from_as_df","text":"<pre><code>copy_rates_from_as_df(\n    symbol: str,\n    timeframe: int,\n    date_from: datetime,\n    count: int,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get bars for a specified date range as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>timeframe</code> <code>int</code> <p>Timeframe constant.</p> required <code>date_from</code> <code>datetime</code> <p>Start date.</p> required <code>count</code> <code>int</code> <p>Number of rates to retrieve.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with OHLCV data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef copy_rates_from_as_df(\n    self,\n    symbol: str,\n    timeframe: int,\n    date_from: datetime,\n    count: int,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get bars for a specified date range as a data frame.\n\n    Args:\n        symbol: Symbol name.\n        timeframe: Timeframe constant.\n        date_from: Start date.\n        count: Number of rates to retrieve.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with OHLCV data.\n    \"\"\"\n    self._validate_positive_count(count=count)\n    return pd.DataFrame(\n        self.copy_rates_from(\n            symbol=symbol,\n            timeframe=timeframe,\n            date_from=date_from,\n            count=count,\n        )\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_from_as_dicts","title":"copy_rates_from_as_dicts","text":"<pre><code>copy_rates_from_as_dicts(\n    symbol: str,\n    timeframe: int,\n    date_from: datetime,\n    count: int,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get bars for a specified date range as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>timeframe</code> <code>int</code> <p>Timeframe constant.</p> required <code>date_from</code> <code>datetime</code> <p>Start date.</p> required <code>count</code> <code>int</code> <p>Number of rates to retrieve.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with OHLCV data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def copy_rates_from_as_dicts(\n    self,\n    symbol: str,\n    timeframe: int,\n    date_from: datetime,\n    count: int,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get bars for a specified date range as a list of dictionaries.\n\n    Args:\n        symbol: Symbol name.\n        timeframe: Timeframe constant.\n        date_from: Start date.\n        count: Number of rates to retrieve.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with OHLCV data.\n    \"\"\"\n    return self.copy_rates_from_as_df(\n        symbol=symbol,\n        timeframe=timeframe,\n        date_from=date_from,\n        count=count,\n        skip_to_datetime=skip_to_datetime,\n        index_keys=None,\n    ).to_dict(orient=\"records\")\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_from_pos_as_df","title":"copy_rates_from_pos_as_df","text":"<pre><code>copy_rates_from_pos_as_df(\n    symbol: str,\n    timeframe: int,\n    start_pos: int,\n    count: int,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get bars from a specified position as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>timeframe</code> <code>int</code> <p>Timeframe constant.</p> required <code>start_pos</code> <code>int</code> <p>Start position.</p> required <code>count</code> <code>int</code> <p>Number of rates to retrieve.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with OHLCV data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef copy_rates_from_pos_as_df(\n    self,\n    symbol: str,\n    timeframe: int,\n    start_pos: int,\n    count: int,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get bars from a specified position as a data frame.\n\n    Args:\n        symbol: Symbol name.\n        timeframe: Timeframe constant.\n        start_pos: Start position.\n        count: Number of rates to retrieve.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with OHLCV data.\n    \"\"\"\n    self._validate_positive_count(count=count)\n    self._validate_non_negative_position(position=start_pos)\n    return pd.DataFrame(\n        self.copy_rates_from_pos(\n            symbol=symbol,\n            timeframe=timeframe,\n            start_pos=start_pos,\n            count=count,\n        )\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_from_pos_as_dicts","title":"copy_rates_from_pos_as_dicts","text":"<pre><code>copy_rates_from_pos_as_dicts(\n    symbol: str,\n    timeframe: int,\n    start_pos: int,\n    count: int,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get bars from a specified position as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>timeframe</code> <code>int</code> <p>Timeframe constant.</p> required <code>start_pos</code> <code>int</code> <p>Start position.</p> required <code>count</code> <code>int</code> <p>Number of rates to retrieve.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with OHLCV data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def copy_rates_from_pos_as_dicts(\n    self,\n    symbol: str,\n    timeframe: int,\n    start_pos: int,\n    count: int,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get bars from a specified position as a list of dictionaries.\n\n    Args:\n        symbol: Symbol name.\n        timeframe: Timeframe constant.\n        start_pos: Start position.\n        count: Number of rates to retrieve.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with OHLCV data.\n    \"\"\"\n    return self.copy_rates_from_pos_as_df(\n        symbol=symbol,\n        timeframe=timeframe,\n        start_pos=start_pos,\n        count=count,\n        skip_to_datetime=skip_to_datetime,\n        index_keys=None,\n    ).to_dict(orient=\"records\")\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_range_as_df","title":"copy_rates_range_as_df","text":"<pre><code>copy_rates_range_as_df(\n    symbol: str,\n    timeframe: int,\n    date_from: datetime,\n    date_to: datetime,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get bars for a specified date range as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>timeframe</code> <code>int</code> <p>Timeframe constant.</p> required <code>date_from</code> <code>datetime</code> <p>Start date.</p> required <code>date_to</code> <code>datetime</code> <p>End date.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with OHLCV data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef copy_rates_range_as_df(\n    self,\n    symbol: str,\n    timeframe: int,\n    date_from: datetime,\n    date_to: datetime,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get bars for a specified date range as a data frame.\n\n    Args:\n        symbol: Symbol name.\n        timeframe: Timeframe constant.\n        date_from: Start date.\n        date_to: End date.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with OHLCV data.\n    \"\"\"\n    self._validate_date_range(date_from=date_from, date_to=date_to)\n    return pd.DataFrame(\n        self.copy_rates_range(\n            symbol=symbol,\n            timeframe=timeframe,\n            date_from=date_from,\n            date_to=date_to,\n        )\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_range_as_dicts","title":"copy_rates_range_as_dicts","text":"<pre><code>copy_rates_range_as_dicts(\n    symbol: str,\n    timeframe: int,\n    date_from: datetime,\n    date_to: datetime,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get bars for a specified date range as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>timeframe</code> <code>int</code> <p>Timeframe constant.</p> required <code>date_from</code> <code>datetime</code> <p>Start date.</p> required <code>date_to</code> <code>datetime</code> <p>End date.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with OHLCV data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def copy_rates_range_as_dicts(\n    self,\n    symbol: str,\n    timeframe: int,\n    date_from: datetime,\n    date_to: datetime,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get bars for a specified date range as a list of dictionaries.\n\n    Args:\n        symbol: Symbol name.\n        timeframe: Timeframe constant.\n        date_from: Start date.\n        date_to: End date.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with OHLCV data.\n    \"\"\"\n    return self.copy_rates_range_as_df(\n        symbol=symbol,\n        timeframe=timeframe,\n        date_from=date_from,\n        date_to=date_to,\n        skip_to_datetime=skip_to_datetime,\n        index_keys=None,\n    ).to_dict(orient=\"records\")\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_ticks_from_as_df","title":"copy_ticks_from_as_df","text":"<pre><code>copy_ticks_from_as_df(\n    symbol: str,\n    date_from: datetime,\n    count: int,\n    flags: int,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get ticks from a specified date as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>date_from</code> <code>datetime</code> <p>Start date.</p> required <code>count</code> <code>int</code> <p>Number of ticks to retrieve.</p> required <code>flags</code> <code>int</code> <p>Tick flags (use constants from MetaTrader5).</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with tick data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef copy_ticks_from_as_df(\n    self,\n    symbol: str,\n    date_from: datetime,\n    count: int,\n    flags: int,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get ticks from a specified date as a data frame.\n\n    Args:\n        symbol: Symbol name.\n        date_from: Start date.\n        count: Number of ticks to retrieve.\n        flags: Tick flags (use constants from MetaTrader5).\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with tick data.\n    \"\"\"\n    self._validate_positive_count(count=count)\n    return pd.DataFrame(\n        self.copy_ticks_from(\n            symbol=symbol,\n            date_from=date_from,\n            count=count,\n            flags=flags,\n        )\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_ticks_from_as_dicts","title":"copy_ticks_from_as_dicts","text":"<pre><code>copy_ticks_from_as_dicts(\n    symbol: str,\n    date_from: datetime,\n    count: int,\n    flags: int,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get ticks from a specified date as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>date_from</code> <code>datetime</code> <p>Start date.</p> required <code>count</code> <code>int</code> <p>Number of ticks to retrieve.</p> required <code>flags</code> <code>int</code> <p>Tick flags (use constants from MetaTrader5).</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with tick data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def copy_ticks_from_as_dicts(\n    self,\n    symbol: str,\n    date_from: datetime,\n    count: int,\n    flags: int,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get ticks from a specified date as a list of dictionaries.\n\n    Args:\n        symbol: Symbol name.\n        date_from: Start date.\n        count: Number of ticks to retrieve.\n        flags: Tick flags (use constants from MetaTrader5).\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with tick data.\n    \"\"\"\n    return self.copy_ticks_from_as_df(\n        symbol=symbol,\n        date_from=date_from,\n        count=count,\n        flags=flags,\n        skip_to_datetime=skip_to_datetime,\n        index_keys=None,\n    ).to_dict(orient=\"records\")  # type: ignore[reportReturnType]\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_ticks_range_as_df","title":"copy_ticks_range_as_df","text":"<pre><code>copy_ticks_range_as_df(\n    symbol: str,\n    date_from: datetime,\n    date_to: datetime,\n    flags: int,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get ticks for a specified date range as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>date_from</code> <code>datetime</code> <p>Start date.</p> required <code>date_to</code> <code>datetime</code> <p>End date.</p> required <code>flags</code> <code>int</code> <p>Tick flags (use constants from MetaTrader5).</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with tick data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef copy_ticks_range_as_df(\n    self,\n    symbol: str,\n    date_from: datetime,\n    date_to: datetime,\n    flags: int,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get ticks for a specified date range as a data frame.\n\n    Args:\n        symbol: Symbol name.\n        date_from: Start date.\n        date_to: End date.\n        flags: Tick flags (use constants from MetaTrader5).\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with tick data.\n    \"\"\"\n    self._validate_date_range(date_from=date_from, date_to=date_to)\n    return pd.DataFrame(\n        self.copy_ticks_range(\n            symbol=symbol,\n            date_from=date_from,\n            date_to=date_to,\n            flags=flags,\n        )\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_ticks_range_as_dicts","title":"copy_ticks_range_as_dicts","text":"<pre><code>copy_ticks_range_as_dicts(\n    symbol: str,\n    date_from: datetime,\n    date_to: datetime,\n    flags: int,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get ticks for a specified date range as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>date_from</code> <code>datetime</code> <p>Start date.</p> required <code>date_to</code> <code>datetime</code> <p>End date.</p> required <code>flags</code> <code>int</code> <p>Tick flags (use constants from MetaTrader5).</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with tick data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def copy_ticks_range_as_dicts(\n    self,\n    symbol: str,\n    date_from: datetime,\n    date_to: datetime,\n    flags: int,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get ticks for a specified date range as a list of dictionaries.\n\n    Args:\n        symbol: Symbol name.\n        date_from: Start date.\n        date_to: End date.\n        flags: Tick flags (use constants from MetaTrader5).\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with tick data.\n    \"\"\"\n    return self.copy_ticks_range_as_df(\n        symbol=symbol,\n        date_from=date_from,\n        date_to=date_to,\n        flags=flags,\n        skip_to_datetime=skip_to_datetime,\n        index_keys=None,\n    ).to_dict(orient=\"records\")  # type: ignore[reportReturnType]\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.history_deals_get_as_df","title":"history_deals_get_as_df","text":"<pre><code>history_deals_get_as_df(\n    date_from: datetime | None = None,\n    date_to: datetime | None = None,\n    group: str | None = None,\n    symbol: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get historical deals with optional filters as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>date_from</code> <code>datetime | None</code> <p>Start date (required if not using ticket/position).</p> <code>None</code> <code>date_to</code> <code>datetime | None</code> <p>End date (required if not using ticket/position).</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Optional group filter.</p> <code>None</code> <code>symbol</code> <code>str | None</code> <p>Optional symbol filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Get deals by order ticket.</p> <code>None</code> <code>position</code> <code>int | None</code> <p>Get deals by position ticket.</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with historical deal information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef history_deals_get_as_df(\n    self,\n    date_from: datetime | None = None,\n    date_to: datetime | None = None,\n    group: str | None = None,\n    symbol: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get historical deals with optional filters as a data frame.\n\n    Args:\n        date_from: Start date (required if not using ticket/position).\n        date_to: End date (required if not using ticket/position).\n        group: Optional group filter.\n        symbol: Optional symbol filter.\n        ticket: Get deals by order ticket.\n        position: Get deals by position ticket.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with historical deal information.\n    \"\"\"\n    return pd.DataFrame(\n        self.history_deals_get_as_dicts(\n            date_from=date_from,\n            date_to=date_to,\n            group=group,\n            symbol=symbol,\n            ticket=ticket,\n            position=position,\n            skip_to_datetime=True,\n        )\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.history_deals_get_as_dicts","title":"history_deals_get_as_dicts","text":"<pre><code>history_deals_get_as_dicts(\n    date_from: datetime | None = None,\n    date_to: datetime | None = None,\n    group: str | None = None,\n    symbol: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get historical deals with optional filters as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>date_from</code> <code>datetime | None</code> <p>Start date (required if not using ticket/position).</p> <code>None</code> <code>date_to</code> <code>datetime | None</code> <p>End date (required if not using ticket/position).</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Optional group filter.</p> <code>None</code> <code>symbol</code> <code>str | None</code> <p>Optional symbol filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Get deals by order ticket.</p> <code>None</code> <code>position</code> <code>int | None</code> <p>Get deals by position ticket.</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with historical deal information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef history_deals_get_as_dicts(\n    self,\n    date_from: datetime | None = None,\n    date_to: datetime | None = None,\n    group: str | None = None,\n    symbol: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get historical deals with optional filters as a list of dictionaries.\n\n    Args:\n        date_from: Start date (required if not using ticket/position).\n        date_to: End date (required if not using ticket/position).\n        group: Optional group filter.\n        symbol: Optional symbol filter.\n        ticket: Get deals by order ticket.\n        position: Get deals by position ticket.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with historical deal information.\n    \"\"\"\n    self._validate_history_input(\n        date_from=date_from,\n        date_to=date_to,\n        ticket=ticket,\n        position=position,\n    )\n    return [\n        d._asdict()\n        for d in self.history_deals_get(\n            date_from=date_from,\n            date_to=date_to,\n            group=(f\"*{symbol}*\" if symbol else group),\n            ticket=ticket,\n            position=position,\n        )\n    ]\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.history_orders_get_as_df","title":"history_orders_get_as_df","text":"<pre><code>history_orders_get_as_df(\n    date_from: datetime | None = None,\n    date_to: datetime | None = None,\n    group: str | None = None,\n    symbol: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get historical orders with optional filters as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>date_from</code> <code>datetime | None</code> <p>Start date (required if not using ticket/position).</p> <code>None</code> <code>date_to</code> <code>datetime | None</code> <p>End date (required if not using ticket/position).</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Optional group filter.</p> <code>None</code> <code>symbol</code> <code>str | None</code> <p>Optional symbol filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Get orders by ticket.</p> <code>None</code> <code>position</code> <code>int | None</code> <p>Get orders by position.</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with historical order information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef history_orders_get_as_df(\n    self,\n    date_from: datetime | None = None,\n    date_to: datetime | None = None,\n    group: str | None = None,\n    symbol: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get historical orders with optional filters as a data frame.\n\n    Args:\n        date_from: Start date (required if not using ticket/position).\n        date_to: End date (required if not using ticket/position).\n        group: Optional group filter.\n        symbol: Optional symbol filter.\n        ticket: Get orders by ticket.\n        position: Get orders by position.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with historical order information.\n    \"\"\"\n    return pd.DataFrame(\n        self.history_orders_get_as_dicts(\n            date_from=date_from,\n            date_to=date_to,\n            group=group,\n            symbol=symbol,\n            ticket=ticket,\n            position=position,\n            skip_to_datetime=True,\n        )\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.history_orders_get_as_dicts","title":"history_orders_get_as_dicts","text":"<pre><code>history_orders_get_as_dicts(\n    date_from: datetime | None = None,\n    date_to: datetime | None = None,\n    group: str | None = None,\n    symbol: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get historical orders with optional filters as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>date_from</code> <code>datetime | None</code> <p>Start date (required if not using ticket/position).</p> <code>None</code> <code>date_to</code> <code>datetime | None</code> <p>End date (required if not using ticket/position).</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Optional group filter.</p> <code>None</code> <code>symbol</code> <code>str | None</code> <p>Optional symbol filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Get orders by ticket.</p> <code>None</code> <code>position</code> <code>int | None</code> <p>Get orders by position.</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with historical order information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef history_orders_get_as_dicts(\n    self,\n    date_from: datetime | None = None,\n    date_to: datetime | None = None,\n    group: str | None = None,\n    symbol: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get historical orders with optional filters as a list of dictionaries.\n\n    Args:\n        date_from: Start date (required if not using ticket/position).\n        date_to: End date (required if not using ticket/position).\n        group: Optional group filter.\n        symbol: Optional symbol filter.\n        ticket: Get orders by ticket.\n        position: Get orders by position.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with historical order information.\n    \"\"\"\n    self._validate_history_input(\n        date_from=date_from,\n        date_to=date_to,\n        ticket=ticket,\n        position=position,\n    )\n    return [\n        o._asdict()\n        for o in self.history_orders_get(\n            date_from=date_from,\n            date_to=date_to,\n            group=(f\"*{symbol}*\" if symbol else group),\n            ticket=ticket,\n            position=position,\n        )\n    ]\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.initialize_and_login_mt5","title":"initialize_and_login_mt5","text":"<pre><code>initialize_and_login_mt5(\n    path: str | None = None,\n    login: int | None = None,\n    password: str | None = None,\n    server: str | None = None,\n    timeout: int | None = None,\n) -&gt; None\n</code></pre> <p>Initialize MetaTrader5 connection with retry logic.</p> <p>This method overrides the base class to add retry logic and use config values.</p> <p>Parameters:</p> Name Type Description Default <code>path</code> <code>str | None</code> <p>Path to terminal EXE file (overrides config).</p> <code>None</code> <code>login</code> <code>int | None</code> <p>Account login (overrides config).</p> <code>None</code> <code>password</code> <code>str | None</code> <p>Account password (overrides config).</p> <code>None</code> <code>server</code> <code>str | None</code> <p>Server name (overrides config).</p> <code>None</code> <code>timeout</code> <code>int | None</code> <p>Connection timeout (overrides config).</p> <code>None</code> <p>Raises:</p> Type Description <code>Mt5RuntimeError</code> <p>If initialization fails after retries.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def initialize_and_login_mt5(\n    self,\n    path: str | None = None,\n    login: int | None = None,\n    password: str | None = None,\n    server: str | None = None,\n    timeout: int | None = None,\n) -&gt; None:\n    \"\"\"Initialize MetaTrader5 connection with retry logic.\n\n    This method overrides the base class to add retry logic and use config values.\n\n    Args:\n        path: Path to terminal EXE file (overrides config).\n        login: Account login (overrides config).\n        password: Account password (overrides config).\n        server: Server name (overrides config).\n        timeout: Connection timeout (overrides config).\n\n    Raises:\n        Mt5RuntimeError: If initialization fails after retries.\n    \"\"\"\n    path = path or self.config.path\n    login_kwargs = {\n        \"login\": login or self.config.login,\n        \"password\": password or self.config.password,\n        \"server\": server or self.config.server,\n        \"timeout\": timeout or self.config.timeout,\n    }\n    for i in range(1 + max(0, self.retry_count)):\n        if i:\n            self.logger.warning(\n                \"Retrying MT5 initialization (%d/%d)...\",\n                i,\n                self.retry_count,\n            )\n            time.sleep(i)\n        if self.initialize(path=path, **login_kwargs) and (\n            (not login_kwargs[\"login\"]) or self.login(**login_kwargs)\n        ):\n            return\n    error_message = (\n        f\"MT5 initialize and login failed after {self.retry_count} retries:\"\n        f\" {self.last_error()}\"\n    )\n    raise Mt5RuntimeError(error_message)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.last_error_as_df","title":"last_error_as_df","text":"<pre><code>last_error_as_df(\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get the last error information as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with last error information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\ndef last_error_as_df(self, index_keys: str | None = None) -&gt; pd.DataFrame:  # noqa: ARG002\n    \"\"\"Get the last error information as a data frame.\n\n    Args:\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with last error information.\n    \"\"\"\n    return pd.DataFrame([self.last_error_as_dict()])\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.last_error_as_dict","title":"last_error_as_dict","text":"<pre><code>last_error_as_dict() -&gt; dict[str, Any]\n</code></pre> <p>Get the last error information as a dictionary.</p> <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dictionary with last error information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def last_error_as_dict(self) -&gt; dict[str, Any]:\n    \"\"\"Get the last error information as a dictionary.\n\n    Returns:\n        Dictionary with last error information.\n    \"\"\"\n    response = self.last_error()\n    return {\"error_code\": response[0], \"error_description\": response[1]}\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.market_book_get_as_df","title":"market_book_get_as_df","text":"<pre><code>market_book_get_as_df(\n    symbol: str,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get market depth for a specified symbol as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with market depth data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef market_book_get_as_df(\n    self,\n    symbol: str,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get market depth for a specified symbol as a data frame.\n\n    Args:\n        symbol: Symbol name.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with market depth data.\n    \"\"\"\n    return pd.DataFrame(\n        self.market_book_get_as_dicts(symbol=symbol, skip_to_datetime=True)\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.market_book_get_as_dicts","title":"market_book_get_as_dicts","text":"<pre><code>market_book_get_as_dicts(\n    symbol: str, skip_to_datetime: bool = False\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get market depth for a specified symbol as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with market depth data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef market_book_get_as_dicts(\n    self,\n    symbol: str,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get market depth for a specified symbol as a list of dictionaries.\n\n    Args:\n        symbol: Symbol name.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with market depth data.\n    \"\"\"\n    return [b._asdict() for b in self.market_book_get(symbol=symbol)]\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.order_check_as_df","title":"order_check_as_df","text":"<pre><code>order_check_as_df(\n    request: dict[str, Any], index_keys: str | None = None\n) -&gt; DataFrame\n</code></pre> <p>Check funds sufficiency for performing a requested trading operation as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>request</code> <code>dict[str, Any]</code> <p>Order request parameters.</p> required <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with order check results.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\ndef order_check_as_df(\n    self,\n    request: dict[str, Any],\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Check funds sufficiency for performing a requested trading operation as a data frame.\n\n    Args:\n        request: Order request parameters.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with order check results.\n    \"\"\"  # noqa: E501\n    return pd.DataFrame([\n        self._flatten_dict_to_one_level(\n            dictionary=self.order_check_as_dict(request=request),\n        )\n    ])\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.order_check_as_dict","title":"order_check_as_dict","text":"<pre><code>order_check_as_dict(\n    request: dict[str, Any],\n) -&gt; dict[str, Any]\n</code></pre> <p>Check funds sufficiency for performing a requested trading operation as a dictionary.</p> <p>Parameters:</p> Name Type Description Default <code>request</code> <code>dict[str, Any]</code> <p>Order request parameters.</p> required <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dictionary with order check results.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def order_check_as_dict(self, request: dict[str, Any]) -&gt; dict[str, Any]:\n    \"\"\"Check funds sufficiency for performing a requested trading operation as a dictionary.\n\n    Args:\n        request: Order request parameters.\n\n    Returns:\n        Dictionary with order check results.\n    \"\"\"  # noqa: E501\n    return {\n        k: (v._asdict() if k == \"request\" else v)\n        for k, v in self.order_check(request=request)._asdict().items()\n    }\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.order_send_as_df","title":"order_send_as_df","text":"<pre><code>order_send_as_df(\n    request: dict[str, Any], index_keys: str | None = None\n) -&gt; DataFrame\n</code></pre> <p>Send a request to perform a trading operation from the terminal to the trade server as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>request</code> <code>dict[str, Any]</code> <p>Order request parameters.</p> required <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with order send results.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\ndef order_send_as_df(\n    self,\n    request: dict[str, Any],\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Send a request to perform a trading operation from the terminal to the trade server as a data frame.\n\n    Args:\n        request: Order request parameters.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with order send results.\n    \"\"\"  # noqa: E501\n    return pd.DataFrame([\n        self._flatten_dict_to_one_level(\n            dictionary=self.order_send_as_dict(request=request),\n        )\n    ])\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.order_send_as_dict","title":"order_send_as_dict","text":"<pre><code>order_send_as_dict(\n    request: dict[str, Any],\n) -&gt; dict[str, Any]\n</code></pre> <p>Send a request to perform a trading operation from the terminal to the trade server as a dictionary.</p> <p>Parameters:</p> Name Type Description Default <code>request</code> <code>dict[str, Any]</code> <p>Order request parameters.</p> required <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dictionary with order send results.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def order_send_as_dict(self, request: dict[str, Any]) -&gt; dict[str, Any]:\n    \"\"\"Send a request to perform a trading operation from the terminal to the trade server as a dictionary.\n\n    Args:\n        request: Order request parameters.\n\n    Returns:\n        Dictionary with order send results.\n    \"\"\"  # noqa: E501\n    return {\n        k: (v._asdict() if k == \"request\" else v)\n        for k, v in self.order_send(request=request)._asdict().items()\n    }\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.orders_get_as_df","title":"orders_get_as_df","text":"<pre><code>orders_get_as_df(\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get active orders with optional filters as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str | None</code> <p>Optional symbol filter.</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Optional group filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Optional order ticket filter.</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with order information or empty DataFrame if no orders.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef orders_get_as_df(\n    self,\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get active orders with optional filters as a data frame.\n\n    Args:\n        symbol: Optional symbol filter.\n        group: Optional group filter.\n        ticket: Optional order ticket filter.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with order information or empty DataFrame if no orders.\n    \"\"\"\n    return pd.DataFrame(\n        self.orders_get_as_dicts(\n            symbol=symbol,\n            group=group,\n            ticket=ticket,\n            skip_to_datetime=True,\n        )\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.orders_get_as_dicts","title":"orders_get_as_dicts","text":"<pre><code>orders_get_as_dicts(\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get active orders with optional filters as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str | None</code> <p>Optional symbol filter.</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Optional group filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Optional order ticket filter.</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with order information or empty list if no orders.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef orders_get_as_dicts(\n    self,\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get active orders with optional filters as a list of dictionaries.\n\n    Args:\n        symbol: Optional symbol filter.\n        group: Optional group filter.\n        ticket: Optional order ticket filter.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with order information or empty list if no orders.\n    \"\"\"\n    return [\n        o._asdict()\n        for o in self.orders_get(symbol=symbol, group=group, ticket=ticket)\n    ]\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.positions_get_as_df","title":"positions_get_as_df","text":"<pre><code>positions_get_as_df(\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get open positions with optional filters as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str | None</code> <p>Optional symbol filter.</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Optional group filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Optional position ticket filter.</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with position information or empty DataFrame if no positions.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef positions_get_as_df(\n    self,\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get open positions with optional filters as a data frame.\n\n    Args:\n        symbol: Optional symbol filter.\n        group: Optional group filter.\n        ticket: Optional position ticket filter.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with position information or empty DataFrame if no positions.\n    \"\"\"\n    return pd.DataFrame(\n        self.positions_get_as_dicts(\n            symbol=symbol,\n            group=group,\n            ticket=ticket,\n            skip_to_datetime=True,\n        )\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.positions_get_as_dicts","title":"positions_get_as_dicts","text":"<pre><code>positions_get_as_dicts(\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get open positions with optional filters as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str | None</code> <p>Optional symbol filter.</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Optional group filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Optional position ticket filter.</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with position information or empty list if no</p> <code>list[dict[str, Any]]</code> <p>positions.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef positions_get_as_dicts(\n    self,\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get open positions with optional filters as a list of dictionaries.\n\n    Args:\n        symbol: Optional symbol filter.\n        group: Optional group filter.\n        ticket: Optional position ticket filter.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with position information or empty list if no\n        positions.\n    \"\"\"\n    return [\n        p._asdict()\n        for p in self.positions_get(symbol=symbol, group=group, ticket=ticket)\n    ]\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbol_info_as_df","title":"symbol_info_as_df","text":"<pre><code>symbol_info_as_df(\n    symbol: str,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get data on a specific symbol as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with symbol information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef symbol_info_as_df(\n    self,\n    symbol: str,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get data on a specific symbol as a data frame.\n\n    Args:\n        symbol: Symbol name.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with symbol information.\n    \"\"\"\n    return pd.DataFrame([\n        self.symbol_info_as_dict(symbol=symbol, skip_to_datetime=True)\n    ])\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbol_info_as_dict","title":"symbol_info_as_dict","text":"<pre><code>symbol_info_as_dict(\n    symbol: str, skip_to_datetime: bool = False\n) -&gt; dict[str, Any]\n</code></pre> <p>Get data on a specific symbol as a dictionary.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dictionary with symbol information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef symbol_info_as_dict(\n    self,\n    symbol: str,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n) -&gt; dict[str, Any]:\n    \"\"\"Get data on a specific symbol as a dictionary.\n\n    Args:\n        symbol: Symbol name.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        Dictionary with symbol information.\n    \"\"\"\n    return self.symbol_info(symbol=symbol)._asdict()\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbol_info_tick_as_df","title":"symbol_info_tick_as_df","text":"<pre><code>symbol_info_tick_as_df(\n    symbol: str,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get the last tick for the specified financial instrument as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with tick information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef symbol_info_tick_as_df(\n    self,\n    symbol: str,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get the last tick for the specified financial instrument as a data frame.\n\n    Args:\n        symbol: Symbol name.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with tick information.\n    \"\"\"\n    return pd.DataFrame([\n        self.symbol_info_tick_as_dict(symbol=symbol, skip_to_datetime=True)\n    ])\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbol_info_tick_as_dict","title":"symbol_info_tick_as_dict","text":"<pre><code>symbol_info_tick_as_dict(\n    symbol: str, skip_to_datetime: bool = False\n) -&gt; dict[str, Any]\n</code></pre> <p>Get the last tick for the specified financial instrument as a dictionary.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dictionary with tick information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef symbol_info_tick_as_dict(\n    self,\n    symbol: str,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n) -&gt; dict[str, Any]:\n    \"\"\"Get the last tick for the specified financial instrument as a dictionary.\n\n    Args:\n        symbol: Symbol name.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        Dictionary with tick information.\n    \"\"\"\n    return self.symbol_info_tick(symbol=symbol)._asdict()\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbols_get_as_df","title":"symbols_get_as_df","text":"<pre><code>symbols_get_as_df(\n    group: str | None = None,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get symbols as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>group</code> <code>str | None</code> <p>Symbol group filter (e.g., \"USD\", \"Forex*\").</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with symbol information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef symbols_get_as_df(\n    self,\n    group: str | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get symbols as a data frame.\n\n    Args:\n        group: Symbol group filter (e.g., \"*USD*\", \"Forex*\").\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with symbol information.\n    \"\"\"\n    return pd.DataFrame(\n        self.symbols_get_as_dicts(group=group, skip_to_datetime=True)\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbols_get_as_dicts","title":"symbols_get_as_dicts","text":"<pre><code>symbols_get_as_dicts(\n    group: str | None = None, skip_to_datetime: bool = False\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get symbols as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>group</code> <code>str | None</code> <p>Symbol group filter (e.g., \"USD\", \"Forex*\").</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with symbol information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef symbols_get_as_dicts(\n    self,\n    group: str | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get symbols as a list of dictionaries.\n\n    Args:\n        group: Symbol group filter (e.g., \"*USD*\", \"Forex*\").\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with symbol information.\n    \"\"\"\n    return [s._asdict() for s in self.symbols_get(group=group)]\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.terminal_info_as_df","title":"terminal_info_as_df","text":"<pre><code>terminal_info_as_df(\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get the connected terminal status and settings as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with terminal information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\ndef terminal_info_as_df(self, index_keys: str | None = None) -&gt; pd.DataFrame:  # noqa: ARG002\n    \"\"\"Get the connected terminal status and settings as a data frame.\n\n    Args:\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with terminal information.\n    \"\"\"\n    return pd.DataFrame([self.terminal_info_as_dict()])\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.terminal_info_as_dict","title":"terminal_info_as_dict","text":"<pre><code>terminal_info_as_dict() -&gt; dict[str, Any]\n</code></pre> <p>Get the connected terminal status and settings as a dictionary.</p> <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dictionary with terminal information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def terminal_info_as_dict(self) -&gt; dict[str, Any]:\n    \"\"\"Get the connected terminal status and settings as a dictionary.\n\n    Returns:\n        Dictionary with terminal information.\n    \"\"\"\n    return self.terminal_info()._asdict()\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.version_as_df","title":"version_as_df","text":"<pre><code>version_as_df(index_keys: str | None = None) -&gt; DataFrame\n</code></pre> <p>Return MetaTrader5 version information as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with MetaTrader5 version information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\ndef version_as_df(self, index_keys: str | None = None) -&gt; pd.DataFrame:  # noqa: ARG002\n    \"\"\"Return MetaTrader5 version information as a data frame.\n\n    Args:\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with MetaTrader5 version information.\n    \"\"\"\n    return pd.DataFrame([self.version_as_dict()])\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.version_as_dict","title":"version_as_dict","text":"<pre><code>version_as_dict() -&gt; dict[str, int | str]\n</code></pre> <p>Return MetaTrader5 version information as a dictionary.</p> <p>Returns:</p> Type Description <code>dict[str, int | str]</code> <p>Dictionary with MetaTrader5 version information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def version_as_dict(self) -&gt; dict[str, int | str]:\n    \"\"\"Return MetaTrader5 version information as a dictionary.\n\n    Returns:\n        Dictionary with MetaTrader5 version information.\n    \"\"\"\n    response = self.version()\n    return {\n        \"mt5_terminal_version\": response[0],\n        \"build\": response[1],\n        \"build_release_date\": response[2],\n    }\n</code></pre>"},{"location":"api/dataframe/#overview","title":"Overview","text":"<p>The dataframe module extends the base Mt5Client with pandas-friendly functionality for connecting to MetaTrader 5 and retrieving trading data as pandas DataFrames. It includes configuration management, automatic data conversion, and comprehensive validation utilities.</p>"},{"location":"api/dataframe/#classes","title":"Classes","text":""},{"location":"api/dataframe/#mt5config","title":"Mt5Config","text":"<p>options: show_bases: false</p> <p>Configuration class for MetaTrader 5 connection parameters using pydantic for validation.</p>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config","title":"pdmt5.dataframe.Mt5Config","text":"<p>               Bases: <code>BaseModel</code></p> <p>Configuration for MetaTrader5 connection.</p>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.login","title":"login  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>login: int | None = Field(\n    default=None, description=\"Trading account login\"\n)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.model_config","title":"model_config  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>model_config = ConfigDict(frozen=True)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.password","title":"password  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>password: str | None = Field(\n    default=None, description=\"Trading account password\"\n)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.path","title":"path  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>path: str | None = Field(\n    default=None,\n    description=\"Path to MetaTrader5 terminal EXE file\",\n)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.server","title":"server  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>server: str | None = Field(\n    default=None, description=\"Trading server name\"\n)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.timeout","title":"timeout  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>timeout: int | None = Field(\n    default=None,\n    description=\"Connection timeout in milliseconds\",\n)\n</code></pre>"},{"location":"api/dataframe/#mt5dataclient","title":"Mt5DataClient","text":"<p>options: show_bases: false</p> <p>Extended client class that inherits from <code>Mt5Client</code> and provides a pandas-friendly interface to MetaTrader 5 functions with automatic DataFrame conversion.</p>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient","title":"pdmt5.dataframe.Mt5DataClient","text":"<p>               Bases: <code>Mt5Client</code></p> <p>MetaTrader5 data client with pandas DataFrame and dictionary conversion.</p> <p>This class provides a pandas-friendly interface to MetaTrader5 functions, converting native MetaTrader5 data structures to pandas DataFrames with pydantic validation.</p>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.config","title":"config  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>config: Mt5Config = Field(\n    default_factory=Mt5Config,\n    description=\"MetaTrader5 connection configuration\",\n)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.model_config","title":"model_config  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>model_config = ConfigDict(arbitrary_types_allowed=True)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.retry_count","title":"retry_count  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>retry_count: int = Field(\n    default=3,\n    ge=0,\n    description=\"Number of retry attempts for connection initialization\",\n)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.account_info_as_df","title":"account_info_as_df","text":"<pre><code>account_info_as_df(\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get info on the current account as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with account information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\ndef account_info_as_df(self, index_keys: str | None = None) -&gt; pd.DataFrame:  # noqa: ARG002\n    \"\"\"Get info on the current account as a data frame.\n\n    Args:\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with account information.\n    \"\"\"\n    return pd.DataFrame([self.account_info_as_dict()])\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.account_info_as_dict","title":"account_info_as_dict","text":"<pre><code>account_info_as_dict() -&gt; dict[str, Any]\n</code></pre> <p>Get info on the current account as a dictionary.</p> <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dictionary with account information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def account_info_as_dict(self) -&gt; dict[str, Any]:\n    \"\"\"Get info on the current account as a dictionary.\n\n    Returns:\n        Dictionary with account information.\n    \"\"\"\n    return self.account_info()._asdict()\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_from_as_df","title":"copy_rates_from_as_df","text":"<pre><code>copy_rates_from_as_df(\n    symbol: str,\n    timeframe: int,\n    date_from: datetime,\n    count: int,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get bars for a specified date range as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>timeframe</code> <code>int</code> <p>Timeframe constant.</p> required <code>date_from</code> <code>datetime</code> <p>Start date.</p> required <code>count</code> <code>int</code> <p>Number of rates to retrieve.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with OHLCV data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef copy_rates_from_as_df(\n    self,\n    symbol: str,\n    timeframe: int,\n    date_from: datetime,\n    count: int,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get bars for a specified date range as a data frame.\n\n    Args:\n        symbol: Symbol name.\n        timeframe: Timeframe constant.\n        date_from: Start date.\n        count: Number of rates to retrieve.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with OHLCV data.\n    \"\"\"\n    self._validate_positive_count(count=count)\n    return pd.DataFrame(\n        self.copy_rates_from(\n            symbol=symbol,\n            timeframe=timeframe,\n            date_from=date_from,\n            count=count,\n        )\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_from_as_dicts","title":"copy_rates_from_as_dicts","text":"<pre><code>copy_rates_from_as_dicts(\n    symbol: str,\n    timeframe: int,\n    date_from: datetime,\n    count: int,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get bars for a specified date range as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>timeframe</code> <code>int</code> <p>Timeframe constant.</p> required <code>date_from</code> <code>datetime</code> <p>Start date.</p> required <code>count</code> <code>int</code> <p>Number of rates to retrieve.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with OHLCV data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def copy_rates_from_as_dicts(\n    self,\n    symbol: str,\n    timeframe: int,\n    date_from: datetime,\n    count: int,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get bars for a specified date range as a list of dictionaries.\n\n    Args:\n        symbol: Symbol name.\n        timeframe: Timeframe constant.\n        date_from: Start date.\n        count: Number of rates to retrieve.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with OHLCV data.\n    \"\"\"\n    return self.copy_rates_from_as_df(\n        symbol=symbol,\n        timeframe=timeframe,\n        date_from=date_from,\n        count=count,\n        skip_to_datetime=skip_to_datetime,\n        index_keys=None,\n    ).to_dict(orient=\"records\")\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_from_pos_as_df","title":"copy_rates_from_pos_as_df","text":"<pre><code>copy_rates_from_pos_as_df(\n    symbol: str,\n    timeframe: int,\n    start_pos: int,\n    count: int,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get bars from a specified position as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>timeframe</code> <code>int</code> <p>Timeframe constant.</p> required <code>start_pos</code> <code>int</code> <p>Start position.</p> required <code>count</code> <code>int</code> <p>Number of rates to retrieve.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with OHLCV data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef copy_rates_from_pos_as_df(\n    self,\n    symbol: str,\n    timeframe: int,\n    start_pos: int,\n    count: int,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get bars from a specified position as a data frame.\n\n    Args:\n        symbol: Symbol name.\n        timeframe: Timeframe constant.\n        start_pos: Start position.\n        count: Number of rates to retrieve.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with OHLCV data.\n    \"\"\"\n    self._validate_positive_count(count=count)\n    self._validate_non_negative_position(position=start_pos)\n    return pd.DataFrame(\n        self.copy_rates_from_pos(\n            symbol=symbol,\n            timeframe=timeframe,\n            start_pos=start_pos,\n            count=count,\n        )\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_from_pos_as_dicts","title":"copy_rates_from_pos_as_dicts","text":"<pre><code>copy_rates_from_pos_as_dicts(\n    symbol: str,\n    timeframe: int,\n    start_pos: int,\n    count: int,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get bars from a specified position as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>timeframe</code> <code>int</code> <p>Timeframe constant.</p> required <code>start_pos</code> <code>int</code> <p>Start position.</p> required <code>count</code> <code>int</code> <p>Number of rates to retrieve.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with OHLCV data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def copy_rates_from_pos_as_dicts(\n    self,\n    symbol: str,\n    timeframe: int,\n    start_pos: int,\n    count: int,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get bars from a specified position as a list of dictionaries.\n\n    Args:\n        symbol: Symbol name.\n        timeframe: Timeframe constant.\n        start_pos: Start position.\n        count: Number of rates to retrieve.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with OHLCV data.\n    \"\"\"\n    return self.copy_rates_from_pos_as_df(\n        symbol=symbol,\n        timeframe=timeframe,\n        start_pos=start_pos,\n        count=count,\n        skip_to_datetime=skip_to_datetime,\n        index_keys=None,\n    ).to_dict(orient=\"records\")\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_range_as_df","title":"copy_rates_range_as_df","text":"<pre><code>copy_rates_range_as_df(\n    symbol: str,\n    timeframe: int,\n    date_from: datetime,\n    date_to: datetime,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get bars for a specified date range as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>timeframe</code> <code>int</code> <p>Timeframe constant.</p> required <code>date_from</code> <code>datetime</code> <p>Start date.</p> required <code>date_to</code> <code>datetime</code> <p>End date.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with OHLCV data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef copy_rates_range_as_df(\n    self,\n    symbol: str,\n    timeframe: int,\n    date_from: datetime,\n    date_to: datetime,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get bars for a specified date range as a data frame.\n\n    Args:\n        symbol: Symbol name.\n        timeframe: Timeframe constant.\n        date_from: Start date.\n        date_to: End date.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with OHLCV data.\n    \"\"\"\n    self._validate_date_range(date_from=date_from, date_to=date_to)\n    return pd.DataFrame(\n        self.copy_rates_range(\n            symbol=symbol,\n            timeframe=timeframe,\n            date_from=date_from,\n            date_to=date_to,\n        )\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_range_as_dicts","title":"copy_rates_range_as_dicts","text":"<pre><code>copy_rates_range_as_dicts(\n    symbol: str,\n    timeframe: int,\n    date_from: datetime,\n    date_to: datetime,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get bars for a specified date range as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>timeframe</code> <code>int</code> <p>Timeframe constant.</p> required <code>date_from</code> <code>datetime</code> <p>Start date.</p> required <code>date_to</code> <code>datetime</code> <p>End date.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with OHLCV data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def copy_rates_range_as_dicts(\n    self,\n    symbol: str,\n    timeframe: int,\n    date_from: datetime,\n    date_to: datetime,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get bars for a specified date range as a list of dictionaries.\n\n    Args:\n        symbol: Symbol name.\n        timeframe: Timeframe constant.\n        date_from: Start date.\n        date_to: End date.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with OHLCV data.\n    \"\"\"\n    return self.copy_rates_range_as_df(\n        symbol=symbol,\n        timeframe=timeframe,\n        date_from=date_from,\n        date_to=date_to,\n        skip_to_datetime=skip_to_datetime,\n        index_keys=None,\n    ).to_dict(orient=\"records\")\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_ticks_from_as_df","title":"copy_ticks_from_as_df","text":"<pre><code>copy_ticks_from_as_df(\n    symbol: str,\n    date_from: datetime,\n    count: int,\n    flags: int,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get ticks from a specified date as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>date_from</code> <code>datetime</code> <p>Start date.</p> required <code>count</code> <code>int</code> <p>Number of ticks to retrieve.</p> required <code>flags</code> <code>int</code> <p>Tick flags (use constants from MetaTrader5).</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with tick data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef copy_ticks_from_as_df(\n    self,\n    symbol: str,\n    date_from: datetime,\n    count: int,\n    flags: int,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get ticks from a specified date as a data frame.\n\n    Args:\n        symbol: Symbol name.\n        date_from: Start date.\n        count: Number of ticks to retrieve.\n        flags: Tick flags (use constants from MetaTrader5).\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with tick data.\n    \"\"\"\n    self._validate_positive_count(count=count)\n    return pd.DataFrame(\n        self.copy_ticks_from(\n            symbol=symbol,\n            date_from=date_from,\n            count=count,\n            flags=flags,\n        )\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_ticks_from_as_dicts","title":"copy_ticks_from_as_dicts","text":"<pre><code>copy_ticks_from_as_dicts(\n    symbol: str,\n    date_from: datetime,\n    count: int,\n    flags: int,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get ticks from a specified date as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>date_from</code> <code>datetime</code> <p>Start date.</p> required <code>count</code> <code>int</code> <p>Number of ticks to retrieve.</p> required <code>flags</code> <code>int</code> <p>Tick flags (use constants from MetaTrader5).</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with tick data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def copy_ticks_from_as_dicts(\n    self,\n    symbol: str,\n    date_from: datetime,\n    count: int,\n    flags: int,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get ticks from a specified date as a list of dictionaries.\n\n    Args:\n        symbol: Symbol name.\n        date_from: Start date.\n        count: Number of ticks to retrieve.\n        flags: Tick flags (use constants from MetaTrader5).\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with tick data.\n    \"\"\"\n    return self.copy_ticks_from_as_df(\n        symbol=symbol,\n        date_from=date_from,\n        count=count,\n        flags=flags,\n        skip_to_datetime=skip_to_datetime,\n        index_keys=None,\n    ).to_dict(orient=\"records\")  # type: ignore[reportReturnType]\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_ticks_range_as_df","title":"copy_ticks_range_as_df","text":"<pre><code>copy_ticks_range_as_df(\n    symbol: str,\n    date_from: datetime,\n    date_to: datetime,\n    flags: int,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get ticks for a specified date range as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>date_from</code> <code>datetime</code> <p>Start date.</p> required <code>date_to</code> <code>datetime</code> <p>End date.</p> required <code>flags</code> <code>int</code> <p>Tick flags (use constants from MetaTrader5).</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with tick data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef copy_ticks_range_as_df(\n    self,\n    symbol: str,\n    date_from: datetime,\n    date_to: datetime,\n    flags: int,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get ticks for a specified date range as a data frame.\n\n    Args:\n        symbol: Symbol name.\n        date_from: Start date.\n        date_to: End date.\n        flags: Tick flags (use constants from MetaTrader5).\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with tick data.\n    \"\"\"\n    self._validate_date_range(date_from=date_from, date_to=date_to)\n    return pd.DataFrame(\n        self.copy_ticks_range(\n            symbol=symbol,\n            date_from=date_from,\n            date_to=date_to,\n            flags=flags,\n        )\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_ticks_range_as_dicts","title":"copy_ticks_range_as_dicts","text":"<pre><code>copy_ticks_range_as_dicts(\n    symbol: str,\n    date_from: datetime,\n    date_to: datetime,\n    flags: int,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get ticks for a specified date range as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>date_from</code> <code>datetime</code> <p>Start date.</p> required <code>date_to</code> <code>datetime</code> <p>End date.</p> required <code>flags</code> <code>int</code> <p>Tick flags (use constants from MetaTrader5).</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with tick data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def copy_ticks_range_as_dicts(\n    self,\n    symbol: str,\n    date_from: datetime,\n    date_to: datetime,\n    flags: int,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get ticks for a specified date range as a list of dictionaries.\n\n    Args:\n        symbol: Symbol name.\n        date_from: Start date.\n        date_to: End date.\n        flags: Tick flags (use constants from MetaTrader5).\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with tick data.\n    \"\"\"\n    return self.copy_ticks_range_as_df(\n        symbol=symbol,\n        date_from=date_from,\n        date_to=date_to,\n        flags=flags,\n        skip_to_datetime=skip_to_datetime,\n        index_keys=None,\n    ).to_dict(orient=\"records\")  # type: ignore[reportReturnType]\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.history_deals_get_as_df","title":"history_deals_get_as_df","text":"<pre><code>history_deals_get_as_df(\n    date_from: datetime | None = None,\n    date_to: datetime | None = None,\n    group: str | None = None,\n    symbol: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get historical deals with optional filters as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>date_from</code> <code>datetime | None</code> <p>Start date (required if not using ticket/position).</p> <code>None</code> <code>date_to</code> <code>datetime | None</code> <p>End date (required if not using ticket/position).</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Optional group filter.</p> <code>None</code> <code>symbol</code> <code>str | None</code> <p>Optional symbol filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Get deals by order ticket.</p> <code>None</code> <code>position</code> <code>int | None</code> <p>Get deals by position ticket.</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with historical deal information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef history_deals_get_as_df(\n    self,\n    date_from: datetime | None = None,\n    date_to: datetime | None = None,\n    group: str | None = None,\n    symbol: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get historical deals with optional filters as a data frame.\n\n    Args:\n        date_from: Start date (required if not using ticket/position).\n        date_to: End date (required if not using ticket/position).\n        group: Optional group filter.\n        symbol: Optional symbol filter.\n        ticket: Get deals by order ticket.\n        position: Get deals by position ticket.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with historical deal information.\n    \"\"\"\n    return pd.DataFrame(\n        self.history_deals_get_as_dicts(\n            date_from=date_from,\n            date_to=date_to,\n            group=group,\n            symbol=symbol,\n            ticket=ticket,\n            position=position,\n            skip_to_datetime=True,\n        )\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.history_deals_get_as_dicts","title":"history_deals_get_as_dicts","text":"<pre><code>history_deals_get_as_dicts(\n    date_from: datetime | None = None,\n    date_to: datetime | None = None,\n    group: str | None = None,\n    symbol: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get historical deals with optional filters as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>date_from</code> <code>datetime | None</code> <p>Start date (required if not using ticket/position).</p> <code>None</code> <code>date_to</code> <code>datetime | None</code> <p>End date (required if not using ticket/position).</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Optional group filter.</p> <code>None</code> <code>symbol</code> <code>str | None</code> <p>Optional symbol filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Get deals by order ticket.</p> <code>None</code> <code>position</code> <code>int | None</code> <p>Get deals by position ticket.</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with historical deal information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef history_deals_get_as_dicts(\n    self,\n    date_from: datetime | None = None,\n    date_to: datetime | None = None,\n    group: str | None = None,\n    symbol: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get historical deals with optional filters as a list of dictionaries.\n\n    Args:\n        date_from: Start date (required if not using ticket/position).\n        date_to: End date (required if not using ticket/position).\n        group: Optional group filter.\n        symbol: Optional symbol filter.\n        ticket: Get deals by order ticket.\n        position: Get deals by position ticket.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with historical deal information.\n    \"\"\"\n    self._validate_history_input(\n        date_from=date_from,\n        date_to=date_to,\n        ticket=ticket,\n        position=position,\n    )\n    return [\n        d._asdict()\n        for d in self.history_deals_get(\n            date_from=date_from,\n            date_to=date_to,\n            group=(f\"*{symbol}*\" if symbol else group),\n            ticket=ticket,\n            position=position,\n        )\n    ]\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.history_orders_get_as_df","title":"history_orders_get_as_df","text":"<pre><code>history_orders_get_as_df(\n    date_from: datetime | None = None,\n    date_to: datetime | None = None,\n    group: str | None = None,\n    symbol: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get historical orders with optional filters as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>date_from</code> <code>datetime | None</code> <p>Start date (required if not using ticket/position).</p> <code>None</code> <code>date_to</code> <code>datetime | None</code> <p>End date (required if not using ticket/position).</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Optional group filter.</p> <code>None</code> <code>symbol</code> <code>str | None</code> <p>Optional symbol filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Get orders by ticket.</p> <code>None</code> <code>position</code> <code>int | None</code> <p>Get orders by position.</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with historical order information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef history_orders_get_as_df(\n    self,\n    date_from: datetime | None = None,\n    date_to: datetime | None = None,\n    group: str | None = None,\n    symbol: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get historical orders with optional filters as a data frame.\n\n    Args:\n        date_from: Start date (required if not using ticket/position).\n        date_to: End date (required if not using ticket/position).\n        group: Optional group filter.\n        symbol: Optional symbol filter.\n        ticket: Get orders by ticket.\n        position: Get orders by position.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with historical order information.\n    \"\"\"\n    return pd.DataFrame(\n        self.history_orders_get_as_dicts(\n            date_from=date_from,\n            date_to=date_to,\n            group=group,\n            symbol=symbol,\n            ticket=ticket,\n            position=position,\n            skip_to_datetime=True,\n        )\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.history_orders_get_as_dicts","title":"history_orders_get_as_dicts","text":"<pre><code>history_orders_get_as_dicts(\n    date_from: datetime | None = None,\n    date_to: datetime | None = None,\n    group: str | None = None,\n    symbol: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get historical orders with optional filters as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>date_from</code> <code>datetime | None</code> <p>Start date (required if not using ticket/position).</p> <code>None</code> <code>date_to</code> <code>datetime | None</code> <p>End date (required if not using ticket/position).</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Optional group filter.</p> <code>None</code> <code>symbol</code> <code>str | None</code> <p>Optional symbol filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Get orders by ticket.</p> <code>None</code> <code>position</code> <code>int | None</code> <p>Get orders by position.</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with historical order information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef history_orders_get_as_dicts(\n    self,\n    date_from: datetime | None = None,\n    date_to: datetime | None = None,\n    group: str | None = None,\n    symbol: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get historical orders with optional filters as a list of dictionaries.\n\n    Args:\n        date_from: Start date (required if not using ticket/position).\n        date_to: End date (required if not using ticket/position).\n        group: Optional group filter.\n        symbol: Optional symbol filter.\n        ticket: Get orders by ticket.\n        position: Get orders by position.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with historical order information.\n    \"\"\"\n    self._validate_history_input(\n        date_from=date_from,\n        date_to=date_to,\n        ticket=ticket,\n        position=position,\n    )\n    return [\n        o._asdict()\n        for o in self.history_orders_get(\n            date_from=date_from,\n            date_to=date_to,\n            group=(f\"*{symbol}*\" if symbol else group),\n            ticket=ticket,\n            position=position,\n        )\n    ]\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.initialize_and_login_mt5","title":"initialize_and_login_mt5","text":"<pre><code>initialize_and_login_mt5(\n    path: str | None = None,\n    login: int | None = None,\n    password: str | None = None,\n    server: str | None = None,\n    timeout: int | None = None,\n) -&gt; None\n</code></pre> <p>Initialize MetaTrader5 connection with retry logic.</p> <p>This method overrides the base class to add retry logic and use config values.</p> <p>Parameters:</p> Name Type Description Default <code>path</code> <code>str | None</code> <p>Path to terminal EXE file (overrides config).</p> <code>None</code> <code>login</code> <code>int | None</code> <p>Account login (overrides config).</p> <code>None</code> <code>password</code> <code>str | None</code> <p>Account password (overrides config).</p> <code>None</code> <code>server</code> <code>str | None</code> <p>Server name (overrides config).</p> <code>None</code> <code>timeout</code> <code>int | None</code> <p>Connection timeout (overrides config).</p> <code>None</code> <p>Raises:</p> Type Description <code>Mt5RuntimeError</code> <p>If initialization fails after retries.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def initialize_and_login_mt5(\n    self,\n    path: str | None = None,\n    login: int | None = None,\n    password: str | None = None,\n    server: str | None = None,\n    timeout: int | None = None,\n) -&gt; None:\n    \"\"\"Initialize MetaTrader5 connection with retry logic.\n\n    This method overrides the base class to add retry logic and use config values.\n\n    Args:\n        path: Path to terminal EXE file (overrides config).\n        login: Account login (overrides config).\n        password: Account password (overrides config).\n        server: Server name (overrides config).\n        timeout: Connection timeout (overrides config).\n\n    Raises:\n        Mt5RuntimeError: If initialization fails after retries.\n    \"\"\"\n    path = path or self.config.path\n    login_kwargs = {\n        \"login\": login or self.config.login,\n        \"password\": password or self.config.password,\n        \"server\": server or self.config.server,\n        \"timeout\": timeout or self.config.timeout,\n    }\n    for i in range(1 + max(0, self.retry_count)):\n        if i:\n            self.logger.warning(\n                \"Retrying MT5 initialization (%d/%d)...\",\n                i,\n                self.retry_count,\n            )\n            time.sleep(i)\n        if self.initialize(path=path, **login_kwargs) and (\n            (not login_kwargs[\"login\"]) or self.login(**login_kwargs)\n        ):\n            return\n    error_message = (\n        f\"MT5 initialize and login failed after {self.retry_count} retries:\"\n        f\" {self.last_error()}\"\n    )\n    raise Mt5RuntimeError(error_message)\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.last_error_as_df","title":"last_error_as_df","text":"<pre><code>last_error_as_df(\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get the last error information as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with last error information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\ndef last_error_as_df(self, index_keys: str | None = None) -&gt; pd.DataFrame:  # noqa: ARG002\n    \"\"\"Get the last error information as a data frame.\n\n    Args:\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with last error information.\n    \"\"\"\n    return pd.DataFrame([self.last_error_as_dict()])\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.last_error_as_dict","title":"last_error_as_dict","text":"<pre><code>last_error_as_dict() -&gt; dict[str, Any]\n</code></pre> <p>Get the last error information as a dictionary.</p> <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dictionary with last error information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def last_error_as_dict(self) -&gt; dict[str, Any]:\n    \"\"\"Get the last error information as a dictionary.\n\n    Returns:\n        Dictionary with last error information.\n    \"\"\"\n    response = self.last_error()\n    return {\"error_code\": response[0], \"error_description\": response[1]}\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.market_book_get_as_df","title":"market_book_get_as_df","text":"<pre><code>market_book_get_as_df(\n    symbol: str,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get market depth for a specified symbol as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with market depth data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef market_book_get_as_df(\n    self,\n    symbol: str,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get market depth for a specified symbol as a data frame.\n\n    Args:\n        symbol: Symbol name.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with market depth data.\n    \"\"\"\n    return pd.DataFrame(\n        self.market_book_get_as_dicts(symbol=symbol, skip_to_datetime=True)\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.market_book_get_as_dicts","title":"market_book_get_as_dicts","text":"<pre><code>market_book_get_as_dicts(\n    symbol: str, skip_to_datetime: bool = False\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get market depth for a specified symbol as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with market depth data.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef market_book_get_as_dicts(\n    self,\n    symbol: str,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get market depth for a specified symbol as a list of dictionaries.\n\n    Args:\n        symbol: Symbol name.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with market depth data.\n    \"\"\"\n    return [b._asdict() for b in self.market_book_get(symbol=symbol)]\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.order_check_as_df","title":"order_check_as_df","text":"<pre><code>order_check_as_df(\n    request: dict[str, Any], index_keys: str | None = None\n) -&gt; DataFrame\n</code></pre> <p>Check funds sufficiency for performing a requested trading operation as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>request</code> <code>dict[str, Any]</code> <p>Order request parameters.</p> required <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with order check results.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\ndef order_check_as_df(\n    self,\n    request: dict[str, Any],\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Check funds sufficiency for performing a requested trading operation as a data frame.\n\n    Args:\n        request: Order request parameters.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with order check results.\n    \"\"\"  # noqa: E501\n    return pd.DataFrame([\n        self._flatten_dict_to_one_level(\n            dictionary=self.order_check_as_dict(request=request),\n        )\n    ])\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.order_check_as_dict","title":"order_check_as_dict","text":"<pre><code>order_check_as_dict(\n    request: dict[str, Any],\n) -&gt; dict[str, Any]\n</code></pre> <p>Check funds sufficiency for performing a requested trading operation as a dictionary.</p> <p>Parameters:</p> Name Type Description Default <code>request</code> <code>dict[str, Any]</code> <p>Order request parameters.</p> required <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dictionary with order check results.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def order_check_as_dict(self, request: dict[str, Any]) -&gt; dict[str, Any]:\n    \"\"\"Check funds sufficiency for performing a requested trading operation as a dictionary.\n\n    Args:\n        request: Order request parameters.\n\n    Returns:\n        Dictionary with order check results.\n    \"\"\"  # noqa: E501\n    return {\n        k: (v._asdict() if k == \"request\" else v)\n        for k, v in self.order_check(request=request)._asdict().items()\n    }\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.order_send_as_df","title":"order_send_as_df","text":"<pre><code>order_send_as_df(\n    request: dict[str, Any], index_keys: str | None = None\n) -&gt; DataFrame\n</code></pre> <p>Send a request to perform a trading operation from the terminal to the trade server as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>request</code> <code>dict[str, Any]</code> <p>Order request parameters.</p> required <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with order send results.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\ndef order_send_as_df(\n    self,\n    request: dict[str, Any],\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Send a request to perform a trading operation from the terminal to the trade server as a data frame.\n\n    Args:\n        request: Order request parameters.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with order send results.\n    \"\"\"  # noqa: E501\n    return pd.DataFrame([\n        self._flatten_dict_to_one_level(\n            dictionary=self.order_send_as_dict(request=request),\n        )\n    ])\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.order_send_as_dict","title":"order_send_as_dict","text":"<pre><code>order_send_as_dict(\n    request: dict[str, Any],\n) -&gt; dict[str, Any]\n</code></pre> <p>Send a request to perform a trading operation from the terminal to the trade server as a dictionary.</p> <p>Parameters:</p> Name Type Description Default <code>request</code> <code>dict[str, Any]</code> <p>Order request parameters.</p> required <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dictionary with order send results.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def order_send_as_dict(self, request: dict[str, Any]) -&gt; dict[str, Any]:\n    \"\"\"Send a request to perform a trading operation from the terminal to the trade server as a dictionary.\n\n    Args:\n        request: Order request parameters.\n\n    Returns:\n        Dictionary with order send results.\n    \"\"\"  # noqa: E501\n    return {\n        k: (v._asdict() if k == \"request\" else v)\n        for k, v in self.order_send(request=request)._asdict().items()\n    }\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.orders_get_as_df","title":"orders_get_as_df","text":"<pre><code>orders_get_as_df(\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get active orders with optional filters as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str | None</code> <p>Optional symbol filter.</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Optional group filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Optional order ticket filter.</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with order information or empty DataFrame if no orders.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef orders_get_as_df(\n    self,\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get active orders with optional filters as a data frame.\n\n    Args:\n        symbol: Optional symbol filter.\n        group: Optional group filter.\n        ticket: Optional order ticket filter.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with order information or empty DataFrame if no orders.\n    \"\"\"\n    return pd.DataFrame(\n        self.orders_get_as_dicts(\n            symbol=symbol,\n            group=group,\n            ticket=ticket,\n            skip_to_datetime=True,\n        )\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.orders_get_as_dicts","title":"orders_get_as_dicts","text":"<pre><code>orders_get_as_dicts(\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get active orders with optional filters as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str | None</code> <p>Optional symbol filter.</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Optional group filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Optional order ticket filter.</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with order information or empty list if no orders.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef orders_get_as_dicts(\n    self,\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get active orders with optional filters as a list of dictionaries.\n\n    Args:\n        symbol: Optional symbol filter.\n        group: Optional group filter.\n        ticket: Optional order ticket filter.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with order information or empty list if no orders.\n    \"\"\"\n    return [\n        o._asdict()\n        for o in self.orders_get(symbol=symbol, group=group, ticket=ticket)\n    ]\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.positions_get_as_df","title":"positions_get_as_df","text":"<pre><code>positions_get_as_df(\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get open positions with optional filters as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str | None</code> <p>Optional symbol filter.</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Optional group filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Optional position ticket filter.</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with position information or empty DataFrame if no positions.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef positions_get_as_df(\n    self,\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get open positions with optional filters as a data frame.\n\n    Args:\n        symbol: Optional symbol filter.\n        group: Optional group filter.\n        ticket: Optional position ticket filter.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with position information or empty DataFrame if no positions.\n    \"\"\"\n    return pd.DataFrame(\n        self.positions_get_as_dicts(\n            symbol=symbol,\n            group=group,\n            ticket=ticket,\n            skip_to_datetime=True,\n        )\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.positions_get_as_dicts","title":"positions_get_as_dicts","text":"<pre><code>positions_get_as_dicts(\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    skip_to_datetime: bool = False,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get open positions with optional filters as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str | None</code> <p>Optional symbol filter.</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Optional group filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Optional position ticket filter.</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with position information or empty list if no</p> <code>list[dict[str, Any]]</code> <p>positions.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef positions_get_as_dicts(\n    self,\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get open positions with optional filters as a list of dictionaries.\n\n    Args:\n        symbol: Optional symbol filter.\n        group: Optional group filter.\n        ticket: Optional position ticket filter.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with position information or empty list if no\n        positions.\n    \"\"\"\n    return [\n        p._asdict()\n        for p in self.positions_get(symbol=symbol, group=group, ticket=ticket)\n    ]\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbol_info_as_df","title":"symbol_info_as_df","text":"<pre><code>symbol_info_as_df(\n    symbol: str,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get data on a specific symbol as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with symbol information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef symbol_info_as_df(\n    self,\n    symbol: str,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get data on a specific symbol as a data frame.\n\n    Args:\n        symbol: Symbol name.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with symbol information.\n    \"\"\"\n    return pd.DataFrame([\n        self.symbol_info_as_dict(symbol=symbol, skip_to_datetime=True)\n    ])\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbol_info_as_dict","title":"symbol_info_as_dict","text":"<pre><code>symbol_info_as_dict(\n    symbol: str, skip_to_datetime: bool = False\n) -&gt; dict[str, Any]\n</code></pre> <p>Get data on a specific symbol as a dictionary.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dictionary with symbol information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef symbol_info_as_dict(\n    self,\n    symbol: str,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n) -&gt; dict[str, Any]:\n    \"\"\"Get data on a specific symbol as a dictionary.\n\n    Args:\n        symbol: Symbol name.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        Dictionary with symbol information.\n    \"\"\"\n    return self.symbol_info(symbol=symbol)._asdict()\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbol_info_tick_as_df","title":"symbol_info_tick_as_df","text":"<pre><code>symbol_info_tick_as_df(\n    symbol: str,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get the last tick for the specified financial instrument as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with tick information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef symbol_info_tick_as_df(\n    self,\n    symbol: str,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get the last tick for the specified financial instrument as a data frame.\n\n    Args:\n        symbol: Symbol name.\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with tick information.\n    \"\"\"\n    return pd.DataFrame([\n        self.symbol_info_tick_as_dict(symbol=symbol, skip_to_datetime=True)\n    ])\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbol_info_tick_as_dict","title":"symbol_info_tick_as_dict","text":"<pre><code>symbol_info_tick_as_dict(\n    symbol: str, skip_to_datetime: bool = False\n) -&gt; dict[str, Any]\n</code></pre> <p>Get the last tick for the specified financial instrument as a dictionary.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dictionary with tick information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef symbol_info_tick_as_dict(\n    self,\n    symbol: str,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n) -&gt; dict[str, Any]:\n    \"\"\"Get the last tick for the specified financial instrument as a dictionary.\n\n    Args:\n        symbol: Symbol name.\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        Dictionary with tick information.\n    \"\"\"\n    return self.symbol_info_tick(symbol=symbol)._asdict()\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbols_get_as_df","title":"symbols_get_as_df","text":"<pre><code>symbols_get_as_df(\n    group: str | None = None,\n    skip_to_datetime: bool = False,\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get symbols as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>group</code> <code>str | None</code> <p>Symbol group filter (e.g., \"USD\", \"Forex*\").</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with symbol information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\n@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef symbols_get_as_df(\n    self,\n    group: str | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n    index_keys: str | None = None,  # noqa: ARG002\n) -&gt; pd.DataFrame:\n    \"\"\"Get symbols as a data frame.\n\n    Args:\n        group: Symbol group filter (e.g., \"*USD*\", \"Forex*\").\n        skip_to_datetime: Whether to skip converting time to datetime.\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with symbol information.\n    \"\"\"\n    return pd.DataFrame(\n        self.symbols_get_as_dicts(group=group, skip_to_datetime=True)\n    )\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbols_get_as_dicts","title":"symbols_get_as_dicts","text":"<pre><code>symbols_get_as_dicts(\n    group: str | None = None, skip_to_datetime: bool = False\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Get symbols as a list of dictionaries.</p> <p>Parameters:</p> Name Type Description Default <code>group</code> <code>str | None</code> <p>Symbol group filter (e.g., \"USD\", \"Forex*\").</p> <code>None</code> <code>skip_to_datetime</code> <code>bool</code> <p>Whether to skip converting time to datetime.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with symbol information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@detect_and_convert_time_to_datetime(skip_toggle=\"skip_to_datetime\")\ndef symbols_get_as_dicts(\n    self,\n    group: str | None = None,\n    skip_to_datetime: bool = False,  # noqa: ARG002\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Get symbols as a list of dictionaries.\n\n    Args:\n        group: Symbol group filter (e.g., \"*USD*\", \"Forex*\").\n        skip_to_datetime: Whether to skip converting time to datetime.\n\n    Returns:\n        List of dictionaries with symbol information.\n    \"\"\"\n    return [s._asdict() for s in self.symbols_get(group=group)]\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.terminal_info_as_df","title":"terminal_info_as_df","text":"<pre><code>terminal_info_as_df(\n    index_keys: str | None = None,\n) -&gt; DataFrame\n</code></pre> <p>Get the connected terminal status and settings as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with terminal information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\ndef terminal_info_as_df(self, index_keys: str | None = None) -&gt; pd.DataFrame:  # noqa: ARG002\n    \"\"\"Get the connected terminal status and settings as a data frame.\n\n    Args:\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with terminal information.\n    \"\"\"\n    return pd.DataFrame([self.terminal_info_as_dict()])\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.terminal_info_as_dict","title":"terminal_info_as_dict","text":"<pre><code>terminal_info_as_dict() -&gt; dict[str, Any]\n</code></pre> <p>Get the connected terminal status and settings as a dictionary.</p> <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dictionary with terminal information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def terminal_info_as_dict(self) -&gt; dict[str, Any]:\n    \"\"\"Get the connected terminal status and settings as a dictionary.\n\n    Returns:\n        Dictionary with terminal information.\n    \"\"\"\n    return self.terminal_info()._asdict()\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.version_as_df","title":"version_as_df","text":"<pre><code>version_as_df(index_keys: str | None = None) -&gt; DataFrame\n</code></pre> <p>Return MetaTrader5 version information as a data frame.</p> <p>Parameters:</p> Name Type Description Default <code>index_keys</code> <code>str | None</code> <p>Column name to set as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>DataFrame with MetaTrader5 version information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>@set_index_if_possible(index_parameters=\"index_keys\")\ndef version_as_df(self, index_keys: str | None = None) -&gt; pd.DataFrame:  # noqa: ARG002\n    \"\"\"Return MetaTrader5 version information as a data frame.\n\n    Args:\n        index_keys: Column name to set as index if provided.\n\n    Returns:\n        DataFrame with MetaTrader5 version information.\n    \"\"\"\n    return pd.DataFrame([self.version_as_dict()])\n</code></pre>"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.version_as_dict","title":"version_as_dict","text":"<pre><code>version_as_dict() -&gt; dict[str, int | str]\n</code></pre> <p>Return MetaTrader5 version information as a dictionary.</p> <p>Returns:</p> Type Description <code>dict[str, int | str]</code> <p>Dictionary with MetaTrader5 version information.</p> Source code in <code>pdmt5/dataframe.py</code> <pre><code>def version_as_dict(self) -&gt; dict[str, int | str]:\n    \"\"\"Return MetaTrader5 version information as a dictionary.\n\n    Returns:\n        Dictionary with MetaTrader5 version information.\n    \"\"\"\n    response = self.version()\n    return {\n        \"mt5_terminal_version\": response[0],\n        \"build\": response[1],\n        \"build_release_date\": response[2],\n    }\n</code></pre>"},{"location":"api/dataframe/#usage-examples","title":"Usage Examples","text":""},{"location":"api/dataframe/#basic-connection","title":"Basic Connection","text":"<pre><code>import MetaTrader5 as mt5\nfrom pdmt5.dataframe import Mt5DataClient, Mt5Config\n\n# Create configuration\nconfig = Mt5Config(\n    login=123456,\n    password=\"your_password\",\n    server=\"broker_server\"\n)\n\n# Create client\nclient = Mt5DataClient(mt5=mt5, config=config)\n\n# Use as context manager\nwith client:\n    # Get account information\n    account_df = client.account_info()\n    print(account_df)\n</code></pre>"},{"location":"api/dataframe/#retrieving-market-data","title":"Retrieving Market Data","text":"<pre><code>from datetime import datetime\nimport MetaTrader5 as mt5\n\nwith client:\n    # Get OHLCV data\n    rates_df = client.copy_rates_from(\n        symbol=\"EURUSD\",\n        timeframe=mt5.TIMEFRAME_H1,\n        date_from=datetime(2024, 1, 1),\n        count=1000\n    )\n\n    # Get tick data\n    ticks_df = client.copy_ticks_from(\n        symbol=\"EURUSD\",\n        date_from=datetime(2024, 1, 1),\n        count=1000,\n        flags=mt5.COPY_TICKS_ALL\n    )\n</code></pre>"},{"location":"api/dataframe/#symbol-information","title":"Symbol Information","text":"<pre><code>with client:\n    # Get all symbols\n    symbols_df = client.symbols_get()\n\n    # Get specific symbol info\n    symbol_info_df = client.symbol_info(\"EURUSD\")\n\n    # Get current tick\n    tick_df = client.symbol_info_tick(\"EURUSD\")\n</code></pre>"},{"location":"api/dataframe/#trading-history","title":"Trading History","text":"<pre><code>from datetime import datetime\n\nwith client:\n    # Get historical orders\n    orders_df = client.history_orders_get(\n        date_from=datetime(2024, 1, 1),\n        date_to=datetime(2024, 1, 31),\n        symbol=\"EURUSD\"\n    )\n\n    # Get historical deals\n    deals_df = client.history_deals_get(\n        date_from=datetime(2024, 1, 1),\n        date_to=datetime(2024, 1, 31)\n    )\n</code></pre>"},{"location":"api/dataframe/#current-positions-and-orders","title":"Current Positions and Orders","text":"<pre><code>with client:\n    # Get current positions\n    positions_df = client.positions_get()\n\n    # Get current orders\n    orders_df = client.orders_get(symbol=\"EURUSD\")\n</code></pre>"},{"location":"api/dataframe/#data-conversion-features","title":"Data Conversion Features","text":"<p>The Mt5DataClient automatically handles:</p> <ul> <li>Time Conversion: Converts Unix timestamps to pandas datetime objects</li> <li>Index Setting: Sets appropriate datetime indexes for time-series data</li> <li>DataFrame Creation: Converts MetaTrader 5 named tuples to pandas DataFrames</li> <li>Error Handling: Provides meaningful error messages for failed operations</li> <li>Empty Data: Returns empty DataFrames when no data is available</li> </ul>"},{"location":"api/dataframe/#error-handling","title":"Error Handling","text":"<p>All methods raise <code>Mt5RuntimeError</code> exceptions with detailed error information when operations fail:</p> <pre><code>from pdmt5.mt5 import Mt5RuntimeError\n\ntry:\n    rates_df = client.copy_rates_from(\"INVALID\", mt5.TIMEFRAME_H1, datetime.now(), 100)\nexcept Mt5RuntimeError as e:\n    print(f\"MetaTrader 5 error: {e}\")\n</code></pre>"},{"location":"api/dataframe/#connection-management","title":"Connection Management","text":"<p>The client supports both explicit and context manager usage:</p> <pre><code># Explicit initialization\nclient.initialize()\ntry:\n    # Your trading operations\n    pass\nfinally:\n    client.shutdown()\n\n# Context manager (recommended)\nwith client:\n    # Your trading operations\n    pass\n</code></pre>"},{"location":"api/dataframe/#type-safety","title":"Type Safety","text":"<p>All methods include comprehensive type hints and use pydantic for configuration validation, ensuring type safety throughout the codebase.</p>"},{"location":"api/deployment/","title":"Deployment Guide (Windows Service)","text":"<p>This guide describes how to deploy the pdmt5 REST API as a Windows service alongside the MetaTrader 5 terminal.</p>"},{"location":"api/deployment/#prerequisites","title":"Prerequisites","text":"<ul> <li>Windows 10/11</li> <li>MetaTrader 5 installed and logged in</li> <li>Python 3.11+</li> <li><code>pdmt5[api]</code> installed</li> </ul>"},{"location":"api/deployment/#service-setup-nssm","title":"Service Setup (NSSM)","text":"<ol> <li>Download NSSM: https://nssm.cc/download</li> <li>Open an elevated PowerShell session.</li> <li>Create a service:</li> </ol> <pre><code>nssm install pdmt5-api\n</code></pre> <ol> <li> <p>Set the application path and arguments:</p> </li> <li> <p>Path: <code>C:\\Path\\To\\Python\\python.exe</code></p> </li> <li>Arguments: <code>-m uvicorn pdmt5.api.main:app --host 0.0.0.0 --port 8000</code></li> <li> <p>Startup directory: your project directory</p> </li> <li> <p>Set environment variables in the NSSM GUI:</p> </li> </ol> <pre><code>MT5_API_KEY=your-secret-api-key\nAPI_LOG_LEVEL=INFO\nAPI_RATE_LIMIT=100\nAPI_CORS_ORIGINS=*\n</code></pre> <ol> <li>Start the service:</li> </ol> <pre><code>nssm start pdmt5-api\n</code></pre>"},{"location":"api/deployment/#validation","title":"Validation","text":"<pre><code>curl http://localhost:8000/api/v1/health\n</code></pre> <p>Expected status: <code>healthy</code> (or <code>unhealthy</code> if MT5 is not connected).</p>"},{"location":"api/deployment/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>Ensure the MT5 terminal is running and logged in.</li> <li>Confirm firewall rules allow inbound traffic on the API port.</li> <li>Check Windows Event Viewer for NSSM service logs.</li> </ul>"},{"location":"api/mt5/","title":"Mt5Client","text":""},{"location":"api/mt5/#pdmt5.mt5","title":"pdmt5.mt5","text":"<p>MetaTrader5 client wrapper class.</p>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client","title":"Mt5Client","text":"<p>               Bases: <code>BaseModel</code></p> <p>MetaTrader5 client class.</p> <p>This class provides a wrapper interface to all MetaTrader5 functions, delegating calls to the underlying MetaTrader5 module while providing error handling and logging capabilities.</p>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.logger","title":"logger  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>logger: Logger = Field(\n    default_factory=lambda: getLogger(__name__),\n    description=\"Logger instance for MetaTrader5 operations\",\n)\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.model_config","title":"model_config  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>model_config = ConfigDict(arbitrary_types_allowed=True)\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.mt5","title":"mt5  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>mt5: ModuleType = Field(\n    default_factory=lambda: import_module(\"MetaTrader5\"),\n    description=\"MetaTrader5 module instance\",\n)\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.__enter__","title":"__enter__","text":"<pre><code>__enter__() -&gt; Self\n</code></pre> <p>Context manager entry.</p> <p>Returns:</p> Name Type Description <code>Mt5Client</code> <code>Self</code> <p>The client instance.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>def __enter__(self) -&gt; Self:\n    \"\"\"Context manager entry.\n\n    Returns:\n        Mt5Client: The client instance.\n    \"\"\"\n    self.initialize()\n    return self\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.__exit__","title":"__exit__","text":"<pre><code>__exit__(\n    exc_type: type[BaseException] | None,\n    exc_val: BaseException | None,\n    exc_tb: TracebackType | None,\n) -&gt; None\n</code></pre> <p>Context manager exit.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>def __exit__(\n    self,\n    exc_type: type[BaseException] | None,\n    exc_val: BaseException | None,\n    exc_tb: TracebackType | None,\n) -&gt; None:\n    \"\"\"Context manager exit.\"\"\"\n    self.shutdown()\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.account_info","title":"account_info","text":"<pre><code>account_info() -&gt; Any\n</code></pre> <p>Get info on the current trading account.</p> <p>Returns:</p> Type Description <code>Any</code> <p>AccountInfo structure or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef account_info(self) -&gt; Any:\n    \"\"\"Get info on the current trading account.\n\n    Returns:\n        AccountInfo structure or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Retrieving account information.\")\n    response = self.mt5.account_info()\n    self._validate_mt5_response_is_not_none(\n        response=response, operation=\"account_info\"\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_rates_from","title":"copy_rates_from","text":"<pre><code>copy_rates_from(\n    symbol: str,\n    timeframe: int,\n    date_from: datetime | int,\n    count: int,\n) -&gt; Any\n</code></pre> <p>Get bars from the terminal starting from the specified date.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>timeframe</code> <code>int</code> <p>Timeframe constant.</p> required <code>date_from</code> <code>datetime | int</code> <p>Start date or timestamp.</p> required <code>count</code> <code>int</code> <p>Number of bars to retrieve.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>Array of rates or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef copy_rates_from(\n    self,\n    symbol: str,\n    timeframe: int,\n    date_from: datetime | int,\n    count: int,\n) -&gt; Any:\n    \"\"\"Get bars from the terminal starting from the specified date.\n\n    Args:\n        symbol: Symbol name.\n        timeframe: Timeframe constant.\n        date_from: Start date or timestamp.\n        count: Number of bars to retrieve.\n\n    Returns:\n        Array of rates or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\n        \"Copying rates from symbol: %s, timeframe: %d, date_from: %s, count: %d\",\n        symbol,\n        timeframe,\n        date_from,\n        count,\n    )\n    response = self.mt5.copy_rates_from(symbol, timeframe, date_from, count)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"copy_rates_from\",\n        context=(\n            f\"symbol={symbol}, timeframe={timeframe},\"\n            f\" date_from={date_from}, count={count}\"\n        ),\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_rates_from_pos","title":"copy_rates_from_pos","text":"<pre><code>copy_rates_from_pos(\n    symbol: str, timeframe: int, start_pos: int, count: int\n) -&gt; Any\n</code></pre> <p>Get bars from the terminal starting from the specified index.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>timeframe</code> <code>int</code> <p>Timeframe constant.</p> required <code>start_pos</code> <code>int</code> <p>Starting position.</p> required <code>count</code> <code>int</code> <p>Number of bars to retrieve.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>Array of rates or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef copy_rates_from_pos(\n    self,\n    symbol: str,\n    timeframe: int,\n    start_pos: int,\n    count: int,\n) -&gt; Any:\n    \"\"\"Get bars from the terminal starting from the specified index.\n\n    Args:\n        symbol: Symbol name.\n        timeframe: Timeframe constant.\n        start_pos: Starting position.\n        count: Number of bars to retrieve.\n\n    Returns:\n        Array of rates or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\n        (\n            \"Copying rates from position:\"\n            \" symbol=%s, timeframe=%d, start_pos=%d, count=%d\"\n        ),\n        symbol,\n        timeframe,\n        start_pos,\n        count,\n    )\n    response = self.mt5.copy_rates_from_pos(symbol, timeframe, start_pos, count)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"copy_rates_from_pos\",\n        context=(\n            f\"symbol={symbol}, timeframe={timeframe},\"\n            f\" start_pos={start_pos}, count={count}\"\n        ),\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_rates_range","title":"copy_rates_range","text":"<pre><code>copy_rates_range(\n    symbol: str,\n    timeframe: int,\n    date_from: datetime | int,\n    date_to: datetime | int,\n) -&gt; Any\n</code></pre> <p>Get bars in the specified date range from the terminal.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>timeframe</code> <code>int</code> <p>Timeframe constant.</p> required <code>date_from</code> <code>datetime | int</code> <p>Start date or timestamp.</p> required <code>date_to</code> <code>datetime | int</code> <p>End date or timestamp.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>Array of rates or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef copy_rates_range(\n    self,\n    symbol: str,\n    timeframe: int,\n    date_from: datetime | int,\n    date_to: datetime | int,\n) -&gt; Any:\n    \"\"\"Get bars in the specified date range from the terminal.\n\n    Args:\n        symbol: Symbol name.\n        timeframe: Timeframe constant.\n        date_from: Start date or timestamp.\n        date_to: End date or timestamp.\n\n    Returns:\n        Array of rates or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\n        \"Copying rates range: symbol=%s, timeframe=%d, date_from=%s, date_to=%s\",\n        symbol,\n        timeframe,\n        date_from,\n        date_to,\n    )\n    response = self.mt5.copy_rates_range(symbol, timeframe, date_from, date_to)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"copy_rates_range\",\n        context=(\n            f\"symbol={symbol}, timeframe={timeframe},\"\n            f\" date_from={date_from}, date_to={date_to}\"\n        ),\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_ticks_from","title":"copy_ticks_from","text":"<pre><code>copy_ticks_from(\n    symbol: str,\n    date_from: datetime | int,\n    count: int,\n    flags: int,\n) -&gt; Any\n</code></pre> <p>Get ticks from the terminal starting from the specified date.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>date_from</code> <code>datetime | int</code> <p>Start date or timestamp.</p> required <code>count</code> <code>int</code> <p>Number of ticks to retrieve.</p> required <code>flags</code> <code>int</code> <p>Tick flags.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>Array of ticks or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef copy_ticks_from(\n    self,\n    symbol: str,\n    date_from: datetime | int,\n    count: int,\n    flags: int,\n) -&gt; Any:\n    \"\"\"Get ticks from the terminal starting from the specified date.\n\n    Args:\n        symbol: Symbol name.\n        date_from: Start date or timestamp.\n        count: Number of ticks to retrieve.\n        flags: Tick flags.\n\n    Returns:\n        Array of ticks or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\n        \"Copying ticks from symbol: %s, date_from: %s, count: %d, flags: %d\",\n        symbol,\n        date_from,\n        count,\n        flags,\n    )\n    response = self.mt5.copy_ticks_from(symbol, date_from, count, flags)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"copy_ticks_from\",\n        context=(\n            f\"symbol={symbol}, date_from={date_from}, count={count}, flags={flags}\"\n        ),\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_ticks_range","title":"copy_ticks_range","text":"<pre><code>copy_ticks_range(\n    symbol: str,\n    date_from: datetime | int,\n    date_to: datetime | int,\n    flags: int,\n) -&gt; Any\n</code></pre> <p>Get ticks for the specified date range from the terminal.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>date_from</code> <code>datetime | int</code> <p>Start date or timestamp.</p> required <code>date_to</code> <code>datetime | int</code> <p>End date or timestamp.</p> required <code>flags</code> <code>int</code> <p>Tick flags.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>Array of ticks or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef copy_ticks_range(\n    self,\n    symbol: str,\n    date_from: datetime | int,\n    date_to: datetime | int,\n    flags: int,\n) -&gt; Any:\n    \"\"\"Get ticks for the specified date range from the terminal.\n\n    Args:\n        symbol: Symbol name.\n        date_from: Start date or timestamp.\n        date_to: End date or timestamp.\n        flags: Tick flags.\n\n    Returns:\n        Array of ticks or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\n        \"Copying ticks range: symbol=%s, date_from=%s, date_to=%s, flags=%d\",\n        symbol,\n        date_from,\n        date_to,\n        flags,\n    )\n    response = self.mt5.copy_ticks_range(symbol, date_from, date_to, flags)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"copy_ticks_range\",\n        context=(\n            f\"symbol={symbol}, date_from={date_from},\"\n            f\" date_to={date_to}, flags={flags}\"\n        ),\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.history_deals_get","title":"history_deals_get","text":"<pre><code>history_deals_get(\n    date_from: datetime | int | None = None,\n    date_to: datetime | int | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n) -&gt; tuple[Any, ...]\n</code></pre> <p>Get deals from trading history within the specified interval with the ability to filter by ticket or position.</p> <p>Parameters:</p> Name Type Description Default <code>date_from</code> <code>datetime | int | None</code> <p>Start date or timestamp.</p> <code>None</code> <code>date_to</code> <code>datetime | int | None</code> <p>End date or timestamp.</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Group filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Order ticket filter.</p> <code>None</code> <code>position</code> <code>int | None</code> <p>Position ticket filter.</p> <code>None</code> <p>Returns:</p> Type Description <code>tuple[Any, ...]</code> <p>Tuple of historical deal info structures or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef history_deals_get(\n    self,\n    date_from: datetime | int | None = None,\n    date_to: datetime | int | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n) -&gt; tuple[Any, ...]:\n    \"\"\"Get deals from trading history within the specified interval with the ability to filter by ticket or position.\n\n    Args:\n        date_from: Start date or timestamp.\n        date_to: End date or timestamp.\n        group: Group filter.\n        ticket: Order ticket filter.\n        position: Position ticket filter.\n\n    Returns:\n        Tuple of historical deal info structures or None.\n    \"\"\"  # noqa: E501\n    self._initialize_if_needed()\n    if ticket is not None:\n        self.logger.info(\"Retrieving deal with ticket: %d\", ticket)\n        response = self.mt5.history_deals_get(ticket=ticket)\n        context = f\"ticket={ticket}\"\n    elif position is not None:\n        self.logger.info(\"Retrieving deal for position: %d\", position)\n        response = self.mt5.history_deals_get(position=position)\n        context = f\"position={position}\"\n    elif group is not None:\n        self.logger.info(\n            \"Retrieving deals for group: %s, date_from: %s, date_to: %s\",\n            group,\n            date_from,\n            date_to,\n        )\n        response = self.mt5.history_deals_get(date_from, date_to, group=group)\n        context = f\"date_from={date_from}, date_to={date_to}, group={group}\"\n    else:\n        self.logger.info(\n            \"Retrieving all historical deals from %s to %s\",\n            date_from,\n            date_to,\n        )\n        response = self.mt5.history_deals_get(date_from, date_to)\n        context = f\"date_from={date_from}, date_to={date_to}\"\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"history_deals_get\",\n        context=context,\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.history_deals_total","title":"history_deals_total","text":"<pre><code>history_deals_total(\n    date_from: datetime | int, date_to: datetime | int\n) -&gt; int\n</code></pre> <p>Get the number of deals in trading history within the specified interval.</p> <p>Parameters:</p> Name Type Description Default <code>date_from</code> <code>datetime | int</code> <p>Start date or timestamp.</p> required <code>date_to</code> <code>datetime | int</code> <p>End date or timestamp.</p> required <p>Returns:</p> Type Description <code>int</code> <p>Number of historical deals.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef history_deals_total(\n    self,\n    date_from: datetime | int,\n    date_to: datetime | int,\n) -&gt; int:\n    \"\"\"Get the number of deals in trading history within the specified interval.\n\n    Args:\n        date_from: Start date or timestamp.\n        date_to: End date or timestamp.\n\n    Returns:\n        Number of historical deals.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\n        \"Retrieving total number of historical deals from %s to %s\",\n        date_from,\n        date_to,\n    )\n    return self.mt5.history_deals_total(date_from, date_to)\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.history_orders_get","title":"history_orders_get","text":"<pre><code>history_orders_get(\n    date_from: datetime | int | None = None,\n    date_to: datetime | int | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n) -&gt; tuple[Any, ...]\n</code></pre> <p>Get orders from trading history with the ability to filter by ticket or position.</p> <p>Parameters:</p> Name Type Description Default <code>date_from</code> <code>datetime | int | None</code> <p>Start date or timestamp.</p> <code>None</code> <code>date_to</code> <code>datetime | int | None</code> <p>End date or timestamp.</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Group filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Order ticket filter.</p> <code>None</code> <code>position</code> <code>int | None</code> <p>Position ticket filter.</p> <code>None</code> <p>Returns:</p> Type Description <code>tuple[Any, ...]</code> <p>Tuple of historical order info structures or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef history_orders_get(\n    self,\n    date_from: datetime | int | None = None,\n    date_to: datetime | int | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n) -&gt; tuple[Any, ...]:\n    \"\"\"Get orders from trading history with the ability to filter by ticket or position.\n\n    Args:\n        date_from: Start date or timestamp.\n        date_to: End date or timestamp.\n        group: Group filter.\n        ticket: Order ticket filter.\n        position: Position ticket filter.\n\n    Returns:\n        Tuple of historical order info structures or None.\n    \"\"\"  # noqa: E501\n    self._initialize_if_needed()\n    if ticket is not None:\n        self.logger.info(\"Retrieving order with ticket: %d\", ticket)\n        response = self.mt5.history_orders_get(ticket=ticket)\n        context = f\"ticket={ticket}\"\n    elif position is not None:\n        self.logger.info(\"Retrieving order for position: %d\", position)\n        response = self.mt5.history_orders_get(position=position)\n        context = f\"position={position}\"\n    elif group is not None:\n        self.logger.info(\n            \"Retrieving orders for group: %s, date_from: %s, date_to: %s\",\n            group,\n            date_from,\n            date_to,\n        )\n        response = self.mt5.history_orders_get(date_from, date_to, group=group)\n        context = f\"date_from={date_from}, date_to={date_to}, group={group}\"\n    else:\n        self.logger.info(\n            \"Retrieving all historical orders from %s to %s\",\n            date_from,\n            date_to,\n        )\n        response = self.mt5.history_orders_get(date_from, date_to)\n        context = f\"date_from={date_from}, date_to={date_to}\"\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"history_orders_get\",\n        context=context,\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.history_orders_total","title":"history_orders_total","text":"<pre><code>history_orders_total(\n    date_from: datetime | int, date_to: datetime | int\n) -&gt; int\n</code></pre> <p>Get the number of orders in trading history within the specified interval.</p> <p>Parameters:</p> Name Type Description Default <code>date_from</code> <code>datetime | int</code> <p>Start date or timestamp.</p> required <code>date_to</code> <code>datetime | int</code> <p>End date or timestamp.</p> required <p>Returns:</p> Type Description <code>int</code> <p>Number of historical orders.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef history_orders_total(\n    self,\n    date_from: datetime | int,\n    date_to: datetime | int,\n) -&gt; int:\n    \"\"\"Get the number of orders in trading history within the specified interval.\n\n    Args:\n        date_from: Start date or timestamp.\n        date_to: End date or timestamp.\n\n    Returns:\n        Number of historical orders.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\n        \"Retrieving total number of historical orders from %s to %s\",\n        date_from,\n        date_to,\n    )\n    return self.mt5.history_orders_total(date_from, date_to)\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.initialize","title":"initialize","text":"<pre><code>initialize(\n    path: str | None = None,\n    login: int | None = None,\n    password: str | None = None,\n    server: str | None = None,\n    timeout: int | None = None,\n) -&gt; bool\n</code></pre> <p>Establish a connection with the MetaTrader 5 terminal.</p> <p>Parameters:</p> Name Type Description Default <code>path</code> <code>str | None</code> <p>Path to the MetaTrader 5 terminal EXE file.</p> <code>None</code> <code>login</code> <code>int | None</code> <p>Trading account number.</p> <code>None</code> <code>password</code> <code>str | None</code> <p>Trading account password.</p> <code>None</code> <code>server</code> <code>str | None</code> <p>Trade server address.</p> <code>None</code> <code>timeout</code> <code>int | None</code> <p>Connection timeout in milliseconds.</p> <code>None</code> <p>Returns:</p> Type Description <code>bool</code> <p>True if successful, False otherwise.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef initialize(\n    self,\n    path: str | None = None,\n    login: int | None = None,\n    password: str | None = None,\n    server: str | None = None,\n    timeout: int | None = None,\n) -&gt; bool:\n    \"\"\"Establish a connection with the MetaTrader 5 terminal.\n\n    Args:\n        path: Path to the MetaTrader 5 terminal EXE file.\n        login: Trading account number.\n        password: Trading account password.\n        server: Trade server address.\n        timeout: Connection timeout in milliseconds.\n\n    Returns:\n        True if successful, False otherwise.\n    \"\"\"\n    if path is not None:\n        self.logger.info(\n            \"Initializing MT5 connection with path: %s\",\n            path,\n        )\n        self._is_initialized = self.mt5.initialize(\n            path,\n            **{\n                k: v\n                for k, v in {\n                    \"login\": login,\n                    \"password\": password,\n                    \"server\": server,\n                    \"timeout\": timeout,\n                }.items()\n                if v is not None\n            },\n        )\n    else:\n        self.logger.info(\"Initializing MT5 connection.\")\n        self._is_initialized = self.mt5.initialize()\n    return self._is_initialized\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.last_error","title":"last_error","text":"<pre><code>last_error() -&gt; tuple[int, str]\n</code></pre> <p>Return data on the last error.</p> <p>Returns:</p> Type Description <code>tuple[int, str]</code> <p>Tuple of (error_code, error_description).</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef last_error(self) -&gt; tuple[int, str]:\n    \"\"\"Return data on the last error.\n\n    Returns:\n        Tuple of (error_code, error_description).\n    \"\"\"\n    self.logger.info(\"Retrieving last MT5 error\")\n    return self.mt5.last_error()\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.login","title":"login","text":"<pre><code>login(\n    login: int,\n    password: str | None = None,\n    server: str | None = None,\n    timeout: int | None = None,\n) -&gt; bool\n</code></pre> <p>Connect to a trading account using specified parameters.</p> <p>Parameters:</p> Name Type Description Default <code>login</code> <code>int</code> <p>Trading account number.</p> required <code>password</code> <code>str | None</code> <p>Trading account password.</p> <code>None</code> <code>server</code> <code>str | None</code> <p>Trade server address.</p> <code>None</code> <code>timeout</code> <code>int | None</code> <p>Connection timeout in milliseconds.</p> <code>None</code> <p>Returns:</p> Type Description <code>bool</code> <p>True if successful, False otherwise.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef login(\n    self,\n    login: int,\n    password: str | None = None,\n    server: str | None = None,\n    timeout: int | None = None,\n) -&gt; bool:\n    \"\"\"Connect to a trading account using specified parameters.\n\n    Args:\n        login: Trading account number.\n        password: Trading account password.\n        server: Trade server address.\n        timeout: Connection timeout in milliseconds.\n\n    Returns:\n        True if successful, False otherwise.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Logging in to MT5 account: %d\", login)\n    return self.mt5.login(\n        login,\n        **{\n            k: v\n            for k, v in {\n                \"password\": password,\n                \"server\": server,\n                \"timeout\": timeout,\n            }.items()\n            if v is not None\n        },\n    )\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.market_book_add","title":"market_book_add","text":"<pre><code>market_book_add(symbol: str) -&gt; bool\n</code></pre> <p>Subscribe the terminal to the Market Depth change events for a specified symbol.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <p>Returns:</p> Type Description <code>bool</code> <p>True if successful, False otherwise.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef market_book_add(self, symbol: str) -&gt; bool:\n    \"\"\"Subscribe the terminal to the Market Depth change events for a specified symbol.\n\n    Args:\n        symbol: Symbol name.\n\n    Returns:\n        True if successful, False otherwise.\n    \"\"\"  # noqa: E501\n    self._initialize_if_needed()\n    self.logger.info(\"Adding market book for symbol: %s\", symbol)\n    response = self.mt5.market_book_add(symbol)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"market_book_add\",\n        context=f\"symbol={symbol}\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.market_book_get","title":"market_book_get","text":"<pre><code>market_book_get(symbol: str) -&gt; tuple[Any, ...]\n</code></pre> <p>Return a tuple from BookInfo featuring Market Depth entries for the specified symbol.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <p>Returns:</p> Type Description <code>tuple[Any, ...]</code> <p>Tuple of BookInfo structures or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef market_book_get(self, symbol: str) -&gt; tuple[Any, ...]:\n    \"\"\"Return a tuple from BookInfo featuring Market Depth entries for the specified symbol.\n\n    Args:\n        symbol: Symbol name.\n\n    Returns:\n        Tuple of BookInfo structures or None.\n    \"\"\"  # noqa: E501\n    self._initialize_if_needed()\n    self.logger.info(\"Retrieving market book for symbol: %s\", symbol)\n    response = self.mt5.market_book_get(symbol)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"market_book_get\",\n        context=f\"symbol={symbol}\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.market_book_release","title":"market_book_release","text":"<pre><code>market_book_release(symbol: str) -&gt; bool\n</code></pre> <p>Cancels subscription of the terminal to the Market Depth change events for a specified symbol.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <p>Returns:</p> Type Description <code>bool</code> <p>True if successful, False otherwise.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef market_book_release(self, symbol: str) -&gt; bool:\n    \"\"\"Cancels subscription of the terminal to the Market Depth change events for a specified symbol.\n\n    Args:\n        symbol: Symbol name.\n\n    Returns:\n        True if successful, False otherwise.\n    \"\"\"  # noqa: E501\n    self._initialize_if_needed()\n    self.logger.info(\"Releasing market book for symbol: %s\", symbol)\n    response = self.mt5.market_book_release(symbol)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"market_book_release\",\n        context=f\"symbol={symbol}\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.order_calc_margin","title":"order_calc_margin","text":"<pre><code>order_calc_margin(\n    action: int, symbol: str, volume: float, price: float\n) -&gt; float\n</code></pre> <p>Return margin in the account currency to perform a specified trading operation.</p> <p>Parameters:</p> Name Type Description Default <code>action</code> <code>int</code> <p>Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL).</p> required <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>volume</code> <code>float</code> <p>Volume in lots.</p> required <code>price</code> <code>float</code> <p>Open price.</p> required <p>Returns:</p> Type Description <code>float</code> <p>Required margin amount or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef order_calc_margin(\n    self,\n    action: int,\n    symbol: str,\n    volume: float,\n    price: float,\n) -&gt; float:\n    \"\"\"Return margin in the account currency to perform a specified trading operation.\n\n    Args:\n        action: Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL).\n        symbol: Symbol name.\n        volume: Volume in lots.\n        price: Open price.\n\n    Returns:\n        Required margin amount or None.\n    \"\"\"  # noqa: E501\n    self._initialize_if_needed()\n    self.logger.info(\n        \"Calculating margin: action=%d, symbol=%s, volume=%.2f, price=%.5f\",\n        action,\n        symbol,\n        volume,\n        price,\n    )\n    response = self.mt5.order_calc_margin(action, symbol, volume, price)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"order_calc_margin\",\n        context=f\"action={action}, symbol={symbol}, volume={volume}, price={price}\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.order_calc_profit","title":"order_calc_profit","text":"<pre><code>order_calc_profit(\n    action: int,\n    symbol: str,\n    volume: float,\n    price_open: float,\n    price_close: float,\n) -&gt; float\n</code></pre> <p>Return profit in the account currency for a specified trading operation.</p> <p>Parameters:</p> Name Type Description Default <code>action</code> <code>int</code> <p>Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL).</p> required <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>volume</code> <code>float</code> <p>Volume in lots.</p> required <code>price_open</code> <code>float</code> <p>Open price.</p> required <code>price_close</code> <code>float</code> <p>Close price.</p> required <p>Returns:</p> Type Description <code>float</code> <p>Calculated profit or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef order_calc_profit(\n    self,\n    action: int,\n    symbol: str,\n    volume: float,\n    price_open: float,\n    price_close: float,\n) -&gt; float:\n    \"\"\"Return profit in the account currency for a specified trading operation.\n\n    Args:\n        action: Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL).\n        symbol: Symbol name.\n        volume: Volume in lots.\n        price_open: Open price.\n        price_close: Close price.\n\n    Returns:\n        Calculated profit or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\n        (\n            \"Calculating profit: action=%d, symbol=%s, volume=%.2f,\"\n            \" price_open=%.5f, price_close=%.5f\"\n        ),\n        action,\n        symbol,\n        volume,\n        price_open,\n        price_close,\n    )\n    response = self.mt5.order_calc_profit(\n        action, symbol, volume, price_open, price_close\n    )\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"order_calc_profit\",\n        context=(\n            f\"action={action}, symbol={symbol}, volume={volume},\"\n            f\" price_open={price_open}, price_close={price_close}\"\n        ),\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.order_check","title":"order_check","text":"<pre><code>order_check(request: dict[str, Any]) -&gt; Any\n</code></pre> <p>Check funds sufficiency for performing a required trading operation.</p> <p>Parameters:</p> Name Type Description Default <code>request</code> <code>dict[str, Any]</code> <p>Trade request dictionary.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>OrderCheckResult structure or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef order_check(self, request: dict[str, Any]) -&gt; Any:\n    \"\"\"Check funds sufficiency for performing a required trading operation.\n\n    Args:\n        request: Trade request dictionary.\n\n    Returns:\n        OrderCheckResult structure or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Checking order with request: %s\", request)\n    response = self.mt5.order_check(request)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"order_check\",\n        context=f\"request={request}\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.order_send","title":"order_send","text":"<pre><code>order_send(request: dict[str, Any]) -&gt; Any\n</code></pre> <p>Send a request to perform a trading operation from the terminal to the trade server.</p> <p>Parameters:</p> Name Type Description Default <code>request</code> <code>dict[str, Any]</code> <p>Trade request dictionary.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>OrderSendResult structure or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef order_send(self, request: dict[str, Any]) -&gt; Any:\n    \"\"\"Send a request to perform a trading operation from the terminal to the trade server.\n\n    Args:\n        request: Trade request dictionary.\n\n    Returns:\n        OrderSendResult structure or None.\n    \"\"\"  # noqa: E501\n    self._initialize_if_needed()\n    self.logger.info(\"Sending order with request: %s\", request)\n    response = self.mt5.order_send(request)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"order_send\",\n        context=f\"request={request}\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.orders_get","title":"orders_get","text":"<pre><code>orders_get(\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n) -&gt; tuple[Any, ...]\n</code></pre> <p>Get active orders with the ability to filter by symbol or ticket.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str | None</code> <p>Symbol name filter.</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Group filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Order ticket filter.</p> <code>None</code> <p>Returns:</p> Type Description <code>tuple[Any, ...]</code> <p>Tuple of order info structures or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef orders_get(\n    self,\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n) -&gt; tuple[Any, ...]:\n    \"\"\"Get active orders with the ability to filter by symbol or ticket.\n\n    Args:\n        symbol: Symbol name filter.\n        group: Group filter.\n        ticket: Order ticket filter.\n\n    Returns:\n        Tuple of order info structures or None.\n    \"\"\"\n    self._initialize_if_needed()\n    if ticket is not None:\n        self.logger.info(\"Retrieving order with ticket: %d\", ticket)\n        response = self.mt5.orders_get(ticket=ticket)\n        context = f\"ticket={ticket}\"\n    elif group is not None:\n        self.logger.info(\"Retrieving orders for group: %s\", group)\n        response = self.mt5.orders_get(group=group)\n        context = f\"group={group}\"\n    elif symbol is not None:\n        self.logger.info(\"Retrieving orders for symbol: %s\", symbol)\n        response = self.mt5.orders_get(symbol=symbol)\n        context = f\"symbol={symbol}\"\n    else:\n        self.logger.info(\"Retrieving all active orders.\")\n        response = self.mt5.orders_get()\n        context = None\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"orders_get\",\n        context=context,\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.orders_total","title":"orders_total","text":"<pre><code>orders_total() -&gt; int\n</code></pre> <p>Get the number of active orders.</p> <p>Returns:</p> Type Description <code>int</code> <p>Number of active orders.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef orders_total(self) -&gt; int:\n    \"\"\"Get the number of active orders.\n\n    Returns:\n        Number of active orders.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Retrieving total number of active orders.\")\n    return self.mt5.orders_total()\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.positions_get","title":"positions_get","text":"<pre><code>positions_get(\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n) -&gt; tuple[Any, ...]\n</code></pre> <p>Get open positions with the ability to filter by symbol or ticket.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str | None</code> <p>Symbol name filter.</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Group filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Position ticket filter.</p> <code>None</code> <p>Returns:</p> Type Description <code>tuple[Any, ...]</code> <p>Tuple of position info structures or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef positions_get(\n    self,\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n) -&gt; tuple[Any, ...]:\n    \"\"\"Get open positions with the ability to filter by symbol or ticket.\n\n    Args:\n        symbol: Symbol name filter.\n        group: Group filter.\n        ticket: Position ticket filter.\n\n    Returns:\n        Tuple of position info structures or None.\n    \"\"\"\n    self._initialize_if_needed()\n    if ticket is not None:\n        self.logger.info(\"Retrieving position with ticket: %d\", ticket)\n        response = self.mt5.positions_get(ticket=ticket)\n        context = f\"ticket={ticket}\"\n    elif group is not None:\n        self.logger.info(\"Retrieving positions for group: %s\", group)\n        response = self.mt5.positions_get(group=group)\n        context = f\"group={group}\"\n    elif symbol is not None:\n        self.logger.info(\"Retrieving positions for symbol: %s\", symbol)\n        response = self.mt5.positions_get(symbol=symbol)\n        context = f\"symbol={symbol}\"\n    else:\n        self.logger.info(\"Retrieving all open positions.\")\n        response = self.mt5.positions_get()\n        context = None\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"positions_get\",\n        context=context,\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.positions_total","title":"positions_total","text":"<pre><code>positions_total() -&gt; int\n</code></pre> <p>Get the number of open positions.</p> <p>Returns:</p> Type Description <code>int</code> <p>Number of open positions.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef positions_total(self) -&gt; int:\n    \"\"\"Get the number of open positions.\n\n    Returns:\n        Number of open positions.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Retrieving total number of open positions.\")\n    return self.mt5.positions_total()\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.shutdown","title":"shutdown","text":"<pre><code>shutdown() -&gt; None\n</code></pre> <p>Close the previously established connection to the MetaTrader 5 terminal.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef shutdown(self) -&gt; None:\n    \"\"\"Close the previously established connection to the MetaTrader 5 terminal.\"\"\"\n    self.logger.info(\"Shutting down MT5 connection.\")\n    response = self.mt5.shutdown()\n    self._is_initialized = False\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbol_info","title":"symbol_info","text":"<pre><code>symbol_info(symbol: str) -&gt; Any\n</code></pre> <p>Get data on the specified financial instrument.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>Symbol info structure or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef symbol_info(self, symbol: str) -&gt; Any:\n    \"\"\"Get data on the specified financial instrument.\n\n    Args:\n        symbol: Symbol name.\n\n    Returns:\n        Symbol info structure or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Retrieving information for symbol: %s\", symbol)\n    response = self.mt5.symbol_info(symbol)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"symbol_info\",\n        context=f\"symbol={symbol}\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbol_info_tick","title":"symbol_info_tick","text":"<pre><code>symbol_info_tick(symbol: str) -&gt; Any\n</code></pre> <p>Get the last tick for the specified financial instrument.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>Tick info structure or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef symbol_info_tick(self, symbol: str) -&gt; Any:\n    \"\"\"Get the last tick for the specified financial instrument.\n\n    Args:\n        symbol: Symbol name.\n\n    Returns:\n        Tick info structure or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Retrieving last tick for symbol: %s\", symbol)\n    response = self.mt5.symbol_info_tick(symbol)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"symbol_info_tick\",\n        context=f\"symbol={symbol}\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbol_select","title":"symbol_select","text":"<pre><code>symbol_select(symbol: str, enable: bool = True) -&gt; bool\n</code></pre> <p>Select a symbol in the MarketWatch window or remove a symbol from the window.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>enable</code> <code>bool</code> <p>True to show, False to hide.</p> <code>True</code> <p>Returns:</p> Type Description <code>bool</code> <p>True if successful, False otherwise.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef symbol_select(self, symbol: str, enable: bool = True) -&gt; bool:\n    \"\"\"Select a symbol in the MarketWatch window or remove a symbol from the window.\n\n    Args:\n        symbol: Symbol name.\n        enable: True to show, False to hide.\n\n    Returns:\n        True if successful, False otherwise.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Selecting symbol: %s, enable=%s\", symbol, enable)\n    response = self.mt5.symbol_select(symbol, enable)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"symbol_select\",\n        context=f\"symbol={symbol}, enable={enable}\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbols_get","title":"symbols_get","text":"<pre><code>symbols_get(group: str | None = None) -&gt; tuple[Any, ...]\n</code></pre> <p>Get all financial instruments from the terminal.</p> <p>Parameters:</p> Name Type Description Default <code>group</code> <code>str | None</code> <p>Symbol group filter.</p> <code>None</code> <p>Returns:</p> Type Description <code>tuple[Any, ...]</code> <p>Tuple of symbol info structures or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef symbols_get(self, group: str | None = None) -&gt; tuple[Any, ...]:\n    \"\"\"Get all financial instruments from the terminal.\n\n    Args:\n        group: Symbol group filter.\n\n    Returns:\n        Tuple of symbol info structures or None.\n    \"\"\"\n    self._initialize_if_needed()\n    if group is not None:\n        self.logger.info(\"Retrieving symbols for group: %s\", group)\n        response = self.mt5.symbols_get(group=group)\n        context = f\"group={group}\"\n    else:\n        self.logger.info(\"Retrieving all symbols.\")\n        response = self.mt5.symbols_get()\n        context = None\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"symbols_get\",\n        context=context,\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbols_total","title":"symbols_total","text":"<pre><code>symbols_total() -&gt; int\n</code></pre> <p>Get the number of all financial instruments in the terminal.</p> <p>Returns:</p> Type Description <code>int</code> <p>Total number of symbols.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef symbols_total(self) -&gt; int:\n    \"\"\"Get the number of all financial instruments in the terminal.\n\n    Returns:\n        Total number of symbols.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Retrieving total number of symbols.\")\n    return self.mt5.symbols_total()\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.terminal_info","title":"terminal_info","text":"<pre><code>terminal_info() -&gt; Any\n</code></pre> <p>Get the connected MetaTrader 5 client terminal status and settings.</p> <p>Returns:</p> Type Description <code>Any</code> <p>TerminalInfo structure or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef terminal_info(self) -&gt; Any:\n    \"\"\"Get the connected MetaTrader 5 client terminal status and settings.\n\n    Returns:\n        TerminalInfo structure or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Retrieving terminal information.\")\n    response = self.mt5.terminal_info()\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"terminal_info\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.version","title":"version","text":"<pre><code>version() -&gt; tuple[int, int, str]\n</code></pre> <p>Return the MetaTrader 5 terminal version.</p> <p>Returns:</p> Type Description <code>tuple[int, int, str]</code> <p>Tuple of (terminal_version, build, release_date).</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef version(self) -&gt; tuple[int, int, str]:\n    \"\"\"Return the MetaTrader 5 terminal version.\n\n    Returns:\n        Tuple of (terminal_version, build, release_date).\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Retrieving MT5 version information.\")\n    return self.mt5.version()\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5RuntimeError","title":"Mt5RuntimeError","text":"<p>               Bases: <code>RuntimeError</code></p> <p>MetaTrader5 specific runtime error.</p> <p>Raised when MetaTrader5 operations fail or when the client is used incorrectly (e.g., calling methods before initialization).</p>"},{"location":"api/mt5/#overview","title":"Overview","text":"<p>The Mt5Client module provides the base client class for connecting to MetaTrader 5 and performing core operations. This is the foundation class that handles the low-level MT5 API interactions and provides basic error handling and connection management.</p>"},{"location":"api/mt5/#classes","title":"Classes","text":""},{"location":"api/mt5/#mt5client_1","title":"Mt5Client","text":"<p>options: show_bases: false</p> <p>Base client class for MetaTrader 5 operations with connection management and error handling.</p>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client","title":"pdmt5.mt5.Mt5Client","text":"<p>               Bases: <code>BaseModel</code></p> <p>MetaTrader5 client class.</p> <p>This class provides a wrapper interface to all MetaTrader5 functions, delegating calls to the underlying MetaTrader5 module while providing error handling and logging capabilities.</p>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.logger","title":"logger  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>logger: Logger = Field(\n    default_factory=lambda: getLogger(__name__),\n    description=\"Logger instance for MetaTrader5 operations\",\n)\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.model_config","title":"model_config  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>model_config = ConfigDict(arbitrary_types_allowed=True)\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.mt5","title":"mt5  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>mt5: ModuleType = Field(\n    default_factory=lambda: import_module(\"MetaTrader5\"),\n    description=\"MetaTrader5 module instance\",\n)\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.__enter__","title":"__enter__","text":"<pre><code>__enter__() -&gt; Self\n</code></pre> <p>Context manager entry.</p> <p>Returns:</p> Name Type Description <code>Mt5Client</code> <code>Self</code> <p>The client instance.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>def __enter__(self) -&gt; Self:\n    \"\"\"Context manager entry.\n\n    Returns:\n        Mt5Client: The client instance.\n    \"\"\"\n    self.initialize()\n    return self\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.__exit__","title":"__exit__","text":"<pre><code>__exit__(\n    exc_type: type[BaseException] | None,\n    exc_val: BaseException | None,\n    exc_tb: TracebackType | None,\n) -&gt; None\n</code></pre> <p>Context manager exit.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>def __exit__(\n    self,\n    exc_type: type[BaseException] | None,\n    exc_val: BaseException | None,\n    exc_tb: TracebackType | None,\n) -&gt; None:\n    \"\"\"Context manager exit.\"\"\"\n    self.shutdown()\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.account_info","title":"account_info","text":"<pre><code>account_info() -&gt; Any\n</code></pre> <p>Get info on the current trading account.</p> <p>Returns:</p> Type Description <code>Any</code> <p>AccountInfo structure or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef account_info(self) -&gt; Any:\n    \"\"\"Get info on the current trading account.\n\n    Returns:\n        AccountInfo structure or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Retrieving account information.\")\n    response = self.mt5.account_info()\n    self._validate_mt5_response_is_not_none(\n        response=response, operation=\"account_info\"\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_rates_from","title":"copy_rates_from","text":"<pre><code>copy_rates_from(\n    symbol: str,\n    timeframe: int,\n    date_from: datetime | int,\n    count: int,\n) -&gt; Any\n</code></pre> <p>Get bars from the terminal starting from the specified date.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>timeframe</code> <code>int</code> <p>Timeframe constant.</p> required <code>date_from</code> <code>datetime | int</code> <p>Start date or timestamp.</p> required <code>count</code> <code>int</code> <p>Number of bars to retrieve.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>Array of rates or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef copy_rates_from(\n    self,\n    symbol: str,\n    timeframe: int,\n    date_from: datetime | int,\n    count: int,\n) -&gt; Any:\n    \"\"\"Get bars from the terminal starting from the specified date.\n\n    Args:\n        symbol: Symbol name.\n        timeframe: Timeframe constant.\n        date_from: Start date or timestamp.\n        count: Number of bars to retrieve.\n\n    Returns:\n        Array of rates or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\n        \"Copying rates from symbol: %s, timeframe: %d, date_from: %s, count: %d\",\n        symbol,\n        timeframe,\n        date_from,\n        count,\n    )\n    response = self.mt5.copy_rates_from(symbol, timeframe, date_from, count)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"copy_rates_from\",\n        context=(\n            f\"symbol={symbol}, timeframe={timeframe},\"\n            f\" date_from={date_from}, count={count}\"\n        ),\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_rates_from_pos","title":"copy_rates_from_pos","text":"<pre><code>copy_rates_from_pos(\n    symbol: str, timeframe: int, start_pos: int, count: int\n) -&gt; Any\n</code></pre> <p>Get bars from the terminal starting from the specified index.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>timeframe</code> <code>int</code> <p>Timeframe constant.</p> required <code>start_pos</code> <code>int</code> <p>Starting position.</p> required <code>count</code> <code>int</code> <p>Number of bars to retrieve.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>Array of rates or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef copy_rates_from_pos(\n    self,\n    symbol: str,\n    timeframe: int,\n    start_pos: int,\n    count: int,\n) -&gt; Any:\n    \"\"\"Get bars from the terminal starting from the specified index.\n\n    Args:\n        symbol: Symbol name.\n        timeframe: Timeframe constant.\n        start_pos: Starting position.\n        count: Number of bars to retrieve.\n\n    Returns:\n        Array of rates or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\n        (\n            \"Copying rates from position:\"\n            \" symbol=%s, timeframe=%d, start_pos=%d, count=%d\"\n        ),\n        symbol,\n        timeframe,\n        start_pos,\n        count,\n    )\n    response = self.mt5.copy_rates_from_pos(symbol, timeframe, start_pos, count)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"copy_rates_from_pos\",\n        context=(\n            f\"symbol={symbol}, timeframe={timeframe},\"\n            f\" start_pos={start_pos}, count={count}\"\n        ),\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_rates_range","title":"copy_rates_range","text":"<pre><code>copy_rates_range(\n    symbol: str,\n    timeframe: int,\n    date_from: datetime | int,\n    date_to: datetime | int,\n) -&gt; Any\n</code></pre> <p>Get bars in the specified date range from the terminal.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>timeframe</code> <code>int</code> <p>Timeframe constant.</p> required <code>date_from</code> <code>datetime | int</code> <p>Start date or timestamp.</p> required <code>date_to</code> <code>datetime | int</code> <p>End date or timestamp.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>Array of rates or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef copy_rates_range(\n    self,\n    symbol: str,\n    timeframe: int,\n    date_from: datetime | int,\n    date_to: datetime | int,\n) -&gt; Any:\n    \"\"\"Get bars in the specified date range from the terminal.\n\n    Args:\n        symbol: Symbol name.\n        timeframe: Timeframe constant.\n        date_from: Start date or timestamp.\n        date_to: End date or timestamp.\n\n    Returns:\n        Array of rates or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\n        \"Copying rates range: symbol=%s, timeframe=%d, date_from=%s, date_to=%s\",\n        symbol,\n        timeframe,\n        date_from,\n        date_to,\n    )\n    response = self.mt5.copy_rates_range(symbol, timeframe, date_from, date_to)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"copy_rates_range\",\n        context=(\n            f\"symbol={symbol}, timeframe={timeframe},\"\n            f\" date_from={date_from}, date_to={date_to}\"\n        ),\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_ticks_from","title":"copy_ticks_from","text":"<pre><code>copy_ticks_from(\n    symbol: str,\n    date_from: datetime | int,\n    count: int,\n    flags: int,\n) -&gt; Any\n</code></pre> <p>Get ticks from the terminal starting from the specified date.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>date_from</code> <code>datetime | int</code> <p>Start date or timestamp.</p> required <code>count</code> <code>int</code> <p>Number of ticks to retrieve.</p> required <code>flags</code> <code>int</code> <p>Tick flags.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>Array of ticks or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef copy_ticks_from(\n    self,\n    symbol: str,\n    date_from: datetime | int,\n    count: int,\n    flags: int,\n) -&gt; Any:\n    \"\"\"Get ticks from the terminal starting from the specified date.\n\n    Args:\n        symbol: Symbol name.\n        date_from: Start date or timestamp.\n        count: Number of ticks to retrieve.\n        flags: Tick flags.\n\n    Returns:\n        Array of ticks or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\n        \"Copying ticks from symbol: %s, date_from: %s, count: %d, flags: %d\",\n        symbol,\n        date_from,\n        count,\n        flags,\n    )\n    response = self.mt5.copy_ticks_from(symbol, date_from, count, flags)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"copy_ticks_from\",\n        context=(\n            f\"symbol={symbol}, date_from={date_from}, count={count}, flags={flags}\"\n        ),\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_ticks_range","title":"copy_ticks_range","text":"<pre><code>copy_ticks_range(\n    symbol: str,\n    date_from: datetime | int,\n    date_to: datetime | int,\n    flags: int,\n) -&gt; Any\n</code></pre> <p>Get ticks for the specified date range from the terminal.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>date_from</code> <code>datetime | int</code> <p>Start date or timestamp.</p> required <code>date_to</code> <code>datetime | int</code> <p>End date or timestamp.</p> required <code>flags</code> <code>int</code> <p>Tick flags.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>Array of ticks or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef copy_ticks_range(\n    self,\n    symbol: str,\n    date_from: datetime | int,\n    date_to: datetime | int,\n    flags: int,\n) -&gt; Any:\n    \"\"\"Get ticks for the specified date range from the terminal.\n\n    Args:\n        symbol: Symbol name.\n        date_from: Start date or timestamp.\n        date_to: End date or timestamp.\n        flags: Tick flags.\n\n    Returns:\n        Array of ticks or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\n        \"Copying ticks range: symbol=%s, date_from=%s, date_to=%s, flags=%d\",\n        symbol,\n        date_from,\n        date_to,\n        flags,\n    )\n    response = self.mt5.copy_ticks_range(symbol, date_from, date_to, flags)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"copy_ticks_range\",\n        context=(\n            f\"symbol={symbol}, date_from={date_from},\"\n            f\" date_to={date_to}, flags={flags}\"\n        ),\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.history_deals_get","title":"history_deals_get","text":"<pre><code>history_deals_get(\n    date_from: datetime | int | None = None,\n    date_to: datetime | int | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n) -&gt; tuple[Any, ...]\n</code></pre> <p>Get deals from trading history within the specified interval with the ability to filter by ticket or position.</p> <p>Parameters:</p> Name Type Description Default <code>date_from</code> <code>datetime | int | None</code> <p>Start date or timestamp.</p> <code>None</code> <code>date_to</code> <code>datetime | int | None</code> <p>End date or timestamp.</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Group filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Order ticket filter.</p> <code>None</code> <code>position</code> <code>int | None</code> <p>Position ticket filter.</p> <code>None</code> <p>Returns:</p> Type Description <code>tuple[Any, ...]</code> <p>Tuple of historical deal info structures or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef history_deals_get(\n    self,\n    date_from: datetime | int | None = None,\n    date_to: datetime | int | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n) -&gt; tuple[Any, ...]:\n    \"\"\"Get deals from trading history within the specified interval with the ability to filter by ticket or position.\n\n    Args:\n        date_from: Start date or timestamp.\n        date_to: End date or timestamp.\n        group: Group filter.\n        ticket: Order ticket filter.\n        position: Position ticket filter.\n\n    Returns:\n        Tuple of historical deal info structures or None.\n    \"\"\"  # noqa: E501\n    self._initialize_if_needed()\n    if ticket is not None:\n        self.logger.info(\"Retrieving deal with ticket: %d\", ticket)\n        response = self.mt5.history_deals_get(ticket=ticket)\n        context = f\"ticket={ticket}\"\n    elif position is not None:\n        self.logger.info(\"Retrieving deal for position: %d\", position)\n        response = self.mt5.history_deals_get(position=position)\n        context = f\"position={position}\"\n    elif group is not None:\n        self.logger.info(\n            \"Retrieving deals for group: %s, date_from: %s, date_to: %s\",\n            group,\n            date_from,\n            date_to,\n        )\n        response = self.mt5.history_deals_get(date_from, date_to, group=group)\n        context = f\"date_from={date_from}, date_to={date_to}, group={group}\"\n    else:\n        self.logger.info(\n            \"Retrieving all historical deals from %s to %s\",\n            date_from,\n            date_to,\n        )\n        response = self.mt5.history_deals_get(date_from, date_to)\n        context = f\"date_from={date_from}, date_to={date_to}\"\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"history_deals_get\",\n        context=context,\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.history_deals_total","title":"history_deals_total","text":"<pre><code>history_deals_total(\n    date_from: datetime | int, date_to: datetime | int\n) -&gt; int\n</code></pre> <p>Get the number of deals in trading history within the specified interval.</p> <p>Parameters:</p> Name Type Description Default <code>date_from</code> <code>datetime | int</code> <p>Start date or timestamp.</p> required <code>date_to</code> <code>datetime | int</code> <p>End date or timestamp.</p> required <p>Returns:</p> Type Description <code>int</code> <p>Number of historical deals.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef history_deals_total(\n    self,\n    date_from: datetime | int,\n    date_to: datetime | int,\n) -&gt; int:\n    \"\"\"Get the number of deals in trading history within the specified interval.\n\n    Args:\n        date_from: Start date or timestamp.\n        date_to: End date or timestamp.\n\n    Returns:\n        Number of historical deals.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\n        \"Retrieving total number of historical deals from %s to %s\",\n        date_from,\n        date_to,\n    )\n    return self.mt5.history_deals_total(date_from, date_to)\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.history_orders_get","title":"history_orders_get","text":"<pre><code>history_orders_get(\n    date_from: datetime | int | None = None,\n    date_to: datetime | int | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n) -&gt; tuple[Any, ...]\n</code></pre> <p>Get orders from trading history with the ability to filter by ticket or position.</p> <p>Parameters:</p> Name Type Description Default <code>date_from</code> <code>datetime | int | None</code> <p>Start date or timestamp.</p> <code>None</code> <code>date_to</code> <code>datetime | int | None</code> <p>End date or timestamp.</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Group filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Order ticket filter.</p> <code>None</code> <code>position</code> <code>int | None</code> <p>Position ticket filter.</p> <code>None</code> <p>Returns:</p> Type Description <code>tuple[Any, ...]</code> <p>Tuple of historical order info structures or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef history_orders_get(\n    self,\n    date_from: datetime | int | None = None,\n    date_to: datetime | int | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n    position: int | None = None,\n) -&gt; tuple[Any, ...]:\n    \"\"\"Get orders from trading history with the ability to filter by ticket or position.\n\n    Args:\n        date_from: Start date or timestamp.\n        date_to: End date or timestamp.\n        group: Group filter.\n        ticket: Order ticket filter.\n        position: Position ticket filter.\n\n    Returns:\n        Tuple of historical order info structures or None.\n    \"\"\"  # noqa: E501\n    self._initialize_if_needed()\n    if ticket is not None:\n        self.logger.info(\"Retrieving order with ticket: %d\", ticket)\n        response = self.mt5.history_orders_get(ticket=ticket)\n        context = f\"ticket={ticket}\"\n    elif position is not None:\n        self.logger.info(\"Retrieving order for position: %d\", position)\n        response = self.mt5.history_orders_get(position=position)\n        context = f\"position={position}\"\n    elif group is not None:\n        self.logger.info(\n            \"Retrieving orders for group: %s, date_from: %s, date_to: %s\",\n            group,\n            date_from,\n            date_to,\n        )\n        response = self.mt5.history_orders_get(date_from, date_to, group=group)\n        context = f\"date_from={date_from}, date_to={date_to}, group={group}\"\n    else:\n        self.logger.info(\n            \"Retrieving all historical orders from %s to %s\",\n            date_from,\n            date_to,\n        )\n        response = self.mt5.history_orders_get(date_from, date_to)\n        context = f\"date_from={date_from}, date_to={date_to}\"\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"history_orders_get\",\n        context=context,\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.history_orders_total","title":"history_orders_total","text":"<pre><code>history_orders_total(\n    date_from: datetime | int, date_to: datetime | int\n) -&gt; int\n</code></pre> <p>Get the number of orders in trading history within the specified interval.</p> <p>Parameters:</p> Name Type Description Default <code>date_from</code> <code>datetime | int</code> <p>Start date or timestamp.</p> required <code>date_to</code> <code>datetime | int</code> <p>End date or timestamp.</p> required <p>Returns:</p> Type Description <code>int</code> <p>Number of historical orders.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef history_orders_total(\n    self,\n    date_from: datetime | int,\n    date_to: datetime | int,\n) -&gt; int:\n    \"\"\"Get the number of orders in trading history within the specified interval.\n\n    Args:\n        date_from: Start date or timestamp.\n        date_to: End date or timestamp.\n\n    Returns:\n        Number of historical orders.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\n        \"Retrieving total number of historical orders from %s to %s\",\n        date_from,\n        date_to,\n    )\n    return self.mt5.history_orders_total(date_from, date_to)\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.initialize","title":"initialize","text":"<pre><code>initialize(\n    path: str | None = None,\n    login: int | None = None,\n    password: str | None = None,\n    server: str | None = None,\n    timeout: int | None = None,\n) -&gt; bool\n</code></pre> <p>Establish a connection with the MetaTrader 5 terminal.</p> <p>Parameters:</p> Name Type Description Default <code>path</code> <code>str | None</code> <p>Path to the MetaTrader 5 terminal EXE file.</p> <code>None</code> <code>login</code> <code>int | None</code> <p>Trading account number.</p> <code>None</code> <code>password</code> <code>str | None</code> <p>Trading account password.</p> <code>None</code> <code>server</code> <code>str | None</code> <p>Trade server address.</p> <code>None</code> <code>timeout</code> <code>int | None</code> <p>Connection timeout in milliseconds.</p> <code>None</code> <p>Returns:</p> Type Description <code>bool</code> <p>True if successful, False otherwise.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef initialize(\n    self,\n    path: str | None = None,\n    login: int | None = None,\n    password: str | None = None,\n    server: str | None = None,\n    timeout: int | None = None,\n) -&gt; bool:\n    \"\"\"Establish a connection with the MetaTrader 5 terminal.\n\n    Args:\n        path: Path to the MetaTrader 5 terminal EXE file.\n        login: Trading account number.\n        password: Trading account password.\n        server: Trade server address.\n        timeout: Connection timeout in milliseconds.\n\n    Returns:\n        True if successful, False otherwise.\n    \"\"\"\n    if path is not None:\n        self.logger.info(\n            \"Initializing MT5 connection with path: %s\",\n            path,\n        )\n        self._is_initialized = self.mt5.initialize(\n            path,\n            **{\n                k: v\n                for k, v in {\n                    \"login\": login,\n                    \"password\": password,\n                    \"server\": server,\n                    \"timeout\": timeout,\n                }.items()\n                if v is not None\n            },\n        )\n    else:\n        self.logger.info(\"Initializing MT5 connection.\")\n        self._is_initialized = self.mt5.initialize()\n    return self._is_initialized\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.last_error","title":"last_error","text":"<pre><code>last_error() -&gt; tuple[int, str]\n</code></pre> <p>Return data on the last error.</p> <p>Returns:</p> Type Description <code>tuple[int, str]</code> <p>Tuple of (error_code, error_description).</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef last_error(self) -&gt; tuple[int, str]:\n    \"\"\"Return data on the last error.\n\n    Returns:\n        Tuple of (error_code, error_description).\n    \"\"\"\n    self.logger.info(\"Retrieving last MT5 error\")\n    return self.mt5.last_error()\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.login","title":"login","text":"<pre><code>login(\n    login: int,\n    password: str | None = None,\n    server: str | None = None,\n    timeout: int | None = None,\n) -&gt; bool\n</code></pre> <p>Connect to a trading account using specified parameters.</p> <p>Parameters:</p> Name Type Description Default <code>login</code> <code>int</code> <p>Trading account number.</p> required <code>password</code> <code>str | None</code> <p>Trading account password.</p> <code>None</code> <code>server</code> <code>str | None</code> <p>Trade server address.</p> <code>None</code> <code>timeout</code> <code>int | None</code> <p>Connection timeout in milliseconds.</p> <code>None</code> <p>Returns:</p> Type Description <code>bool</code> <p>True if successful, False otherwise.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef login(\n    self,\n    login: int,\n    password: str | None = None,\n    server: str | None = None,\n    timeout: int | None = None,\n) -&gt; bool:\n    \"\"\"Connect to a trading account using specified parameters.\n\n    Args:\n        login: Trading account number.\n        password: Trading account password.\n        server: Trade server address.\n        timeout: Connection timeout in milliseconds.\n\n    Returns:\n        True if successful, False otherwise.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Logging in to MT5 account: %d\", login)\n    return self.mt5.login(\n        login,\n        **{\n            k: v\n            for k, v in {\n                \"password\": password,\n                \"server\": server,\n                \"timeout\": timeout,\n            }.items()\n            if v is not None\n        },\n    )\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.market_book_add","title":"market_book_add","text":"<pre><code>market_book_add(symbol: str) -&gt; bool\n</code></pre> <p>Subscribe the terminal to the Market Depth change events for a specified symbol.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <p>Returns:</p> Type Description <code>bool</code> <p>True if successful, False otherwise.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef market_book_add(self, symbol: str) -&gt; bool:\n    \"\"\"Subscribe the terminal to the Market Depth change events for a specified symbol.\n\n    Args:\n        symbol: Symbol name.\n\n    Returns:\n        True if successful, False otherwise.\n    \"\"\"  # noqa: E501\n    self._initialize_if_needed()\n    self.logger.info(\"Adding market book for symbol: %s\", symbol)\n    response = self.mt5.market_book_add(symbol)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"market_book_add\",\n        context=f\"symbol={symbol}\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.market_book_get","title":"market_book_get","text":"<pre><code>market_book_get(symbol: str) -&gt; tuple[Any, ...]\n</code></pre> <p>Return a tuple from BookInfo featuring Market Depth entries for the specified symbol.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <p>Returns:</p> Type Description <code>tuple[Any, ...]</code> <p>Tuple of BookInfo structures or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef market_book_get(self, symbol: str) -&gt; tuple[Any, ...]:\n    \"\"\"Return a tuple from BookInfo featuring Market Depth entries for the specified symbol.\n\n    Args:\n        symbol: Symbol name.\n\n    Returns:\n        Tuple of BookInfo structures or None.\n    \"\"\"  # noqa: E501\n    self._initialize_if_needed()\n    self.logger.info(\"Retrieving market book for symbol: %s\", symbol)\n    response = self.mt5.market_book_get(symbol)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"market_book_get\",\n        context=f\"symbol={symbol}\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.market_book_release","title":"market_book_release","text":"<pre><code>market_book_release(symbol: str) -&gt; bool\n</code></pre> <p>Cancels subscription of the terminal to the Market Depth change events for a specified symbol.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <p>Returns:</p> Type Description <code>bool</code> <p>True if successful, False otherwise.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef market_book_release(self, symbol: str) -&gt; bool:\n    \"\"\"Cancels subscription of the terminal to the Market Depth change events for a specified symbol.\n\n    Args:\n        symbol: Symbol name.\n\n    Returns:\n        True if successful, False otherwise.\n    \"\"\"  # noqa: E501\n    self._initialize_if_needed()\n    self.logger.info(\"Releasing market book for symbol: %s\", symbol)\n    response = self.mt5.market_book_release(symbol)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"market_book_release\",\n        context=f\"symbol={symbol}\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.order_calc_margin","title":"order_calc_margin","text":"<pre><code>order_calc_margin(\n    action: int, symbol: str, volume: float, price: float\n) -&gt; float\n</code></pre> <p>Return margin in the account currency to perform a specified trading operation.</p> <p>Parameters:</p> Name Type Description Default <code>action</code> <code>int</code> <p>Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL).</p> required <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>volume</code> <code>float</code> <p>Volume in lots.</p> required <code>price</code> <code>float</code> <p>Open price.</p> required <p>Returns:</p> Type Description <code>float</code> <p>Required margin amount or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef order_calc_margin(\n    self,\n    action: int,\n    symbol: str,\n    volume: float,\n    price: float,\n) -&gt; float:\n    \"\"\"Return margin in the account currency to perform a specified trading operation.\n\n    Args:\n        action: Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL).\n        symbol: Symbol name.\n        volume: Volume in lots.\n        price: Open price.\n\n    Returns:\n        Required margin amount or None.\n    \"\"\"  # noqa: E501\n    self._initialize_if_needed()\n    self.logger.info(\n        \"Calculating margin: action=%d, symbol=%s, volume=%.2f, price=%.5f\",\n        action,\n        symbol,\n        volume,\n        price,\n    )\n    response = self.mt5.order_calc_margin(action, symbol, volume, price)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"order_calc_margin\",\n        context=f\"action={action}, symbol={symbol}, volume={volume}, price={price}\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.order_calc_profit","title":"order_calc_profit","text":"<pre><code>order_calc_profit(\n    action: int,\n    symbol: str,\n    volume: float,\n    price_open: float,\n    price_close: float,\n) -&gt; float\n</code></pre> <p>Return profit in the account currency for a specified trading operation.</p> <p>Parameters:</p> Name Type Description Default <code>action</code> <code>int</code> <p>Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL).</p> required <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>volume</code> <code>float</code> <p>Volume in lots.</p> required <code>price_open</code> <code>float</code> <p>Open price.</p> required <code>price_close</code> <code>float</code> <p>Close price.</p> required <p>Returns:</p> Type Description <code>float</code> <p>Calculated profit or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef order_calc_profit(\n    self,\n    action: int,\n    symbol: str,\n    volume: float,\n    price_open: float,\n    price_close: float,\n) -&gt; float:\n    \"\"\"Return profit in the account currency for a specified trading operation.\n\n    Args:\n        action: Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL).\n        symbol: Symbol name.\n        volume: Volume in lots.\n        price_open: Open price.\n        price_close: Close price.\n\n    Returns:\n        Calculated profit or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\n        (\n            \"Calculating profit: action=%d, symbol=%s, volume=%.2f,\"\n            \" price_open=%.5f, price_close=%.5f\"\n        ),\n        action,\n        symbol,\n        volume,\n        price_open,\n        price_close,\n    )\n    response = self.mt5.order_calc_profit(\n        action, symbol, volume, price_open, price_close\n    )\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"order_calc_profit\",\n        context=(\n            f\"action={action}, symbol={symbol}, volume={volume},\"\n            f\" price_open={price_open}, price_close={price_close}\"\n        ),\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.order_check","title":"order_check","text":"<pre><code>order_check(request: dict[str, Any]) -&gt; Any\n</code></pre> <p>Check funds sufficiency for performing a required trading operation.</p> <p>Parameters:</p> Name Type Description Default <code>request</code> <code>dict[str, Any]</code> <p>Trade request dictionary.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>OrderCheckResult structure or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef order_check(self, request: dict[str, Any]) -&gt; Any:\n    \"\"\"Check funds sufficiency for performing a required trading operation.\n\n    Args:\n        request: Trade request dictionary.\n\n    Returns:\n        OrderCheckResult structure or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Checking order with request: %s\", request)\n    response = self.mt5.order_check(request)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"order_check\",\n        context=f\"request={request}\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.order_send","title":"order_send","text":"<pre><code>order_send(request: dict[str, Any]) -&gt; Any\n</code></pre> <p>Send a request to perform a trading operation from the terminal to the trade server.</p> <p>Parameters:</p> Name Type Description Default <code>request</code> <code>dict[str, Any]</code> <p>Trade request dictionary.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>OrderSendResult structure or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef order_send(self, request: dict[str, Any]) -&gt; Any:\n    \"\"\"Send a request to perform a trading operation from the terminal to the trade server.\n\n    Args:\n        request: Trade request dictionary.\n\n    Returns:\n        OrderSendResult structure or None.\n    \"\"\"  # noqa: E501\n    self._initialize_if_needed()\n    self.logger.info(\"Sending order with request: %s\", request)\n    response = self.mt5.order_send(request)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"order_send\",\n        context=f\"request={request}\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.orders_get","title":"orders_get","text":"<pre><code>orders_get(\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n) -&gt; tuple[Any, ...]\n</code></pre> <p>Get active orders with the ability to filter by symbol or ticket.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str | None</code> <p>Symbol name filter.</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Group filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Order ticket filter.</p> <code>None</code> <p>Returns:</p> Type Description <code>tuple[Any, ...]</code> <p>Tuple of order info structures or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef orders_get(\n    self,\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n) -&gt; tuple[Any, ...]:\n    \"\"\"Get active orders with the ability to filter by symbol or ticket.\n\n    Args:\n        symbol: Symbol name filter.\n        group: Group filter.\n        ticket: Order ticket filter.\n\n    Returns:\n        Tuple of order info structures or None.\n    \"\"\"\n    self._initialize_if_needed()\n    if ticket is not None:\n        self.logger.info(\"Retrieving order with ticket: %d\", ticket)\n        response = self.mt5.orders_get(ticket=ticket)\n        context = f\"ticket={ticket}\"\n    elif group is not None:\n        self.logger.info(\"Retrieving orders for group: %s\", group)\n        response = self.mt5.orders_get(group=group)\n        context = f\"group={group}\"\n    elif symbol is not None:\n        self.logger.info(\"Retrieving orders for symbol: %s\", symbol)\n        response = self.mt5.orders_get(symbol=symbol)\n        context = f\"symbol={symbol}\"\n    else:\n        self.logger.info(\"Retrieving all active orders.\")\n        response = self.mt5.orders_get()\n        context = None\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"orders_get\",\n        context=context,\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.orders_total","title":"orders_total","text":"<pre><code>orders_total() -&gt; int\n</code></pre> <p>Get the number of active orders.</p> <p>Returns:</p> Type Description <code>int</code> <p>Number of active orders.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef orders_total(self) -&gt; int:\n    \"\"\"Get the number of active orders.\n\n    Returns:\n        Number of active orders.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Retrieving total number of active orders.\")\n    return self.mt5.orders_total()\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.positions_get","title":"positions_get","text":"<pre><code>positions_get(\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n) -&gt; tuple[Any, ...]\n</code></pre> <p>Get open positions with the ability to filter by symbol or ticket.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str | None</code> <p>Symbol name filter.</p> <code>None</code> <code>group</code> <code>str | None</code> <p>Group filter.</p> <code>None</code> <code>ticket</code> <code>int | None</code> <p>Position ticket filter.</p> <code>None</code> <p>Returns:</p> Type Description <code>tuple[Any, ...]</code> <p>Tuple of position info structures or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef positions_get(\n    self,\n    symbol: str | None = None,\n    group: str | None = None,\n    ticket: int | None = None,\n) -&gt; tuple[Any, ...]:\n    \"\"\"Get open positions with the ability to filter by symbol or ticket.\n\n    Args:\n        symbol: Symbol name filter.\n        group: Group filter.\n        ticket: Position ticket filter.\n\n    Returns:\n        Tuple of position info structures or None.\n    \"\"\"\n    self._initialize_if_needed()\n    if ticket is not None:\n        self.logger.info(\"Retrieving position with ticket: %d\", ticket)\n        response = self.mt5.positions_get(ticket=ticket)\n        context = f\"ticket={ticket}\"\n    elif group is not None:\n        self.logger.info(\"Retrieving positions for group: %s\", group)\n        response = self.mt5.positions_get(group=group)\n        context = f\"group={group}\"\n    elif symbol is not None:\n        self.logger.info(\"Retrieving positions for symbol: %s\", symbol)\n        response = self.mt5.positions_get(symbol=symbol)\n        context = f\"symbol={symbol}\"\n    else:\n        self.logger.info(\"Retrieving all open positions.\")\n        response = self.mt5.positions_get()\n        context = None\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"positions_get\",\n        context=context,\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.positions_total","title":"positions_total","text":"<pre><code>positions_total() -&gt; int\n</code></pre> <p>Get the number of open positions.</p> <p>Returns:</p> Type Description <code>int</code> <p>Number of open positions.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef positions_total(self) -&gt; int:\n    \"\"\"Get the number of open positions.\n\n    Returns:\n        Number of open positions.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Retrieving total number of open positions.\")\n    return self.mt5.positions_total()\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.shutdown","title":"shutdown","text":"<pre><code>shutdown() -&gt; None\n</code></pre> <p>Close the previously established connection to the MetaTrader 5 terminal.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef shutdown(self) -&gt; None:\n    \"\"\"Close the previously established connection to the MetaTrader 5 terminal.\"\"\"\n    self.logger.info(\"Shutting down MT5 connection.\")\n    response = self.mt5.shutdown()\n    self._is_initialized = False\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbol_info","title":"symbol_info","text":"<pre><code>symbol_info(symbol: str) -&gt; Any\n</code></pre> <p>Get data on the specified financial instrument.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>Symbol info structure or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef symbol_info(self, symbol: str) -&gt; Any:\n    \"\"\"Get data on the specified financial instrument.\n\n    Args:\n        symbol: Symbol name.\n\n    Returns:\n        Symbol info structure or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Retrieving information for symbol: %s\", symbol)\n    response = self.mt5.symbol_info(symbol)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"symbol_info\",\n        context=f\"symbol={symbol}\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbol_info_tick","title":"symbol_info_tick","text":"<pre><code>symbol_info_tick(symbol: str) -&gt; Any\n</code></pre> <p>Get the last tick for the specified financial instrument.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>Tick info structure or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef symbol_info_tick(self, symbol: str) -&gt; Any:\n    \"\"\"Get the last tick for the specified financial instrument.\n\n    Args:\n        symbol: Symbol name.\n\n    Returns:\n        Tick info structure or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Retrieving last tick for symbol: %s\", symbol)\n    response = self.mt5.symbol_info_tick(symbol)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"symbol_info_tick\",\n        context=f\"symbol={symbol}\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbol_select","title":"symbol_select","text":"<pre><code>symbol_select(symbol: str, enable: bool = True) -&gt; bool\n</code></pre> <p>Select a symbol in the MarketWatch window or remove a symbol from the window.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol name.</p> required <code>enable</code> <code>bool</code> <p>True to show, False to hide.</p> <code>True</code> <p>Returns:</p> Type Description <code>bool</code> <p>True if successful, False otherwise.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef symbol_select(self, symbol: str, enable: bool = True) -&gt; bool:\n    \"\"\"Select a symbol in the MarketWatch window or remove a symbol from the window.\n\n    Args:\n        symbol: Symbol name.\n        enable: True to show, False to hide.\n\n    Returns:\n        True if successful, False otherwise.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Selecting symbol: %s, enable=%s\", symbol, enable)\n    response = self.mt5.symbol_select(symbol, enable)\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"symbol_select\",\n        context=f\"symbol={symbol}, enable={enable}\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbols_get","title":"symbols_get","text":"<pre><code>symbols_get(group: str | None = None) -&gt; tuple[Any, ...]\n</code></pre> <p>Get all financial instruments from the terminal.</p> <p>Parameters:</p> Name Type Description Default <code>group</code> <code>str | None</code> <p>Symbol group filter.</p> <code>None</code> <p>Returns:</p> Type Description <code>tuple[Any, ...]</code> <p>Tuple of symbol info structures or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef symbols_get(self, group: str | None = None) -&gt; tuple[Any, ...]:\n    \"\"\"Get all financial instruments from the terminal.\n\n    Args:\n        group: Symbol group filter.\n\n    Returns:\n        Tuple of symbol info structures or None.\n    \"\"\"\n    self._initialize_if_needed()\n    if group is not None:\n        self.logger.info(\"Retrieving symbols for group: %s\", group)\n        response = self.mt5.symbols_get(group=group)\n        context = f\"group={group}\"\n    else:\n        self.logger.info(\"Retrieving all symbols.\")\n        response = self.mt5.symbols_get()\n        context = None\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"symbols_get\",\n        context=context,\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbols_total","title":"symbols_total","text":"<pre><code>symbols_total() -&gt; int\n</code></pre> <p>Get the number of all financial instruments in the terminal.</p> <p>Returns:</p> Type Description <code>int</code> <p>Total number of symbols.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef symbols_total(self) -&gt; int:\n    \"\"\"Get the number of all financial instruments in the terminal.\n\n    Returns:\n        Total number of symbols.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Retrieving total number of symbols.\")\n    return self.mt5.symbols_total()\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.terminal_info","title":"terminal_info","text":"<pre><code>terminal_info() -&gt; Any\n</code></pre> <p>Get the connected MetaTrader 5 client terminal status and settings.</p> <p>Returns:</p> Type Description <code>Any</code> <p>TerminalInfo structure or None.</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef terminal_info(self) -&gt; Any:\n    \"\"\"Get the connected MetaTrader 5 client terminal status and settings.\n\n    Returns:\n        TerminalInfo structure or None.\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Retrieving terminal information.\")\n    response = self.mt5.terminal_info()\n    self._validate_mt5_response_is_not_none(\n        response=response,\n        operation=\"terminal_info\",\n    )\n    return response\n</code></pre>"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.version","title":"version","text":"<pre><code>version() -&gt; tuple[int, int, str]\n</code></pre> <p>Return the MetaTrader 5 terminal version.</p> <p>Returns:</p> Type Description <code>tuple[int, int, str]</code> <p>Tuple of (terminal_version, build, release_date).</p> Source code in <code>pdmt5/mt5.py</code> <pre><code>@_log_mt5_last_status_code\ndef version(self) -&gt; tuple[int, int, str]:\n    \"\"\"Return the MetaTrader 5 terminal version.\n\n    Returns:\n        Tuple of (terminal_version, build, release_date).\n    \"\"\"\n    self._initialize_if_needed()\n    self.logger.info(\"Retrieving MT5 version information.\")\n    return self.mt5.version()\n</code></pre>"},{"location":"api/mt5/#mt5runtimeerror","title":"Mt5RuntimeError","text":"<p>options: show_bases: false</p> <p>Custom runtime exception for MetaTrader 5 specific errors.</p>"},{"location":"api/mt5/#pdmt5.mt5.Mt5RuntimeError","title":"pdmt5.mt5.Mt5RuntimeError","text":"<p>               Bases: <code>RuntimeError</code></p> <p>MetaTrader5 specific runtime error.</p> <p>Raised when MetaTrader5 operations fail or when the client is used incorrectly (e.g., calling methods before initialization).</p>"},{"location":"api/mt5/#usage-examples","title":"Usage Examples","text":""},{"location":"api/mt5/#basic-connection","title":"Basic Connection","text":"<pre><code>import MetaTrader5 as mt5\nfrom pdmt5.mt5 import Mt5Client\n\n# Create client\nclient = Mt5Client(mt5=mt5)\n\n# Use as context manager\nwith client:\n    # Initialize connection\n    success = client.initialize()\n    if success:\n        print(\"Connected to MetaTrader 5\")\n\n        # Get version info\n        version = client.version()\n        print(f\"MT5 Version: {version}\")\n\n        # Get account info\n        account = client.account_info()\n        print(f\"Account: {account}\")\n</code></pre>"},{"location":"api/mt5/#connection-with-login","title":"Connection with Login","text":"<pre><code>with client:\n    # Initialize with path\n    client.initialize(path=\"C:\\\\Program Files\\\\MetaTrader 5\\\\terminal64.exe\")\n\n    # Login to specific account\n    success = client.login(\n        login=12345,\n        password=\"your_password\",\n        server=\"broker_server\"\n    )\n\n    if success:\n        print(\"Logged in successfully\")\n</code></pre>"},{"location":"api/mt5/#symbol-operations","title":"Symbol Operations","text":"<pre><code>with client:\n    client.initialize()\n\n    # Get total number of symbols\n    total = client.symbols_total()\n    print(f\"Total symbols: {total}\")\n\n    # Get all symbols\n    symbols = client.symbols_get()\n    print(f\"First 5 symbols: {symbols[:5]}\")\n\n    # Get symbols by group\n    forex_symbols = client.symbols_get(group=\"*USD*\")\n\n    # Get specific symbol info\n    symbol_info = client.symbol_info(\"EURUSD\")\n    print(f\"EURUSD info: {symbol_info}\")\n\n    # Get current tick\n    tick = client.symbol_info_tick(\"EURUSD\")\n    print(f\"Current EURUSD tick: {tick}\")\n</code></pre>"},{"location":"api/mt5/#market-data-retrieval","title":"Market Data Retrieval","text":"<pre><code>from datetime import datetime\nimport MetaTrader5 as mt5\n\nwith client:\n    client.initialize()\n\n    # Get OHLCV rates from specific date\n    rates = client.copy_rates_from(\n        symbol=\"EURUSD\",\n        timeframe=mt5.TIMEFRAME_H1,\n        date_from=datetime(2024, 1, 1),\n        count=100\n    )\n\n    # Get rates within date range\n    rates_range = client.copy_rates_range(\n        symbol=\"EURUSD\",\n        timeframe=mt5.TIMEFRAME_D1,\n        date_from=datetime(2024, 1, 1),\n        date_to=datetime(2024, 1, 31)\n    )\n\n    # Get tick data\n    ticks = client.copy_ticks_from(\n        symbol=\"EURUSD\",\n        date_from=datetime(2024, 1, 1),\n        count=1000,\n        flags=mt5.COPY_TICKS_ALL\n    )\n</code></pre>"},{"location":"api/mt5/#trading-operations","title":"Trading Operations","text":"<pre><code>with client:\n    client.initialize()\n    client.login(12345, \"password\", \"server\")\n\n    # Get current positions\n    positions = client.positions_get()\n    print(f\"Open positions: {len(positions) if positions else 0}\")\n\n    # Get current orders\n    orders = client.orders_get()\n    print(f\"Pending orders: {len(orders) if orders else 0}\")\n\n    # Calculate margin requirement\n    margin = client.order_calc_margin(\n        action=mt5.ORDER_TYPE_BUY,\n        symbol=\"EURUSD\",\n        volume=1.0,\n        price=1.1000\n    )\n    print(f\"Required margin: {margin}\")\n\n    # Calculate profit\n    profit = client.order_calc_profit(\n        action=mt5.ORDER_TYPE_BUY,\n        symbol=\"EURUSD\",\n        volume=1.0,\n        price_open=1.1000,\n        price_close=1.1050\n    )\n    print(f\"Calculated profit: {profit}\")\n</code></pre>"},{"location":"api/mt5/#historical-data","title":"Historical Data","text":"<pre><code>from datetime import datetime\n\nwith client:\n    client.initialize()\n\n    # Get historical orders\n    history_orders = client.history_orders_get(\n        date_from=datetime(2024, 1, 1),\n        date_to=datetime(2024, 1, 31)\n    )\n\n    # Get historical deals\n    history_deals = client.history_deals_get(\n        date_from=datetime(2024, 1, 1),\n        date_to=datetime(2024, 1, 31)\n    )\n\n    # Get specific order by ticket\n    order = client.history_orders_get(ticket=123456)\n</code></pre>"},{"location":"api/mt5/#market-book-operations","title":"Market Book Operations","text":"<pre><code>with client:\n    client.initialize()\n\n    # Subscribe to market depth\n    success = client.market_book_add(\"EURUSD\")\n    if success:\n        print(\"Subscribed to EURUSD market depth\")\n\n        # Get market book\n        book = client.market_book_get(\"EURUSD\")\n        print(f\"Market book: {book}\")\n\n        # Unsubscribe\n        client.market_book_release(\"EURUSD\")\n</code></pre>"},{"location":"api/mt5/#connection-management","title":"Connection Management","text":"<p>The Mt5Client supports both explicit and context manager usage:</p> <pre><code># Explicit initialization\nclient = Mt5Client(mt5=mt5)\nclient.initialize()\ntry:\n    # Your trading operations\n    account = client.account_info()\nfinally:\n    client.shutdown()\n\n# Context manager (recommended)\nwith Mt5Client(mt5=mt5) as client:\n    client.initialize()\n    # Your trading operations\n    account = client.account_info()\n</code></pre>"},{"location":"api/mt5/#error-handling","title":"Error Handling","text":"<p>All methods include proper error handling and raise <code>Mt5RuntimeError</code> with detailed information when operations fail:</p> <pre><code>from pdmt5.mt5 import Mt5RuntimeError\n\ntry:\n    with client:\n        client.initialize()\n        rates = client.copy_rates_from(\"INVALID\", mt5.TIMEFRAME_H1, datetime.now(), 100)\nexcept Mt5RuntimeError as e:\n    print(f\"MetaTrader 5 error: {e}\")\n</code></pre>"},{"location":"api/mt5/#logging","title":"Logging","text":"<p>The client includes comprehensive logging for all operations:</p> <pre><code>import logging\n\n# Enable debug logging to see all MT5 operations\nlogging.basicConfig(level=logging.DEBUG)\n\nwith client:\n    client.initialize()  # Will log initialization details\n    account = client.account_info()  # Will log account retrieval\n</code></pre>"},{"location":"api/mt5/#method-categories","title":"Method Categories","text":""},{"location":"api/mt5/#connection-management_1","title":"Connection Management","text":"<ul> <li><code>initialize()</code> - Initialize MT5 connection</li> <li><code>login()</code> - Login to trading account</li> <li><code>shutdown()</code> - Close connection</li> <li><code>version()</code> - Get MT5 version</li> <li><code>last_error()</code> - Get last error details</li> </ul>"},{"location":"api/mt5/#account-terminal","title":"Account &amp; Terminal","text":"<ul> <li><code>account_info()</code> - Get account information</li> <li><code>terminal_info()</code> - Get terminal status and settings</li> </ul>"},{"location":"api/mt5/#symbol-management","title":"Symbol Management","text":"<ul> <li><code>symbols_total()</code> - Get total number of symbols</li> <li><code>symbols_get()</code> - Get symbol list</li> <li><code>symbol_info()</code> - Get symbol information</li> <li><code>symbol_info_tick()</code> - Get current tick</li> <li><code>symbol_select()</code> - Add/remove symbol from Market Watch</li> </ul>"},{"location":"api/mt5/#market-data","title":"Market Data","text":"<ul> <li><code>copy_rates_from()</code> - Get OHLCV rates from date</li> <li><code>copy_rates_from_pos()</code> - Get OHLCV rates from position</li> <li><code>copy_rates_range()</code> - Get OHLCV rates in date range</li> <li><code>copy_ticks_from()</code> - Get ticks from date</li> <li><code>copy_ticks_range()</code> - Get ticks in date range</li> </ul>"},{"location":"api/mt5/#market-book","title":"Market Book","text":"<ul> <li><code>market_book_add()</code> - Subscribe to market depth</li> <li><code>market_book_release()</code> - Unsubscribe from market depth</li> <li><code>market_book_get()</code> - Get market book data</li> </ul>"},{"location":"api/mt5/#trading","title":"Trading","text":"<ul> <li><code>orders_total()</code> - Get number of pending orders</li> <li><code>orders_get()</code> - Get pending orders</li> <li><code>positions_total()</code> - Get number of open positions</li> <li><code>positions_get()</code> - Get open positions</li> <li><code>order_calc_margin()</code> - Calculate required margin</li> <li><code>order_calc_profit()</code> - Calculate profit</li> <li><code>order_check()</code> - Validate order request</li> <li><code>order_send()</code> - Send trading order</li> </ul>"},{"location":"api/mt5/#history","title":"History","text":"<ul> <li><code>history_orders_total()</code> - Get historical orders count</li> <li><code>history_orders_get()</code> - Get historical orders</li> <li><code>history_deals_total()</code> - Get historical deals count</li> <li><code>history_deals_get()</code> - Get historical deals</li> </ul>"},{"location":"api/mt5/#best-practices","title":"Best Practices","text":"<ol> <li>Always use context manager for automatic connection management</li> <li>Handle errors gracefully with try-except blocks</li> <li>Initialize before operations - call <code>initialize()</code> after creating the client</li> <li>Use logging to debug connection and operation issues</li> <li>Check return values - many methods return None on failure</li> <li>Use appropriate timeframes and date ranges for data requests</li> <li>Subscribe/unsubscribe to market book properly to avoid resource leaks</li> </ol>"},{"location":"api/rest-api/","title":"REST API","text":"<p>The pdmt5 REST API exposes read-only MetaTrader 5 data via FastAPI. It supports JSON and Apache Parquet responses for efficient analytics workflows.</p>"},{"location":"api/rest-api/#installation","title":"Installation","text":"<p>Install pdmt5 with API dependencies:</p> <pre><code>pip install pdmt5[api]\n</code></pre>"},{"location":"api/rest-api/#configuration","title":"Configuration","text":"<p>Set the API key and optional limits via environment variables:</p> <pre><code>export MT5_API_KEY=\"your-secret-api-key\"\nexport API_LOG_LEVEL=\"INFO\"\nexport API_RATE_LIMIT=\"100\"\nexport API_CORS_ORIGINS=\"*\"\n</code></pre>"},{"location":"api/rest-api/#running-the-api","title":"Running the API","text":"<pre><code>uvicorn pdmt5.api.main:app --host 0.0.0.0 --port 8000\n</code></pre> <p>Access the docs at:</p> <ul> <li>Swagger UI: <code>http://localhost:8000/docs</code></li> <li>OpenAPI JSON: <code>http://localhost:8000/openapi.json</code></li> </ul>"},{"location":"api/rest-api/#authentication","title":"Authentication","text":"<p>All endpoints except <code>/api/v1/health</code> require an API key header:</p> <pre><code>curl -H \"X-API-Key: your-secret-api-key\" \\\n  http://localhost:8000/api/v1/symbols\n</code></pre>"},{"location":"api/rest-api/#format-negotiation","title":"Format Negotiation","text":"<p>Use <code>Accept</code> header or <code>format</code> query parameter:</p> <pre><code>curl -H \"X-API-Key: your-secret-api-key\" \\\n  -H \"Accept: application/parquet\" \\\n  \"http://localhost:8000/api/v1/rates/from?symbol=EURUSD&amp;timeframe=1&amp;date_from=2024-01-01T00:00:00Z&amp;count=100\"\n</code></pre> <pre><code>curl -H \"X-API-Key: your-secret-api-key\" \\\n  \"http://localhost:8000/api/v1/symbols?format=json\"\n</code></pre>"},{"location":"api/rest-api/#example-requests","title":"Example Requests","text":""},{"location":"api/rest-api/#health-check-no-auth","title":"Health Check (No Auth)","text":"<pre><code>curl http://localhost:8000/api/v1/health\n</code></pre>"},{"location":"api/rest-api/#mt5-version","title":"MT5 Version","text":"<pre><code>curl -H \"X-API-Key: your-secret-api-key\" \\\n  http://localhost:8000/api/v1/version\n</code></pre>"},{"location":"api/rest-api/#symbols","title":"Symbols","text":"<pre><code>curl -H \"X-API-Key: your-secret-api-key\" \\\n  http://localhost:8000/api/v1/symbols\n</code></pre> <pre><code>curl -H \"X-API-Key: your-secret-api-key\" \\\n  \"http://localhost:8000/api/v1/symbols?group=*USD*\"\n</code></pre>"},{"location":"api/rest-api/#symbol-details","title":"Symbol Details","text":"<pre><code>curl -H \"X-API-Key: your-secret-api-key\" \\\n  http://localhost:8000/api/v1/symbols/EURUSD\n</code></pre>"},{"location":"api/rest-api/#rates-ohlcv","title":"Rates (OHLCV)","text":"<pre><code>curl -H \"X-API-Key: your-secret-api-key\" \\\n  \"http://localhost:8000/api/v1/rates/from?symbol=EURUSD&amp;timeframe=1&amp;date_from=2024-01-01T00:00:00Z&amp;count=100\"\n</code></pre>"},{"location":"api/rest-api/#account-info","title":"Account Info","text":"<pre><code>curl -H \"X-API-Key: your-secret-api-key\" \\\n  http://localhost:8000/api/v1/account\n</code></pre>"},{"location":"api/rest-api/#history-orders","title":"History Orders","text":"<pre><code>curl -H \"X-API-Key: your-secret-api-key\" \\\n  \"http://localhost:8000/api/v1/history/orders?date_from=2024-01-01T00:00:00Z&amp;date_to=2024-01-02T00:00:00Z\"\n</code></pre>"},{"location":"api/rest-api/#error-responses","title":"Error Responses","text":"<p>Errors follow RFC 7807 Problem Details:</p> <pre><code>{\n  \"type\": \"/errors/validation-error\",\n  \"title\": \"Request Validation Failed\",\n  \"status\": 400,\n  \"detail\": \"count must be positive (got: -10)\",\n  \"instance\": \"/api/v1/rates/from\"\n}\n</code></pre>"},{"location":"api/rest-api/#performance-benchmarks","title":"Performance Benchmarks","text":"<p>Target benchmarks for production readiness:</p> <ul> <li>Health check latency &lt; 500ms under normal load</li> <li>Market data queries &lt; 2s for typical datasets (&lt;1000 records)</li> <li>100 concurrent requests without significant degradation</li> </ul>"},{"location":"api/rest-api/#security-checklist","title":"Security Checklist","text":"<p>Minimum security posture for deployments:</p> <ul> <li>API key authentication enabled (<code>MT5_API_KEY</code>)</li> <li>Rate limiting enabled (<code>API_RATE_LIMIT</code>)</li> <li>Run behind HTTPS in production</li> <li>Restrict CORS origins (<code>API_CORS_ORIGINS</code>) for public deployments</li> </ul>"},{"location":"api/trading/","title":"Trading","text":""},{"location":"api/trading/#pdmt5.trading","title":"pdmt5.trading","text":"<p>Trading operations module with advanced MetaTrader5 functionality.</p>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient","title":"Mt5TradingClient","text":"<p>               Bases: <code>Mt5DataClient</code></p> <p>MetaTrader5 trading client with advanced trading operations.</p> <p>This class extends Mt5DataClient to provide specialized trading functionality including position management, order analysis, and trading performance metrics.</p>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.model_config","title":"model_config  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>model_config = ConfigDict(frozen=True)\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.mt5_failed_trade_retcodes","title":"mt5_failed_trade_retcodes  <code>cached</code> <code>property</code>","text":"<pre><code>mt5_failed_trade_retcodes: set[int]\n</code></pre> <p>Set of failed trade return codes.</p> <p>Returns:</p> Type Description <code>set[int]</code> <p>Set of failed trade return codes.</p>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.mt5_successful_trade_retcodes","title":"mt5_successful_trade_retcodes  <code>cached</code> <code>property</code>","text":"<pre><code>mt5_successful_trade_retcodes: set[int]\n</code></pre> <p>Set of successful trade return codes.</p> <p>Returns:</p> Type Description <code>set[int]</code> <p>Set of successful trade return codes.</p>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.calculate_minimum_order_margin","title":"calculate_minimum_order_margin","text":"<pre><code>calculate_minimum_order_margin(\n    symbol: str, order_side: Literal[\"BUY\", \"SELL\"]\n) -&gt; dict[str, float]\n</code></pre> <p>Calculate the minimum order margins for a given symbol.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol for which to calculate the minimum order margins.</p> required <code>order_side</code> <code>Literal['BUY', 'SELL']</code> <p>Optional side of the order, either \"BUY\" or \"SELL\".</p> required <p>Returns:</p> Type Description <code>dict[str, float]</code> <p>Dictionary with minimum volume and margin for the specified order side.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def calculate_minimum_order_margin(\n    self,\n    symbol: str,\n    order_side: Literal[\"BUY\", \"SELL\"],\n) -&gt; dict[str, float]:\n    \"\"\"Calculate the minimum order margins for a given symbol.\n\n    Args:\n        symbol: Symbol for which to calculate the minimum order margins.\n        order_side: Optional side of the order, either \"BUY\" or \"SELL\".\n\n    Returns:\n        Dictionary with minimum volume and margin for the specified order side.\n    \"\"\"\n    symbol_info = self.symbol_info_as_dict(symbol=symbol)\n    symbol_info_tick = self.symbol_info_tick_as_dict(symbol=symbol)\n    margin = self.order_calc_margin(\n        action=getattr(self.mt5, f\"ORDER_TYPE_{order_side.upper()}\"),\n        symbol=symbol,\n        volume=symbol_info[\"volume_min\"],\n        price=(\n            symbol_info_tick[\"bid\"]\n            if order_side == \"SELL\"\n            else symbol_info_tick[\"ask\"]\n        ),\n    )\n    result = {\"volume\": symbol_info[\"volume_min\"], \"margin\": margin}\n    if margin:\n        self.logger.info(\n            \"Calculated minimum %s order margin for %s: %s\",\n            order_side,\n            symbol,\n            result,\n        )\n    else:\n        self.logger.warning(\n            \"Calculated minimum order margin to %s %s: %s\",\n            order_side,\n            symbol,\n            result,\n        )\n    return result\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.calculate_new_position_margin_ratio","title":"calculate_new_position_margin_ratio","text":"<pre><code>calculate_new_position_margin_ratio(\n    symbol: str,\n    new_position_side: Literal[\"BUY\", \"SELL\"] | None = None,\n    new_position_volume: float = 0,\n) -&gt; float\n</code></pre> <p>Calculate the margin ratio for a new position.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol for which to calculate the margin ratio.</p> required <code>new_position_side</code> <code>Literal['BUY', 'SELL'] | None</code> <p>Side of the new position, either \"BUY\" or \"SELL\".</p> <code>None</code> <code>new_position_volume</code> <code>float</code> <p>Volume of the new position.</p> <code>0</code> <p>Returns:</p> Name Type Description <code>float</code> <code>float</code> <p>Margin ratio for the new position as a fraction of account equity.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def calculate_new_position_margin_ratio(\n    self,\n    symbol: str,\n    new_position_side: Literal[\"BUY\", \"SELL\"] | None = None,\n    new_position_volume: float = 0,\n) -&gt; float:\n    \"\"\"Calculate the margin ratio for a new position.\n\n    Args:\n        symbol: Symbol for which to calculate the margin ratio.\n        new_position_side: Side of the new position, either \"BUY\" or \"SELL\".\n        new_position_volume: Volume of the new position.\n\n    Returns:\n        float: Margin ratio for the new position as a fraction of account equity.\n    \"\"\"\n    account_info = self.account_info_as_dict()\n    if not account_info[\"equity\"]:\n        result = 0.0\n    else:\n        positions_df = self.fetch_positions_with_metrics_as_df(symbol=symbol)\n        current_signed_margin = (\n            positions_df[\"signed_margin\"].sum() if positions_df.size else 0\n        )\n        symbol_info_tick = self.symbol_info_tick_as_dict(symbol=symbol)\n        if not (new_position_side and new_position_volume):\n            new_signed_margin = 0\n        elif new_position_side.upper() == \"BUY\":\n            new_signed_margin = self.order_calc_margin(\n                action=self.mt5.ORDER_TYPE_BUY,\n                symbol=symbol,\n                volume=new_position_volume,\n                price=symbol_info_tick[\"ask\"],\n            )\n        elif new_position_side.upper() == \"SELL\":\n            new_signed_margin = -self.order_calc_margin(\n                action=self.mt5.ORDER_TYPE_SELL,\n                symbol=symbol,\n                volume=new_position_volume,\n                price=symbol_info_tick[\"bid\"],\n            )\n        else:\n            new_signed_margin = 0\n        result = abs(\n            (new_signed_margin + current_signed_margin) / account_info[\"equity\"]\n        )\n    self.logger.info(\n        \"Calculated new position margin ratio for %s: %s\",\n        symbol,\n        result,\n    )\n    return result\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.calculate_spread_ratio","title":"calculate_spread_ratio","text":"<pre><code>calculate_spread_ratio(symbol: str) -&gt; float\n</code></pre> <p>Calculate the spread ratio for a given symbol.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol for which to calculate the spread ratio.</p> required <p>Returns:</p> Type Description <code>float</code> <p>Spread ratio as a float.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def calculate_spread_ratio(\n    self,\n    symbol: str,\n) -&gt; float:\n    \"\"\"Calculate the spread ratio for a given symbol.\n\n    Args:\n        symbol: Symbol for which to calculate the spread ratio.\n\n    Returns:\n        Spread ratio as a float.\n    \"\"\"\n    symbol_info_tick = self.symbol_info_tick_as_dict(symbol=symbol)\n    result = (\n        (symbol_info_tick[\"ask\"] - symbol_info_tick[\"bid\"])\n        / (symbol_info_tick[\"ask\"] + symbol_info_tick[\"bid\"])\n        * 2\n    )\n    self.logger.info(\"Calculated spread ratio for %s: %s\", symbol, result)\n    return result\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.calculate_volume_by_margin","title":"calculate_volume_by_margin","text":"<pre><code>calculate_volume_by_margin(\n    symbol: str,\n    margin: float,\n    order_side: Literal[\"BUY\", \"SELL\"],\n) -&gt; float\n</code></pre> <p>Calculate volume based on margin for a given symbol and order side.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol for which to calculate the volume.</p> required <code>margin</code> <code>float</code> <p>Margin amount to use for the calculation.</p> required <code>order_side</code> <code>Literal['BUY', 'SELL']</code> <p>Side of the order, either \"BUY\" or \"SELL\".</p> required <p>Returns:</p> Type Description <code>float</code> <p>Calculated volume as a float.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def calculate_volume_by_margin(\n    self,\n    symbol: str,\n    margin: float,\n    order_side: Literal[\"BUY\", \"SELL\"],\n) -&gt; float:\n    \"\"\"Calculate volume based on margin for a given symbol and order side.\n\n    Args:\n        symbol: Symbol for which to calculate the volume.\n        margin: Margin amount to use for the calculation.\n        order_side: Side of the order, either \"BUY\" or \"SELL\".\n\n    Returns:\n        Calculated volume as a float.\n    \"\"\"\n    min_order_margin_dict = self.calculate_minimum_order_margin(\n        symbol=symbol,\n        order_side=order_side,\n    )\n    if min_order_margin_dict[\"margin\"]:\n        result = (\n            floor(margin / min_order_margin_dict[\"margin\"])\n            * min_order_margin_dict[\"volume\"]\n        )\n    else:\n        result = 0.0\n    self.logger.info(\n        \"Calculated volume by margin to %s %s: %s\",\n        order_side,\n        symbol,\n        result,\n    )\n    return result\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.close_open_positions","title":"close_open_positions","text":"<pre><code>close_open_positions(\n    symbols: str\n    | list[str]\n    | tuple[str, ...]\n    | None = None,\n    order_filling_mode: Literal[\n        \"IOC\", \"FOK\", \"RETURN\"\n    ] = \"IOC\",\n    dry_run: bool = False,\n    **kwargs: Any,\n) -&gt; dict[str, list[dict[str, Any]]]\n</code></pre> <p>Close all open positions for specified symbols.</p> <p>Parameters:</p> Name Type Description Default <code>symbols</code> <code>str | list[str] | tuple[str, ...] | None</code> <p>Optional symbol or list of symbols to filter positions. If None, all symbols will be considered.</p> <code>None</code> <code>order_filling_mode</code> <code>Literal['IOC', 'FOK', 'RETURN']</code> <p>Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\".</p> <code>'IOC'</code> <code>dry_run</code> <code>bool</code> <p>If True, only check the order without sending it.</p> <code>False</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments for request parameters.</p> <code>{}</code> <p>Returns:</p> Type Description <code>dict[str, list[dict[str, Any]]]</code> <p>Dictionary with symbols as keys and lists of dictionaries containing operation results for each closed position as values.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def close_open_positions(\n    self,\n    symbols: str | list[str] | tuple[str, ...] | None = None,\n    order_filling_mode: Literal[\"IOC\", \"FOK\", \"RETURN\"] = \"IOC\",\n    dry_run: bool = False,\n    **kwargs: Any,  # noqa: ANN401\n) -&gt; dict[str, list[dict[str, Any]]]:\n    \"\"\"Close all open positions for specified symbols.\n\n    Args:\n        symbols: Optional symbol or list of symbols to filter positions.\n            If None, all symbols will be considered.\n        order_filling_mode: Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\".\n        dry_run: If True, only check the order without sending it.\n        **kwargs: Additional keyword arguments for request parameters.\n\n    Returns:\n        Dictionary with symbols as keys and lists of dictionaries containing\n            operation results for each closed position as values.\n    \"\"\"\n    if isinstance(symbols, str):\n        symbol_list = [symbols]\n    elif isinstance(symbols, (list, tuple)):\n        symbol_list = symbols\n    else:\n        symbol_list = self.symbols_get()\n    self.logger.info(\"Fetching and closing positions for symbols: %s\", symbol_list)\n    return {\n        s: self._fetch_and_close_position(\n            symbol=s,\n            order_filling_mode=order_filling_mode,\n            dry_run=dry_run,\n            **kwargs,\n        )\n        for s in symbol_list\n    }\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.collect_entry_deals_as_df","title":"collect_entry_deals_as_df","text":"<pre><code>collect_entry_deals_as_df(\n    symbol: str,\n    history_seconds: int = 3600,\n    index_keys: str | None = \"ticket\",\n) -&gt; DataFrame\n</code></pre> <p>Collect entry deals as a DataFrame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol to collect entry deals for.</p> required <code>history_seconds</code> <code>int</code> <p>Time range in seconds to fetch deals around the last tick.</p> <code>3600</code> <code>index_keys</code> <code>str | None</code> <p>Optional index keys for the DataFrame.</p> <code>'ticket'</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>pd.DataFrame: Entry deals with time index.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def collect_entry_deals_as_df(\n    self,\n    symbol: str,\n    history_seconds: int = 3600,\n    index_keys: str | None = \"ticket\",\n) -&gt; pd.DataFrame:\n    \"\"\"Collect entry deals as a DataFrame.\n\n    Args:\n        symbol: Symbol to collect entry deals for.\n        history_seconds: Time range in seconds to fetch deals around the last tick.\n        index_keys: Optional index keys for the DataFrame.\n\n    Returns:\n        pd.DataFrame: Entry deals with time index.\n    \"\"\"\n    last_tick_time = self.symbol_info_tick_as_dict(symbol=symbol)[\"time\"]\n    deals_df = self.history_deals_get_as_df(\n        date_from=(last_tick_time - timedelta(seconds=history_seconds)),\n        date_to=(last_tick_time + timedelta(seconds=history_seconds)),\n        symbol=symbol,\n        index_keys=index_keys,\n    )\n    if deals_df.empty:\n        result = deals_df\n    else:\n        result = deals_df.pipe(\n            lambda d: d[\n                d[\"entry\"]\n                &amp; d[\"type\"].isin({self.mt5.DEAL_TYPE_BUY, self.mt5.DEAL_TYPE_SELL})\n            ]\n        )\n    self.logger.info(\n        \"Collected entry deals for %s: %d rows\",\n        symbol,\n        result.shape[0],\n    )\n    return result\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.fetch_latest_rates_as_df","title":"fetch_latest_rates_as_df","text":"<pre><code>fetch_latest_rates_as_df(\n    symbol: str,\n    granularity: str = \"M1\",\n    count: int = 1440,\n    index_keys: str | None = \"time\",\n) -&gt; DataFrame\n</code></pre> <p>Fetch rate (OHLC) data as a DataFrame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol to fetch data for.</p> required <code>granularity</code> <code>str</code> <p>Time granularity as a timeframe suffix (e.g., \"M1\", \"H1\").</p> <code>'M1'</code> <code>count</code> <code>int</code> <p>Number of bars to fetch.</p> <code>1440</code> <code>index_keys</code> <code>str | None</code> <p>Optional index keys for the DataFrame.</p> <code>'time'</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>pd.DataFrame: OHLC data with time index.</p> <p>Raises:</p> Type Description <code>Mt5TradingError</code> <p>If the granularity is not supported by MetaTrader5.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def fetch_latest_rates_as_df(\n    self,\n    symbol: str,\n    granularity: str = \"M1\",\n    count: int = 1440,\n    index_keys: str | None = \"time\",\n) -&gt; pd.DataFrame:\n    \"\"\"Fetch rate (OHLC) data as a DataFrame.\n\n    Args:\n        symbol: Symbol to fetch data for.\n        granularity: Time granularity as a timeframe suffix (e.g., \"M1\", \"H1\").\n        count: Number of bars to fetch.\n        index_keys: Optional index keys for the DataFrame.\n\n    Returns:\n        pd.DataFrame: OHLC data with time index.\n\n    Raises:\n        Mt5TradingError: If the granularity is not supported by MetaTrader5.\n    \"\"\"\n    try:\n        timeframe = getattr(self.mt5, f\"TIMEFRAME_{granularity.upper()}\")\n    except AttributeError as e:\n        error_message = (\n            f\"MetaTrader5 does not support the given granularity: {granularity}\"\n        )\n        raise Mt5TradingError(error_message) from e\n    else:\n        result = self.copy_rates_from_pos_as_df(\n            symbol=symbol,\n            timeframe=timeframe,\n            start_pos=0,\n            count=count,\n            index_keys=index_keys,\n        )\n        self.logger.info(\n            \"Fetched latest %s rates for %s: %d rows\",\n            granularity,\n            symbol,\n            result.shape[0],\n        )\n        return result\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.fetch_latest_ticks_as_df","title":"fetch_latest_ticks_as_df","text":"<pre><code>fetch_latest_ticks_as_df(\n    symbol: str,\n    seconds: int = 300,\n    index_keys: str | None = \"time_msc\",\n) -&gt; DataFrame\n</code></pre> <p>Fetch tick data as a DataFrame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol to fetch tick data for.</p> required <code>seconds</code> <code>int</code> <p>Time range in seconds to fetch ticks around the last tick time.</p> <code>300</code> <code>index_keys</code> <code>str | None</code> <p>Optional index keys for the DataFrame.</p> <code>'time_msc'</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>pd.DataFrame: Tick data with time index.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def fetch_latest_ticks_as_df(\n    self,\n    symbol: str,\n    seconds: int = 300,\n    index_keys: str | None = \"time_msc\",\n) -&gt; pd.DataFrame:\n    \"\"\"Fetch tick data as a DataFrame.\n\n    Args:\n        symbol: Symbol to fetch tick data for.\n        seconds: Time range in seconds to fetch ticks around the last tick time.\n        index_keys: Optional index keys for the DataFrame.\n\n    Returns:\n        pd.DataFrame: Tick data with time index.\n    \"\"\"\n    last_tick_time = self.symbol_info_tick_as_dict(symbol=symbol)[\"time\"]\n    result = self.copy_ticks_range_as_df(\n        symbol=symbol,\n        date_from=(last_tick_time - timedelta(seconds=seconds)),\n        date_to=(last_tick_time + timedelta(seconds=seconds)),\n        flags=self.mt5.COPY_TICKS_ALL,\n        index_keys=index_keys,\n    )\n    self.logger.info(\n        \"Fetched latest ticks for %s: %d rows\",\n        symbol,\n        result.shape[0],\n    )\n    return result\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.fetch_positions_with_metrics_as_df","title":"fetch_positions_with_metrics_as_df","text":"<pre><code>fetch_positions_with_metrics_as_df(\n    symbol: str,\n) -&gt; DataFrame\n</code></pre> <p>Fetch open positions as a DataFrame with additional metrics.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol to fetch positions for.</p> required <p>Returns:</p> Type Description <code>DataFrame</code> <p>pd.DataFrame: DataFrame containing open positions with additional metrics.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def fetch_positions_with_metrics_as_df(\n    self,\n    symbol: str,\n) -&gt; pd.DataFrame:\n    \"\"\"Fetch open positions as a DataFrame with additional metrics.\n\n    Args:\n        symbol: Symbol to fetch positions for.\n\n    Returns:\n        pd.DataFrame: DataFrame containing open positions with additional metrics.\n    \"\"\"\n    positions_df = self.positions_get_as_df(symbol=symbol)\n    if positions_df.empty:\n        result = positions_df\n    else:\n        symbol_info_tick = self.symbol_info_tick_as_dict(symbol=symbol)\n        ask_margin = self.order_calc_margin(\n            action=self.mt5.ORDER_TYPE_BUY,\n            symbol=symbol,\n            volume=1,\n            price=symbol_info_tick[\"ask\"],\n        )\n        bid_margin = self.order_calc_margin(\n            action=self.mt5.ORDER_TYPE_SELL,\n            symbol=symbol,\n            volume=1,\n            price=symbol_info_tick[\"bid\"],\n        )\n        result = (\n            positions_df.assign(\n                elapsed_seconds=lambda d: (\n                    symbol_info_tick[\"time\"] - d[\"time\"]\n                ).dt.total_seconds(),\n                underlier_increase_ratio=lambda d: (\n                    d[\"price_current\"] / d[\"price_open\"] - 1\n                ),\n                buy=lambda d: (d[\"type\"] == self.mt5.POSITION_TYPE_BUY),\n                sell=lambda d: (d[\"type\"] == self.mt5.POSITION_TYPE_SELL),\n            )\n            .assign(\n                buy_i=lambda d: d[\"buy\"].astype(int),\n                sell_i=lambda d: d[\"sell\"].astype(int),\n            )\n            .assign(\n                sign=lambda d: (d[\"buy_i\"] - d[\"sell_i\"]),\n                margin=lambda d: (\n                    (d[\"buy_i\"] * ask_margin + d[\"sell_i\"] * bid_margin)\n                    * d[\"volume\"]\n                ),\n            )\n            .assign(\n                signed_volume=lambda d: (d[\"volume\"] * d[\"sign\"]),\n                signed_margin=lambda d: (d[\"margin\"] * d[\"sign\"]),\n                underlier_profit_ratio=lambda d: (\n                    d[\"underlier_increase_ratio\"] * d[\"sign\"]\n                ),\n            )\n            .drop(columns=[\"buy_i\", \"sell_i\", \"sign\", \"underlier_increase_ratio\"])\n        )\n    self.logger.info(\n        \"Fetched positions with metrics for %s: %d rows\",\n        symbol,\n        result.shape[0],\n    )\n    return result\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.place_market_order","title":"place_market_order","text":"<pre><code>place_market_order(\n    symbol: str,\n    volume: float,\n    order_side: Literal[\"BUY\", \"SELL\"],\n    order_filling_mode: Literal[\n        \"IOC\", \"FOK\", \"RETURN\"\n    ] = \"IOC\",\n    order_time_mode: Literal[\n        \"GTC\", \"DAY\", \"SPECIFIED\", \"SPECIFIED_DAY\"\n    ] = \"GTC\",\n    raise_on_error: bool = False,\n    dry_run: bool = False,\n    **kwargs: Any,\n) -&gt; dict[str, Any]\n</code></pre> <p>Send or check an order request to place a market order.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol for the order.</p> required <code>volume</code> <code>float</code> <p>Volume of the order.</p> required <code>order_side</code> <code>Literal['BUY', 'SELL']</code> <p>Side of the order, either \"BUY\" or \"SELL\".</p> required <code>order_filling_mode</code> <code>Literal['IOC', 'FOK', 'RETURN']</code> <p>Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\".</p> <code>'IOC'</code> <code>order_time_mode</code> <code>Literal['GTC', 'DAY', 'SPECIFIED', 'SPECIFIED_DAY']</code> <p>Order time mode, either \"GTC\", \"DAY\", \"SPECIFIED\", or \"SPECIFIED_DAY\".</p> <code>'GTC'</code> <code>raise_on_error</code> <code>bool</code> <p>If True, raise an error on operation failure.</p> <code>False</code> <code>dry_run</code> <code>bool</code> <p>If True, only check the order without sending it.</p> <code>False</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments for request parameters.</p> <code>{}</code> <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dictionary with operation result.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def place_market_order(\n    self,\n    symbol: str,\n    volume: float,\n    order_side: Literal[\"BUY\", \"SELL\"],\n    order_filling_mode: Literal[\"IOC\", \"FOK\", \"RETURN\"] = \"IOC\",\n    order_time_mode: Literal[\"GTC\", \"DAY\", \"SPECIFIED\", \"SPECIFIED_DAY\"] = \"GTC\",\n    raise_on_error: bool = False,\n    dry_run: bool = False,\n    **kwargs: Any,  # noqa: ANN401\n) -&gt; dict[str, Any]:\n    \"\"\"Send or check an order request to place a market order.\n\n    Args:\n        symbol: Symbol for the order.\n        volume: Volume of the order.\n        order_side: Side of the order, either \"BUY\" or \"SELL\".\n        order_filling_mode: Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\".\n        order_time_mode: Order time mode, either \"GTC\", \"DAY\", \"SPECIFIED\",\n            or \"SPECIFIED_DAY\".\n        raise_on_error: If True, raise an error on operation failure.\n        dry_run: If True, only check the order without sending it.\n        **kwargs: Additional keyword arguments for request parameters.\n\n    Returns:\n        Dictionary with operation result.\n    \"\"\"\n    self.logger.info(\"Placing market order: %s %s %s\", order_side, volume, symbol)\n    return self._send_or_check_order(\n        request={\n            \"action\": self.mt5.TRADE_ACTION_DEAL,\n            \"symbol\": symbol,\n            \"volume\": volume,\n            \"type\": getattr(self.mt5, f\"ORDER_TYPE_{order_side.upper()}\"),\n            \"type_filling\": getattr(\n                self.mt5, f\"ORDER_FILLING_{order_filling_mode.upper()}\"\n            ),\n            \"type_time\": getattr(self.mt5, f\"ORDER_TIME_{order_time_mode.upper()}\"),\n            **kwargs,\n        },\n        raise_on_error=raise_on_error,\n        dry_run=dry_run,\n    )\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.update_sltp_for_open_positions","title":"update_sltp_for_open_positions","text":"<pre><code>update_sltp_for_open_positions(\n    symbol: str,\n    stop_loss: float | None = None,\n    take_profit: float | None = None,\n    tickets: list[int] | None = None,\n    raise_on_error: bool = False,\n    dry_run: bool = False,\n    **kwargs: Any,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Change Stop Loss and Take Profit for open positions.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol for the position.</p> required <code>stop_loss</code> <code>float | None</code> <p>New Stop Loss price. If None, it will not be changed.</p> <code>None</code> <code>take_profit</code> <code>float | None</code> <p>New Take Profit price. If None, it will not be changed.</p> <code>None</code> <code>tickets</code> <code>list[int] | None</code> <p>List of position tickets to filter positions. If None, all open positions for the symbol will be considered.</p> <code>None</code> <code>raise_on_error</code> <code>bool</code> <p>If True, raise an error on operation failure.</p> <code>False</code> <code>dry_run</code> <code>bool</code> <p>If True, only check the order without sending it.</p> <code>False</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments for request parameters.</p> <code>{}</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with operation results for each updated position.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def update_sltp_for_open_positions(\n    self,\n    symbol: str,\n    stop_loss: float | None = None,\n    take_profit: float | None = None,\n    tickets: list[int] | None = None,\n    raise_on_error: bool = False,\n    dry_run: bool = False,\n    **kwargs: Any,  # noqa: ANN401\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Change Stop Loss and Take Profit for open positions.\n\n    Args:\n        symbol: Symbol for the position.\n        stop_loss: New Stop Loss price. If None, it will not be changed.\n        take_profit: New Take Profit price. If None, it will not be changed.\n        tickets: List of position tickets to filter positions. If None, all open\n            positions for the symbol will be considered.\n        raise_on_error: If True, raise an error on operation failure.\n        dry_run: If True, only check the order without sending it.\n        **kwargs: Additional keyword arguments for request parameters.\n\n    Returns:\n        List of dictionaries with operation results for each updated position.\n    \"\"\"\n    positions_df = self.positions_get_as_df(symbol=symbol)\n    if positions_df.empty:\n        self.logger.warning(\"No open positions found for symbol: %s\", symbol)\n        return []\n    elif tickets:\n        filtered_positions_df = positions_df.pipe(\n            lambda d: d[d[\"ticket\"].isin(tickets)]\n        )\n    else:\n        filtered_positions_df = positions_df\n    if filtered_positions_df.empty:\n        self.logger.warning(\n            \"No open positions found for symbol: %s with specified tickets: %s\",\n            symbol,\n            tickets,\n        )\n        return []\n    else:\n        symbol_info = self.symbol_info_as_dict(symbol=symbol)\n        sl = round(stop_loss, symbol_info[\"digits\"]) if stop_loss else None\n        tp = round(take_profit, symbol_info[\"digits\"]) if take_profit else None\n        order_requests = [\n            {\n                \"action\": self.mt5.TRADE_ACTION_SLTP,\n                \"symbol\": p[\"symbol\"],\n                \"position\": p[\"ticket\"],\n                \"sl\": (sl or p[\"sl\"]),\n                \"tp\": (tp or p[\"tp\"]),\n                **kwargs,\n            }\n            for _, p in filtered_positions_df.iterrows()\n            if sl != p[\"sl\"] or tp != p[\"tp\"]\n        ]\n        if order_requests:\n            self.logger.info(\n                \"Updating SL/TP for %d positions for %s: %s/%s\",\n                len(order_requests),\n                symbol,\n                sl,\n                tp,\n            )\n            return [\n                self._send_or_check_order(\n                    request=r, raise_on_error=raise_on_error, dry_run=dry_run\n                )\n                for r in order_requests\n            ]\n        else:\n            self.logger.info(\n                \"No positions to update for symbol: %s with SL: %s and TP: %s\",\n                symbol,\n                sl,\n                tp,\n            )\n            return []\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingError","title":"Mt5TradingError","text":"<p>               Bases: <code>Mt5RuntimeError</code></p> <p>MetaTrader5 trading error.</p>"},{"location":"api/trading/#overview","title":"Overview","text":"<p>The trading module extends Mt5DataClient with advanced trading operations including position management, order execution, and dry run support for testing trading strategies without actual execution.</p>"},{"location":"api/trading/#classes","title":"Classes","text":""},{"location":"api/trading/#mt5tradingclient","title":"Mt5TradingClient","text":"<p>options: show_bases: false</p> <p>Advanced trading client class that inherits from <code>Mt5DataClient</code> and provides specialized trading functionality.</p>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient","title":"pdmt5.trading.Mt5TradingClient","text":"<p>               Bases: <code>Mt5DataClient</code></p> <p>MetaTrader5 trading client with advanced trading operations.</p> <p>This class extends Mt5DataClient to provide specialized trading functionality including position management, order analysis, and trading performance metrics.</p>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.model_config","title":"model_config  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>model_config = ConfigDict(frozen=True)\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.mt5_failed_trade_retcodes","title":"mt5_failed_trade_retcodes  <code>cached</code> <code>property</code>","text":"<pre><code>mt5_failed_trade_retcodes: set[int]\n</code></pre> <p>Set of failed trade return codes.</p> <p>Returns:</p> Type Description <code>set[int]</code> <p>Set of failed trade return codes.</p>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.mt5_successful_trade_retcodes","title":"mt5_successful_trade_retcodes  <code>cached</code> <code>property</code>","text":"<pre><code>mt5_successful_trade_retcodes: set[int]\n</code></pre> <p>Set of successful trade return codes.</p> <p>Returns:</p> Type Description <code>set[int]</code> <p>Set of successful trade return codes.</p>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.calculate_minimum_order_margin","title":"calculate_minimum_order_margin","text":"<pre><code>calculate_minimum_order_margin(\n    symbol: str, order_side: Literal[\"BUY\", \"SELL\"]\n) -&gt; dict[str, float]\n</code></pre> <p>Calculate the minimum order margins for a given symbol.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol for which to calculate the minimum order margins.</p> required <code>order_side</code> <code>Literal['BUY', 'SELL']</code> <p>Optional side of the order, either \"BUY\" or \"SELL\".</p> required <p>Returns:</p> Type Description <code>dict[str, float]</code> <p>Dictionary with minimum volume and margin for the specified order side.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def calculate_minimum_order_margin(\n    self,\n    symbol: str,\n    order_side: Literal[\"BUY\", \"SELL\"],\n) -&gt; dict[str, float]:\n    \"\"\"Calculate the minimum order margins for a given symbol.\n\n    Args:\n        symbol: Symbol for which to calculate the minimum order margins.\n        order_side: Optional side of the order, either \"BUY\" or \"SELL\".\n\n    Returns:\n        Dictionary with minimum volume and margin for the specified order side.\n    \"\"\"\n    symbol_info = self.symbol_info_as_dict(symbol=symbol)\n    symbol_info_tick = self.symbol_info_tick_as_dict(symbol=symbol)\n    margin = self.order_calc_margin(\n        action=getattr(self.mt5, f\"ORDER_TYPE_{order_side.upper()}\"),\n        symbol=symbol,\n        volume=symbol_info[\"volume_min\"],\n        price=(\n            symbol_info_tick[\"bid\"]\n            if order_side == \"SELL\"\n            else symbol_info_tick[\"ask\"]\n        ),\n    )\n    result = {\"volume\": symbol_info[\"volume_min\"], \"margin\": margin}\n    if margin:\n        self.logger.info(\n            \"Calculated minimum %s order margin for %s: %s\",\n            order_side,\n            symbol,\n            result,\n        )\n    else:\n        self.logger.warning(\n            \"Calculated minimum order margin to %s %s: %s\",\n            order_side,\n            symbol,\n            result,\n        )\n    return result\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.calculate_new_position_margin_ratio","title":"calculate_new_position_margin_ratio","text":"<pre><code>calculate_new_position_margin_ratio(\n    symbol: str,\n    new_position_side: Literal[\"BUY\", \"SELL\"] | None = None,\n    new_position_volume: float = 0,\n) -&gt; float\n</code></pre> <p>Calculate the margin ratio for a new position.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol for which to calculate the margin ratio.</p> required <code>new_position_side</code> <code>Literal['BUY', 'SELL'] | None</code> <p>Side of the new position, either \"BUY\" or \"SELL\".</p> <code>None</code> <code>new_position_volume</code> <code>float</code> <p>Volume of the new position.</p> <code>0</code> <p>Returns:</p> Name Type Description <code>float</code> <code>float</code> <p>Margin ratio for the new position as a fraction of account equity.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def calculate_new_position_margin_ratio(\n    self,\n    symbol: str,\n    new_position_side: Literal[\"BUY\", \"SELL\"] | None = None,\n    new_position_volume: float = 0,\n) -&gt; float:\n    \"\"\"Calculate the margin ratio for a new position.\n\n    Args:\n        symbol: Symbol for which to calculate the margin ratio.\n        new_position_side: Side of the new position, either \"BUY\" or \"SELL\".\n        new_position_volume: Volume of the new position.\n\n    Returns:\n        float: Margin ratio for the new position as a fraction of account equity.\n    \"\"\"\n    account_info = self.account_info_as_dict()\n    if not account_info[\"equity\"]:\n        result = 0.0\n    else:\n        positions_df = self.fetch_positions_with_metrics_as_df(symbol=symbol)\n        current_signed_margin = (\n            positions_df[\"signed_margin\"].sum() if positions_df.size else 0\n        )\n        symbol_info_tick = self.symbol_info_tick_as_dict(symbol=symbol)\n        if not (new_position_side and new_position_volume):\n            new_signed_margin = 0\n        elif new_position_side.upper() == \"BUY\":\n            new_signed_margin = self.order_calc_margin(\n                action=self.mt5.ORDER_TYPE_BUY,\n                symbol=symbol,\n                volume=new_position_volume,\n                price=symbol_info_tick[\"ask\"],\n            )\n        elif new_position_side.upper() == \"SELL\":\n            new_signed_margin = -self.order_calc_margin(\n                action=self.mt5.ORDER_TYPE_SELL,\n                symbol=symbol,\n                volume=new_position_volume,\n                price=symbol_info_tick[\"bid\"],\n            )\n        else:\n            new_signed_margin = 0\n        result = abs(\n            (new_signed_margin + current_signed_margin) / account_info[\"equity\"]\n        )\n    self.logger.info(\n        \"Calculated new position margin ratio for %s: %s\",\n        symbol,\n        result,\n    )\n    return result\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.calculate_spread_ratio","title":"calculate_spread_ratio","text":"<pre><code>calculate_spread_ratio(symbol: str) -&gt; float\n</code></pre> <p>Calculate the spread ratio for a given symbol.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol for which to calculate the spread ratio.</p> required <p>Returns:</p> Type Description <code>float</code> <p>Spread ratio as a float.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def calculate_spread_ratio(\n    self,\n    symbol: str,\n) -&gt; float:\n    \"\"\"Calculate the spread ratio for a given symbol.\n\n    Args:\n        symbol: Symbol for which to calculate the spread ratio.\n\n    Returns:\n        Spread ratio as a float.\n    \"\"\"\n    symbol_info_tick = self.symbol_info_tick_as_dict(symbol=symbol)\n    result = (\n        (symbol_info_tick[\"ask\"] - symbol_info_tick[\"bid\"])\n        / (symbol_info_tick[\"ask\"] + symbol_info_tick[\"bid\"])\n        * 2\n    )\n    self.logger.info(\"Calculated spread ratio for %s: %s\", symbol, result)\n    return result\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.calculate_volume_by_margin","title":"calculate_volume_by_margin","text":"<pre><code>calculate_volume_by_margin(\n    symbol: str,\n    margin: float,\n    order_side: Literal[\"BUY\", \"SELL\"],\n) -&gt; float\n</code></pre> <p>Calculate volume based on margin for a given symbol and order side.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol for which to calculate the volume.</p> required <code>margin</code> <code>float</code> <p>Margin amount to use for the calculation.</p> required <code>order_side</code> <code>Literal['BUY', 'SELL']</code> <p>Side of the order, either \"BUY\" or \"SELL\".</p> required <p>Returns:</p> Type Description <code>float</code> <p>Calculated volume as a float.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def calculate_volume_by_margin(\n    self,\n    symbol: str,\n    margin: float,\n    order_side: Literal[\"BUY\", \"SELL\"],\n) -&gt; float:\n    \"\"\"Calculate volume based on margin for a given symbol and order side.\n\n    Args:\n        symbol: Symbol for which to calculate the volume.\n        margin: Margin amount to use for the calculation.\n        order_side: Side of the order, either \"BUY\" or \"SELL\".\n\n    Returns:\n        Calculated volume as a float.\n    \"\"\"\n    min_order_margin_dict = self.calculate_minimum_order_margin(\n        symbol=symbol,\n        order_side=order_side,\n    )\n    if min_order_margin_dict[\"margin\"]:\n        result = (\n            floor(margin / min_order_margin_dict[\"margin\"])\n            * min_order_margin_dict[\"volume\"]\n        )\n    else:\n        result = 0.0\n    self.logger.info(\n        \"Calculated volume by margin to %s %s: %s\",\n        order_side,\n        symbol,\n        result,\n    )\n    return result\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.close_open_positions","title":"close_open_positions","text":"<pre><code>close_open_positions(\n    symbols: str\n    | list[str]\n    | tuple[str, ...]\n    | None = None,\n    order_filling_mode: Literal[\n        \"IOC\", \"FOK\", \"RETURN\"\n    ] = \"IOC\",\n    dry_run: bool = False,\n    **kwargs: Any,\n) -&gt; dict[str, list[dict[str, Any]]]\n</code></pre> <p>Close all open positions for specified symbols.</p> <p>Parameters:</p> Name Type Description Default <code>symbols</code> <code>str | list[str] | tuple[str, ...] | None</code> <p>Optional symbol or list of symbols to filter positions. If None, all symbols will be considered.</p> <code>None</code> <code>order_filling_mode</code> <code>Literal['IOC', 'FOK', 'RETURN']</code> <p>Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\".</p> <code>'IOC'</code> <code>dry_run</code> <code>bool</code> <p>If True, only check the order without sending it.</p> <code>False</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments for request parameters.</p> <code>{}</code> <p>Returns:</p> Type Description <code>dict[str, list[dict[str, Any]]]</code> <p>Dictionary with symbols as keys and lists of dictionaries containing operation results for each closed position as values.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def close_open_positions(\n    self,\n    symbols: str | list[str] | tuple[str, ...] | None = None,\n    order_filling_mode: Literal[\"IOC\", \"FOK\", \"RETURN\"] = \"IOC\",\n    dry_run: bool = False,\n    **kwargs: Any,  # noqa: ANN401\n) -&gt; dict[str, list[dict[str, Any]]]:\n    \"\"\"Close all open positions for specified symbols.\n\n    Args:\n        symbols: Optional symbol or list of symbols to filter positions.\n            If None, all symbols will be considered.\n        order_filling_mode: Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\".\n        dry_run: If True, only check the order without sending it.\n        **kwargs: Additional keyword arguments for request parameters.\n\n    Returns:\n        Dictionary with symbols as keys and lists of dictionaries containing\n            operation results for each closed position as values.\n    \"\"\"\n    if isinstance(symbols, str):\n        symbol_list = [symbols]\n    elif isinstance(symbols, (list, tuple)):\n        symbol_list = symbols\n    else:\n        symbol_list = self.symbols_get()\n    self.logger.info(\"Fetching and closing positions for symbols: %s\", symbol_list)\n    return {\n        s: self._fetch_and_close_position(\n            symbol=s,\n            order_filling_mode=order_filling_mode,\n            dry_run=dry_run,\n            **kwargs,\n        )\n        for s in symbol_list\n    }\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.collect_entry_deals_as_df","title":"collect_entry_deals_as_df","text":"<pre><code>collect_entry_deals_as_df(\n    symbol: str,\n    history_seconds: int = 3600,\n    index_keys: str | None = \"ticket\",\n) -&gt; DataFrame\n</code></pre> <p>Collect entry deals as a DataFrame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol to collect entry deals for.</p> required <code>history_seconds</code> <code>int</code> <p>Time range in seconds to fetch deals around the last tick.</p> <code>3600</code> <code>index_keys</code> <code>str | None</code> <p>Optional index keys for the DataFrame.</p> <code>'ticket'</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>pd.DataFrame: Entry deals with time index.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def collect_entry_deals_as_df(\n    self,\n    symbol: str,\n    history_seconds: int = 3600,\n    index_keys: str | None = \"ticket\",\n) -&gt; pd.DataFrame:\n    \"\"\"Collect entry deals as a DataFrame.\n\n    Args:\n        symbol: Symbol to collect entry deals for.\n        history_seconds: Time range in seconds to fetch deals around the last tick.\n        index_keys: Optional index keys for the DataFrame.\n\n    Returns:\n        pd.DataFrame: Entry deals with time index.\n    \"\"\"\n    last_tick_time = self.symbol_info_tick_as_dict(symbol=symbol)[\"time\"]\n    deals_df = self.history_deals_get_as_df(\n        date_from=(last_tick_time - timedelta(seconds=history_seconds)),\n        date_to=(last_tick_time + timedelta(seconds=history_seconds)),\n        symbol=symbol,\n        index_keys=index_keys,\n    )\n    if deals_df.empty:\n        result = deals_df\n    else:\n        result = deals_df.pipe(\n            lambda d: d[\n                d[\"entry\"]\n                &amp; d[\"type\"].isin({self.mt5.DEAL_TYPE_BUY, self.mt5.DEAL_TYPE_SELL})\n            ]\n        )\n    self.logger.info(\n        \"Collected entry deals for %s: %d rows\",\n        symbol,\n        result.shape[0],\n    )\n    return result\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.fetch_latest_rates_as_df","title":"fetch_latest_rates_as_df","text":"<pre><code>fetch_latest_rates_as_df(\n    symbol: str,\n    granularity: str = \"M1\",\n    count: int = 1440,\n    index_keys: str | None = \"time\",\n) -&gt; DataFrame\n</code></pre> <p>Fetch rate (OHLC) data as a DataFrame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol to fetch data for.</p> required <code>granularity</code> <code>str</code> <p>Time granularity as a timeframe suffix (e.g., \"M1\", \"H1\").</p> <code>'M1'</code> <code>count</code> <code>int</code> <p>Number of bars to fetch.</p> <code>1440</code> <code>index_keys</code> <code>str | None</code> <p>Optional index keys for the DataFrame.</p> <code>'time'</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>pd.DataFrame: OHLC data with time index.</p> <p>Raises:</p> Type Description <code>Mt5TradingError</code> <p>If the granularity is not supported by MetaTrader5.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def fetch_latest_rates_as_df(\n    self,\n    symbol: str,\n    granularity: str = \"M1\",\n    count: int = 1440,\n    index_keys: str | None = \"time\",\n) -&gt; pd.DataFrame:\n    \"\"\"Fetch rate (OHLC) data as a DataFrame.\n\n    Args:\n        symbol: Symbol to fetch data for.\n        granularity: Time granularity as a timeframe suffix (e.g., \"M1\", \"H1\").\n        count: Number of bars to fetch.\n        index_keys: Optional index keys for the DataFrame.\n\n    Returns:\n        pd.DataFrame: OHLC data with time index.\n\n    Raises:\n        Mt5TradingError: If the granularity is not supported by MetaTrader5.\n    \"\"\"\n    try:\n        timeframe = getattr(self.mt5, f\"TIMEFRAME_{granularity.upper()}\")\n    except AttributeError as e:\n        error_message = (\n            f\"MetaTrader5 does not support the given granularity: {granularity}\"\n        )\n        raise Mt5TradingError(error_message) from e\n    else:\n        result = self.copy_rates_from_pos_as_df(\n            symbol=symbol,\n            timeframe=timeframe,\n            start_pos=0,\n            count=count,\n            index_keys=index_keys,\n        )\n        self.logger.info(\n            \"Fetched latest %s rates for %s: %d rows\",\n            granularity,\n            symbol,\n            result.shape[0],\n        )\n        return result\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.fetch_latest_ticks_as_df","title":"fetch_latest_ticks_as_df","text":"<pre><code>fetch_latest_ticks_as_df(\n    symbol: str,\n    seconds: int = 300,\n    index_keys: str | None = \"time_msc\",\n) -&gt; DataFrame\n</code></pre> <p>Fetch tick data as a DataFrame.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol to fetch tick data for.</p> required <code>seconds</code> <code>int</code> <p>Time range in seconds to fetch ticks around the last tick time.</p> <code>300</code> <code>index_keys</code> <code>str | None</code> <p>Optional index keys for the DataFrame.</p> <code>'time_msc'</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>pd.DataFrame: Tick data with time index.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def fetch_latest_ticks_as_df(\n    self,\n    symbol: str,\n    seconds: int = 300,\n    index_keys: str | None = \"time_msc\",\n) -&gt; pd.DataFrame:\n    \"\"\"Fetch tick data as a DataFrame.\n\n    Args:\n        symbol: Symbol to fetch tick data for.\n        seconds: Time range in seconds to fetch ticks around the last tick time.\n        index_keys: Optional index keys for the DataFrame.\n\n    Returns:\n        pd.DataFrame: Tick data with time index.\n    \"\"\"\n    last_tick_time = self.symbol_info_tick_as_dict(symbol=symbol)[\"time\"]\n    result = self.copy_ticks_range_as_df(\n        symbol=symbol,\n        date_from=(last_tick_time - timedelta(seconds=seconds)),\n        date_to=(last_tick_time + timedelta(seconds=seconds)),\n        flags=self.mt5.COPY_TICKS_ALL,\n        index_keys=index_keys,\n    )\n    self.logger.info(\n        \"Fetched latest ticks for %s: %d rows\",\n        symbol,\n        result.shape[0],\n    )\n    return result\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.fetch_positions_with_metrics_as_df","title":"fetch_positions_with_metrics_as_df","text":"<pre><code>fetch_positions_with_metrics_as_df(\n    symbol: str,\n) -&gt; DataFrame\n</code></pre> <p>Fetch open positions as a DataFrame with additional metrics.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol to fetch positions for.</p> required <p>Returns:</p> Type Description <code>DataFrame</code> <p>pd.DataFrame: DataFrame containing open positions with additional metrics.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def fetch_positions_with_metrics_as_df(\n    self,\n    symbol: str,\n) -&gt; pd.DataFrame:\n    \"\"\"Fetch open positions as a DataFrame with additional metrics.\n\n    Args:\n        symbol: Symbol to fetch positions for.\n\n    Returns:\n        pd.DataFrame: DataFrame containing open positions with additional metrics.\n    \"\"\"\n    positions_df = self.positions_get_as_df(symbol=symbol)\n    if positions_df.empty:\n        result = positions_df\n    else:\n        symbol_info_tick = self.symbol_info_tick_as_dict(symbol=symbol)\n        ask_margin = self.order_calc_margin(\n            action=self.mt5.ORDER_TYPE_BUY,\n            symbol=symbol,\n            volume=1,\n            price=symbol_info_tick[\"ask\"],\n        )\n        bid_margin = self.order_calc_margin(\n            action=self.mt5.ORDER_TYPE_SELL,\n            symbol=symbol,\n            volume=1,\n            price=symbol_info_tick[\"bid\"],\n        )\n        result = (\n            positions_df.assign(\n                elapsed_seconds=lambda d: (\n                    symbol_info_tick[\"time\"] - d[\"time\"]\n                ).dt.total_seconds(),\n                underlier_increase_ratio=lambda d: (\n                    d[\"price_current\"] / d[\"price_open\"] - 1\n                ),\n                buy=lambda d: (d[\"type\"] == self.mt5.POSITION_TYPE_BUY),\n                sell=lambda d: (d[\"type\"] == self.mt5.POSITION_TYPE_SELL),\n            )\n            .assign(\n                buy_i=lambda d: d[\"buy\"].astype(int),\n                sell_i=lambda d: d[\"sell\"].astype(int),\n            )\n            .assign(\n                sign=lambda d: (d[\"buy_i\"] - d[\"sell_i\"]),\n                margin=lambda d: (\n                    (d[\"buy_i\"] * ask_margin + d[\"sell_i\"] * bid_margin)\n                    * d[\"volume\"]\n                ),\n            )\n            .assign(\n                signed_volume=lambda d: (d[\"volume\"] * d[\"sign\"]),\n                signed_margin=lambda d: (d[\"margin\"] * d[\"sign\"]),\n                underlier_profit_ratio=lambda d: (\n                    d[\"underlier_increase_ratio\"] * d[\"sign\"]\n                ),\n            )\n            .drop(columns=[\"buy_i\", \"sell_i\", \"sign\", \"underlier_increase_ratio\"])\n        )\n    self.logger.info(\n        \"Fetched positions with metrics for %s: %d rows\",\n        symbol,\n        result.shape[0],\n    )\n    return result\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.place_market_order","title":"place_market_order","text":"<pre><code>place_market_order(\n    symbol: str,\n    volume: float,\n    order_side: Literal[\"BUY\", \"SELL\"],\n    order_filling_mode: Literal[\n        \"IOC\", \"FOK\", \"RETURN\"\n    ] = \"IOC\",\n    order_time_mode: Literal[\n        \"GTC\", \"DAY\", \"SPECIFIED\", \"SPECIFIED_DAY\"\n    ] = \"GTC\",\n    raise_on_error: bool = False,\n    dry_run: bool = False,\n    **kwargs: Any,\n) -&gt; dict[str, Any]\n</code></pre> <p>Send or check an order request to place a market order.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol for the order.</p> required <code>volume</code> <code>float</code> <p>Volume of the order.</p> required <code>order_side</code> <code>Literal['BUY', 'SELL']</code> <p>Side of the order, either \"BUY\" or \"SELL\".</p> required <code>order_filling_mode</code> <code>Literal['IOC', 'FOK', 'RETURN']</code> <p>Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\".</p> <code>'IOC'</code> <code>order_time_mode</code> <code>Literal['GTC', 'DAY', 'SPECIFIED', 'SPECIFIED_DAY']</code> <p>Order time mode, either \"GTC\", \"DAY\", \"SPECIFIED\", or \"SPECIFIED_DAY\".</p> <code>'GTC'</code> <code>raise_on_error</code> <code>bool</code> <p>If True, raise an error on operation failure.</p> <code>False</code> <code>dry_run</code> <code>bool</code> <p>If True, only check the order without sending it.</p> <code>False</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments for request parameters.</p> <code>{}</code> <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dictionary with operation result.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def place_market_order(\n    self,\n    symbol: str,\n    volume: float,\n    order_side: Literal[\"BUY\", \"SELL\"],\n    order_filling_mode: Literal[\"IOC\", \"FOK\", \"RETURN\"] = \"IOC\",\n    order_time_mode: Literal[\"GTC\", \"DAY\", \"SPECIFIED\", \"SPECIFIED_DAY\"] = \"GTC\",\n    raise_on_error: bool = False,\n    dry_run: bool = False,\n    **kwargs: Any,  # noqa: ANN401\n) -&gt; dict[str, Any]:\n    \"\"\"Send or check an order request to place a market order.\n\n    Args:\n        symbol: Symbol for the order.\n        volume: Volume of the order.\n        order_side: Side of the order, either \"BUY\" or \"SELL\".\n        order_filling_mode: Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\".\n        order_time_mode: Order time mode, either \"GTC\", \"DAY\", \"SPECIFIED\",\n            or \"SPECIFIED_DAY\".\n        raise_on_error: If True, raise an error on operation failure.\n        dry_run: If True, only check the order without sending it.\n        **kwargs: Additional keyword arguments for request parameters.\n\n    Returns:\n        Dictionary with operation result.\n    \"\"\"\n    self.logger.info(\"Placing market order: %s %s %s\", order_side, volume, symbol)\n    return self._send_or_check_order(\n        request={\n            \"action\": self.mt5.TRADE_ACTION_DEAL,\n            \"symbol\": symbol,\n            \"volume\": volume,\n            \"type\": getattr(self.mt5, f\"ORDER_TYPE_{order_side.upper()}\"),\n            \"type_filling\": getattr(\n                self.mt5, f\"ORDER_FILLING_{order_filling_mode.upper()}\"\n            ),\n            \"type_time\": getattr(self.mt5, f\"ORDER_TIME_{order_time_mode.upper()}\"),\n            **kwargs,\n        },\n        raise_on_error=raise_on_error,\n        dry_run=dry_run,\n    )\n</code></pre>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.update_sltp_for_open_positions","title":"update_sltp_for_open_positions","text":"<pre><code>update_sltp_for_open_positions(\n    symbol: str,\n    stop_loss: float | None = None,\n    take_profit: float | None = None,\n    tickets: list[int] | None = None,\n    raise_on_error: bool = False,\n    dry_run: bool = False,\n    **kwargs: Any,\n) -&gt; list[dict[str, Any]]\n</code></pre> <p>Change Stop Loss and Take Profit for open positions.</p> <p>Parameters:</p> Name Type Description Default <code>symbol</code> <code>str</code> <p>Symbol for the position.</p> required <code>stop_loss</code> <code>float | None</code> <p>New Stop Loss price. If None, it will not be changed.</p> <code>None</code> <code>take_profit</code> <code>float | None</code> <p>New Take Profit price. If None, it will not be changed.</p> <code>None</code> <code>tickets</code> <code>list[int] | None</code> <p>List of position tickets to filter positions. If None, all open positions for the symbol will be considered.</p> <code>None</code> <code>raise_on_error</code> <code>bool</code> <p>If True, raise an error on operation failure.</p> <code>False</code> <code>dry_run</code> <code>bool</code> <p>If True, only check the order without sending it.</p> <code>False</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments for request parameters.</p> <code>{}</code> <p>Returns:</p> Type Description <code>list[dict[str, Any]]</code> <p>List of dictionaries with operation results for each updated position.</p> Source code in <code>pdmt5/trading.py</code> <pre><code>def update_sltp_for_open_positions(\n    self,\n    symbol: str,\n    stop_loss: float | None = None,\n    take_profit: float | None = None,\n    tickets: list[int] | None = None,\n    raise_on_error: bool = False,\n    dry_run: bool = False,\n    **kwargs: Any,  # noqa: ANN401\n) -&gt; list[dict[str, Any]]:\n    \"\"\"Change Stop Loss and Take Profit for open positions.\n\n    Args:\n        symbol: Symbol for the position.\n        stop_loss: New Stop Loss price. If None, it will not be changed.\n        take_profit: New Take Profit price. If None, it will not be changed.\n        tickets: List of position tickets to filter positions. If None, all open\n            positions for the symbol will be considered.\n        raise_on_error: If True, raise an error on operation failure.\n        dry_run: If True, only check the order without sending it.\n        **kwargs: Additional keyword arguments for request parameters.\n\n    Returns:\n        List of dictionaries with operation results for each updated position.\n    \"\"\"\n    positions_df = self.positions_get_as_df(symbol=symbol)\n    if positions_df.empty:\n        self.logger.warning(\"No open positions found for symbol: %s\", symbol)\n        return []\n    elif tickets:\n        filtered_positions_df = positions_df.pipe(\n            lambda d: d[d[\"ticket\"].isin(tickets)]\n        )\n    else:\n        filtered_positions_df = positions_df\n    if filtered_positions_df.empty:\n        self.logger.warning(\n            \"No open positions found for symbol: %s with specified tickets: %s\",\n            symbol,\n            tickets,\n        )\n        return []\n    else:\n        symbol_info = self.symbol_info_as_dict(symbol=symbol)\n        sl = round(stop_loss, symbol_info[\"digits\"]) if stop_loss else None\n        tp = round(take_profit, symbol_info[\"digits\"]) if take_profit else None\n        order_requests = [\n            {\n                \"action\": self.mt5.TRADE_ACTION_SLTP,\n                \"symbol\": p[\"symbol\"],\n                \"position\": p[\"ticket\"],\n                \"sl\": (sl or p[\"sl\"]),\n                \"tp\": (tp or p[\"tp\"]),\n                **kwargs,\n            }\n            for _, p in filtered_positions_df.iterrows()\n            if sl != p[\"sl\"] or tp != p[\"tp\"]\n        ]\n        if order_requests:\n            self.logger.info(\n                \"Updating SL/TP for %d positions for %s: %s/%s\",\n                len(order_requests),\n                symbol,\n                sl,\n                tp,\n            )\n            return [\n                self._send_or_check_order(\n                    request=r, raise_on_error=raise_on_error, dry_run=dry_run\n                )\n                for r in order_requests\n            ]\n        else:\n            self.logger.info(\n                \"No positions to update for symbol: %s with SL: %s and TP: %s\",\n                symbol,\n                sl,\n                tp,\n            )\n            return []\n</code></pre>"},{"location":"api/trading/#mt5tradingerror","title":"Mt5TradingError","text":"<p>options: show_bases: false</p> <p>Custom runtime exception for trading-specific errors.</p>"},{"location":"api/trading/#pdmt5.trading.Mt5TradingError","title":"pdmt5.trading.Mt5TradingError","text":"<p>               Bases: <code>Mt5RuntimeError</code></p> <p>MetaTrader5 trading error.</p>"},{"location":"api/trading/#usage-examples","title":"Usage Examples","text":""},{"location":"api/trading/#basic-trading-operations","title":"Basic Trading Operations","text":"<pre><code>import MetaTrader5 as mt5\nfrom pdmt5 import Mt5TradingClient, Mt5Config\n\n# Create configuration\nconfig = Mt5Config(\n    login=123456,\n    password=\"your_password\",\n    server=\"broker_server\",\n    timeout=60000,\n    portable=False\n)\n\n# Create client with dry run mode for testing\nclient = Mt5TradingClient(config=config, dry_run=True)\n\n# Use as context manager\nwith client:\n    # Get current positions as DataFrame\n    positions_df = client.get_positions_as_df()\n    print(f\"Open positions: {len(positions_df)}\")\n\n    # Close positions for specific symbol\n    results = client.close_open_positions(\"EURUSD\")\n    print(f\"Closed positions: {results}\")\n</code></pre>"},{"location":"api/trading/#production-trading","title":"Production Trading","text":"<pre><code># Create client for live trading (dry_run=False)\nclient = Mt5TradingClient(config=config, dry_run=False)\n\nwith client:\n    # Close all positions for multiple symbols\n    results = client.close_open_positions([\"EURUSD\", \"GBPUSD\", \"USDJPY\"])\n\n    # Close all positions (all symbols)\n    all_results = client.close_open_positions()\n</code></pre>"},{"location":"api/trading/#order-filling-modes","title":"Order Filling Modes","text":"<pre><code>with Mt5TradingClient(config=config) as client:\n    # Use IOC (Immediate or Cancel) - default\n    results_ioc = client.close_open_positions(\n        symbols=\"EURUSD\",\n        order_filling_mode=\"IOC\"\n    )\n\n    # Use FOK (Fill or Kill)\n    results_fok = client.close_open_positions(\n        symbols=\"GBPUSD\",\n        order_filling_mode=\"FOK\"\n    )\n\n    # Use RETURN (Return if not filled)\n    results_return = client.close_open_positions(\n        symbols=\"USDJPY\",\n        order_filling_mode=\"RETURN\"\n    )\n</code></pre>"},{"location":"api/trading/#custom-order-parameters","title":"Custom Order Parameters","text":"<pre><code>with client:\n    # Close positions with custom parameters and order filling mode\n    results = client.close_open_positions(\n        \"EURUSD\",\n        order_filling_mode=\"IOC\",  # Specify per method call\n        comment=\"Closing all EURUSD positions\",\n        deviation=10  # Maximum price deviation\n    )\n</code></pre>"},{"location":"api/trading/#error-handling","title":"Error Handling","text":"<pre><code>from pdmt5.trading import Mt5TradingError\n\ntry:\n    with client:\n        results = client.close_open_positions(\"EURUSD\")\nexcept Mt5TradingError as e:\n    print(f\"Trading error: {e}\")\n    # Handle specific trading errors\n</code></pre>"},{"location":"api/trading/#checking-order-status","title":"Checking Order Status","text":"<pre><code>with client:\n    # Check order (note: send_or_check_order is an internal method)\n    # For trading operations, use the provided methods like close_open_positions\n\n    # Example: Check if we can close a position\n    positions = client.get_positions_as_df()\n    if not positions.empty:\n        # Close specific position\n        results = client.close_open_positions(\"EURUSD\")\n</code></pre>"},{"location":"api/trading/#position-management-features","title":"Position Management Features","text":"<p>The Mt5TradingClient provides intelligent position management:</p> <ul> <li>Automatic Position Reversal: Automatically determines the correct order type to close positions</li> <li>Batch Operations: Close multiple positions for one or more symbols</li> <li>Dry Run Support: Test trading logic without executing real trades</li> <li>Flexible Filtering: Close positions by symbol, group, or all positions</li> <li>Custom Parameters: Support for additional order parameters like comment, deviation, etc.</li> </ul>"},{"location":"api/trading/#dry-run-mode","title":"Dry Run Mode","text":"<p>Dry run mode is essential for testing trading strategies:</p> <pre><code># Test mode - validates orders without execution\ntest_client = Mt5TradingClient(config=config, dry_run=True)\n\n# Production mode - executes real orders\nprod_client = Mt5TradingClient(config=config, dry_run=False)\n</code></pre> <p>In dry run mode:</p> <ul> <li>Orders are validated using <code>order_check()</code> instead of <code>order_send()</code></li> <li>No actual trades are executed</li> <li>Full validation of margin requirements and order parameters</li> <li>Same return structure as live trading for easy testing</li> </ul>"},{"location":"api/trading/#return-values","title":"Return Values","text":"<p>The <code>close_open_positions()</code> method returns a dictionary with symbols as keys:</p> <pre><code>{\n    \"EURUSD\": [\n        {\n            \"retcode\": 10009,  # Trade done\n            \"deal\": 123456,\n            \"order\": 789012,\n            \"volume\": 1.0,\n            \"price\": 1.1000,\n            \"comment\": \"Request executed\",\n            ...\n        }\n    ],\n    \"GBPUSD\": [...]\n}\n</code></pre>"},{"location":"api/trading/#best-practices","title":"Best Practices","text":"<ol> <li>Always use dry run mode first to test your trading logic</li> <li>Handle Mt5TradingError exceptions for proper error management</li> <li>Check return codes to verify successful execution</li> <li>Use context managers for automatic connection handling</li> <li>Log trading operations for audit trails</li> <li>Validate positions exist before attempting to close them</li> <li>Consider market hours and trading session times</li> </ol>"},{"location":"api/trading/#common-return-codes","title":"Common Return Codes","text":"<ul> <li><code>TRADE_RETCODE_DONE</code> (10009): Trade operation completed successfully</li> <li><code>TRADE_RETCODE_TRADE_DISABLED</code>: Trading disabled for the account</li> <li><code>TRADE_RETCODE_MARKET_CLOSED</code>: Market is closed</li> <li><code>TRADE_RETCODE_NO_MONEY</code>: Insufficient funds</li> <li><code>TRADE_RETCODE_INVALID_VOLUME</code>: Invalid trade volume</li> </ul>"},{"location":"api/trading/#margin-calculation-methods","title":"Margin Calculation Methods","text":"<p>The trading client provides advanced margin calculation capabilities:</p>"},{"location":"api/trading/#calculate-minimum-order-margin","title":"Calculate Minimum Order Margin","text":"<pre><code>with client:\n    # Calculate minimum margin required for BUY order\n    min_margin_buy = client.calculate_minimum_order_margin(\"EURUSD\", \"BUY\")\n    print(f\"Minimum volume: {min_margin_buy['volume']}\")\n    print(f\"Minimum margin: {min_margin_buy['margin']}\")\n\n    # Calculate minimum margin required for SELL order\n    min_margin_sell = client.calculate_minimum_order_margin(\"EURUSD\", \"SELL\")\n</code></pre>"},{"location":"api/trading/#calculate-volume-by-margin","title":"Calculate Volume by Margin","text":"<pre><code>with client:\n    # Calculate maximum volume for given margin amount\n    available_margin = 1000.0  # USD\n    max_volume_buy = client.calculate_volume_by_margin(\"EURUSD\", available_margin, \"BUY\")\n    max_volume_sell = client.calculate_volume_by_margin(\"EURUSD\", available_margin, \"SELL\")\n\n    print(f\"Max BUY volume for ${available_margin}: {max_volume_buy}\")\n    print(f\"Max SELL volume for ${available_margin}: {max_volume_sell}\")\n</code></pre>"},{"location":"api/trading/#calculate-new-position-margin-ratio","title":"Calculate New Position Margin Ratio","text":"<pre><code>with client:\n    # Calculate margin ratio for potential new position\n    margin_ratio = client.calculate_new_position_margin_ratio(\n        symbol=\"EURUSD\",\n        new_position_side=\"BUY\",\n        new_position_volume=1.0\n    )\n    print(f\"New position would use {margin_ratio:.2%} of account equity\")\n\n    # Check if adding position would exceed risk limits\n    if margin_ratio &gt; 0.1:  # 10% risk limit\n        print(\"Position size too large for risk management\")\n</code></pre>"},{"location":"api/trading/#market-order-placement","title":"Market Order Placement","text":"<p>Place market orders with flexible configuration:</p> <pre><code>with client:\n    # Place a BUY market order\n    result = client.place_market_order(\n        symbol=\"EURUSD\",\n        volume=1.0,\n        order_side=\"BUY\",\n        order_filling_mode=\"IOC\",  # Immediate or Cancel\n        order_time_mode=\"GTC\",     # Good Till Cancelled\n        dry_run=False,             # Set to True for testing\n        comment=\"My buy order\"\n    )\n\n    # Place a SELL market order with FOK filling\n    result = client.place_market_order(\n        symbol=\"EURUSD\",\n        volume=0.5,\n        order_side=\"SELL\",\n        order_filling_mode=\"FOK\",  # Fill or Kill\n        dry_run=True  # Test mode\n    )\n\n    print(f\"Order result: {result}\")\n</code></pre>"},{"location":"api/trading/#stop-loss-and-take-profit-management","title":"Stop Loss and Take Profit Management","text":"<p>Update SL/TP for existing positions:</p> <pre><code>with client:\n    # Update SL/TP for all EURUSD positions\n    results = client.update_sltp_for_open_positions(\n        symbol=\"EURUSD\",\n        stop_loss=1.0950,\n        take_profit=1.1100,\n        dry_run=False\n    )\n\n    # Update only specific positions by ticket\n    results = client.update_sltp_for_open_positions(\n        symbol=\"EURUSD\",\n        stop_loss=1.0950,\n        tickets=[123456, 789012],  # Specific position tickets\n        dry_run=True\n    )\n</code></pre>"},{"location":"api/trading/#market-data-and-analysis-methods","title":"Market Data and Analysis Methods","text":""},{"location":"api/trading/#spread-analysis","title":"Spread Analysis","text":"<pre><code>with client:\n    # Calculate spread ratio for symbol\n    spread_ratio = client.calculate_spread_ratio(\"EURUSD\")\n    print(f\"EURUSD spread ratio: {spread_ratio:.6f}\")\n</code></pre>"},{"location":"api/trading/#ohlc-data-retrieval","title":"OHLC Data Retrieval","text":"<pre><code>with client:\n    # Fetch latest rate data as DataFrame\n    rates_df = client.fetch_latest_rates_as_df(\n        symbol=\"EURUSD\",\n        granularity=\"M1\",  # 1-minute bars\n        count=1440,        # Last 24 hours\n        index_keys=\"time\"\n    )\n    print(f\"Latest rates: {rates_df.tail()}\")\n</code></pre>"},{"location":"api/trading/#tick-data-analysis","title":"Tick Data Analysis","text":"<pre><code>with client:\n    # Fetch recent tick data\n    ticks_df = client.fetch_latest_ticks_as_df(\n        symbol=\"EURUSD\",\n        seconds=300,           # Last 5 minutes\n        index_keys=\"time_msc\"\n    )\n    print(f\"Tick count: {len(ticks_df)}\")\n</code></pre>"},{"location":"api/trading/#position-analytics-with-enhanced-metrics","title":"Position Analytics with Enhanced Metrics","text":"<pre><code>with client:\n    # Get positions with additional calculated metrics\n    positions_df = client.fetch_positions_with_metrics_as_df(\"EURUSD\")\n\n    if not positions_df.empty:\n        print(\"Position metrics:\")\n        print(f\"Total signed volume: {positions_df['signed_volume'].sum()}\")\n        print(f\"Total signed margin: {positions_df['signed_margin'].sum()}\")\n        print(f\"Average profit ratio: {positions_df['underlier_profit_ratio'].mean():.4f}\")\n</code></pre>"},{"location":"api/trading/#deal-history-analysis","title":"Deal History Analysis","text":"<pre><code>with client:\n    # Collect entry deals for analysis\n    deals_df = client.collect_entry_deals_as_df(\n        symbol=\"EURUSD\",\n        history_seconds=3600,  # Last hour\n        index_keys=\"ticket\"\n    )\n\n    if not deals_df.empty:\n        print(f\"Entry deals found: {len(deals_df)}\")\n        print(f\"Deal types: {deals_df['type'].value_counts()}\")\n</code></pre>"},{"location":"api/trading/#integration-with-mt5dataclient","title":"Integration with Mt5DataClient","text":"<p>Since Mt5TradingClient inherits from Mt5DataClient, all data retrieval methods are available:</p> <pre><code>with Mt5TradingClient(config=config) as client:\n    # Get current positions as DataFrame\n    positions_df = client.get_positions_as_df()\n\n    # Analyze positions\n    if not positions_df.empty:\n        # Calculate total exposure\n        total_volume = positions_df['volume'].sum()\n\n        # Close losing positions\n        losing_positions = positions_df[positions_df['profit'] &lt; 0]\n        for symbol in losing_positions['symbol'].unique():\n            client.close_open_positions(symbol)\n\n    # Risk management with margin calculations\n    for symbol in [\"EURUSD\", \"GBPUSD\", \"USDJPY\"]:\n        # Calculate current margin usage\n        current_ratio = client.calculate_new_position_margin_ratio(symbol)\n        print(f\"{symbol} current margin ratio: {current_ratio:.2%}\")\n\n        # Calculate maximum safe position size\n        safe_margin = 500.0  # USD\n        max_safe_volume = client.calculate_volume_by_margin(symbol, safe_margin, \"BUY\")\n        print(f\"{symbol} max safe volume: {max_safe_volume}\")\n</code></pre>"},{"location":"api/utils/","title":"Utilities","text":""},{"location":"api/utils/#pdmt5.utils","title":"pdmt5.utils","text":"<p>Utility functions for the pdmt5 package.</p>"},{"location":"api/utils/#pdmt5.utils.detect_and_convert_time_to_datetime","title":"detect_and_convert_time_to_datetime","text":"<pre><code>detect_and_convert_time_to_datetime(\n    skip_toggle: str | None = None,\n) -&gt; Callable[..., Any]\n</code></pre> <p>Decorator to convert time values/columns to datetime based on result type.</p> <p>Automatically detects result type and applies appropriate time conversion: - dict: converts time values in the dictionary - list: converts time values in each dictionary item - DataFrame: converts time columns</p> <p>Parameters:</p> Name Type Description Default <code>skip_toggle</code> <code>str | None</code> <p>Name of the parameter to skip conversion if set to False.</p> <code>None</code> <p>Returns:</p> Type Description <code>Callable[..., Any]</code> <p>Decorator function.</p> Source code in <code>pdmt5/utils.py</code> <pre><code>def detect_and_convert_time_to_datetime(\n    skip_toggle: str | None = None,\n) -&gt; Callable[..., Any]:\n    \"\"\"Decorator to convert time values/columns to datetime based on result type.\n\n    Automatically detects result type and applies appropriate time conversion:\n    - dict: converts time values in the dictionary\n    - list: converts time values in each dictionary item\n    - DataFrame: converts time columns\n\n    Args:\n        skip_toggle: Name of the parameter to skip conversion if set to False.\n\n    Returns:\n        Decorator function.\n    \"\"\"\n\n    def decorator(func: Callable[..., Any]) -&gt; Callable[..., Any]:\n        @wraps(func)\n        def wrapper(*args: Any, **kwargs: Any) -&gt; Any:  # noqa: ANN401\n            result = func(*args, **kwargs)\n            if skip_toggle and kwargs.get(skip_toggle):\n                return result\n            elif isinstance(result, dict):\n                return _convert_time_values_in_dict(dictionary=result)\n            elif isinstance(result, list):\n                return [\n                    (\n                        _convert_time_values_in_dict(dictionary=d)\n                        if isinstance(d, dict)\n                        else d\n                    )\n                    for d in result\n                ]\n            elif isinstance(result, pd.DataFrame):\n                return _convert_time_columns_in_df(result)\n            else:\n                return result\n\n        return wrapper\n\n    return decorator\n</code></pre>"},{"location":"api/utils/#pdmt5.utils.set_index_if_possible","title":"set_index_if_possible","text":"<pre><code>set_index_if_possible(\n    index_parameters: str | None = None,\n) -&gt; Callable[..., Any]\n</code></pre> <p>Decorator to set index on DataFrame results if not empty.</p> <p>Parameters:</p> Name Type Description Default <code>index_parameters</code> <code>str | None</code> <p>Name of the parameter to use as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>Callable[..., Any]</code> <p>Decorator function.</p> Source code in <code>pdmt5/utils.py</code> <pre><code>def set_index_if_possible(index_parameters: str | None = None) -&gt; Callable[..., Any]:\n    \"\"\"Decorator to set index on DataFrame results if not empty.\n\n    Args:\n        index_parameters: Name of the parameter to use as index if provided.\n\n    Returns:\n        Decorator function.\n    \"\"\"\n\n    def decorator(func: Callable[..., Any]) -&gt; Callable[..., Any]:\n        @wraps(func)\n        def wrapper(*args: Any, **kwargs: Any) -&gt; Any:  # noqa: ANN401\n            result = func(*args, **kwargs)\n            if not isinstance(result, pd.DataFrame):\n                error_message = (\n                    f\"Function {func.__name__} returned non-DataFrame result: \"\n                    f\"{type(result).__name__}. Expected DataFrame.\"\n                )\n                raise TypeError(error_message)\n            elif index_parameters and kwargs.get(index_parameters) and not result.empty:\n                return result.set_index(kwargs[index_parameters])\n            else:\n                return result\n\n        return wrapper\n\n    return decorator\n</code></pre>"},{"location":"api/utils/#overview","title":"Overview","text":"<p>The utils module provides internal utility functions and decorators used throughout the pdmt5 package for data transformation and DataFrame manipulation.</p>"},{"location":"api/utils/#functions","title":"Functions","text":""},{"location":"api/utils/#detect_and_convert_time_to_datetime","title":"detect_and_convert_time_to_datetime","text":"<p>options: show_bases: false</p> <p>Decorator that automatically converts time values to datetime objects based on the result type.</p>"},{"location":"api/utils/#pdmt5.utils.detect_and_convert_time_to_datetime","title":"pdmt5.utils.detect_and_convert_time_to_datetime","text":"<pre><code>detect_and_convert_time_to_datetime(\n    skip_toggle: str | None = None,\n) -&gt; Callable[..., Any]\n</code></pre> <p>Decorator to convert time values/columns to datetime based on result type.</p> <p>Automatically detects result type and applies appropriate time conversion: - dict: converts time values in the dictionary - list: converts time values in each dictionary item - DataFrame: converts time columns</p> <p>Parameters:</p> Name Type Description Default <code>skip_toggle</code> <code>str | None</code> <p>Name of the parameter to skip conversion if set to False.</p> <code>None</code> <p>Returns:</p> Type Description <code>Callable[..., Any]</code> <p>Decorator function.</p> Source code in <code>pdmt5/utils.py</code> <pre><code>def detect_and_convert_time_to_datetime(\n    skip_toggle: str | None = None,\n) -&gt; Callable[..., Any]:\n    \"\"\"Decorator to convert time values/columns to datetime based on result type.\n\n    Automatically detects result type and applies appropriate time conversion:\n    - dict: converts time values in the dictionary\n    - list: converts time values in each dictionary item\n    - DataFrame: converts time columns\n\n    Args:\n        skip_toggle: Name of the parameter to skip conversion if set to False.\n\n    Returns:\n        Decorator function.\n    \"\"\"\n\n    def decorator(func: Callable[..., Any]) -&gt; Callable[..., Any]:\n        @wraps(func)\n        def wrapper(*args: Any, **kwargs: Any) -&gt; Any:  # noqa: ANN401\n            result = func(*args, **kwargs)\n            if skip_toggle and kwargs.get(skip_toggle):\n                return result\n            elif isinstance(result, dict):\n                return _convert_time_values_in_dict(dictionary=result)\n            elif isinstance(result, list):\n                return [\n                    (\n                        _convert_time_values_in_dict(dictionary=d)\n                        if isinstance(d, dict)\n                        else d\n                    )\n                    for d in result\n                ]\n            elif isinstance(result, pd.DataFrame):\n                return _convert_time_columns_in_df(result)\n            else:\n                return result\n\n        return wrapper\n\n    return decorator\n</code></pre>"},{"location":"api/utils/#set_index_if_possible","title":"set_index_if_possible","text":"<p>options: show_bases: false</p> <p>Decorator that sets DataFrame index if specified and the DataFrame is not empty.</p>"},{"location":"api/utils/#pdmt5.utils.set_index_if_possible","title":"pdmt5.utils.set_index_if_possible","text":"<pre><code>set_index_if_possible(\n    index_parameters: str | None = None,\n) -&gt; Callable[..., Any]\n</code></pre> <p>Decorator to set index on DataFrame results if not empty.</p> <p>Parameters:</p> Name Type Description Default <code>index_parameters</code> <code>str | None</code> <p>Name of the parameter to use as index if provided.</p> <code>None</code> <p>Returns:</p> Type Description <code>Callable[..., Any]</code> <p>Decorator function.</p> Source code in <code>pdmt5/utils.py</code> <pre><code>def set_index_if_possible(index_parameters: str | None = None) -&gt; Callable[..., Any]:\n    \"\"\"Decorator to set index on DataFrame results if not empty.\n\n    Args:\n        index_parameters: Name of the parameter to use as index if provided.\n\n    Returns:\n        Decorator function.\n    \"\"\"\n\n    def decorator(func: Callable[..., Any]) -&gt; Callable[..., Any]:\n        @wraps(func)\n        def wrapper(*args: Any, **kwargs: Any) -&gt; Any:  # noqa: ANN401\n            result = func(*args, **kwargs)\n            if not isinstance(result, pd.DataFrame):\n                error_message = (\n                    f\"Function {func.__name__} returned non-DataFrame result: \"\n                    f\"{type(result).__name__}. Expected DataFrame.\"\n                )\n                raise TypeError(error_message)\n            elif index_parameters and kwargs.get(index_parameters) and not result.empty:\n                return result.set_index(kwargs[index_parameters])\n            else:\n                return result\n\n        return wrapper\n\n    return decorator\n</code></pre>"},{"location":"api/utils/#internal-functions","title":"Internal Functions","text":"<p>These functions are used internally by the decorators:</p>"},{"location":"api/utils/#_convert_time_values_in_dict","title":"_convert_time_values_in_dict","text":"<p>Converts Unix timestamp values in dictionaries to pandas datetime objects. Handles both seconds and milliseconds based on field naming conventions.</p>"},{"location":"api/utils/#_convert_time_columns_in_df","title":"_convert_time_columns_in_df","text":"<p>Converts time columns in pandas DataFrames to datetime format. Automatically detects time columns by name patterns.</p>"},{"location":"api/utils/#usage","title":"Usage","text":"<p>These utilities are primarily used internally by Mt5DataClient methods through decorators:</p> <pre><code># Example of how decorators are applied internally\n@detect_and_convert_time_to_datetime(skip_toggle=\"convert_time\")\n@set_index_if_possible(index_parameters=\"index_keys\")\ndef some_method(self, convert_time: bool = True, index_keys: str | None = None):\n    # Method implementation\n    pass\n</code></pre>"},{"location":"api/utils/#time-conversion-rules","title":"Time Conversion Rules","text":"<p>The time conversion follows these rules:</p> <ol> <li>Millisecond Timestamps: Fields ending with <code>_msc</code> are converted using <code>pd.to_datetime(value, unit=\"ms\")</code></li> <li>Second Timestamps: Fields named <code>time</code> or starting with <code>time_</code> are converted using <code>pd.to_datetime(value, unit=\"s\")</code></li> <li>Automatic Detection: Conversion happens automatically unless explicitly disabled</li> </ol>"},{"location":"api/utils/#dataframe-index-setting","title":"DataFrame Index Setting","text":"<p>The index setting decorator:</p> <ol> <li>Only sets index if DataFrame is not empty</li> <li>Uses the specified column name as index</li> <li>Validates that the result is a DataFrame</li> <li>Preserves original DataFrame if no index column specified</li> </ol>"},{"location":"api/utils/#integration-with-mt5dataclient","title":"Integration with Mt5DataClient","text":"<p>These utilities enable Mt5DataClient to provide user-friendly data:</p> <pre><code># Time values are automatically converted\ndf = client.get_symbols_as_df(convert_time=True)\n# Returns DataFrame with datetime objects instead of Unix timestamps\n\n# DataFrames can have custom indexes\ndf = client.copy_rates_from_as_df(\n    symbol=\"EURUSD\",\n    timeframe=mt5.TIMEFRAME_H1,\n    date_from=datetime.now(),\n    count=100,\n    index_keys=\"time\"  # Sets 'time' column as index\n)\n</code></pre>"},{"location":"api/utils/#design-philosophy","title":"Design Philosophy","text":"<p>The utilities module follows these principles:</p> <ol> <li>Automatic Conversion: Time values should be human-readable by default</li> <li>Opt-out Capability: Users can disable conversion when needed</li> <li>Type Safety: Decorators validate input and output types</li> <li>Non-intrusive: Original data is never modified, only copies</li> <li>Consistent Behavior: Same conversion rules across all methods</li> </ol>"},{"location":"api/utils/#implementation-details","title":"Implementation Details","text":""},{"location":"api/utils/#time-detection-patterns","title":"Time Detection Patterns","text":"<ul> <li><code>time</code>: Base time field (seconds)</li> <li><code>time_*</code>: Time-prefixed fields (seconds)</li> <li><code>time_*_msc</code>: Millisecond timestamp fields</li> </ul>"},{"location":"api/utils/#error-handling","title":"Error Handling","text":"<ul> <li>Invalid DataFrame types raise <code>TypeError</code></li> <li>Empty DataFrames are returned as-is</li> <li>Non-time fields are ignored during conversion</li> </ul>"},{"location":"api/utils/#performance-considerations","title":"Performance Considerations","text":"<ul> <li>Conversions only happen when requested</li> <li>Dictionary operations use shallow copies</li> <li>DataFrame operations use efficient pandas methods</li> <li>Decorators add minimal overhead</li> </ul>"}]}