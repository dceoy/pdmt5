{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"pdmt5 API Documentation \u00b6 Pandas-based data handler for MetaTrader 5 trading platform. Overview \u00b6 pdmt5 is a Python library that provides a pandas-based interface for handling MetaTrader 5 trading data. It simplifies data manipulation and analysis tasks for financial trading applications. Features \u00b6 MetaTrader 5 Integration : Direct connection to MetaTrader 5 platform (Windows only) Pandas-based : Leverages pandas for efficient data manipulation Type Safety : Built with pydantic for robust data validation Financial Focus : Designed specifically for trading and financial data analysis Installation \u00b6 pip install pdmt5 Quick Start \u00b6 from pdmt5 import Mt5Client , Mt5Config , Mt5DataClient , Mt5TradingClient import MetaTrader5 as mt5 from datetime import datetime # Configure connection config = Mt5Config ( login = 12345678 , password = \"your_password\" , server = \"YourBroker-Server\" , timeout = 60000 , portable = False ) # Low-level API access with context manager with Mt5Client () as client : client . initialize () client . login ( config . login , config . password , config . server ) account = client . account_info () rates = client . copy_rates_from ( \"EURUSD\" , mt5 . TIMEFRAME_H1 , datetime . now (), 100 ) # Pandas-friendly interface with automatic initialization with Mt5DataClient ( config = config ) as client : # Get symbol information as DataFrame symbols_df = client . get_symbols_as_df () # Get OHLCV data as DataFrame rates_df = client . copy_rates_from_as_df ( \"EURUSD\" , mt5 . TIMEFRAME_H1 , datetime . now (), 100 ) # Get account info as DataFrame account_df = client . get_account_info_as_df () # Trading operations with dry run support with Mt5TradingClient ( config = config , dry_run = True ) as client : # Check open positions as DataFrame positions_df = client . get_positions_as_df () # Close positions for specific symbol (dry run) results = client . close_open_positions ( \"EURUSD\" ) Requirements \u00b6 Python 3.11+ Windows OS (MetaTrader 5 requirement) MetaTrader 5 platform API Reference \u00b6 Browse the API documentation to learn about available modules and functions: Mt5Client - Base client for low-level MT5 API access with context manager support Mt5DataClient & Mt5Config - Pandas-friendly data client with DataFrame conversions Mt5TradingClient - Advanced trading operations with position management Utility Functions - Helper decorators and functions for data processing Development \u00b6 This project follows strict code quality standards: Type hints required (strict mode) Comprehensive linting with Ruff Test coverage tracking Google-style docstrings License \u00b6 MIT License - see LICENSE file for details.","title":"Home"},{"location":"#pdmt5-api-documentation","text":"Pandas-based data handler for MetaTrader 5 trading platform.","title":"pdmt5 API Documentation"},{"location":"#overview","text":"pdmt5 is a Python library that provides a pandas-based interface for handling MetaTrader 5 trading data. It simplifies data manipulation and analysis tasks for financial trading applications.","title":"Overview"},{"location":"#features","text":"MetaTrader 5 Integration : Direct connection to MetaTrader 5 platform (Windows only) Pandas-based : Leverages pandas for efficient data manipulation Type Safety : Built with pydantic for robust data validation Financial Focus : Designed specifically for trading and financial data analysis","title":"Features"},{"location":"#installation","text":"pip install pdmt5","title":"Installation"},{"location":"#quick-start","text":"from pdmt5 import Mt5Client , Mt5Config , Mt5DataClient , Mt5TradingClient import MetaTrader5 as mt5 from datetime import datetime # Configure connection config = Mt5Config ( login = 12345678 , password = \"your_password\" , server = \"YourBroker-Server\" , timeout = 60000 , portable = False ) # Low-level API access with context manager with Mt5Client () as client : client . initialize () client . login ( config . login , config . password , config . server ) account = client . account_info () rates = client . copy_rates_from ( \"EURUSD\" , mt5 . TIMEFRAME_H1 , datetime . now (), 100 ) # Pandas-friendly interface with automatic initialization with Mt5DataClient ( config = config ) as client : # Get symbol information as DataFrame symbols_df = client . get_symbols_as_df () # Get OHLCV data as DataFrame rates_df = client . copy_rates_from_as_df ( \"EURUSD\" , mt5 . TIMEFRAME_H1 , datetime . now (), 100 ) # Get account info as DataFrame account_df = client . get_account_info_as_df () # Trading operations with dry run support with Mt5TradingClient ( config = config , dry_run = True ) as client : # Check open positions as DataFrame positions_df = client . get_positions_as_df () # Close positions for specific symbol (dry run) results = client . close_open_positions ( \"EURUSD\" )","title":"Quick Start"},{"location":"#requirements","text":"Python 3.11+ Windows OS (MetaTrader 5 requirement) MetaTrader 5 platform","title":"Requirements"},{"location":"#api-reference","text":"Browse the API documentation to learn about available modules and functions: Mt5Client - Base client for low-level MT5 API access with context manager support Mt5DataClient & Mt5Config - Pandas-friendly data client with DataFrame conversions Mt5TradingClient - Advanced trading operations with position management Utility Functions - Helper decorators and functions for data processing","title":"API Reference"},{"location":"#development","text":"This project follows strict code quality standards: Type hints required (strict mode) Comprehensive linting with Ruff Test coverage tracking Google-style docstrings","title":"Development"},{"location":"#license","text":"MIT License - see LICENSE file for details.","title":"License"},{"location":"api/","text":"API Reference \u00b6 This section contains the complete API documentation for pdmt5. Modules \u00b6 The pdmt5 package consists of the following modules: Mt5Client \u00b6 Base client class for MetaTrader 5 operations with connection management, low-level API access, and error handling ( Mt5RuntimeError ). Mt5DataClient & Mt5Config \u00b6 Core data client functionality and configuration, providing pandas-friendly interface to MetaTrader 5. Mt5TradingClient \u00b6 Advanced trading operations including position management, order analysis, and trading performance metrics with dry run support. REST API \u00b6 FastAPI-based REST API that exposes read-only MT5 data over HTTP with JSON and Parquet support. Deployment \u00b6 Windows service deployment guide for hosting the REST API alongside MetaTrader 5. Architecture Overview \u00b6 The package follows a layered architecture: Base Layer ( mt5.py ): Provides the base Mt5Client class with low-level MT5 API access and Mt5RuntimeError exception Data Layer ( dataframe.py ): Extends Mt5Client with configuration ( Mt5Config ) and pandas-friendly Mt5DataClient class Trading Layer ( trading.py ): Extends Mt5DataClient with advanced trading operations and Mt5TradingError exception Utilities ( utils.py ): Helper functions for time conversion and DataFrame manipulation Usage Guidelines \u00b6 All modules follow these conventions: Type Safety : All functions include comprehensive type hints Error Handling : Centralized through Mt5RuntimeError with meaningful error messages Documentation : Google-style docstrings with examples Validation : Pydantic models for data validation and configuration pandas Integration : All data returns as DataFrames with proper datetime indexing Quick Start \u00b6 from pdmt5 import Mt5Client , Mt5Config , Mt5DataClient , Mt5TradingClient import MetaTrader5 as mt5 from datetime import datetime # Low-level API access with Mt5Client with Mt5Client ( mt5 = mt5 ) as client : client . initialize () account = client . account_info () rates = client . copy_rates_from ( \"EURUSD\" , mt5 . TIMEFRAME_H1 , datetime . now (), 100 ) # Pandas-friendly interface with Mt5DataClient and configuration config = Mt5Config ( login = 12345 , password = \"pass\" , server = \"MetaQuotes-Demo\" ) with Mt5DataClient ( mt5 = mt5 , config = config ) as client : symbols_df = client . symbols_get_as_df () rates_df = client . copy_rates_from_as_df ( \"EURUSD\" , mt5 . TIMEFRAME_H1 , datetime . now (), 100 ) # Advanced trading operations with Mt5TradingClient with Mt5TradingClient ( mt5 = mt5 , config = config , dry_run = True ) as client : # Close all positions for a symbol results = client . close_open_positions ( \"EURUSD\" ) Examples \u00b6 See individual module pages for detailed usage examples and code samples.","title":"Overview"},{"location":"api/#api-reference","text":"This section contains the complete API documentation for pdmt5.","title":"API Reference"},{"location":"api/#modules","text":"The pdmt5 package consists of the following modules:","title":"Modules"},{"location":"api/#mt5client","text":"Base client class for MetaTrader 5 operations with connection management, low-level API access, and error handling ( Mt5RuntimeError ).","title":"Mt5Client"},{"location":"api/#mt5dataclient-mt5config","text":"Core data client functionality and configuration, providing pandas-friendly interface to MetaTrader 5.","title":"Mt5DataClient &amp; Mt5Config"},{"location":"api/#mt5tradingclient","text":"Advanced trading operations including position management, order analysis, and trading performance metrics with dry run support.","title":"Mt5TradingClient"},{"location":"api/#rest-api","text":"FastAPI-based REST API that exposes read-only MT5 data over HTTP with JSON and Parquet support.","title":"REST API"},{"location":"api/#deployment","text":"Windows service deployment guide for hosting the REST API alongside MetaTrader 5.","title":"Deployment"},{"location":"api/#architecture-overview","text":"The package follows a layered architecture: Base Layer ( mt5.py ): Provides the base Mt5Client class with low-level MT5 API access and Mt5RuntimeError exception Data Layer ( dataframe.py ): Extends Mt5Client with configuration ( Mt5Config ) and pandas-friendly Mt5DataClient class Trading Layer ( trading.py ): Extends Mt5DataClient with advanced trading operations and Mt5TradingError exception Utilities ( utils.py ): Helper functions for time conversion and DataFrame manipulation","title":"Architecture Overview"},{"location":"api/#usage-guidelines","text":"All modules follow these conventions: Type Safety : All functions include comprehensive type hints Error Handling : Centralized through Mt5RuntimeError with meaningful error messages Documentation : Google-style docstrings with examples Validation : Pydantic models for data validation and configuration pandas Integration : All data returns as DataFrames with proper datetime indexing","title":"Usage Guidelines"},{"location":"api/#quick-start","text":"from pdmt5 import Mt5Client , Mt5Config , Mt5DataClient , Mt5TradingClient import MetaTrader5 as mt5 from datetime import datetime # Low-level API access with Mt5Client with Mt5Client ( mt5 = mt5 ) as client : client . initialize () account = client . account_info () rates = client . copy_rates_from ( \"EURUSD\" , mt5 . TIMEFRAME_H1 , datetime . now (), 100 ) # Pandas-friendly interface with Mt5DataClient and configuration config = Mt5Config ( login = 12345 , password = \"pass\" , server = \"MetaQuotes-Demo\" ) with Mt5DataClient ( mt5 = mt5 , config = config ) as client : symbols_df = client . symbols_get_as_df () rates_df = client . copy_rates_from_as_df ( \"EURUSD\" , mt5 . TIMEFRAME_H1 , datetime . now (), 100 ) # Advanced trading operations with Mt5TradingClient with Mt5TradingClient ( mt5 = mt5 , config = config , dry_run = True ) as client : # Close all positions for a symbol results = client . close_open_positions ( \"EURUSD\" )","title":"Quick Start"},{"location":"api/#examples","text":"See individual module pages for detailed usage examples and code samples.","title":"Examples"},{"location":"api/dataframe/","text":"DataFrame \u00b6 pdmt5.dataframe \u00b6 MetaTrader5 data client with pandas DataFrame conversion. Mt5Config \u00b6 Bases: BaseModel Configuration for MetaTrader5 connection. login class-attribute instance-attribute \u00b6 login : int | None = Field ( default = None , description = \"Trading account login\" ) model_config class-attribute instance-attribute \u00b6 model_config = ConfigDict ( frozen = True ) password class-attribute instance-attribute \u00b6 password : str | None = Field ( default = None , description = \"Trading account password\" ) path class-attribute instance-attribute \u00b6 path : str | None = Field ( default = None , description = \"Path to MetaTrader5 terminal EXE file\" , ) server class-attribute instance-attribute \u00b6 server : str | None = Field ( default = None , description = \"Trading server name\" ) timeout class-attribute instance-attribute \u00b6 timeout : int | None = Field ( default = None , description = \"Connection timeout in milliseconds\" , ) Mt5DataClient \u00b6 Bases: Mt5Client MetaTrader5 data client with pandas DataFrame and dictionary conversion. This class provides a pandas-friendly interface to MetaTrader5 functions, converting native MetaTrader5 data structures to pandas DataFrames with pydantic validation. config class-attribute instance-attribute \u00b6 config : Mt5Config = Field ( default_factory = Mt5Config , description = \"MetaTrader5 connection configuration\" , ) model_config class-attribute instance-attribute \u00b6 model_config = ConfigDict ( arbitrary_types_allowed = True ) retry_count class-attribute instance-attribute \u00b6 retry_count : int = Field ( default = 3 , ge = 0 , description = \"Number of retry attempts for connection initialization\" , ) account_info_as_df \u00b6 account_info_as_df ( index_keys : str | None = None , ) -> DataFrame Get info on the current account as a data frame. Parameters: Name Type Description Default index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with account information. Source code in pdmt5/dataframe.py 154 155 156 157 158 159 160 161 162 163 164 @set_index_if_possible ( index_parameters = \"index_keys\" ) def account_info_as_df ( self , index_keys : str | None = None ) -> pd . DataFrame : # noqa: ARG002 \"\"\"Get info on the current account as a data frame. Args: index_keys: Column name to set as index if provided. Returns: DataFrame with account information. \"\"\" return pd . DataFrame ([ self . account_info_as_dict ()]) account_info_as_dict \u00b6 account_info_as_dict () -> dict [ str , Any ] Get info on the current account as a dictionary. Returns: Type Description dict [ str , Any ] Dictionary with account information. Source code in pdmt5/dataframe.py 146 147 148 149 150 151 152 def account_info_as_dict ( self ) -> dict [ str , Any ]: \"\"\"Get info on the current account as a dictionary. Returns: Dictionary with account information. \"\"\" return self . account_info () . _asdict () copy_rates_from_as_df \u00b6 copy_rates_from_as_df ( symbol : str , timeframe : int , date_from : datetime , count : int , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get bars for a specified date range as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime Start date. required count int Number of rates to retrieve. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with OHLCV data. Source code in pdmt5/dataframe.py 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401 402 403 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_rates_from_as_df ( self , symbol : str , timeframe : int , date_from : datetime , count : int , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get bars for a specified date range as a data frame. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date. count: Number of rates to retrieve. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with OHLCV data. \"\"\" self . _validate_positive_count ( count = count ) return pd . DataFrame ( self . copy_rates_from ( symbol = symbol , timeframe = timeframe , date_from = date_from , count = count , ) ) copy_rates_from_as_dicts \u00b6 copy_rates_from_as_dicts ( symbol : str , timeframe : int , date_from : datetime , count : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get bars for a specified date range as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime Start date. required count int Number of rates to retrieve. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with OHLCV data. Source code in pdmt5/dataframe.py 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 def copy_rates_from_as_dicts ( self , symbol : str , timeframe : int , date_from : datetime , count : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get bars for a specified date range as a list of dictionaries. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date. count: Number of rates to retrieve. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with OHLCV data. \"\"\" return self . copy_rates_from_as_df ( symbol = symbol , timeframe = timeframe , date_from = date_from , count = count , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" ) copy_rates_from_pos_as_df \u00b6 copy_rates_from_pos_as_df ( symbol : str , timeframe : int , start_pos : int , count : int , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get bars from a specified position as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required start_pos int Start position. required count int Number of rates to retrieve. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with OHLCV data. Source code in pdmt5/dataframe.py 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_rates_from_pos_as_df ( self , symbol : str , timeframe : int , start_pos : int , count : int , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get bars from a specified position as a data frame. Args: symbol: Symbol name. timeframe: Timeframe constant. start_pos: Start position. count: Number of rates to retrieve. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with OHLCV data. \"\"\" self . _validate_positive_count ( count = count ) self . _validate_non_negative_position ( position = start_pos ) return pd . DataFrame ( self . copy_rates_from_pos ( symbol = symbol , timeframe = timeframe , start_pos = start_pos , count = count , ) ) copy_rates_from_pos_as_dicts \u00b6 copy_rates_from_pos_as_dicts ( symbol : str , timeframe : int , start_pos : int , count : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get bars from a specified position as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required start_pos int Start position. required count int Number of rates to retrieve. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with OHLCV data. Source code in pdmt5/dataframe.py 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 def copy_rates_from_pos_as_dicts ( self , symbol : str , timeframe : int , start_pos : int , count : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get bars from a specified position as a list of dictionaries. Args: symbol: Symbol name. timeframe: Timeframe constant. start_pos: Start position. count: Number of rates to retrieve. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with OHLCV data. \"\"\" return self . copy_rates_from_pos_as_df ( symbol = symbol , timeframe = timeframe , start_pos = start_pos , count = count , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" ) copy_rates_range_as_df \u00b6 copy_rates_range_as_df ( symbol : str , timeframe : int , date_from : datetime , date_to : datetime , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get bars for a specified date range as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime Start date. required date_to datetime End date. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with OHLCV data. Source code in pdmt5/dataframe.py 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521 522 523 524 525 526 527 528 529 530 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_rates_range_as_df ( self , symbol : str , timeframe : int , date_from : datetime , date_to : datetime , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get bars for a specified date range as a data frame. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date. date_to: End date. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with OHLCV data. \"\"\" self . _validate_date_range ( date_from = date_from , date_to = date_to ) return pd . DataFrame ( self . copy_rates_range ( symbol = symbol , timeframe = timeframe , date_from = date_from , date_to = date_to , ) ) copy_rates_range_as_dicts \u00b6 copy_rates_range_as_dicts ( symbol : str , timeframe : int , date_from : datetime , date_to : datetime , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get bars for a specified date range as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime Start date. required date_to datetime End date. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with OHLCV data. Source code in pdmt5/dataframe.py 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 def copy_rates_range_as_dicts ( self , symbol : str , timeframe : int , date_from : datetime , date_to : datetime , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get bars for a specified date range as a list of dictionaries. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date. date_to: End date. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with OHLCV data. \"\"\" return self . copy_rates_range_as_df ( symbol = symbol , timeframe = timeframe , date_from = date_from , date_to = date_to , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" ) copy_ticks_from_as_df \u00b6 copy_ticks_from_as_df ( symbol : str , date_from : datetime , count : int , flags : int , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get ticks from a specified date as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime Start date. required count int Number of ticks to retrieve. required flags int Tick flags (use constants from MetaTrader5). required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with tick data. Source code in pdmt5/dataframe.py 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 588 589 590 591 592 593 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_ticks_from_as_df ( self , symbol : str , date_from : datetime , count : int , flags : int , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get ticks from a specified date as a data frame. Args: symbol: Symbol name. date_from: Start date. count: Number of ticks to retrieve. flags: Tick flags (use constants from MetaTrader5). skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with tick data. \"\"\" self . _validate_positive_count ( count = count ) return pd . DataFrame ( self . copy_ticks_from ( symbol = symbol , date_from = date_from , count = count , flags = flags , ) ) copy_ticks_from_as_dicts \u00b6 copy_ticks_from_as_dicts ( symbol : str , date_from : datetime , count : int , flags : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get ticks from a specified date as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime Start date. required count int Number of ticks to retrieve. required flags int Tick flags (use constants from MetaTrader5). required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with tick data. Source code in pdmt5/dataframe.py 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557 558 559 def copy_ticks_from_as_dicts ( self , symbol : str , date_from : datetime , count : int , flags : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get ticks from a specified date as a list of dictionaries. Args: symbol: Symbol name. date_from: Start date. count: Number of ticks to retrieve. flags: Tick flags (use constants from MetaTrader5). skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with tick data. \"\"\" return self . copy_ticks_from_as_df ( symbol = symbol , date_from = date_from , count = count , flags = flags , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" ) # type: ignore[reportReturnType] copy_ticks_range_as_df \u00b6 copy_ticks_range_as_df ( symbol : str , date_from : datetime , date_to : datetime , flags : int , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get ticks for a specified date range as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime Start date. required date_to datetime End date. required flags int Tick flags (use constants from MetaTrader5). required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with tick data. Source code in pdmt5/dataframe.py 624 625 626 627 628 629 630 631 632 633 634 635 636 637 638 639 640 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_ticks_range_as_df ( self , symbol : str , date_from : datetime , date_to : datetime , flags : int , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get ticks for a specified date range as a data frame. Args: symbol: Symbol name. date_from: Start date. date_to: End date. flags: Tick flags (use constants from MetaTrader5). skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with tick data. \"\"\" self . _validate_date_range ( date_from = date_from , date_to = date_to ) return pd . DataFrame ( self . copy_ticks_range ( symbol = symbol , date_from = date_from , date_to = date_to , flags = flags , ) ) copy_ticks_range_as_dicts \u00b6 copy_ticks_range_as_dicts ( symbol : str , date_from : datetime , date_to : datetime , flags : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get ticks for a specified date range as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime Start date. required date_to datetime End date. required flags int Tick flags (use constants from MetaTrader5). required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with tick data. Source code in pdmt5/dataframe.py 595 596 597 598 599 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 def copy_ticks_range_as_dicts ( self , symbol : str , date_from : datetime , date_to : datetime , flags : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get ticks for a specified date range as a list of dictionaries. Args: symbol: Symbol name. date_from: Start date. date_to: End date. flags: Tick flags (use constants from MetaTrader5). skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with tick data. \"\"\" return self . copy_ticks_range_as_df ( symbol = symbol , date_from = date_from , date_to = date_to , flags = flags , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" ) # type: ignore[reportReturnType] history_deals_get_as_df \u00b6 history_deals_get_as_df ( date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get historical deals with optional filters as a data frame. Parameters: Name Type Description Default date_from datetime | None Start date (required if not using ticket/position). None date_to datetime | None End date (required if not using ticket/position). None group str | None Optional group filter. None symbol str | None Optional symbol filter. None ticket int | None Get deals by order ticket. None position int | None Get deals by position ticket. None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with historical deal information. Source code in pdmt5/dataframe.py 963 964 965 966 967 968 969 970 971 972 973 974 975 976 977 978 979 980 981 982 983 984 985 986 987 988 989 990 991 992 993 994 995 996 997 998 999 1000 1001 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def history_deals_get_as_df ( self , date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get historical deals with optional filters as a data frame. Args: date_from: Start date (required if not using ticket/position). date_to: End date (required if not using ticket/position). group: Optional group filter. symbol: Optional symbol filter. ticket: Get deals by order ticket. position: Get deals by position ticket. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with historical deal information. \"\"\" return pd . DataFrame ( self . history_deals_get_as_dicts ( date_from = date_from , date_to = date_to , group = group , symbol = symbol , ticket = ticket , position = position , skip_to_datetime = True , ) ) history_deals_get_as_dicts \u00b6 history_deals_get_as_dicts ( date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get historical deals with optional filters as a list of dictionaries. Parameters: Name Type Description Default date_from datetime | None Start date (required if not using ticket/position). None date_to datetime | None End date (required if not using ticket/position). None group str | None Optional group filter. None symbol str | None Optional symbol filter. None ticket int | None Get deals by order ticket. None position int | None Get deals by position ticket. None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with historical deal information. Source code in pdmt5/dataframe.py 921 922 923 924 925 926 927 928 929 930 931 932 933 934 935 936 937 938 939 940 941 942 943 944 945 946 947 948 949 950 951 952 953 954 955 956 957 958 959 960 961 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def history_deals_get_as_dicts ( self , date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get historical deals with optional filters as a list of dictionaries. Args: date_from: Start date (required if not using ticket/position). date_to: End date (required if not using ticket/position). group: Optional group filter. symbol: Optional symbol filter. ticket: Get deals by order ticket. position: Get deals by position ticket. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with historical deal information. \"\"\" self . _validate_history_input ( date_from = date_from , date_to = date_to , ticket = ticket , position = position , ) return [ d . _asdict () for d in self . history_deals_get ( date_from = date_from , date_to = date_to , group = ( f \"* { symbol } *\" if symbol else group ), ticket = ticket , position = position , ) ] history_orders_get_as_df \u00b6 history_orders_get_as_df ( date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get historical orders with optional filters as a data frame. Parameters: Name Type Description Default date_from datetime | None Start date (required if not using ticket/position). None date_to datetime | None End date (required if not using ticket/position). None group str | None Optional group filter. None symbol str | None Optional symbol filter. None ticket int | None Get orders by ticket. None position int | None Get orders by position. None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with historical order information. Source code in pdmt5/dataframe.py 881 882 883 884 885 886 887 888 889 890 891 892 893 894 895 896 897 898 899 900 901 902 903 904 905 906 907 908 909 910 911 912 913 914 915 916 917 918 919 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def history_orders_get_as_df ( self , date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get historical orders with optional filters as a data frame. Args: date_from: Start date (required if not using ticket/position). date_to: End date (required if not using ticket/position). group: Optional group filter. symbol: Optional symbol filter. ticket: Get orders by ticket. position: Get orders by position. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with historical order information. \"\"\" return pd . DataFrame ( self . history_orders_get_as_dicts ( date_from = date_from , date_to = date_to , group = group , symbol = symbol , ticket = ticket , position = position , skip_to_datetime = True , ) ) history_orders_get_as_dicts \u00b6 history_orders_get_as_dicts ( date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get historical orders with optional filters as a list of dictionaries. Parameters: Name Type Description Default date_from datetime | None Start date (required if not using ticket/position). None date_to datetime | None End date (required if not using ticket/position). None group str | None Optional group filter. None symbol str | None Optional symbol filter. None ticket int | None Get orders by ticket. None position int | None Get orders by position. None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with historical order information. Source code in pdmt5/dataframe.py 839 840 841 842 843 844 845 846 847 848 849 850 851 852 853 854 855 856 857 858 859 860 861 862 863 864 865 866 867 868 869 870 871 872 873 874 875 876 877 878 879 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def history_orders_get_as_dicts ( self , date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get historical orders with optional filters as a list of dictionaries. Args: date_from: Start date (required if not using ticket/position). date_to: End date (required if not using ticket/position). group: Optional group filter. symbol: Optional symbol filter. ticket: Get orders by ticket. position: Get orders by position. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with historical order information. \"\"\" self . _validate_history_input ( date_from = date_from , date_to = date_to , ticket = ticket , position = position , ) return [ o . _asdict () for o in self . history_orders_get ( date_from = date_from , date_to = date_to , group = ( f \"* { symbol } *\" if symbol else group ), ticket = ticket , position = position , ) ] initialize_and_login_mt5 \u00b6 initialize_and_login_mt5 ( path : str | None = None , login : int | None = None , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> None Initialize MetaTrader5 connection with retry logic. This method overrides the base class to add retry logic and use config values. Parameters: Name Type Description Default path str | None Path to terminal EXE file (overrides config). None login int | None Account login (overrides config). None password str | None Account password (overrides config). None server str | None Server name (overrides config). None timeout int | None Connection timeout (overrides config). None Raises: Type Description Mt5RuntimeError If initialization fails after retries. Source code in pdmt5/dataframe.py 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 def initialize_and_login_mt5 ( self , path : str | None = None , login : int | None = None , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> None : \"\"\"Initialize MetaTrader5 connection with retry logic. This method overrides the base class to add retry logic and use config values. Args: path: Path to terminal EXE file (overrides config). login: Account login (overrides config). password: Account password (overrides config). server: Server name (overrides config). timeout: Connection timeout (overrides config). Raises: Mt5RuntimeError: If initialization fails after retries. \"\"\" path = path or self . config . path login_kwargs = { \"login\" : login or self . config . login , \"password\" : password or self . config . password , \"server\" : server or self . config . server , \"timeout\" : timeout or self . config . timeout , } for i in range ( 1 + max ( 0 , self . retry_count )): if i : self . logger . warning ( \"Retrying MT5 initialization ( %d / %d )...\" , i , self . retry_count , ) time . sleep ( i ) if self . initialize ( path = path , ** login_kwargs ) and ( ( not login_kwargs [ \"login\" ]) or self . login ( ** login_kwargs ) ): return error_message = ( f \"MT5 initialize and login failed after { self . retry_count } retries:\" f \" { self . last_error () } \" ) raise Mt5RuntimeError ( error_message ) last_error_as_df \u00b6 last_error_as_df ( index_keys : str | None = None , ) -> DataFrame Get the last error information as a data frame. Parameters: Name Type Description Default index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with last error information. Source code in pdmt5/dataframe.py 134 135 136 137 138 139 140 141 142 143 144 @set_index_if_possible ( index_parameters = \"index_keys\" ) def last_error_as_df ( self , index_keys : str | None = None ) -> pd . DataFrame : # noqa: ARG002 \"\"\"Get the last error information as a data frame. Args: index_keys: Column name to set as index if provided. Returns: DataFrame with last error information. \"\"\" return pd . DataFrame ([ self . last_error_as_dict ()]) last_error_as_dict \u00b6 last_error_as_dict () -> dict [ str , Any ] Get the last error information as a dictionary. Returns: Type Description dict [ str , Any ] Dictionary with last error information. Source code in pdmt5/dataframe.py 125 126 127 128 129 130 131 132 def last_error_as_dict ( self ) -> dict [ str , Any ]: \"\"\"Get the last error information as a dictionary. Returns: Dictionary with last error information. \"\"\" response = self . last_error () return { \"error_code\" : response [ 0 ], \"error_description\" : response [ 1 ]} market_book_get_as_df \u00b6 market_book_get_as_df ( symbol : str , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get market depth for a specified symbol as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with market depth data. Source code in pdmt5/dataframe.py 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def market_book_get_as_df ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get market depth for a specified symbol as a data frame. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with market depth data. \"\"\" return pd . DataFrame ( self . market_book_get_as_dicts ( symbol = symbol , skip_to_datetime = True ) ) market_book_get_as_dicts \u00b6 market_book_get_as_dicts ( symbol : str , skip_to_datetime : bool = False ) -> list [ dict [ str , Any ]] Get market depth for a specified symbol as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with market depth data. Source code in pdmt5/dataframe.py 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def market_book_get_as_dicts ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get market depth for a specified symbol as a list of dictionaries. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with market depth data. \"\"\" return [ b . _asdict () for b in self . market_book_get ( symbol = symbol )] order_check_as_df \u00b6 order_check_as_df ( request : dict [ str , Any ], index_keys : str | None = None ) -> DataFrame Check funds sufficiency for performing a requested trading operation as a data frame. Parameters: Name Type Description Default request dict [ str , Any ] Order request parameters. required index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with order check results. Source code in pdmt5/dataframe.py 727 728 729 730 731 732 733 734 735 736 737 738 739 740 741 742 743 744 745 746 @set_index_if_possible ( index_parameters = \"index_keys\" ) def order_check_as_df ( self , request : dict [ str , Any ], index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Check funds sufficiency for performing a requested trading operation as a data frame. Args: request: Order request parameters. index_keys: Column name to set as index if provided. Returns: DataFrame with order check results. \"\"\" # noqa: E501 return pd . DataFrame ([ self . _flatten_dict_to_one_level ( dictionary = self . order_check_as_dict ( request = request ), ) ]) order_check_as_dict \u00b6 order_check_as_dict ( request : dict [ str , Any ], ) -> dict [ str , Any ] Check funds sufficiency for performing a requested trading operation as a dictionary. Parameters: Name Type Description Default request dict [ str , Any ] Order request parameters. required Returns: Type Description dict [ str , Any ] Dictionary with order check results. Source code in pdmt5/dataframe.py 713 714 715 716 717 718 719 720 721 722 723 724 725 def order_check_as_dict ( self , request : dict [ str , Any ]) -> dict [ str , Any ]: \"\"\"Check funds sufficiency for performing a requested trading operation as a dictionary. Args: request: Order request parameters. Returns: Dictionary with order check results. \"\"\" # noqa: E501 return { k : ( v . _asdict () if k == \"request\" else v ) for k , v in self . order_check ( request = request ) . _asdict () . items () } order_send_as_df \u00b6 order_send_as_df ( request : dict [ str , Any ], index_keys : str | None = None ) -> DataFrame Send a request to perform a trading operation from the terminal to the trade server as a data frame. Parameters: Name Type Description Default request dict [ str , Any ] Order request parameters. required index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with order send results. Source code in pdmt5/dataframe.py 762 763 764 765 766 767 768 769 770 771 772 773 774 775 776 777 778 779 780 781 @set_index_if_possible ( index_parameters = \"index_keys\" ) def order_send_as_df ( self , request : dict [ str , Any ], index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Send a request to perform a trading operation from the terminal to the trade server as a data frame. Args: request: Order request parameters. index_keys: Column name to set as index if provided. Returns: DataFrame with order send results. \"\"\" # noqa: E501 return pd . DataFrame ([ self . _flatten_dict_to_one_level ( dictionary = self . order_send_as_dict ( request = request ), ) ]) order_send_as_dict \u00b6 order_send_as_dict ( request : dict [ str , Any ], ) -> dict [ str , Any ] Send a request to perform a trading operation from the terminal to the trade server as a dictionary. Parameters: Name Type Description Default request dict [ str , Any ] Order request parameters. required Returns: Type Description dict [ str , Any ] Dictionary with order send results. Source code in pdmt5/dataframe.py 748 749 750 751 752 753 754 755 756 757 758 759 760 def order_send_as_dict ( self , request : dict [ str , Any ]) -> dict [ str , Any ]: \"\"\"Send a request to perform a trading operation from the terminal to the trade server as a dictionary. Args: request: Order request parameters. Returns: Dictionary with order send results. \"\"\" # noqa: E501 return { k : ( v . _asdict () if k == \"request\" else v ) for k , v in self . order_send ( request = request ) . _asdict () . items () } orders_get_as_df \u00b6 orders_get_as_df ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get active orders with optional filters as a data frame. Parameters: Name Type Description Default symbol str | None Optional symbol filter. None group str | None Optional group filter. None ticket int | None Optional order ticket filter. None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with order information or empty DataFrame if no orders. Source code in pdmt5/dataframe.py 682 683 684 685 686 687 688 689 690 691 692 693 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def orders_get_as_df ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get active orders with optional filters as a data frame. Args: symbol: Optional symbol filter. group: Optional group filter. ticket: Optional order ticket filter. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with order information or empty DataFrame if no orders. \"\"\" return pd . DataFrame ( self . orders_get_as_dicts ( symbol = symbol , group = group , ticket = ticket , skip_to_datetime = True , ) ) orders_get_as_dicts \u00b6 orders_get_as_dicts ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get active orders with optional filters as a list of dictionaries. Parameters: Name Type Description Default symbol str | None Optional symbol filter. None group str | None Optional group filter. None ticket int | None Optional order ticket filter. None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with order information or empty list if no orders. Source code in pdmt5/dataframe.py 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 675 676 677 678 679 680 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def orders_get_as_dicts ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get active orders with optional filters as a list of dictionaries. Args: symbol: Optional symbol filter. group: Optional group filter. ticket: Optional order ticket filter. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with order information or empty list if no orders. \"\"\" return [ o . _asdict () for o in self . orders_get ( symbol = symbol , group = group , ticket = ticket ) ] positions_get_as_df \u00b6 positions_get_as_df ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get open positions with optional filters as a data frame. Parameters: Name Type Description Default symbol str | None Optional symbol filter. None group str | None Optional group filter. None ticket int | None Optional position ticket filter. None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with position information or empty DataFrame if no positions. Source code in pdmt5/dataframe.py 808 809 810 811 812 813 814 815 816 817 818 819 820 821 822 823 824 825 826 827 828 829 830 831 832 833 834 835 836 837 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def positions_get_as_df ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get open positions with optional filters as a data frame. Args: symbol: Optional symbol filter. group: Optional group filter. ticket: Optional position ticket filter. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with position information or empty DataFrame if no positions. \"\"\" return pd . DataFrame ( self . positions_get_as_dicts ( symbol = symbol , group = group , ticket = ticket , skip_to_datetime = True , ) ) positions_get_as_dicts \u00b6 positions_get_as_dicts ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get open positions with optional filters as a list of dictionaries. Parameters: Name Type Description Default symbol str | None Optional symbol filter. None group str | None Optional group filter. None ticket int | None Optional position ticket filter. None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with position information or empty list if no list [ dict [ str , Any ]] positions. Source code in pdmt5/dataframe.py 783 784 785 786 787 788 789 790 791 792 793 794 795 796 797 798 799 800 801 802 803 804 805 806 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def positions_get_as_dicts ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get open positions with optional filters as a list of dictionaries. Args: symbol: Optional symbol filter. group: Optional group filter. ticket: Optional position ticket filter. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with position information or empty list if no positions. \"\"\" return [ p . _asdict () for p in self . positions_get ( symbol = symbol , group = group , ticket = ticket ) ] symbol_info_as_df \u00b6 symbol_info_as_df ( symbol : str , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get data on a specific symbol as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with symbol information. Source code in pdmt5/dataframe.py 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbol_info_as_df ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get data on a specific symbol as a data frame. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with symbol information. \"\"\" return pd . DataFrame ([ self . symbol_info_as_dict ( symbol = symbol , skip_to_datetime = True ) ]) symbol_info_as_dict \u00b6 symbol_info_as_dict ( symbol : str , skip_to_datetime : bool = False ) -> dict [ str , Any ] Get data on a specific symbol as a dictionary. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description dict [ str , Any ] Dictionary with symbol information. Source code in pdmt5/dataframe.py 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbol_info_as_dict ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 ) -> dict [ str , Any ]: \"\"\"Get data on a specific symbol as a dictionary. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. Returns: Dictionary with symbol information. \"\"\" return self . symbol_info ( symbol = symbol ) . _asdict () symbol_info_tick_as_df \u00b6 symbol_info_tick_as_df ( symbol : str , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get the last tick for the specified financial instrument as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with tick information. Source code in pdmt5/dataframe.py 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbol_info_tick_as_df ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get the last tick for the specified financial instrument as a data frame. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with tick information. \"\"\" return pd . DataFrame ([ self . symbol_info_tick_as_dict ( symbol = symbol , skip_to_datetime = True ) ]) symbol_info_tick_as_dict \u00b6 symbol_info_tick_as_dict ( symbol : str , skip_to_datetime : bool = False ) -> dict [ str , Any ] Get the last tick for the specified financial instrument as a dictionary. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description dict [ str , Any ] Dictionary with tick information. Source code in pdmt5/dataframe.py 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbol_info_tick_as_dict ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 ) -> dict [ str , Any ]: \"\"\"Get the last tick for the specified financial instrument as a dictionary. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. Returns: Dictionary with tick information. \"\"\" return self . symbol_info_tick ( symbol = symbol ) . _asdict () symbols_get_as_df \u00b6 symbols_get_as_df ( group : str | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get symbols as a data frame. Parameters: Name Type Description Default group str | None Symbol group filter (e.g., \" USD \", \"Forex*\"). None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with symbol information. Source code in pdmt5/dataframe.py 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbols_get_as_df ( self , group : str | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get symbols as a data frame. Args: group: Symbol group filter (e.g., \"*USD*\", \"Forex*\"). skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with symbol information. \"\"\" return pd . DataFrame ( self . symbols_get_as_dicts ( group = group , skip_to_datetime = True ) ) symbols_get_as_dicts \u00b6 symbols_get_as_dicts ( group : str | None = None , skip_to_datetime : bool = False ) -> list [ dict [ str , Any ]] Get symbols as a list of dictionaries. Parameters: Name Type Description Default group str | None Symbol group filter (e.g., \" USD \", \"Forex*\"). None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with symbol information. Source code in pdmt5/dataframe.py 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbols_get_as_dicts ( self , group : str | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get symbols as a list of dictionaries. Args: group: Symbol group filter (e.g., \"*USD*\", \"Forex*\"). skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with symbol information. \"\"\" return [ s . _asdict () for s in self . symbols_get ( group = group )] terminal_info_as_df \u00b6 terminal_info_as_df ( index_keys : str | None = None , ) -> DataFrame Get the connected terminal status and settings as a data frame. Parameters: Name Type Description Default index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with terminal information. Source code in pdmt5/dataframe.py 174 175 176 177 178 179 180 181 182 183 184 @set_index_if_possible ( index_parameters = \"index_keys\" ) def terminal_info_as_df ( self , index_keys : str | None = None ) -> pd . DataFrame : # noqa: ARG002 \"\"\"Get the connected terminal status and settings as a data frame. Args: index_keys: Column name to set as index if provided. Returns: DataFrame with terminal information. \"\"\" return pd . DataFrame ([ self . terminal_info_as_dict ()]) terminal_info_as_dict \u00b6 terminal_info_as_dict () -> dict [ str , Any ] Get the connected terminal status and settings as a dictionary. Returns: Type Description dict [ str , Any ] Dictionary with terminal information. Source code in pdmt5/dataframe.py 166 167 168 169 170 171 172 def terminal_info_as_dict ( self ) -> dict [ str , Any ]: \"\"\"Get the connected terminal status and settings as a dictionary. Returns: Dictionary with terminal information. \"\"\" return self . terminal_info () . _asdict () version_as_df \u00b6 version_as_df ( index_keys : str | None = None ) -> DataFrame Return MetaTrader5 version information as a data frame. Parameters: Name Type Description Default index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with MetaTrader5 version information. Source code in pdmt5/dataframe.py 113 114 115 116 117 118 119 120 121 122 123 @set_index_if_possible ( index_parameters = \"index_keys\" ) def version_as_df ( self , index_keys : str | None = None ) -> pd . DataFrame : # noqa: ARG002 \"\"\"Return MetaTrader5 version information as a data frame. Args: index_keys: Column name to set as index if provided. Returns: DataFrame with MetaTrader5 version information. \"\"\" return pd . DataFrame ([ self . version_as_dict ()]) version_as_dict \u00b6 version_as_dict () -> dict [ str , int | str ] Return MetaTrader5 version information as a dictionary. Returns: Type Description dict [ str , int | str ] Dictionary with MetaTrader5 version information. Source code in pdmt5/dataframe.py 100 101 102 103 104 105 106 107 108 109 110 111 def version_as_dict ( self ) -> dict [ str , int | str ]: \"\"\"Return MetaTrader5 version information as a dictionary. Returns: Dictionary with MetaTrader5 version information. \"\"\" response = self . version () return { \"mt5_terminal_version\" : response [ 0 ], \"build\" : response [ 1 ], \"build_release_date\" : response [ 2 ], } Overview \u00b6 The dataframe module extends the base Mt5Client with pandas-friendly functionality for connecting to MetaTrader 5 and retrieving trading data as pandas DataFrames. It includes configuration management, automatic data conversion, and comprehensive validation utilities. Classes \u00b6 Mt5Config \u00b6 pdmt5.dataframe.Mt5Config \u00b6 Bases: BaseModel Configuration for MetaTrader5 connection. login class-attribute instance-attribute \u00b6 login : int | None = Field ( default = None , description = \"Trading account login\" ) model_config class-attribute instance-attribute \u00b6 model_config = ConfigDict ( frozen = True ) password class-attribute instance-attribute \u00b6 password : str | None = Field ( default = None , description = \"Trading account password\" ) path class-attribute instance-attribute \u00b6 path : str | None = Field ( default = None , description = \"Path to MetaTrader5 terminal EXE file\" , ) server class-attribute instance-attribute \u00b6 server : str | None = Field ( default = None , description = \"Trading server name\" ) timeout class-attribute instance-attribute \u00b6 timeout : int | None = Field ( default = None , description = \"Connection timeout in milliseconds\" , ) options: show_bases: false Configuration class for MetaTrader 5 connection parameters using pydantic for validation. Mt5DataClient \u00b6 pdmt5.dataframe.Mt5DataClient \u00b6 Bases: Mt5Client MetaTrader5 data client with pandas DataFrame and dictionary conversion. This class provides a pandas-friendly interface to MetaTrader5 functions, converting native MetaTrader5 data structures to pandas DataFrames with pydantic validation. config class-attribute instance-attribute \u00b6 config : Mt5Config = Field ( default_factory = Mt5Config , description = \"MetaTrader5 connection configuration\" , ) model_config class-attribute instance-attribute \u00b6 model_config = ConfigDict ( arbitrary_types_allowed = True ) retry_count class-attribute instance-attribute \u00b6 retry_count : int = Field ( default = 3 , ge = 0 , description = \"Number of retry attempts for connection initialization\" , ) account_info_as_df \u00b6 account_info_as_df ( index_keys : str | None = None , ) -> DataFrame Get info on the current account as a data frame. Parameters: Name Type Description Default index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with account information. Source code in pdmt5/dataframe.py 154 155 156 157 158 159 160 161 162 163 164 @set_index_if_possible ( index_parameters = \"index_keys\" ) def account_info_as_df ( self , index_keys : str | None = None ) -> pd . DataFrame : # noqa: ARG002 \"\"\"Get info on the current account as a data frame. Args: index_keys: Column name to set as index if provided. Returns: DataFrame with account information. \"\"\" return pd . DataFrame ([ self . account_info_as_dict ()]) account_info_as_dict \u00b6 account_info_as_dict () -> dict [ str , Any ] Get info on the current account as a dictionary. Returns: Type Description dict [ str , Any ] Dictionary with account information. Source code in pdmt5/dataframe.py 146 147 148 149 150 151 152 def account_info_as_dict ( self ) -> dict [ str , Any ]: \"\"\"Get info on the current account as a dictionary. Returns: Dictionary with account information. \"\"\" return self . account_info () . _asdict () copy_rates_from_as_df \u00b6 copy_rates_from_as_df ( symbol : str , timeframe : int , date_from : datetime , count : int , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get bars for a specified date range as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime Start date. required count int Number of rates to retrieve. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with OHLCV data. Source code in pdmt5/dataframe.py 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401 402 403 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_rates_from_as_df ( self , symbol : str , timeframe : int , date_from : datetime , count : int , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get bars for a specified date range as a data frame. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date. count: Number of rates to retrieve. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with OHLCV data. \"\"\" self . _validate_positive_count ( count = count ) return pd . DataFrame ( self . copy_rates_from ( symbol = symbol , timeframe = timeframe , date_from = date_from , count = count , ) ) copy_rates_from_as_dicts \u00b6 copy_rates_from_as_dicts ( symbol : str , timeframe : int , date_from : datetime , count : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get bars for a specified date range as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime Start date. required count int Number of rates to retrieve. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with OHLCV data. Source code in pdmt5/dataframe.py 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 def copy_rates_from_as_dicts ( self , symbol : str , timeframe : int , date_from : datetime , count : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get bars for a specified date range as a list of dictionaries. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date. count: Number of rates to retrieve. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with OHLCV data. \"\"\" return self . copy_rates_from_as_df ( symbol = symbol , timeframe = timeframe , date_from = date_from , count = count , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" ) copy_rates_from_pos_as_df \u00b6 copy_rates_from_pos_as_df ( symbol : str , timeframe : int , start_pos : int , count : int , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get bars from a specified position as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required start_pos int Start position. required count int Number of rates to retrieve. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with OHLCV data. Source code in pdmt5/dataframe.py 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_rates_from_pos_as_df ( self , symbol : str , timeframe : int , start_pos : int , count : int , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get bars from a specified position as a data frame. Args: symbol: Symbol name. timeframe: Timeframe constant. start_pos: Start position. count: Number of rates to retrieve. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with OHLCV data. \"\"\" self . _validate_positive_count ( count = count ) self . _validate_non_negative_position ( position = start_pos ) return pd . DataFrame ( self . copy_rates_from_pos ( symbol = symbol , timeframe = timeframe , start_pos = start_pos , count = count , ) ) copy_rates_from_pos_as_dicts \u00b6 copy_rates_from_pos_as_dicts ( symbol : str , timeframe : int , start_pos : int , count : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get bars from a specified position as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required start_pos int Start position. required count int Number of rates to retrieve. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with OHLCV data. Source code in pdmt5/dataframe.py 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 def copy_rates_from_pos_as_dicts ( self , symbol : str , timeframe : int , start_pos : int , count : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get bars from a specified position as a list of dictionaries. Args: symbol: Symbol name. timeframe: Timeframe constant. start_pos: Start position. count: Number of rates to retrieve. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with OHLCV data. \"\"\" return self . copy_rates_from_pos_as_df ( symbol = symbol , timeframe = timeframe , start_pos = start_pos , count = count , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" ) copy_rates_range_as_df \u00b6 copy_rates_range_as_df ( symbol : str , timeframe : int , date_from : datetime , date_to : datetime , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get bars for a specified date range as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime Start date. required date_to datetime End date. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with OHLCV data. Source code in pdmt5/dataframe.py 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521 522 523 524 525 526 527 528 529 530 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_rates_range_as_df ( self , symbol : str , timeframe : int , date_from : datetime , date_to : datetime , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get bars for a specified date range as a data frame. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date. date_to: End date. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with OHLCV data. \"\"\" self . _validate_date_range ( date_from = date_from , date_to = date_to ) return pd . DataFrame ( self . copy_rates_range ( symbol = symbol , timeframe = timeframe , date_from = date_from , date_to = date_to , ) ) copy_rates_range_as_dicts \u00b6 copy_rates_range_as_dicts ( symbol : str , timeframe : int , date_from : datetime , date_to : datetime , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get bars for a specified date range as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime Start date. required date_to datetime End date. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with OHLCV data. Source code in pdmt5/dataframe.py 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 def copy_rates_range_as_dicts ( self , symbol : str , timeframe : int , date_from : datetime , date_to : datetime , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get bars for a specified date range as a list of dictionaries. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date. date_to: End date. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with OHLCV data. \"\"\" return self . copy_rates_range_as_df ( symbol = symbol , timeframe = timeframe , date_from = date_from , date_to = date_to , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" ) copy_ticks_from_as_df \u00b6 copy_ticks_from_as_df ( symbol : str , date_from : datetime , count : int , flags : int , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get ticks from a specified date as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime Start date. required count int Number of ticks to retrieve. required flags int Tick flags (use constants from MetaTrader5). required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with tick data. Source code in pdmt5/dataframe.py 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 588 589 590 591 592 593 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_ticks_from_as_df ( self , symbol : str , date_from : datetime , count : int , flags : int , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get ticks from a specified date as a data frame. Args: symbol: Symbol name. date_from: Start date. count: Number of ticks to retrieve. flags: Tick flags (use constants from MetaTrader5). skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with tick data. \"\"\" self . _validate_positive_count ( count = count ) return pd . DataFrame ( self . copy_ticks_from ( symbol = symbol , date_from = date_from , count = count , flags = flags , ) ) copy_ticks_from_as_dicts \u00b6 copy_ticks_from_as_dicts ( symbol : str , date_from : datetime , count : int , flags : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get ticks from a specified date as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime Start date. required count int Number of ticks to retrieve. required flags int Tick flags (use constants from MetaTrader5). required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with tick data. Source code in pdmt5/dataframe.py 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557 558 559 def copy_ticks_from_as_dicts ( self , symbol : str , date_from : datetime , count : int , flags : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get ticks from a specified date as a list of dictionaries. Args: symbol: Symbol name. date_from: Start date. count: Number of ticks to retrieve. flags: Tick flags (use constants from MetaTrader5). skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with tick data. \"\"\" return self . copy_ticks_from_as_df ( symbol = symbol , date_from = date_from , count = count , flags = flags , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" ) # type: ignore[reportReturnType] copy_ticks_range_as_df \u00b6 copy_ticks_range_as_df ( symbol : str , date_from : datetime , date_to : datetime , flags : int , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get ticks for a specified date range as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime Start date. required date_to datetime End date. required flags int Tick flags (use constants from MetaTrader5). required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with tick data. Source code in pdmt5/dataframe.py 624 625 626 627 628 629 630 631 632 633 634 635 636 637 638 639 640 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_ticks_range_as_df ( self , symbol : str , date_from : datetime , date_to : datetime , flags : int , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get ticks for a specified date range as a data frame. Args: symbol: Symbol name. date_from: Start date. date_to: End date. flags: Tick flags (use constants from MetaTrader5). skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with tick data. \"\"\" self . _validate_date_range ( date_from = date_from , date_to = date_to ) return pd . DataFrame ( self . copy_ticks_range ( symbol = symbol , date_from = date_from , date_to = date_to , flags = flags , ) ) copy_ticks_range_as_dicts \u00b6 copy_ticks_range_as_dicts ( symbol : str , date_from : datetime , date_to : datetime , flags : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get ticks for a specified date range as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime Start date. required date_to datetime End date. required flags int Tick flags (use constants from MetaTrader5). required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with tick data. Source code in pdmt5/dataframe.py 595 596 597 598 599 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 def copy_ticks_range_as_dicts ( self , symbol : str , date_from : datetime , date_to : datetime , flags : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get ticks for a specified date range as a list of dictionaries. Args: symbol: Symbol name. date_from: Start date. date_to: End date. flags: Tick flags (use constants from MetaTrader5). skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with tick data. \"\"\" return self . copy_ticks_range_as_df ( symbol = symbol , date_from = date_from , date_to = date_to , flags = flags , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" ) # type: ignore[reportReturnType] history_deals_get_as_df \u00b6 history_deals_get_as_df ( date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get historical deals with optional filters as a data frame. Parameters: Name Type Description Default date_from datetime | None Start date (required if not using ticket/position). None date_to datetime | None End date (required if not using ticket/position). None group str | None Optional group filter. None symbol str | None Optional symbol filter. None ticket int | None Get deals by order ticket. None position int | None Get deals by position ticket. None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with historical deal information. Source code in pdmt5/dataframe.py 963 964 965 966 967 968 969 970 971 972 973 974 975 976 977 978 979 980 981 982 983 984 985 986 987 988 989 990 991 992 993 994 995 996 997 998 999 1000 1001 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def history_deals_get_as_df ( self , date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get historical deals with optional filters as a data frame. Args: date_from: Start date (required if not using ticket/position). date_to: End date (required if not using ticket/position). group: Optional group filter. symbol: Optional symbol filter. ticket: Get deals by order ticket. position: Get deals by position ticket. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with historical deal information. \"\"\" return pd . DataFrame ( self . history_deals_get_as_dicts ( date_from = date_from , date_to = date_to , group = group , symbol = symbol , ticket = ticket , position = position , skip_to_datetime = True , ) ) history_deals_get_as_dicts \u00b6 history_deals_get_as_dicts ( date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get historical deals with optional filters as a list of dictionaries. Parameters: Name Type Description Default date_from datetime | None Start date (required if not using ticket/position). None date_to datetime | None End date (required if not using ticket/position). None group str | None Optional group filter. None symbol str | None Optional symbol filter. None ticket int | None Get deals by order ticket. None position int | None Get deals by position ticket. None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with historical deal information. Source code in pdmt5/dataframe.py 921 922 923 924 925 926 927 928 929 930 931 932 933 934 935 936 937 938 939 940 941 942 943 944 945 946 947 948 949 950 951 952 953 954 955 956 957 958 959 960 961 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def history_deals_get_as_dicts ( self , date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get historical deals with optional filters as a list of dictionaries. Args: date_from: Start date (required if not using ticket/position). date_to: End date (required if not using ticket/position). group: Optional group filter. symbol: Optional symbol filter. ticket: Get deals by order ticket. position: Get deals by position ticket. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with historical deal information. \"\"\" self . _validate_history_input ( date_from = date_from , date_to = date_to , ticket = ticket , position = position , ) return [ d . _asdict () for d in self . history_deals_get ( date_from = date_from , date_to = date_to , group = ( f \"* { symbol } *\" if symbol else group ), ticket = ticket , position = position , ) ] history_orders_get_as_df \u00b6 history_orders_get_as_df ( date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get historical orders with optional filters as a data frame. Parameters: Name Type Description Default date_from datetime | None Start date (required if not using ticket/position). None date_to datetime | None End date (required if not using ticket/position). None group str | None Optional group filter. None symbol str | None Optional symbol filter. None ticket int | None Get orders by ticket. None position int | None Get orders by position. None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with historical order information. Source code in pdmt5/dataframe.py 881 882 883 884 885 886 887 888 889 890 891 892 893 894 895 896 897 898 899 900 901 902 903 904 905 906 907 908 909 910 911 912 913 914 915 916 917 918 919 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def history_orders_get_as_df ( self , date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get historical orders with optional filters as a data frame. Args: date_from: Start date (required if not using ticket/position). date_to: End date (required if not using ticket/position). group: Optional group filter. symbol: Optional symbol filter. ticket: Get orders by ticket. position: Get orders by position. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with historical order information. \"\"\" return pd . DataFrame ( self . history_orders_get_as_dicts ( date_from = date_from , date_to = date_to , group = group , symbol = symbol , ticket = ticket , position = position , skip_to_datetime = True , ) ) history_orders_get_as_dicts \u00b6 history_orders_get_as_dicts ( date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get historical orders with optional filters as a list of dictionaries. Parameters: Name Type Description Default date_from datetime | None Start date (required if not using ticket/position). None date_to datetime | None End date (required if not using ticket/position). None group str | None Optional group filter. None symbol str | None Optional symbol filter. None ticket int | None Get orders by ticket. None position int | None Get orders by position. None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with historical order information. Source code in pdmt5/dataframe.py 839 840 841 842 843 844 845 846 847 848 849 850 851 852 853 854 855 856 857 858 859 860 861 862 863 864 865 866 867 868 869 870 871 872 873 874 875 876 877 878 879 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def history_orders_get_as_dicts ( self , date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get historical orders with optional filters as a list of dictionaries. Args: date_from: Start date (required if not using ticket/position). date_to: End date (required if not using ticket/position). group: Optional group filter. symbol: Optional symbol filter. ticket: Get orders by ticket. position: Get orders by position. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with historical order information. \"\"\" self . _validate_history_input ( date_from = date_from , date_to = date_to , ticket = ticket , position = position , ) return [ o . _asdict () for o in self . history_orders_get ( date_from = date_from , date_to = date_to , group = ( f \"* { symbol } *\" if symbol else group ), ticket = ticket , position = position , ) ] initialize_and_login_mt5 \u00b6 initialize_and_login_mt5 ( path : str | None = None , login : int | None = None , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> None Initialize MetaTrader5 connection with retry logic. This method overrides the base class to add retry logic and use config values. Parameters: Name Type Description Default path str | None Path to terminal EXE file (overrides config). None login int | None Account login (overrides config). None password str | None Account password (overrides config). None server str | None Server name (overrides config). None timeout int | None Connection timeout (overrides config). None Raises: Type Description Mt5RuntimeError If initialization fails after retries. Source code in pdmt5/dataframe.py 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 def initialize_and_login_mt5 ( self , path : str | None = None , login : int | None = None , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> None : \"\"\"Initialize MetaTrader5 connection with retry logic. This method overrides the base class to add retry logic and use config values. Args: path: Path to terminal EXE file (overrides config). login: Account login (overrides config). password: Account password (overrides config). server: Server name (overrides config). timeout: Connection timeout (overrides config). Raises: Mt5RuntimeError: If initialization fails after retries. \"\"\" path = path or self . config . path login_kwargs = { \"login\" : login or self . config . login , \"password\" : password or self . config . password , \"server\" : server or self . config . server , \"timeout\" : timeout or self . config . timeout , } for i in range ( 1 + max ( 0 , self . retry_count )): if i : self . logger . warning ( \"Retrying MT5 initialization ( %d / %d )...\" , i , self . retry_count , ) time . sleep ( i ) if self . initialize ( path = path , ** login_kwargs ) and ( ( not login_kwargs [ \"login\" ]) or self . login ( ** login_kwargs ) ): return error_message = ( f \"MT5 initialize and login failed after { self . retry_count } retries:\" f \" { self . last_error () } \" ) raise Mt5RuntimeError ( error_message ) last_error_as_df \u00b6 last_error_as_df ( index_keys : str | None = None , ) -> DataFrame Get the last error information as a data frame. Parameters: Name Type Description Default index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with last error information. Source code in pdmt5/dataframe.py 134 135 136 137 138 139 140 141 142 143 144 @set_index_if_possible ( index_parameters = \"index_keys\" ) def last_error_as_df ( self , index_keys : str | None = None ) -> pd . DataFrame : # noqa: ARG002 \"\"\"Get the last error information as a data frame. Args: index_keys: Column name to set as index if provided. Returns: DataFrame with last error information. \"\"\" return pd . DataFrame ([ self . last_error_as_dict ()]) last_error_as_dict \u00b6 last_error_as_dict () -> dict [ str , Any ] Get the last error information as a dictionary. Returns: Type Description dict [ str , Any ] Dictionary with last error information. Source code in pdmt5/dataframe.py 125 126 127 128 129 130 131 132 def last_error_as_dict ( self ) -> dict [ str , Any ]: \"\"\"Get the last error information as a dictionary. Returns: Dictionary with last error information. \"\"\" response = self . last_error () return { \"error_code\" : response [ 0 ], \"error_description\" : response [ 1 ]} market_book_get_as_df \u00b6 market_book_get_as_df ( symbol : str , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get market depth for a specified symbol as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with market depth data. Source code in pdmt5/dataframe.py 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def market_book_get_as_df ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get market depth for a specified symbol as a data frame. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with market depth data. \"\"\" return pd . DataFrame ( self . market_book_get_as_dicts ( symbol = symbol , skip_to_datetime = True ) ) market_book_get_as_dicts \u00b6 market_book_get_as_dicts ( symbol : str , skip_to_datetime : bool = False ) -> list [ dict [ str , Any ]] Get market depth for a specified symbol as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with market depth data. Source code in pdmt5/dataframe.py 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def market_book_get_as_dicts ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get market depth for a specified symbol as a list of dictionaries. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with market depth data. \"\"\" return [ b . _asdict () for b in self . market_book_get ( symbol = symbol )] order_check_as_df \u00b6 order_check_as_df ( request : dict [ str , Any ], index_keys : str | None = None ) -> DataFrame Check funds sufficiency for performing a requested trading operation as a data frame. Parameters: Name Type Description Default request dict [ str , Any ] Order request parameters. required index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with order check results. Source code in pdmt5/dataframe.py 727 728 729 730 731 732 733 734 735 736 737 738 739 740 741 742 743 744 745 746 @set_index_if_possible ( index_parameters = \"index_keys\" ) def order_check_as_df ( self , request : dict [ str , Any ], index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Check funds sufficiency for performing a requested trading operation as a data frame. Args: request: Order request parameters. index_keys: Column name to set as index if provided. Returns: DataFrame with order check results. \"\"\" # noqa: E501 return pd . DataFrame ([ self . _flatten_dict_to_one_level ( dictionary = self . order_check_as_dict ( request = request ), ) ]) order_check_as_dict \u00b6 order_check_as_dict ( request : dict [ str , Any ], ) -> dict [ str , Any ] Check funds sufficiency for performing a requested trading operation as a dictionary. Parameters: Name Type Description Default request dict [ str , Any ] Order request parameters. required Returns: Type Description dict [ str , Any ] Dictionary with order check results. Source code in pdmt5/dataframe.py 713 714 715 716 717 718 719 720 721 722 723 724 725 def order_check_as_dict ( self , request : dict [ str , Any ]) -> dict [ str , Any ]: \"\"\"Check funds sufficiency for performing a requested trading operation as a dictionary. Args: request: Order request parameters. Returns: Dictionary with order check results. \"\"\" # noqa: E501 return { k : ( v . _asdict () if k == \"request\" else v ) for k , v in self . order_check ( request = request ) . _asdict () . items () } order_send_as_df \u00b6 order_send_as_df ( request : dict [ str , Any ], index_keys : str | None = None ) -> DataFrame Send a request to perform a trading operation from the terminal to the trade server as a data frame. Parameters: Name Type Description Default request dict [ str , Any ] Order request parameters. required index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with order send results. Source code in pdmt5/dataframe.py 762 763 764 765 766 767 768 769 770 771 772 773 774 775 776 777 778 779 780 781 @set_index_if_possible ( index_parameters = \"index_keys\" ) def order_send_as_df ( self , request : dict [ str , Any ], index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Send a request to perform a trading operation from the terminal to the trade server as a data frame. Args: request: Order request parameters. index_keys: Column name to set as index if provided. Returns: DataFrame with order send results. \"\"\" # noqa: E501 return pd . DataFrame ([ self . _flatten_dict_to_one_level ( dictionary = self . order_send_as_dict ( request = request ), ) ]) order_send_as_dict \u00b6 order_send_as_dict ( request : dict [ str , Any ], ) -> dict [ str , Any ] Send a request to perform a trading operation from the terminal to the trade server as a dictionary. Parameters: Name Type Description Default request dict [ str , Any ] Order request parameters. required Returns: Type Description dict [ str , Any ] Dictionary with order send results. Source code in pdmt5/dataframe.py 748 749 750 751 752 753 754 755 756 757 758 759 760 def order_send_as_dict ( self , request : dict [ str , Any ]) -> dict [ str , Any ]: \"\"\"Send a request to perform a trading operation from the terminal to the trade server as a dictionary. Args: request: Order request parameters. Returns: Dictionary with order send results. \"\"\" # noqa: E501 return { k : ( v . _asdict () if k == \"request\" else v ) for k , v in self . order_send ( request = request ) . _asdict () . items () } orders_get_as_df \u00b6 orders_get_as_df ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get active orders with optional filters as a data frame. Parameters: Name Type Description Default symbol str | None Optional symbol filter. None group str | None Optional group filter. None ticket int | None Optional order ticket filter. None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with order information or empty DataFrame if no orders. Source code in pdmt5/dataframe.py 682 683 684 685 686 687 688 689 690 691 692 693 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def orders_get_as_df ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get active orders with optional filters as a data frame. Args: symbol: Optional symbol filter. group: Optional group filter. ticket: Optional order ticket filter. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with order information or empty DataFrame if no orders. \"\"\" return pd . DataFrame ( self . orders_get_as_dicts ( symbol = symbol , group = group , ticket = ticket , skip_to_datetime = True , ) ) orders_get_as_dicts \u00b6 orders_get_as_dicts ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get active orders with optional filters as a list of dictionaries. Parameters: Name Type Description Default symbol str | None Optional symbol filter. None group str | None Optional group filter. None ticket int | None Optional order ticket filter. None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with order information or empty list if no orders. Source code in pdmt5/dataframe.py 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 675 676 677 678 679 680 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def orders_get_as_dicts ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get active orders with optional filters as a list of dictionaries. Args: symbol: Optional symbol filter. group: Optional group filter. ticket: Optional order ticket filter. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with order information or empty list if no orders. \"\"\" return [ o . _asdict () for o in self . orders_get ( symbol = symbol , group = group , ticket = ticket ) ] positions_get_as_df \u00b6 positions_get_as_df ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get open positions with optional filters as a data frame. Parameters: Name Type Description Default symbol str | None Optional symbol filter. None group str | None Optional group filter. None ticket int | None Optional position ticket filter. None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with position information or empty DataFrame if no positions. Source code in pdmt5/dataframe.py 808 809 810 811 812 813 814 815 816 817 818 819 820 821 822 823 824 825 826 827 828 829 830 831 832 833 834 835 836 837 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def positions_get_as_df ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get open positions with optional filters as a data frame. Args: symbol: Optional symbol filter. group: Optional group filter. ticket: Optional position ticket filter. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with position information or empty DataFrame if no positions. \"\"\" return pd . DataFrame ( self . positions_get_as_dicts ( symbol = symbol , group = group , ticket = ticket , skip_to_datetime = True , ) ) positions_get_as_dicts \u00b6 positions_get_as_dicts ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get open positions with optional filters as a list of dictionaries. Parameters: Name Type Description Default symbol str | None Optional symbol filter. None group str | None Optional group filter. None ticket int | None Optional position ticket filter. None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with position information or empty list if no list [ dict [ str , Any ]] positions. Source code in pdmt5/dataframe.py 783 784 785 786 787 788 789 790 791 792 793 794 795 796 797 798 799 800 801 802 803 804 805 806 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def positions_get_as_dicts ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get open positions with optional filters as a list of dictionaries. Args: symbol: Optional symbol filter. group: Optional group filter. ticket: Optional position ticket filter. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with position information or empty list if no positions. \"\"\" return [ p . _asdict () for p in self . positions_get ( symbol = symbol , group = group , ticket = ticket ) ] symbol_info_as_df \u00b6 symbol_info_as_df ( symbol : str , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get data on a specific symbol as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with symbol information. Source code in pdmt5/dataframe.py 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbol_info_as_df ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get data on a specific symbol as a data frame. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with symbol information. \"\"\" return pd . DataFrame ([ self . symbol_info_as_dict ( symbol = symbol , skip_to_datetime = True ) ]) symbol_info_as_dict \u00b6 symbol_info_as_dict ( symbol : str , skip_to_datetime : bool = False ) -> dict [ str , Any ] Get data on a specific symbol as a dictionary. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description dict [ str , Any ] Dictionary with symbol information. Source code in pdmt5/dataframe.py 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbol_info_as_dict ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 ) -> dict [ str , Any ]: \"\"\"Get data on a specific symbol as a dictionary. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. Returns: Dictionary with symbol information. \"\"\" return self . symbol_info ( symbol = symbol ) . _asdict () symbol_info_tick_as_df \u00b6 symbol_info_tick_as_df ( symbol : str , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get the last tick for the specified financial instrument as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with tick information. Source code in pdmt5/dataframe.py 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbol_info_tick_as_df ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get the last tick for the specified financial instrument as a data frame. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with tick information. \"\"\" return pd . DataFrame ([ self . symbol_info_tick_as_dict ( symbol = symbol , skip_to_datetime = True ) ]) symbol_info_tick_as_dict \u00b6 symbol_info_tick_as_dict ( symbol : str , skip_to_datetime : bool = False ) -> dict [ str , Any ] Get the last tick for the specified financial instrument as a dictionary. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description dict [ str , Any ] Dictionary with tick information. Source code in pdmt5/dataframe.py 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbol_info_tick_as_dict ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 ) -> dict [ str , Any ]: \"\"\"Get the last tick for the specified financial instrument as a dictionary. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. Returns: Dictionary with tick information. \"\"\" return self . symbol_info_tick ( symbol = symbol ) . _asdict () symbols_get_as_df \u00b6 symbols_get_as_df ( group : str | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get symbols as a data frame. Parameters: Name Type Description Default group str | None Symbol group filter (e.g., \" USD \", \"Forex*\"). None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with symbol information. Source code in pdmt5/dataframe.py 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbols_get_as_df ( self , group : str | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get symbols as a data frame. Args: group: Symbol group filter (e.g., \"*USD*\", \"Forex*\"). skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with symbol information. \"\"\" return pd . DataFrame ( self . symbols_get_as_dicts ( group = group , skip_to_datetime = True ) ) symbols_get_as_dicts \u00b6 symbols_get_as_dicts ( group : str | None = None , skip_to_datetime : bool = False ) -> list [ dict [ str , Any ]] Get symbols as a list of dictionaries. Parameters: Name Type Description Default group str | None Symbol group filter (e.g., \" USD \", \"Forex*\"). None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with symbol information. Source code in pdmt5/dataframe.py 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbols_get_as_dicts ( self , group : str | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get symbols as a list of dictionaries. Args: group: Symbol group filter (e.g., \"*USD*\", \"Forex*\"). skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with symbol information. \"\"\" return [ s . _asdict () for s in self . symbols_get ( group = group )] terminal_info_as_df \u00b6 terminal_info_as_df ( index_keys : str | None = None , ) -> DataFrame Get the connected terminal status and settings as a data frame. Parameters: Name Type Description Default index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with terminal information. Source code in pdmt5/dataframe.py 174 175 176 177 178 179 180 181 182 183 184 @set_index_if_possible ( index_parameters = \"index_keys\" ) def terminal_info_as_df ( self , index_keys : str | None = None ) -> pd . DataFrame : # noqa: ARG002 \"\"\"Get the connected terminal status and settings as a data frame. Args: index_keys: Column name to set as index if provided. Returns: DataFrame with terminal information. \"\"\" return pd . DataFrame ([ self . terminal_info_as_dict ()]) terminal_info_as_dict \u00b6 terminal_info_as_dict () -> dict [ str , Any ] Get the connected terminal status and settings as a dictionary. Returns: Type Description dict [ str , Any ] Dictionary with terminal information. Source code in pdmt5/dataframe.py 166 167 168 169 170 171 172 def terminal_info_as_dict ( self ) -> dict [ str , Any ]: \"\"\"Get the connected terminal status and settings as a dictionary. Returns: Dictionary with terminal information. \"\"\" return self . terminal_info () . _asdict () version_as_df \u00b6 version_as_df ( index_keys : str | None = None ) -> DataFrame Return MetaTrader5 version information as a data frame. Parameters: Name Type Description Default index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with MetaTrader5 version information. Source code in pdmt5/dataframe.py 113 114 115 116 117 118 119 120 121 122 123 @set_index_if_possible ( index_parameters = \"index_keys\" ) def version_as_df ( self , index_keys : str | None = None ) -> pd . DataFrame : # noqa: ARG002 \"\"\"Return MetaTrader5 version information as a data frame. Args: index_keys: Column name to set as index if provided. Returns: DataFrame with MetaTrader5 version information. \"\"\" return pd . DataFrame ([ self . version_as_dict ()]) version_as_dict \u00b6 version_as_dict () -> dict [ str , int | str ] Return MetaTrader5 version information as a dictionary. Returns: Type Description dict [ str , int | str ] Dictionary with MetaTrader5 version information. Source code in pdmt5/dataframe.py 100 101 102 103 104 105 106 107 108 109 110 111 def version_as_dict ( self ) -> dict [ str , int | str ]: \"\"\"Return MetaTrader5 version information as a dictionary. Returns: Dictionary with MetaTrader5 version information. \"\"\" response = self . version () return { \"mt5_terminal_version\" : response [ 0 ], \"build\" : response [ 1 ], \"build_release_date\" : response [ 2 ], } options: show_bases: false Extended client class that inherits from Mt5Client and provides a pandas-friendly interface to MetaTrader 5 functions with automatic DataFrame conversion. Usage Examples \u00b6 Basic Connection \u00b6 import MetaTrader5 as mt5 from pdmt5.dataframe import Mt5DataClient , Mt5Config # Create configuration config = Mt5Config ( login = 123456 , password = \"your_password\" , server = \"broker_server\" ) # Create client client = Mt5DataClient ( mt5 = mt5 , config = config ) # Use as context manager with client : # Get account information account_df = client . account_info () print ( account_df ) Retrieving Market Data \u00b6 from datetime import datetime import MetaTrader5 as mt5 with client : # Get OHLCV data rates_df = client . copy_rates_from ( symbol = \"EURUSD\" , timeframe = mt5 . TIMEFRAME_H1 , date_from = datetime ( 2024 , 1 , 1 ), count = 1000 ) # Get tick data ticks_df = client . copy_ticks_from ( symbol = \"EURUSD\" , date_from = datetime ( 2024 , 1 , 1 ), count = 1000 , flags = mt5 . COPY_TICKS_ALL ) Symbol Information \u00b6 with client : # Get all symbols symbols_df = client . symbols_get () # Get specific symbol info symbol_info_df = client . symbol_info ( \"EURUSD\" ) # Get current tick tick_df = client . symbol_info_tick ( \"EURUSD\" ) Trading History \u00b6 from datetime import datetime with client : # Get historical orders orders_df = client . history_orders_get ( date_from = datetime ( 2024 , 1 , 1 ), date_to = datetime ( 2024 , 1 , 31 ), symbol = \"EURUSD\" ) # Get historical deals deals_df = client . history_deals_get ( date_from = datetime ( 2024 , 1 , 1 ), date_to = datetime ( 2024 , 1 , 31 ) ) Current Positions and Orders \u00b6 with client : # Get current positions positions_df = client . positions_get () # Get current orders orders_df = client . orders_get ( symbol = \"EURUSD\" ) Data Conversion Features \u00b6 The Mt5DataClient automatically handles: Time Conversion : Converts Unix timestamps to pandas datetime objects Index Setting : Sets appropriate datetime indexes for time-series data DataFrame Creation : Converts MetaTrader 5 named tuples to pandas DataFrames Error Handling : Provides meaningful error messages for failed operations Empty Data : Returns empty DataFrames when no data is available Error Handling \u00b6 All methods raise Mt5RuntimeError exceptions with detailed error information when operations fail: from pdmt5.mt5 import Mt5RuntimeError try : rates_df = client . copy_rates_from ( \"INVALID\" , mt5 . TIMEFRAME_H1 , datetime . now (), 100 ) except Mt5RuntimeError as e : print ( f \"MetaTrader 5 error: { e } \" ) Connection Management \u00b6 The client supports both explicit and context manager usage: # Explicit initialization client . initialize () try : # Your trading operations pass finally : client . shutdown () # Context manager (recommended) with client : # Your trading operations pass Type Safety \u00b6 All methods include comprehensive type hints and use pydantic for configuration validation, ensuring type safety throughout the codebase.","title":"DataFrame"},{"location":"api/dataframe/#dataframe","text":"","title":"DataFrame"},{"location":"api/dataframe/#pdmt5.dataframe","text":"MetaTrader5 data client with pandas DataFrame conversion.","title":"dataframe"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config","text":"Bases: BaseModel Configuration for MetaTrader5 connection.","title":"Mt5Config"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.login","text":"login : int | None = Field ( default = None , description = \"Trading account login\" )","title":"login"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.model_config","text":"model_config = ConfigDict ( frozen = True )","title":"model_config"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.password","text":"password : str | None = Field ( default = None , description = \"Trading account password\" )","title":"password"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.path","text":"path : str | None = Field ( default = None , description = \"Path to MetaTrader5 terminal EXE file\" , )","title":"path"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.server","text":"server : str | None = Field ( default = None , description = \"Trading server name\" )","title":"server"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.timeout","text":"timeout : int | None = Field ( default = None , description = \"Connection timeout in milliseconds\" , )","title":"timeout"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient","text":"Bases: Mt5Client MetaTrader5 data client with pandas DataFrame and dictionary conversion. This class provides a pandas-friendly interface to MetaTrader5 functions, converting native MetaTrader5 data structures to pandas DataFrames with pydantic validation.","title":"Mt5DataClient"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.config","text":"config : Mt5Config = Field ( default_factory = Mt5Config , description = \"MetaTrader5 connection configuration\" , )","title":"config"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.model_config","text":"model_config = ConfigDict ( arbitrary_types_allowed = True )","title":"model_config"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.retry_count","text":"retry_count : int = Field ( default = 3 , ge = 0 , description = \"Number of retry attempts for connection initialization\" , )","title":"retry_count"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.account_info_as_df","text":"account_info_as_df ( index_keys : str | None = None , ) -> DataFrame Get info on the current account as a data frame. Parameters: Name Type Description Default index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with account information. Source code in pdmt5/dataframe.py 154 155 156 157 158 159 160 161 162 163 164 @set_index_if_possible ( index_parameters = \"index_keys\" ) def account_info_as_df ( self , index_keys : str | None = None ) -> pd . DataFrame : # noqa: ARG002 \"\"\"Get info on the current account as a data frame. Args: index_keys: Column name to set as index if provided. Returns: DataFrame with account information. \"\"\" return pd . DataFrame ([ self . account_info_as_dict ()])","title":"account_info_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.account_info_as_dict","text":"account_info_as_dict () -> dict [ str , Any ] Get info on the current account as a dictionary. Returns: Type Description dict [ str , Any ] Dictionary with account information. Source code in pdmt5/dataframe.py 146 147 148 149 150 151 152 def account_info_as_dict ( self ) -> dict [ str , Any ]: \"\"\"Get info on the current account as a dictionary. Returns: Dictionary with account information. \"\"\" return self . account_info () . _asdict ()","title":"account_info_as_dict"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_from_as_df","text":"copy_rates_from_as_df ( symbol : str , timeframe : int , date_from : datetime , count : int , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get bars for a specified date range as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime Start date. required count int Number of rates to retrieve. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with OHLCV data. Source code in pdmt5/dataframe.py 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401 402 403 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_rates_from_as_df ( self , symbol : str , timeframe : int , date_from : datetime , count : int , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get bars for a specified date range as a data frame. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date. count: Number of rates to retrieve. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with OHLCV data. \"\"\" self . _validate_positive_count ( count = count ) return pd . DataFrame ( self . copy_rates_from ( symbol = symbol , timeframe = timeframe , date_from = date_from , count = count , ) )","title":"copy_rates_from_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_from_as_dicts","text":"copy_rates_from_as_dicts ( symbol : str , timeframe : int , date_from : datetime , count : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get bars for a specified date range as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime Start date. required count int Number of rates to retrieve. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with OHLCV data. Source code in pdmt5/dataframe.py 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 def copy_rates_from_as_dicts ( self , symbol : str , timeframe : int , date_from : datetime , count : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get bars for a specified date range as a list of dictionaries. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date. count: Number of rates to retrieve. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with OHLCV data. \"\"\" return self . copy_rates_from_as_df ( symbol = symbol , timeframe = timeframe , date_from = date_from , count = count , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" )","title":"copy_rates_from_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_from_pos_as_df","text":"copy_rates_from_pos_as_df ( symbol : str , timeframe : int , start_pos : int , count : int , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get bars from a specified position as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required start_pos int Start position. required count int Number of rates to retrieve. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with OHLCV data. Source code in pdmt5/dataframe.py 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_rates_from_pos_as_df ( self , symbol : str , timeframe : int , start_pos : int , count : int , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get bars from a specified position as a data frame. Args: symbol: Symbol name. timeframe: Timeframe constant. start_pos: Start position. count: Number of rates to retrieve. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with OHLCV data. \"\"\" self . _validate_positive_count ( count = count ) self . _validate_non_negative_position ( position = start_pos ) return pd . DataFrame ( self . copy_rates_from_pos ( symbol = symbol , timeframe = timeframe , start_pos = start_pos , count = count , ) )","title":"copy_rates_from_pos_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_from_pos_as_dicts","text":"copy_rates_from_pos_as_dicts ( symbol : str , timeframe : int , start_pos : int , count : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get bars from a specified position as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required start_pos int Start position. required count int Number of rates to retrieve. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with OHLCV data. Source code in pdmt5/dataframe.py 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 def copy_rates_from_pos_as_dicts ( self , symbol : str , timeframe : int , start_pos : int , count : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get bars from a specified position as a list of dictionaries. Args: symbol: Symbol name. timeframe: Timeframe constant. start_pos: Start position. count: Number of rates to retrieve. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with OHLCV data. \"\"\" return self . copy_rates_from_pos_as_df ( symbol = symbol , timeframe = timeframe , start_pos = start_pos , count = count , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" )","title":"copy_rates_from_pos_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_range_as_df","text":"copy_rates_range_as_df ( symbol : str , timeframe : int , date_from : datetime , date_to : datetime , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get bars for a specified date range as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime Start date. required date_to datetime End date. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with OHLCV data. Source code in pdmt5/dataframe.py 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521 522 523 524 525 526 527 528 529 530 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_rates_range_as_df ( self , symbol : str , timeframe : int , date_from : datetime , date_to : datetime , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get bars for a specified date range as a data frame. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date. date_to: End date. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with OHLCV data. \"\"\" self . _validate_date_range ( date_from = date_from , date_to = date_to ) return pd . DataFrame ( self . copy_rates_range ( symbol = symbol , timeframe = timeframe , date_from = date_from , date_to = date_to , ) )","title":"copy_rates_range_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_range_as_dicts","text":"copy_rates_range_as_dicts ( symbol : str , timeframe : int , date_from : datetime , date_to : datetime , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get bars for a specified date range as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime Start date. required date_to datetime End date. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with OHLCV data. Source code in pdmt5/dataframe.py 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 def copy_rates_range_as_dicts ( self , symbol : str , timeframe : int , date_from : datetime , date_to : datetime , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get bars for a specified date range as a list of dictionaries. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date. date_to: End date. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with OHLCV data. \"\"\" return self . copy_rates_range_as_df ( symbol = symbol , timeframe = timeframe , date_from = date_from , date_to = date_to , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" )","title":"copy_rates_range_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_ticks_from_as_df","text":"copy_ticks_from_as_df ( symbol : str , date_from : datetime , count : int , flags : int , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get ticks from a specified date as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime Start date. required count int Number of ticks to retrieve. required flags int Tick flags (use constants from MetaTrader5). required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with tick data. Source code in pdmt5/dataframe.py 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 588 589 590 591 592 593 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_ticks_from_as_df ( self , symbol : str , date_from : datetime , count : int , flags : int , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get ticks from a specified date as a data frame. Args: symbol: Symbol name. date_from: Start date. count: Number of ticks to retrieve. flags: Tick flags (use constants from MetaTrader5). skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with tick data. \"\"\" self . _validate_positive_count ( count = count ) return pd . DataFrame ( self . copy_ticks_from ( symbol = symbol , date_from = date_from , count = count , flags = flags , ) )","title":"copy_ticks_from_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_ticks_from_as_dicts","text":"copy_ticks_from_as_dicts ( symbol : str , date_from : datetime , count : int , flags : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get ticks from a specified date as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime Start date. required count int Number of ticks to retrieve. required flags int Tick flags (use constants from MetaTrader5). required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with tick data. Source code in pdmt5/dataframe.py 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557 558 559 def copy_ticks_from_as_dicts ( self , symbol : str , date_from : datetime , count : int , flags : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get ticks from a specified date as a list of dictionaries. Args: symbol: Symbol name. date_from: Start date. count: Number of ticks to retrieve. flags: Tick flags (use constants from MetaTrader5). skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with tick data. \"\"\" return self . copy_ticks_from_as_df ( symbol = symbol , date_from = date_from , count = count , flags = flags , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" ) # type: ignore[reportReturnType]","title":"copy_ticks_from_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_ticks_range_as_df","text":"copy_ticks_range_as_df ( symbol : str , date_from : datetime , date_to : datetime , flags : int , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get ticks for a specified date range as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime Start date. required date_to datetime End date. required flags int Tick flags (use constants from MetaTrader5). required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with tick data. Source code in pdmt5/dataframe.py 624 625 626 627 628 629 630 631 632 633 634 635 636 637 638 639 640 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_ticks_range_as_df ( self , symbol : str , date_from : datetime , date_to : datetime , flags : int , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get ticks for a specified date range as a data frame. Args: symbol: Symbol name. date_from: Start date. date_to: End date. flags: Tick flags (use constants from MetaTrader5). skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with tick data. \"\"\" self . _validate_date_range ( date_from = date_from , date_to = date_to ) return pd . DataFrame ( self . copy_ticks_range ( symbol = symbol , date_from = date_from , date_to = date_to , flags = flags , ) )","title":"copy_ticks_range_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_ticks_range_as_dicts","text":"copy_ticks_range_as_dicts ( symbol : str , date_from : datetime , date_to : datetime , flags : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get ticks for a specified date range as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime Start date. required date_to datetime End date. required flags int Tick flags (use constants from MetaTrader5). required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with tick data. Source code in pdmt5/dataframe.py 595 596 597 598 599 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 def copy_ticks_range_as_dicts ( self , symbol : str , date_from : datetime , date_to : datetime , flags : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get ticks for a specified date range as a list of dictionaries. Args: symbol: Symbol name. date_from: Start date. date_to: End date. flags: Tick flags (use constants from MetaTrader5). skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with tick data. \"\"\" return self . copy_ticks_range_as_df ( symbol = symbol , date_from = date_from , date_to = date_to , flags = flags , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" ) # type: ignore[reportReturnType]","title":"copy_ticks_range_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.history_deals_get_as_df","text":"history_deals_get_as_df ( date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get historical deals with optional filters as a data frame. Parameters: Name Type Description Default date_from datetime | None Start date (required if not using ticket/position). None date_to datetime | None End date (required if not using ticket/position). None group str | None Optional group filter. None symbol str | None Optional symbol filter. None ticket int | None Get deals by order ticket. None position int | None Get deals by position ticket. None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with historical deal information. Source code in pdmt5/dataframe.py 963 964 965 966 967 968 969 970 971 972 973 974 975 976 977 978 979 980 981 982 983 984 985 986 987 988 989 990 991 992 993 994 995 996 997 998 999 1000 1001 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def history_deals_get_as_df ( self , date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get historical deals with optional filters as a data frame. Args: date_from: Start date (required if not using ticket/position). date_to: End date (required if not using ticket/position). group: Optional group filter. symbol: Optional symbol filter. ticket: Get deals by order ticket. position: Get deals by position ticket. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with historical deal information. \"\"\" return pd . DataFrame ( self . history_deals_get_as_dicts ( date_from = date_from , date_to = date_to , group = group , symbol = symbol , ticket = ticket , position = position , skip_to_datetime = True , ) )","title":"history_deals_get_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.history_deals_get_as_dicts","text":"history_deals_get_as_dicts ( date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get historical deals with optional filters as a list of dictionaries. Parameters: Name Type Description Default date_from datetime | None Start date (required if not using ticket/position). None date_to datetime | None End date (required if not using ticket/position). None group str | None Optional group filter. None symbol str | None Optional symbol filter. None ticket int | None Get deals by order ticket. None position int | None Get deals by position ticket. None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with historical deal information. Source code in pdmt5/dataframe.py 921 922 923 924 925 926 927 928 929 930 931 932 933 934 935 936 937 938 939 940 941 942 943 944 945 946 947 948 949 950 951 952 953 954 955 956 957 958 959 960 961 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def history_deals_get_as_dicts ( self , date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get historical deals with optional filters as a list of dictionaries. Args: date_from: Start date (required if not using ticket/position). date_to: End date (required if not using ticket/position). group: Optional group filter. symbol: Optional symbol filter. ticket: Get deals by order ticket. position: Get deals by position ticket. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with historical deal information. \"\"\" self . _validate_history_input ( date_from = date_from , date_to = date_to , ticket = ticket , position = position , ) return [ d . _asdict () for d in self . history_deals_get ( date_from = date_from , date_to = date_to , group = ( f \"* { symbol } *\" if symbol else group ), ticket = ticket , position = position , ) ]","title":"history_deals_get_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.history_orders_get_as_df","text":"history_orders_get_as_df ( date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get historical orders with optional filters as a data frame. Parameters: Name Type Description Default date_from datetime | None Start date (required if not using ticket/position). None date_to datetime | None End date (required if not using ticket/position). None group str | None Optional group filter. None symbol str | None Optional symbol filter. None ticket int | None Get orders by ticket. None position int | None Get orders by position. None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with historical order information. Source code in pdmt5/dataframe.py 881 882 883 884 885 886 887 888 889 890 891 892 893 894 895 896 897 898 899 900 901 902 903 904 905 906 907 908 909 910 911 912 913 914 915 916 917 918 919 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def history_orders_get_as_df ( self , date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get historical orders with optional filters as a data frame. Args: date_from: Start date (required if not using ticket/position). date_to: End date (required if not using ticket/position). group: Optional group filter. symbol: Optional symbol filter. ticket: Get orders by ticket. position: Get orders by position. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with historical order information. \"\"\" return pd . DataFrame ( self . history_orders_get_as_dicts ( date_from = date_from , date_to = date_to , group = group , symbol = symbol , ticket = ticket , position = position , skip_to_datetime = True , ) )","title":"history_orders_get_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.history_orders_get_as_dicts","text":"history_orders_get_as_dicts ( date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get historical orders with optional filters as a list of dictionaries. Parameters: Name Type Description Default date_from datetime | None Start date (required if not using ticket/position). None date_to datetime | None End date (required if not using ticket/position). None group str | None Optional group filter. None symbol str | None Optional symbol filter. None ticket int | None Get orders by ticket. None position int | None Get orders by position. None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with historical order information. Source code in pdmt5/dataframe.py 839 840 841 842 843 844 845 846 847 848 849 850 851 852 853 854 855 856 857 858 859 860 861 862 863 864 865 866 867 868 869 870 871 872 873 874 875 876 877 878 879 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def history_orders_get_as_dicts ( self , date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get historical orders with optional filters as a list of dictionaries. Args: date_from: Start date (required if not using ticket/position). date_to: End date (required if not using ticket/position). group: Optional group filter. symbol: Optional symbol filter. ticket: Get orders by ticket. position: Get orders by position. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with historical order information. \"\"\" self . _validate_history_input ( date_from = date_from , date_to = date_to , ticket = ticket , position = position , ) return [ o . _asdict () for o in self . history_orders_get ( date_from = date_from , date_to = date_to , group = ( f \"* { symbol } *\" if symbol else group ), ticket = ticket , position = position , ) ]","title":"history_orders_get_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.initialize_and_login_mt5","text":"initialize_and_login_mt5 ( path : str | None = None , login : int | None = None , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> None Initialize MetaTrader5 connection with retry logic. This method overrides the base class to add retry logic and use config values. Parameters: Name Type Description Default path str | None Path to terminal EXE file (overrides config). None login int | None Account login (overrides config). None password str | None Account password (overrides config). None server str | None Server name (overrides config). None timeout int | None Connection timeout (overrides config). None Raises: Type Description Mt5RuntimeError If initialization fails after retries. Source code in pdmt5/dataframe.py 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 def initialize_and_login_mt5 ( self , path : str | None = None , login : int | None = None , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> None : \"\"\"Initialize MetaTrader5 connection with retry logic. This method overrides the base class to add retry logic and use config values. Args: path: Path to terminal EXE file (overrides config). login: Account login (overrides config). password: Account password (overrides config). server: Server name (overrides config). timeout: Connection timeout (overrides config). Raises: Mt5RuntimeError: If initialization fails after retries. \"\"\" path = path or self . config . path login_kwargs = { \"login\" : login or self . config . login , \"password\" : password or self . config . password , \"server\" : server or self . config . server , \"timeout\" : timeout or self . config . timeout , } for i in range ( 1 + max ( 0 , self . retry_count )): if i : self . logger . warning ( \"Retrying MT5 initialization ( %d / %d )...\" , i , self . retry_count , ) time . sleep ( i ) if self . initialize ( path = path , ** login_kwargs ) and ( ( not login_kwargs [ \"login\" ]) or self . login ( ** login_kwargs ) ): return error_message = ( f \"MT5 initialize and login failed after { self . retry_count } retries:\" f \" { self . last_error () } \" ) raise Mt5RuntimeError ( error_message )","title":"initialize_and_login_mt5"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.last_error_as_df","text":"last_error_as_df ( index_keys : str | None = None , ) -> DataFrame Get the last error information as a data frame. Parameters: Name Type Description Default index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with last error information. Source code in pdmt5/dataframe.py 134 135 136 137 138 139 140 141 142 143 144 @set_index_if_possible ( index_parameters = \"index_keys\" ) def last_error_as_df ( self , index_keys : str | None = None ) -> pd . DataFrame : # noqa: ARG002 \"\"\"Get the last error information as a data frame. Args: index_keys: Column name to set as index if provided. Returns: DataFrame with last error information. \"\"\" return pd . DataFrame ([ self . last_error_as_dict ()])","title":"last_error_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.last_error_as_dict","text":"last_error_as_dict () -> dict [ str , Any ] Get the last error information as a dictionary. Returns: Type Description dict [ str , Any ] Dictionary with last error information. Source code in pdmt5/dataframe.py 125 126 127 128 129 130 131 132 def last_error_as_dict ( self ) -> dict [ str , Any ]: \"\"\"Get the last error information as a dictionary. Returns: Dictionary with last error information. \"\"\" response = self . last_error () return { \"error_code\" : response [ 0 ], \"error_description\" : response [ 1 ]}","title":"last_error_as_dict"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.market_book_get_as_df","text":"market_book_get_as_df ( symbol : str , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get market depth for a specified symbol as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with market depth data. Source code in pdmt5/dataframe.py 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def market_book_get_as_df ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get market depth for a specified symbol as a data frame. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with market depth data. \"\"\" return pd . DataFrame ( self . market_book_get_as_dicts ( symbol = symbol , skip_to_datetime = True ) )","title":"market_book_get_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.market_book_get_as_dicts","text":"market_book_get_as_dicts ( symbol : str , skip_to_datetime : bool = False ) -> list [ dict [ str , Any ]] Get market depth for a specified symbol as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with market depth data. Source code in pdmt5/dataframe.py 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def market_book_get_as_dicts ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get market depth for a specified symbol as a list of dictionaries. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with market depth data. \"\"\" return [ b . _asdict () for b in self . market_book_get ( symbol = symbol )]","title":"market_book_get_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.order_check_as_df","text":"order_check_as_df ( request : dict [ str , Any ], index_keys : str | None = None ) -> DataFrame Check funds sufficiency for performing a requested trading operation as a data frame. Parameters: Name Type Description Default request dict [ str , Any ] Order request parameters. required index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with order check results. Source code in pdmt5/dataframe.py 727 728 729 730 731 732 733 734 735 736 737 738 739 740 741 742 743 744 745 746 @set_index_if_possible ( index_parameters = \"index_keys\" ) def order_check_as_df ( self , request : dict [ str , Any ], index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Check funds sufficiency for performing a requested trading operation as a data frame. Args: request: Order request parameters. index_keys: Column name to set as index if provided. Returns: DataFrame with order check results. \"\"\" # noqa: E501 return pd . DataFrame ([ self . _flatten_dict_to_one_level ( dictionary = self . order_check_as_dict ( request = request ), ) ])","title":"order_check_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.order_check_as_dict","text":"order_check_as_dict ( request : dict [ str , Any ], ) -> dict [ str , Any ] Check funds sufficiency for performing a requested trading operation as a dictionary. Parameters: Name Type Description Default request dict [ str , Any ] Order request parameters. required Returns: Type Description dict [ str , Any ] Dictionary with order check results. Source code in pdmt5/dataframe.py 713 714 715 716 717 718 719 720 721 722 723 724 725 def order_check_as_dict ( self , request : dict [ str , Any ]) -> dict [ str , Any ]: \"\"\"Check funds sufficiency for performing a requested trading operation as a dictionary. Args: request: Order request parameters. Returns: Dictionary with order check results. \"\"\" # noqa: E501 return { k : ( v . _asdict () if k == \"request\" else v ) for k , v in self . order_check ( request = request ) . _asdict () . items () }","title":"order_check_as_dict"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.order_send_as_df","text":"order_send_as_df ( request : dict [ str , Any ], index_keys : str | None = None ) -> DataFrame Send a request to perform a trading operation from the terminal to the trade server as a data frame. Parameters: Name Type Description Default request dict [ str , Any ] Order request parameters. required index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with order send results. Source code in pdmt5/dataframe.py 762 763 764 765 766 767 768 769 770 771 772 773 774 775 776 777 778 779 780 781 @set_index_if_possible ( index_parameters = \"index_keys\" ) def order_send_as_df ( self , request : dict [ str , Any ], index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Send a request to perform a trading operation from the terminal to the trade server as a data frame. Args: request: Order request parameters. index_keys: Column name to set as index if provided. Returns: DataFrame with order send results. \"\"\" # noqa: E501 return pd . DataFrame ([ self . _flatten_dict_to_one_level ( dictionary = self . order_send_as_dict ( request = request ), ) ])","title":"order_send_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.order_send_as_dict","text":"order_send_as_dict ( request : dict [ str , Any ], ) -> dict [ str , Any ] Send a request to perform a trading operation from the terminal to the trade server as a dictionary. Parameters: Name Type Description Default request dict [ str , Any ] Order request parameters. required Returns: Type Description dict [ str , Any ] Dictionary with order send results. Source code in pdmt5/dataframe.py 748 749 750 751 752 753 754 755 756 757 758 759 760 def order_send_as_dict ( self , request : dict [ str , Any ]) -> dict [ str , Any ]: \"\"\"Send a request to perform a trading operation from the terminal to the trade server as a dictionary. Args: request: Order request parameters. Returns: Dictionary with order send results. \"\"\" # noqa: E501 return { k : ( v . _asdict () if k == \"request\" else v ) for k , v in self . order_send ( request = request ) . _asdict () . items () }","title":"order_send_as_dict"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.orders_get_as_df","text":"orders_get_as_df ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get active orders with optional filters as a data frame. Parameters: Name Type Description Default symbol str | None Optional symbol filter. None group str | None Optional group filter. None ticket int | None Optional order ticket filter. None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with order information or empty DataFrame if no orders. Source code in pdmt5/dataframe.py 682 683 684 685 686 687 688 689 690 691 692 693 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def orders_get_as_df ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get active orders with optional filters as a data frame. Args: symbol: Optional symbol filter. group: Optional group filter. ticket: Optional order ticket filter. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with order information or empty DataFrame if no orders. \"\"\" return pd . DataFrame ( self . orders_get_as_dicts ( symbol = symbol , group = group , ticket = ticket , skip_to_datetime = True , ) )","title":"orders_get_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.orders_get_as_dicts","text":"orders_get_as_dicts ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get active orders with optional filters as a list of dictionaries. Parameters: Name Type Description Default symbol str | None Optional symbol filter. None group str | None Optional group filter. None ticket int | None Optional order ticket filter. None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with order information or empty list if no orders. Source code in pdmt5/dataframe.py 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 675 676 677 678 679 680 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def orders_get_as_dicts ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get active orders with optional filters as a list of dictionaries. Args: symbol: Optional symbol filter. group: Optional group filter. ticket: Optional order ticket filter. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with order information or empty list if no orders. \"\"\" return [ o . _asdict () for o in self . orders_get ( symbol = symbol , group = group , ticket = ticket ) ]","title":"orders_get_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.positions_get_as_df","text":"positions_get_as_df ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get open positions with optional filters as a data frame. Parameters: Name Type Description Default symbol str | None Optional symbol filter. None group str | None Optional group filter. None ticket int | None Optional position ticket filter. None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with position information or empty DataFrame if no positions. Source code in pdmt5/dataframe.py 808 809 810 811 812 813 814 815 816 817 818 819 820 821 822 823 824 825 826 827 828 829 830 831 832 833 834 835 836 837 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def positions_get_as_df ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get open positions with optional filters as a data frame. Args: symbol: Optional symbol filter. group: Optional group filter. ticket: Optional position ticket filter. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with position information or empty DataFrame if no positions. \"\"\" return pd . DataFrame ( self . positions_get_as_dicts ( symbol = symbol , group = group , ticket = ticket , skip_to_datetime = True , ) )","title":"positions_get_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.positions_get_as_dicts","text":"positions_get_as_dicts ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get open positions with optional filters as a list of dictionaries. Parameters: Name Type Description Default symbol str | None Optional symbol filter. None group str | None Optional group filter. None ticket int | None Optional position ticket filter. None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with position information or empty list if no list [ dict [ str , Any ]] positions. Source code in pdmt5/dataframe.py 783 784 785 786 787 788 789 790 791 792 793 794 795 796 797 798 799 800 801 802 803 804 805 806 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def positions_get_as_dicts ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get open positions with optional filters as a list of dictionaries. Args: symbol: Optional symbol filter. group: Optional group filter. ticket: Optional position ticket filter. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with position information or empty list if no positions. \"\"\" return [ p . _asdict () for p in self . positions_get ( symbol = symbol , group = group , ticket = ticket ) ]","title":"positions_get_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbol_info_as_df","text":"symbol_info_as_df ( symbol : str , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get data on a specific symbol as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with symbol information. Source code in pdmt5/dataframe.py 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbol_info_as_df ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get data on a specific symbol as a data frame. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with symbol information. \"\"\" return pd . DataFrame ([ self . symbol_info_as_dict ( symbol = symbol , skip_to_datetime = True ) ])","title":"symbol_info_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbol_info_as_dict","text":"symbol_info_as_dict ( symbol : str , skip_to_datetime : bool = False ) -> dict [ str , Any ] Get data on a specific symbol as a dictionary. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description dict [ str , Any ] Dictionary with symbol information. Source code in pdmt5/dataframe.py 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbol_info_as_dict ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 ) -> dict [ str , Any ]: \"\"\"Get data on a specific symbol as a dictionary. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. Returns: Dictionary with symbol information. \"\"\" return self . symbol_info ( symbol = symbol ) . _asdict ()","title":"symbol_info_as_dict"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbol_info_tick_as_df","text":"symbol_info_tick_as_df ( symbol : str , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get the last tick for the specified financial instrument as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with tick information. Source code in pdmt5/dataframe.py 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbol_info_tick_as_df ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get the last tick for the specified financial instrument as a data frame. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with tick information. \"\"\" return pd . DataFrame ([ self . symbol_info_tick_as_dict ( symbol = symbol , skip_to_datetime = True ) ])","title":"symbol_info_tick_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbol_info_tick_as_dict","text":"symbol_info_tick_as_dict ( symbol : str , skip_to_datetime : bool = False ) -> dict [ str , Any ] Get the last tick for the specified financial instrument as a dictionary. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description dict [ str , Any ] Dictionary with tick information. Source code in pdmt5/dataframe.py 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbol_info_tick_as_dict ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 ) -> dict [ str , Any ]: \"\"\"Get the last tick for the specified financial instrument as a dictionary. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. Returns: Dictionary with tick information. \"\"\" return self . symbol_info_tick ( symbol = symbol ) . _asdict ()","title":"symbol_info_tick_as_dict"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbols_get_as_df","text":"symbols_get_as_df ( group : str | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get symbols as a data frame. Parameters: Name Type Description Default group str | None Symbol group filter (e.g., \" USD \", \"Forex*\"). None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with symbol information. Source code in pdmt5/dataframe.py 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbols_get_as_df ( self , group : str | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get symbols as a data frame. Args: group: Symbol group filter (e.g., \"*USD*\", \"Forex*\"). skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with symbol information. \"\"\" return pd . DataFrame ( self . symbols_get_as_dicts ( group = group , skip_to_datetime = True ) )","title":"symbols_get_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbols_get_as_dicts","text":"symbols_get_as_dicts ( group : str | None = None , skip_to_datetime : bool = False ) -> list [ dict [ str , Any ]] Get symbols as a list of dictionaries. Parameters: Name Type Description Default group str | None Symbol group filter (e.g., \" USD \", \"Forex*\"). None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with symbol information. Source code in pdmt5/dataframe.py 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbols_get_as_dicts ( self , group : str | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get symbols as a list of dictionaries. Args: group: Symbol group filter (e.g., \"*USD*\", \"Forex*\"). skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with symbol information. \"\"\" return [ s . _asdict () for s in self . symbols_get ( group = group )]","title":"symbols_get_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.terminal_info_as_df","text":"terminal_info_as_df ( index_keys : str | None = None , ) -> DataFrame Get the connected terminal status and settings as a data frame. Parameters: Name Type Description Default index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with terminal information. Source code in pdmt5/dataframe.py 174 175 176 177 178 179 180 181 182 183 184 @set_index_if_possible ( index_parameters = \"index_keys\" ) def terminal_info_as_df ( self , index_keys : str | None = None ) -> pd . DataFrame : # noqa: ARG002 \"\"\"Get the connected terminal status and settings as a data frame. Args: index_keys: Column name to set as index if provided. Returns: DataFrame with terminal information. \"\"\" return pd . DataFrame ([ self . terminal_info_as_dict ()])","title":"terminal_info_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.terminal_info_as_dict","text":"terminal_info_as_dict () -> dict [ str , Any ] Get the connected terminal status and settings as a dictionary. Returns: Type Description dict [ str , Any ] Dictionary with terminal information. Source code in pdmt5/dataframe.py 166 167 168 169 170 171 172 def terminal_info_as_dict ( self ) -> dict [ str , Any ]: \"\"\"Get the connected terminal status and settings as a dictionary. Returns: Dictionary with terminal information. \"\"\" return self . terminal_info () . _asdict ()","title":"terminal_info_as_dict"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.version_as_df","text":"version_as_df ( index_keys : str | None = None ) -> DataFrame Return MetaTrader5 version information as a data frame. Parameters: Name Type Description Default index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with MetaTrader5 version information. Source code in pdmt5/dataframe.py 113 114 115 116 117 118 119 120 121 122 123 @set_index_if_possible ( index_parameters = \"index_keys\" ) def version_as_df ( self , index_keys : str | None = None ) -> pd . DataFrame : # noqa: ARG002 \"\"\"Return MetaTrader5 version information as a data frame. Args: index_keys: Column name to set as index if provided. Returns: DataFrame with MetaTrader5 version information. \"\"\" return pd . DataFrame ([ self . version_as_dict ()])","title":"version_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.version_as_dict","text":"version_as_dict () -> dict [ str , int | str ] Return MetaTrader5 version information as a dictionary. Returns: Type Description dict [ str , int | str ] Dictionary with MetaTrader5 version information. Source code in pdmt5/dataframe.py 100 101 102 103 104 105 106 107 108 109 110 111 def version_as_dict ( self ) -> dict [ str , int | str ]: \"\"\"Return MetaTrader5 version information as a dictionary. Returns: Dictionary with MetaTrader5 version information. \"\"\" response = self . version () return { \"mt5_terminal_version\" : response [ 0 ], \"build\" : response [ 1 ], \"build_release_date\" : response [ 2 ], }","title":"version_as_dict"},{"location":"api/dataframe/#overview","text":"The dataframe module extends the base Mt5Client with pandas-friendly functionality for connecting to MetaTrader 5 and retrieving trading data as pandas DataFrames. It includes configuration management, automatic data conversion, and comprehensive validation utilities.","title":"Overview"},{"location":"api/dataframe/#classes","text":"","title":"Classes"},{"location":"api/dataframe/#mt5config","text":"","title":"Mt5Config"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config","text":"Bases: BaseModel Configuration for MetaTrader5 connection.","title":"Mt5Config"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.login","text":"login : int | None = Field ( default = None , description = \"Trading account login\" )","title":"login"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.model_config","text":"model_config = ConfigDict ( frozen = True )","title":"model_config"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.password","text":"password : str | None = Field ( default = None , description = \"Trading account password\" )","title":"password"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.path","text":"path : str | None = Field ( default = None , description = \"Path to MetaTrader5 terminal EXE file\" , )","title":"path"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.server","text":"server : str | None = Field ( default = None , description = \"Trading server name\" )","title":"server"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5Config.timeout","text":"timeout : int | None = Field ( default = None , description = \"Connection timeout in milliseconds\" , ) options: show_bases: false Configuration class for MetaTrader 5 connection parameters using pydantic for validation.","title":"timeout"},{"location":"api/dataframe/#mt5dataclient","text":"","title":"Mt5DataClient"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient","text":"Bases: Mt5Client MetaTrader5 data client with pandas DataFrame and dictionary conversion. This class provides a pandas-friendly interface to MetaTrader5 functions, converting native MetaTrader5 data structures to pandas DataFrames with pydantic validation.","title":"Mt5DataClient"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.config","text":"config : Mt5Config = Field ( default_factory = Mt5Config , description = \"MetaTrader5 connection configuration\" , )","title":"config"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.model_config","text":"model_config = ConfigDict ( arbitrary_types_allowed = True )","title":"model_config"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.retry_count","text":"retry_count : int = Field ( default = 3 , ge = 0 , description = \"Number of retry attempts for connection initialization\" , )","title":"retry_count"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.account_info_as_df","text":"account_info_as_df ( index_keys : str | None = None , ) -> DataFrame Get info on the current account as a data frame. Parameters: Name Type Description Default index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with account information. Source code in pdmt5/dataframe.py 154 155 156 157 158 159 160 161 162 163 164 @set_index_if_possible ( index_parameters = \"index_keys\" ) def account_info_as_df ( self , index_keys : str | None = None ) -> pd . DataFrame : # noqa: ARG002 \"\"\"Get info on the current account as a data frame. Args: index_keys: Column name to set as index if provided. Returns: DataFrame with account information. \"\"\" return pd . DataFrame ([ self . account_info_as_dict ()])","title":"account_info_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.account_info_as_dict","text":"account_info_as_dict () -> dict [ str , Any ] Get info on the current account as a dictionary. Returns: Type Description dict [ str , Any ] Dictionary with account information. Source code in pdmt5/dataframe.py 146 147 148 149 150 151 152 def account_info_as_dict ( self ) -> dict [ str , Any ]: \"\"\"Get info on the current account as a dictionary. Returns: Dictionary with account information. \"\"\" return self . account_info () . _asdict ()","title":"account_info_as_dict"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_from_as_df","text":"copy_rates_from_as_df ( symbol : str , timeframe : int , date_from : datetime , count : int , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get bars for a specified date range as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime Start date. required count int Number of rates to retrieve. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with OHLCV data. Source code in pdmt5/dataframe.py 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401 402 403 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_rates_from_as_df ( self , symbol : str , timeframe : int , date_from : datetime , count : int , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get bars for a specified date range as a data frame. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date. count: Number of rates to retrieve. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with OHLCV data. \"\"\" self . _validate_positive_count ( count = count ) return pd . DataFrame ( self . copy_rates_from ( symbol = symbol , timeframe = timeframe , date_from = date_from , count = count , ) )","title":"copy_rates_from_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_from_as_dicts","text":"copy_rates_from_as_dicts ( symbol : str , timeframe : int , date_from : datetime , count : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get bars for a specified date range as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime Start date. required count int Number of rates to retrieve. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with OHLCV data. Source code in pdmt5/dataframe.py 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 def copy_rates_from_as_dicts ( self , symbol : str , timeframe : int , date_from : datetime , count : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get bars for a specified date range as a list of dictionaries. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date. count: Number of rates to retrieve. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with OHLCV data. \"\"\" return self . copy_rates_from_as_df ( symbol = symbol , timeframe = timeframe , date_from = date_from , count = count , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" )","title":"copy_rates_from_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_from_pos_as_df","text":"copy_rates_from_pos_as_df ( symbol : str , timeframe : int , start_pos : int , count : int , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get bars from a specified position as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required start_pos int Start position. required count int Number of rates to retrieve. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with OHLCV data. Source code in pdmt5/dataframe.py 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_rates_from_pos_as_df ( self , symbol : str , timeframe : int , start_pos : int , count : int , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get bars from a specified position as a data frame. Args: symbol: Symbol name. timeframe: Timeframe constant. start_pos: Start position. count: Number of rates to retrieve. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with OHLCV data. \"\"\" self . _validate_positive_count ( count = count ) self . _validate_non_negative_position ( position = start_pos ) return pd . DataFrame ( self . copy_rates_from_pos ( symbol = symbol , timeframe = timeframe , start_pos = start_pos , count = count , ) )","title":"copy_rates_from_pos_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_from_pos_as_dicts","text":"copy_rates_from_pos_as_dicts ( symbol : str , timeframe : int , start_pos : int , count : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get bars from a specified position as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required start_pos int Start position. required count int Number of rates to retrieve. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with OHLCV data. Source code in pdmt5/dataframe.py 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 def copy_rates_from_pos_as_dicts ( self , symbol : str , timeframe : int , start_pos : int , count : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get bars from a specified position as a list of dictionaries. Args: symbol: Symbol name. timeframe: Timeframe constant. start_pos: Start position. count: Number of rates to retrieve. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with OHLCV data. \"\"\" return self . copy_rates_from_pos_as_df ( symbol = symbol , timeframe = timeframe , start_pos = start_pos , count = count , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" )","title":"copy_rates_from_pos_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_range_as_df","text":"copy_rates_range_as_df ( symbol : str , timeframe : int , date_from : datetime , date_to : datetime , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get bars for a specified date range as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime Start date. required date_to datetime End date. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with OHLCV data. Source code in pdmt5/dataframe.py 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521 522 523 524 525 526 527 528 529 530 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_rates_range_as_df ( self , symbol : str , timeframe : int , date_from : datetime , date_to : datetime , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get bars for a specified date range as a data frame. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date. date_to: End date. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with OHLCV data. \"\"\" self . _validate_date_range ( date_from = date_from , date_to = date_to ) return pd . DataFrame ( self . copy_rates_range ( symbol = symbol , timeframe = timeframe , date_from = date_from , date_to = date_to , ) )","title":"copy_rates_range_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_rates_range_as_dicts","text":"copy_rates_range_as_dicts ( symbol : str , timeframe : int , date_from : datetime , date_to : datetime , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get bars for a specified date range as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime Start date. required date_to datetime End date. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with OHLCV data. Source code in pdmt5/dataframe.py 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 def copy_rates_range_as_dicts ( self , symbol : str , timeframe : int , date_from : datetime , date_to : datetime , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get bars for a specified date range as a list of dictionaries. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date. date_to: End date. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with OHLCV data. \"\"\" return self . copy_rates_range_as_df ( symbol = symbol , timeframe = timeframe , date_from = date_from , date_to = date_to , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" )","title":"copy_rates_range_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_ticks_from_as_df","text":"copy_ticks_from_as_df ( symbol : str , date_from : datetime , count : int , flags : int , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get ticks from a specified date as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime Start date. required count int Number of ticks to retrieve. required flags int Tick flags (use constants from MetaTrader5). required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with tick data. Source code in pdmt5/dataframe.py 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 588 589 590 591 592 593 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_ticks_from_as_df ( self , symbol : str , date_from : datetime , count : int , flags : int , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get ticks from a specified date as a data frame. Args: symbol: Symbol name. date_from: Start date. count: Number of ticks to retrieve. flags: Tick flags (use constants from MetaTrader5). skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with tick data. \"\"\" self . _validate_positive_count ( count = count ) return pd . DataFrame ( self . copy_ticks_from ( symbol = symbol , date_from = date_from , count = count , flags = flags , ) )","title":"copy_ticks_from_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_ticks_from_as_dicts","text":"copy_ticks_from_as_dicts ( symbol : str , date_from : datetime , count : int , flags : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get ticks from a specified date as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime Start date. required count int Number of ticks to retrieve. required flags int Tick flags (use constants from MetaTrader5). required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with tick data. Source code in pdmt5/dataframe.py 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557 558 559 def copy_ticks_from_as_dicts ( self , symbol : str , date_from : datetime , count : int , flags : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get ticks from a specified date as a list of dictionaries. Args: symbol: Symbol name. date_from: Start date. count: Number of ticks to retrieve. flags: Tick flags (use constants from MetaTrader5). skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with tick data. \"\"\" return self . copy_ticks_from_as_df ( symbol = symbol , date_from = date_from , count = count , flags = flags , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" ) # type: ignore[reportReturnType]","title":"copy_ticks_from_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_ticks_range_as_df","text":"copy_ticks_range_as_df ( symbol : str , date_from : datetime , date_to : datetime , flags : int , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get ticks for a specified date range as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime Start date. required date_to datetime End date. required flags int Tick flags (use constants from MetaTrader5). required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with tick data. Source code in pdmt5/dataframe.py 624 625 626 627 628 629 630 631 632 633 634 635 636 637 638 639 640 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def copy_ticks_range_as_df ( self , symbol : str , date_from : datetime , date_to : datetime , flags : int , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get ticks for a specified date range as a data frame. Args: symbol: Symbol name. date_from: Start date. date_to: End date. flags: Tick flags (use constants from MetaTrader5). skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with tick data. \"\"\" self . _validate_date_range ( date_from = date_from , date_to = date_to ) return pd . DataFrame ( self . copy_ticks_range ( symbol = symbol , date_from = date_from , date_to = date_to , flags = flags , ) )","title":"copy_ticks_range_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.copy_ticks_range_as_dicts","text":"copy_ticks_range_as_dicts ( symbol : str , date_from : datetime , date_to : datetime , flags : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get ticks for a specified date range as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime Start date. required date_to datetime End date. required flags int Tick flags (use constants from MetaTrader5). required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with tick data. Source code in pdmt5/dataframe.py 595 596 597 598 599 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 def copy_ticks_range_as_dicts ( self , symbol : str , date_from : datetime , date_to : datetime , flags : int , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]]: \"\"\"Get ticks for a specified date range as a list of dictionaries. Args: symbol: Symbol name. date_from: Start date. date_to: End date. flags: Tick flags (use constants from MetaTrader5). skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with tick data. \"\"\" return self . copy_ticks_range_as_df ( symbol = symbol , date_from = date_from , date_to = date_to , flags = flags , skip_to_datetime = skip_to_datetime , index_keys = None , ) . to_dict ( orient = \"records\" ) # type: ignore[reportReturnType]","title":"copy_ticks_range_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.history_deals_get_as_df","text":"history_deals_get_as_df ( date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get historical deals with optional filters as a data frame. Parameters: Name Type Description Default date_from datetime | None Start date (required if not using ticket/position). None date_to datetime | None End date (required if not using ticket/position). None group str | None Optional group filter. None symbol str | None Optional symbol filter. None ticket int | None Get deals by order ticket. None position int | None Get deals by position ticket. None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with historical deal information. Source code in pdmt5/dataframe.py 963 964 965 966 967 968 969 970 971 972 973 974 975 976 977 978 979 980 981 982 983 984 985 986 987 988 989 990 991 992 993 994 995 996 997 998 999 1000 1001 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def history_deals_get_as_df ( self , date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get historical deals with optional filters as a data frame. Args: date_from: Start date (required if not using ticket/position). date_to: End date (required if not using ticket/position). group: Optional group filter. symbol: Optional symbol filter. ticket: Get deals by order ticket. position: Get deals by position ticket. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with historical deal information. \"\"\" return pd . DataFrame ( self . history_deals_get_as_dicts ( date_from = date_from , date_to = date_to , group = group , symbol = symbol , ticket = ticket , position = position , skip_to_datetime = True , ) )","title":"history_deals_get_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.history_deals_get_as_dicts","text":"history_deals_get_as_dicts ( date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get historical deals with optional filters as a list of dictionaries. Parameters: Name Type Description Default date_from datetime | None Start date (required if not using ticket/position). None date_to datetime | None End date (required if not using ticket/position). None group str | None Optional group filter. None symbol str | None Optional symbol filter. None ticket int | None Get deals by order ticket. None position int | None Get deals by position ticket. None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with historical deal information. Source code in pdmt5/dataframe.py 921 922 923 924 925 926 927 928 929 930 931 932 933 934 935 936 937 938 939 940 941 942 943 944 945 946 947 948 949 950 951 952 953 954 955 956 957 958 959 960 961 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def history_deals_get_as_dicts ( self , date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get historical deals with optional filters as a list of dictionaries. Args: date_from: Start date (required if not using ticket/position). date_to: End date (required if not using ticket/position). group: Optional group filter. symbol: Optional symbol filter. ticket: Get deals by order ticket. position: Get deals by position ticket. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with historical deal information. \"\"\" self . _validate_history_input ( date_from = date_from , date_to = date_to , ticket = ticket , position = position , ) return [ d . _asdict () for d in self . history_deals_get ( date_from = date_from , date_to = date_to , group = ( f \"* { symbol } *\" if symbol else group ), ticket = ticket , position = position , ) ]","title":"history_deals_get_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.history_orders_get_as_df","text":"history_orders_get_as_df ( date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get historical orders with optional filters as a data frame. Parameters: Name Type Description Default date_from datetime | None Start date (required if not using ticket/position). None date_to datetime | None End date (required if not using ticket/position). None group str | None Optional group filter. None symbol str | None Optional symbol filter. None ticket int | None Get orders by ticket. None position int | None Get orders by position. None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with historical order information. Source code in pdmt5/dataframe.py 881 882 883 884 885 886 887 888 889 890 891 892 893 894 895 896 897 898 899 900 901 902 903 904 905 906 907 908 909 910 911 912 913 914 915 916 917 918 919 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def history_orders_get_as_df ( self , date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get historical orders with optional filters as a data frame. Args: date_from: Start date (required if not using ticket/position). date_to: End date (required if not using ticket/position). group: Optional group filter. symbol: Optional symbol filter. ticket: Get orders by ticket. position: Get orders by position. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with historical order information. \"\"\" return pd . DataFrame ( self . history_orders_get_as_dicts ( date_from = date_from , date_to = date_to , group = group , symbol = symbol , ticket = ticket , position = position , skip_to_datetime = True , ) )","title":"history_orders_get_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.history_orders_get_as_dicts","text":"history_orders_get_as_dicts ( date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get historical orders with optional filters as a list of dictionaries. Parameters: Name Type Description Default date_from datetime | None Start date (required if not using ticket/position). None date_to datetime | None End date (required if not using ticket/position). None group str | None Optional group filter. None symbol str | None Optional symbol filter. None ticket int | None Get orders by ticket. None position int | None Get orders by position. None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with historical order information. Source code in pdmt5/dataframe.py 839 840 841 842 843 844 845 846 847 848 849 850 851 852 853 854 855 856 857 858 859 860 861 862 863 864 865 866 867 868 869 870 871 872 873 874 875 876 877 878 879 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def history_orders_get_as_dicts ( self , date_from : datetime | None = None , date_to : datetime | None = None , group : str | None = None , symbol : str | None = None , ticket : int | None = None , position : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get historical orders with optional filters as a list of dictionaries. Args: date_from: Start date (required if not using ticket/position). date_to: End date (required if not using ticket/position). group: Optional group filter. symbol: Optional symbol filter. ticket: Get orders by ticket. position: Get orders by position. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with historical order information. \"\"\" self . _validate_history_input ( date_from = date_from , date_to = date_to , ticket = ticket , position = position , ) return [ o . _asdict () for o in self . history_orders_get ( date_from = date_from , date_to = date_to , group = ( f \"* { symbol } *\" if symbol else group ), ticket = ticket , position = position , ) ]","title":"history_orders_get_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.initialize_and_login_mt5","text":"initialize_and_login_mt5 ( path : str | None = None , login : int | None = None , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> None Initialize MetaTrader5 connection with retry logic. This method overrides the base class to add retry logic and use config values. Parameters: Name Type Description Default path str | None Path to terminal EXE file (overrides config). None login int | None Account login (overrides config). None password str | None Account password (overrides config). None server str | None Server name (overrides config). None timeout int | None Connection timeout (overrides config). None Raises: Type Description Mt5RuntimeError If initialization fails after retries. Source code in pdmt5/dataframe.py 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 def initialize_and_login_mt5 ( self , path : str | None = None , login : int | None = None , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> None : \"\"\"Initialize MetaTrader5 connection with retry logic. This method overrides the base class to add retry logic and use config values. Args: path: Path to terminal EXE file (overrides config). login: Account login (overrides config). password: Account password (overrides config). server: Server name (overrides config). timeout: Connection timeout (overrides config). Raises: Mt5RuntimeError: If initialization fails after retries. \"\"\" path = path or self . config . path login_kwargs = { \"login\" : login or self . config . login , \"password\" : password or self . config . password , \"server\" : server or self . config . server , \"timeout\" : timeout or self . config . timeout , } for i in range ( 1 + max ( 0 , self . retry_count )): if i : self . logger . warning ( \"Retrying MT5 initialization ( %d / %d )...\" , i , self . retry_count , ) time . sleep ( i ) if self . initialize ( path = path , ** login_kwargs ) and ( ( not login_kwargs [ \"login\" ]) or self . login ( ** login_kwargs ) ): return error_message = ( f \"MT5 initialize and login failed after { self . retry_count } retries:\" f \" { self . last_error () } \" ) raise Mt5RuntimeError ( error_message )","title":"initialize_and_login_mt5"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.last_error_as_df","text":"last_error_as_df ( index_keys : str | None = None , ) -> DataFrame Get the last error information as a data frame. Parameters: Name Type Description Default index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with last error information. Source code in pdmt5/dataframe.py 134 135 136 137 138 139 140 141 142 143 144 @set_index_if_possible ( index_parameters = \"index_keys\" ) def last_error_as_df ( self , index_keys : str | None = None ) -> pd . DataFrame : # noqa: ARG002 \"\"\"Get the last error information as a data frame. Args: index_keys: Column name to set as index if provided. Returns: DataFrame with last error information. \"\"\" return pd . DataFrame ([ self . last_error_as_dict ()])","title":"last_error_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.last_error_as_dict","text":"last_error_as_dict () -> dict [ str , Any ] Get the last error information as a dictionary. Returns: Type Description dict [ str , Any ] Dictionary with last error information. Source code in pdmt5/dataframe.py 125 126 127 128 129 130 131 132 def last_error_as_dict ( self ) -> dict [ str , Any ]: \"\"\"Get the last error information as a dictionary. Returns: Dictionary with last error information. \"\"\" response = self . last_error () return { \"error_code\" : response [ 0 ], \"error_description\" : response [ 1 ]}","title":"last_error_as_dict"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.market_book_get_as_df","text":"market_book_get_as_df ( symbol : str , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get market depth for a specified symbol as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with market depth data. Source code in pdmt5/dataframe.py 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def market_book_get_as_df ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get market depth for a specified symbol as a data frame. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with market depth data. \"\"\" return pd . DataFrame ( self . market_book_get_as_dicts ( symbol = symbol , skip_to_datetime = True ) )","title":"market_book_get_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.market_book_get_as_dicts","text":"market_book_get_as_dicts ( symbol : str , skip_to_datetime : bool = False ) -> list [ dict [ str , Any ]] Get market depth for a specified symbol as a list of dictionaries. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with market depth data. Source code in pdmt5/dataframe.py 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def market_book_get_as_dicts ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get market depth for a specified symbol as a list of dictionaries. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with market depth data. \"\"\" return [ b . _asdict () for b in self . market_book_get ( symbol = symbol )]","title":"market_book_get_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.order_check_as_df","text":"order_check_as_df ( request : dict [ str , Any ], index_keys : str | None = None ) -> DataFrame Check funds sufficiency for performing a requested trading operation as a data frame. Parameters: Name Type Description Default request dict [ str , Any ] Order request parameters. required index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with order check results. Source code in pdmt5/dataframe.py 727 728 729 730 731 732 733 734 735 736 737 738 739 740 741 742 743 744 745 746 @set_index_if_possible ( index_parameters = \"index_keys\" ) def order_check_as_df ( self , request : dict [ str , Any ], index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Check funds sufficiency for performing a requested trading operation as a data frame. Args: request: Order request parameters. index_keys: Column name to set as index if provided. Returns: DataFrame with order check results. \"\"\" # noqa: E501 return pd . DataFrame ([ self . _flatten_dict_to_one_level ( dictionary = self . order_check_as_dict ( request = request ), ) ])","title":"order_check_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.order_check_as_dict","text":"order_check_as_dict ( request : dict [ str , Any ], ) -> dict [ str , Any ] Check funds sufficiency for performing a requested trading operation as a dictionary. Parameters: Name Type Description Default request dict [ str , Any ] Order request parameters. required Returns: Type Description dict [ str , Any ] Dictionary with order check results. Source code in pdmt5/dataframe.py 713 714 715 716 717 718 719 720 721 722 723 724 725 def order_check_as_dict ( self , request : dict [ str , Any ]) -> dict [ str , Any ]: \"\"\"Check funds sufficiency for performing a requested trading operation as a dictionary. Args: request: Order request parameters. Returns: Dictionary with order check results. \"\"\" # noqa: E501 return { k : ( v . _asdict () if k == \"request\" else v ) for k , v in self . order_check ( request = request ) . _asdict () . items () }","title":"order_check_as_dict"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.order_send_as_df","text":"order_send_as_df ( request : dict [ str , Any ], index_keys : str | None = None ) -> DataFrame Send a request to perform a trading operation from the terminal to the trade server as a data frame. Parameters: Name Type Description Default request dict [ str , Any ] Order request parameters. required index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with order send results. Source code in pdmt5/dataframe.py 762 763 764 765 766 767 768 769 770 771 772 773 774 775 776 777 778 779 780 781 @set_index_if_possible ( index_parameters = \"index_keys\" ) def order_send_as_df ( self , request : dict [ str , Any ], index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Send a request to perform a trading operation from the terminal to the trade server as a data frame. Args: request: Order request parameters. index_keys: Column name to set as index if provided. Returns: DataFrame with order send results. \"\"\" # noqa: E501 return pd . DataFrame ([ self . _flatten_dict_to_one_level ( dictionary = self . order_send_as_dict ( request = request ), ) ])","title":"order_send_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.order_send_as_dict","text":"order_send_as_dict ( request : dict [ str , Any ], ) -> dict [ str , Any ] Send a request to perform a trading operation from the terminal to the trade server as a dictionary. Parameters: Name Type Description Default request dict [ str , Any ] Order request parameters. required Returns: Type Description dict [ str , Any ] Dictionary with order send results. Source code in pdmt5/dataframe.py 748 749 750 751 752 753 754 755 756 757 758 759 760 def order_send_as_dict ( self , request : dict [ str , Any ]) -> dict [ str , Any ]: \"\"\"Send a request to perform a trading operation from the terminal to the trade server as a dictionary. Args: request: Order request parameters. Returns: Dictionary with order send results. \"\"\" # noqa: E501 return { k : ( v . _asdict () if k == \"request\" else v ) for k , v in self . order_send ( request = request ) . _asdict () . items () }","title":"order_send_as_dict"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.orders_get_as_df","text":"orders_get_as_df ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get active orders with optional filters as a data frame. Parameters: Name Type Description Default symbol str | None Optional symbol filter. None group str | None Optional group filter. None ticket int | None Optional order ticket filter. None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with order information or empty DataFrame if no orders. Source code in pdmt5/dataframe.py 682 683 684 685 686 687 688 689 690 691 692 693 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def orders_get_as_df ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get active orders with optional filters as a data frame. Args: symbol: Optional symbol filter. group: Optional group filter. ticket: Optional order ticket filter. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with order information or empty DataFrame if no orders. \"\"\" return pd . DataFrame ( self . orders_get_as_dicts ( symbol = symbol , group = group , ticket = ticket , skip_to_datetime = True , ) )","title":"orders_get_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.orders_get_as_dicts","text":"orders_get_as_dicts ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get active orders with optional filters as a list of dictionaries. Parameters: Name Type Description Default symbol str | None Optional symbol filter. None group str | None Optional group filter. None ticket int | None Optional order ticket filter. None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with order information or empty list if no orders. Source code in pdmt5/dataframe.py 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 675 676 677 678 679 680 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def orders_get_as_dicts ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get active orders with optional filters as a list of dictionaries. Args: symbol: Optional symbol filter. group: Optional group filter. ticket: Optional order ticket filter. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with order information or empty list if no orders. \"\"\" return [ o . _asdict () for o in self . orders_get ( symbol = symbol , group = group , ticket = ticket ) ]","title":"orders_get_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.positions_get_as_df","text":"positions_get_as_df ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get open positions with optional filters as a data frame. Parameters: Name Type Description Default symbol str | None Optional symbol filter. None group str | None Optional group filter. None ticket int | None Optional position ticket filter. None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with position information or empty DataFrame if no positions. Source code in pdmt5/dataframe.py 808 809 810 811 812 813 814 815 816 817 818 819 820 821 822 823 824 825 826 827 828 829 830 831 832 833 834 835 836 837 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def positions_get_as_df ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get open positions with optional filters as a data frame. Args: symbol: Optional symbol filter. group: Optional group filter. ticket: Optional position ticket filter. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with position information or empty DataFrame if no positions. \"\"\" return pd . DataFrame ( self . positions_get_as_dicts ( symbol = symbol , group = group , ticket = ticket , skip_to_datetime = True , ) )","title":"positions_get_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.positions_get_as_dicts","text":"positions_get_as_dicts ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , ) -> list [ dict [ str , Any ]] Get open positions with optional filters as a list of dictionaries. Parameters: Name Type Description Default symbol str | None Optional symbol filter. None group str | None Optional group filter. None ticket int | None Optional position ticket filter. None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with position information or empty list if no list [ dict [ str , Any ]] positions. Source code in pdmt5/dataframe.py 783 784 785 786 787 788 789 790 791 792 793 794 795 796 797 798 799 800 801 802 803 804 805 806 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def positions_get_as_dicts ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get open positions with optional filters as a list of dictionaries. Args: symbol: Optional symbol filter. group: Optional group filter. ticket: Optional position ticket filter. skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with position information or empty list if no positions. \"\"\" return [ p . _asdict () for p in self . positions_get ( symbol = symbol , group = group , ticket = ticket ) ]","title":"positions_get_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbol_info_as_df","text":"symbol_info_as_df ( symbol : str , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get data on a specific symbol as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with symbol information. Source code in pdmt5/dataframe.py 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbol_info_as_df ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get data on a specific symbol as a data frame. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with symbol information. \"\"\" return pd . DataFrame ([ self . symbol_info_as_dict ( symbol = symbol , skip_to_datetime = True ) ])","title":"symbol_info_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbol_info_as_dict","text":"symbol_info_as_dict ( symbol : str , skip_to_datetime : bool = False ) -> dict [ str , Any ] Get data on a specific symbol as a dictionary. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description dict [ str , Any ] Dictionary with symbol information. Source code in pdmt5/dataframe.py 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbol_info_as_dict ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 ) -> dict [ str , Any ]: \"\"\"Get data on a specific symbol as a dictionary. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. Returns: Dictionary with symbol information. \"\"\" return self . symbol_info ( symbol = symbol ) . _asdict ()","title":"symbol_info_as_dict"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbol_info_tick_as_df","text":"symbol_info_tick_as_df ( symbol : str , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get the last tick for the specified financial instrument as a data frame. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with tick information. Source code in pdmt5/dataframe.py 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbol_info_tick_as_df ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get the last tick for the specified financial instrument as a data frame. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with tick information. \"\"\" return pd . DataFrame ([ self . symbol_info_tick_as_dict ( symbol = symbol , skip_to_datetime = True ) ])","title":"symbol_info_tick_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbol_info_tick_as_dict","text":"symbol_info_tick_as_dict ( symbol : str , skip_to_datetime : bool = False ) -> dict [ str , Any ] Get the last tick for the specified financial instrument as a dictionary. Parameters: Name Type Description Default symbol str Symbol name. required skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description dict [ str , Any ] Dictionary with tick information. Source code in pdmt5/dataframe.py 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbol_info_tick_as_dict ( self , symbol : str , skip_to_datetime : bool = False , # noqa: ARG002 ) -> dict [ str , Any ]: \"\"\"Get the last tick for the specified financial instrument as a dictionary. Args: symbol: Symbol name. skip_to_datetime: Whether to skip converting time to datetime. Returns: Dictionary with tick information. \"\"\" return self . symbol_info_tick ( symbol = symbol ) . _asdict ()","title":"symbol_info_tick_as_dict"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbols_get_as_df","text":"symbols_get_as_df ( group : str | None = None , skip_to_datetime : bool = False , index_keys : str | None = None , ) -> DataFrame Get symbols as a data frame. Parameters: Name Type Description Default group str | None Symbol group filter (e.g., \" USD \", \"Forex*\"). None skip_to_datetime bool Whether to skip converting time to datetime. False index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with symbol information. Source code in pdmt5/dataframe.py 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 @set_index_if_possible ( index_parameters = \"index_keys\" ) @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbols_get_as_df ( self , group : str | None = None , skip_to_datetime : bool = False , # noqa: ARG002 index_keys : str | None = None , # noqa: ARG002 ) -> pd . DataFrame : \"\"\"Get symbols as a data frame. Args: group: Symbol group filter (e.g., \"*USD*\", \"Forex*\"). skip_to_datetime: Whether to skip converting time to datetime. index_keys: Column name to set as index if provided. Returns: DataFrame with symbol information. \"\"\" return pd . DataFrame ( self . symbols_get_as_dicts ( group = group , skip_to_datetime = True ) )","title":"symbols_get_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.symbols_get_as_dicts","text":"symbols_get_as_dicts ( group : str | None = None , skip_to_datetime : bool = False ) -> list [ dict [ str , Any ]] Get symbols as a list of dictionaries. Parameters: Name Type Description Default group str | None Symbol group filter (e.g., \" USD \", \"Forex*\"). None skip_to_datetime bool Whether to skip converting time to datetime. False Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with symbol information. Source code in pdmt5/dataframe.py 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 @detect_and_convert_time_to_datetime ( skip_toggle = \"skip_to_datetime\" ) def symbols_get_as_dicts ( self , group : str | None = None , skip_to_datetime : bool = False , # noqa: ARG002 ) -> list [ dict [ str , Any ]]: \"\"\"Get symbols as a list of dictionaries. Args: group: Symbol group filter (e.g., \"*USD*\", \"Forex*\"). skip_to_datetime: Whether to skip converting time to datetime. Returns: List of dictionaries with symbol information. \"\"\" return [ s . _asdict () for s in self . symbols_get ( group = group )]","title":"symbols_get_as_dicts"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.terminal_info_as_df","text":"terminal_info_as_df ( index_keys : str | None = None , ) -> DataFrame Get the connected terminal status and settings as a data frame. Parameters: Name Type Description Default index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with terminal information. Source code in pdmt5/dataframe.py 174 175 176 177 178 179 180 181 182 183 184 @set_index_if_possible ( index_parameters = \"index_keys\" ) def terminal_info_as_df ( self , index_keys : str | None = None ) -> pd . DataFrame : # noqa: ARG002 \"\"\"Get the connected terminal status and settings as a data frame. Args: index_keys: Column name to set as index if provided. Returns: DataFrame with terminal information. \"\"\" return pd . DataFrame ([ self . terminal_info_as_dict ()])","title":"terminal_info_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.terminal_info_as_dict","text":"terminal_info_as_dict () -> dict [ str , Any ] Get the connected terminal status and settings as a dictionary. Returns: Type Description dict [ str , Any ] Dictionary with terminal information. Source code in pdmt5/dataframe.py 166 167 168 169 170 171 172 def terminal_info_as_dict ( self ) -> dict [ str , Any ]: \"\"\"Get the connected terminal status and settings as a dictionary. Returns: Dictionary with terminal information. \"\"\" return self . terminal_info () . _asdict ()","title":"terminal_info_as_dict"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.version_as_df","text":"version_as_df ( index_keys : str | None = None ) -> DataFrame Return MetaTrader5 version information as a data frame. Parameters: Name Type Description Default index_keys str | None Column name to set as index if provided. None Returns: Type Description DataFrame DataFrame with MetaTrader5 version information. Source code in pdmt5/dataframe.py 113 114 115 116 117 118 119 120 121 122 123 @set_index_if_possible ( index_parameters = \"index_keys\" ) def version_as_df ( self , index_keys : str | None = None ) -> pd . DataFrame : # noqa: ARG002 \"\"\"Return MetaTrader5 version information as a data frame. Args: index_keys: Column name to set as index if provided. Returns: DataFrame with MetaTrader5 version information. \"\"\" return pd . DataFrame ([ self . version_as_dict ()])","title":"version_as_df"},{"location":"api/dataframe/#pdmt5.dataframe.Mt5DataClient.version_as_dict","text":"version_as_dict () -> dict [ str , int | str ] Return MetaTrader5 version information as a dictionary. Returns: Type Description dict [ str , int | str ] Dictionary with MetaTrader5 version information. Source code in pdmt5/dataframe.py 100 101 102 103 104 105 106 107 108 109 110 111 def version_as_dict ( self ) -> dict [ str , int | str ]: \"\"\"Return MetaTrader5 version information as a dictionary. Returns: Dictionary with MetaTrader5 version information. \"\"\" response = self . version () return { \"mt5_terminal_version\" : response [ 0 ], \"build\" : response [ 1 ], \"build_release_date\" : response [ 2 ], } options: show_bases: false Extended client class that inherits from Mt5Client and provides a pandas-friendly interface to MetaTrader 5 functions with automatic DataFrame conversion.","title":"version_as_dict"},{"location":"api/dataframe/#usage-examples","text":"","title":"Usage Examples"},{"location":"api/dataframe/#basic-connection","text":"import MetaTrader5 as mt5 from pdmt5.dataframe import Mt5DataClient , Mt5Config # Create configuration config = Mt5Config ( login = 123456 , password = \"your_password\" , server = \"broker_server\" ) # Create client client = Mt5DataClient ( mt5 = mt5 , config = config ) # Use as context manager with client : # Get account information account_df = client . account_info () print ( account_df )","title":"Basic Connection"},{"location":"api/dataframe/#retrieving-market-data","text":"from datetime import datetime import MetaTrader5 as mt5 with client : # Get OHLCV data rates_df = client . copy_rates_from ( symbol = \"EURUSD\" , timeframe = mt5 . TIMEFRAME_H1 , date_from = datetime ( 2024 , 1 , 1 ), count = 1000 ) # Get tick data ticks_df = client . copy_ticks_from ( symbol = \"EURUSD\" , date_from = datetime ( 2024 , 1 , 1 ), count = 1000 , flags = mt5 . COPY_TICKS_ALL )","title":"Retrieving Market Data"},{"location":"api/dataframe/#symbol-information","text":"with client : # Get all symbols symbols_df = client . symbols_get () # Get specific symbol info symbol_info_df = client . symbol_info ( \"EURUSD\" ) # Get current tick tick_df = client . symbol_info_tick ( \"EURUSD\" )","title":"Symbol Information"},{"location":"api/dataframe/#trading-history","text":"from datetime import datetime with client : # Get historical orders orders_df = client . history_orders_get ( date_from = datetime ( 2024 , 1 , 1 ), date_to = datetime ( 2024 , 1 , 31 ), symbol = \"EURUSD\" ) # Get historical deals deals_df = client . history_deals_get ( date_from = datetime ( 2024 , 1 , 1 ), date_to = datetime ( 2024 , 1 , 31 ) )","title":"Trading History"},{"location":"api/dataframe/#current-positions-and-orders","text":"with client : # Get current positions positions_df = client . positions_get () # Get current orders orders_df = client . orders_get ( symbol = \"EURUSD\" )","title":"Current Positions and Orders"},{"location":"api/dataframe/#data-conversion-features","text":"The Mt5DataClient automatically handles: Time Conversion : Converts Unix timestamps to pandas datetime objects Index Setting : Sets appropriate datetime indexes for time-series data DataFrame Creation : Converts MetaTrader 5 named tuples to pandas DataFrames Error Handling : Provides meaningful error messages for failed operations Empty Data : Returns empty DataFrames when no data is available","title":"Data Conversion Features"},{"location":"api/dataframe/#error-handling","text":"All methods raise Mt5RuntimeError exceptions with detailed error information when operations fail: from pdmt5.mt5 import Mt5RuntimeError try : rates_df = client . copy_rates_from ( \"INVALID\" , mt5 . TIMEFRAME_H1 , datetime . now (), 100 ) except Mt5RuntimeError as e : print ( f \"MetaTrader 5 error: { e } \" )","title":"Error Handling"},{"location":"api/dataframe/#connection-management","text":"The client supports both explicit and context manager usage: # Explicit initialization client . initialize () try : # Your trading operations pass finally : client . shutdown () # Context manager (recommended) with client : # Your trading operations pass","title":"Connection Management"},{"location":"api/dataframe/#type-safety","text":"All methods include comprehensive type hints and use pydantic for configuration validation, ensuring type safety throughout the codebase.","title":"Type Safety"},{"location":"api/deployment/","text":"Deployment Guide (Windows Service) \u00b6 This guide describes how to deploy the pdmt5 REST API as a Windows service alongside the MetaTrader 5 terminal. Prerequisites \u00b6 Windows 10/11 MetaTrader 5 installed and logged in Python 3.11+ pdmt5[api] installed Service Setup (NSSM) \u00b6 Download NSSM: https://nssm.cc/download Open an elevated PowerShell session. Create a service: nssm install pdmt5-api Set the application path and arguments: Path: C:\\Path\\To\\Python\\python.exe Arguments: -m uvicorn pdmt5.api.main:app --host 0.0.0.0 --port 8000 Startup directory: your project directory Set environment variables in the NSSM GUI: MT5_API_KEY=your-secret-api-key API_LOG_LEVEL=INFO API_RATE_LIMIT=100 API_CORS_ORIGINS=* Start the service: nssm start pdmt5-api Validation \u00b6 curl http :// localhost : 8000 / api / v1 / health Expected status: healthy (or unhealthy if MT5 is not connected). Troubleshooting \u00b6 Ensure the MT5 terminal is running and logged in. Confirm firewall rules allow inbound traffic on the API port. Check Windows Event Viewer for NSSM service logs.","title":"Deployment"},{"location":"api/deployment/#deployment-guide-windows-service","text":"This guide describes how to deploy the pdmt5 REST API as a Windows service alongside the MetaTrader 5 terminal.","title":"Deployment Guide (Windows Service)"},{"location":"api/deployment/#prerequisites","text":"Windows 10/11 MetaTrader 5 installed and logged in Python 3.11+ pdmt5[api] installed","title":"Prerequisites"},{"location":"api/deployment/#service-setup-nssm","text":"Download NSSM: https://nssm.cc/download Open an elevated PowerShell session. Create a service: nssm install pdmt5-api Set the application path and arguments: Path: C:\\Path\\To\\Python\\python.exe Arguments: -m uvicorn pdmt5.api.main:app --host 0.0.0.0 --port 8000 Startup directory: your project directory Set environment variables in the NSSM GUI: MT5_API_KEY=your-secret-api-key API_LOG_LEVEL=INFO API_RATE_LIMIT=100 API_CORS_ORIGINS=* Start the service: nssm start pdmt5-api","title":"Service Setup (NSSM)"},{"location":"api/deployment/#validation","text":"curl http :// localhost : 8000 / api / v1 / health Expected status: healthy (or unhealthy if MT5 is not connected).","title":"Validation"},{"location":"api/deployment/#troubleshooting","text":"Ensure the MT5 terminal is running and logged in. Confirm firewall rules allow inbound traffic on the API port. Check Windows Event Viewer for NSSM service logs.","title":"Troubleshooting"},{"location":"api/mt5/","text":"Mt5Client \u00b6 pdmt5.mt5 \u00b6 MetaTrader5 client wrapper class. Mt5Client \u00b6 Bases: BaseModel MetaTrader5 client class. This class provides a wrapper interface to all MetaTrader5 functions, delegating calls to the underlying MetaTrader5 module while providing error handling and logging capabilities. logger class-attribute instance-attribute \u00b6 logger : Logger = Field ( default_factory = lambda : getLogger ( __name__ ), description = \"Logger instance for MetaTrader5 operations\" , ) model_config class-attribute instance-attribute \u00b6 model_config = ConfigDict ( arbitrary_types_allowed = True ) mt5 class-attribute instance-attribute \u00b6 mt5 : ModuleType = Field ( default_factory = lambda : import_module ( \"MetaTrader5\" ), description = \"MetaTrader5 module instance\" , ) __enter__ \u00b6 __enter__ () -> Self Context manager entry. Returns: Name Type Description Mt5Client Self The client instance. Source code in pdmt5/mt5.py 83 84 85 86 87 88 89 90 def __enter__ ( self ) -> Self : \"\"\"Context manager entry. Returns: Mt5Client: The client instance. \"\"\" self . initialize () return self __exit__ \u00b6 __exit__ ( exc_type : type [ BaseException ] | None , exc_val : BaseException | None , exc_tb : TracebackType | None , ) -> None Context manager exit. Source code in pdmt5/mt5.py 92 93 94 95 96 97 98 99 def __exit__ ( self , exc_type : type [ BaseException ] | None , exc_val : BaseException | None , exc_tb : TracebackType | None , ) -> None : \"\"\"Context manager exit.\"\"\" self . shutdown () account_info \u00b6 account_info () -> Any Get info on the current trading account. Returns: Type Description Any AccountInfo structure or None. Source code in pdmt5/mt5.py 208 209 210 211 212 213 214 215 216 217 218 219 220 221 @_log_mt5_last_status_code def account_info ( self ) -> Any : \"\"\"Get info on the current trading account. Returns: AccountInfo structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving account information.\" ) response = self . mt5 . account_info () self . _validate_mt5_response_is_not_none ( response = response , operation = \"account_info\" ) return response copy_rates_from \u00b6 copy_rates_from ( symbol : str , timeframe : int , date_from : datetime | int , count : int , ) -> Any Get bars from the terminal starting from the specified date. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime | int Start date or timestamp. required count int Number of bars to retrieve. required Returns: Type Description Any Array of rates or None. Source code in pdmt5/mt5.py 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 433 @_log_mt5_last_status_code def copy_rates_from ( self , symbol : str , timeframe : int , date_from : datetime | int , count : int , ) -> Any : \"\"\"Get bars from the terminal starting from the specified date. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date or timestamp. count: Number of bars to retrieve. Returns: Array of rates or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Copying rates from symbol: %s , timeframe: %d , date_from: %s , count: %d \" , symbol , timeframe , date_from , count , ) response = self . mt5 . copy_rates_from ( symbol , timeframe , date_from , count ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_rates_from\" , context = ( f \"symbol= { symbol } , timeframe= { timeframe } ,\" f \" date_from= { date_from } , count= { count } \" ), ) return response copy_rates_from_pos \u00b6 copy_rates_from_pos ( symbol : str , timeframe : int , start_pos : int , count : int ) -> Any Get bars from the terminal starting from the specified index. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required start_pos int Starting position. required count int Number of bars to retrieve. required Returns: Type Description Any Array of rates or None. Source code in pdmt5/mt5.py 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 @_log_mt5_last_status_code def copy_rates_from_pos ( self , symbol : str , timeframe : int , start_pos : int , count : int , ) -> Any : \"\"\"Get bars from the terminal starting from the specified index. Args: symbol: Symbol name. timeframe: Timeframe constant. start_pos: Starting position. count: Number of bars to retrieve. Returns: Array of rates or None. \"\"\" self . _initialize_if_needed () self . logger . info ( ( \"Copying rates from position:\" \" symbol= %s , timeframe= %d , start_pos= %d , count= %d \" ), symbol , timeframe , start_pos , count , ) response = self . mt5 . copy_rates_from_pos ( symbol , timeframe , start_pos , count ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_rates_from_pos\" , context = ( f \"symbol= { symbol } , timeframe= { timeframe } ,\" f \" start_pos= { start_pos } , count= { count } \" ), ) return response copy_rates_range \u00b6 copy_rates_range ( symbol : str , timeframe : int , date_from : datetime | int , date_to : datetime | int , ) -> Any Get bars in the specified date range from the terminal. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime | int Start date or timestamp. required date_to datetime | int End date or timestamp. required Returns: Type Description Any Array of rates or None. Source code in pdmt5/mt5.py 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 @_log_mt5_last_status_code def copy_rates_range ( self , symbol : str , timeframe : int , date_from : datetime | int , date_to : datetime | int , ) -> Any : \"\"\"Get bars in the specified date range from the terminal. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date or timestamp. date_to: End date or timestamp. Returns: Array of rates or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Copying rates range: symbol= %s , timeframe= %d , date_from= %s , date_to= %s \" , symbol , timeframe , date_from , date_to , ) response = self . mt5 . copy_rates_range ( symbol , timeframe , date_from , date_to ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_rates_range\" , context = ( f \"symbol= { symbol } , timeframe= { timeframe } ,\" f \" date_from= { date_from } , date_to= { date_to } \" ), ) return response copy_ticks_from \u00b6 copy_ticks_from ( symbol : str , date_from : datetime | int , count : int , flags : int , ) -> Any Get ticks from the terminal starting from the specified date. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime | int Start date or timestamp. required count int Number of ticks to retrieve. required flags int Tick flags. required Returns: Type Description Any Array of ticks or None. Source code in pdmt5/mt5.py 514 515 516 517 518 519 520 521 522 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 @_log_mt5_last_status_code def copy_ticks_from ( self , symbol : str , date_from : datetime | int , count : int , flags : int , ) -> Any : \"\"\"Get ticks from the terminal starting from the specified date. Args: symbol: Symbol name. date_from: Start date or timestamp. count: Number of ticks to retrieve. flags: Tick flags. Returns: Array of ticks or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Copying ticks from symbol: %s , date_from: %s , count: %d , flags: %d \" , symbol , date_from , count , flags , ) response = self . mt5 . copy_ticks_from ( symbol , date_from , count , flags ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_ticks_from\" , context = ( f \"symbol= { symbol } , date_from= { date_from } , count= { count } , flags= { flags } \" ), ) return response copy_ticks_range \u00b6 copy_ticks_range ( symbol : str , date_from : datetime | int , date_to : datetime | int , flags : int , ) -> Any Get ticks for the specified date range from the terminal. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime | int Start date or timestamp. required date_to datetime | int End date or timestamp. required flags int Tick flags. required Returns: Type Description Any Array of ticks or None. Source code in pdmt5/mt5.py 551 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 @_log_mt5_last_status_code def copy_ticks_range ( self , symbol : str , date_from : datetime | int , date_to : datetime | int , flags : int , ) -> Any : \"\"\"Get ticks for the specified date range from the terminal. Args: symbol: Symbol name. date_from: Start date or timestamp. date_to: End date or timestamp. flags: Tick flags. Returns: Array of ticks or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Copying ticks range: symbol= %s , date_from= %s , date_to= %s , flags= %d \" , symbol , date_from , date_to , flags , ) response = self . mt5 . copy_ticks_range ( symbol , date_from , date_to , flags ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_ticks_range\" , context = ( f \"symbol= { symbol } , date_from= { date_from } ,\" f \" date_to= { date_to } , flags= { flags } \" ), ) return response history_deals_get \u00b6 history_deals_get ( date_from : datetime | int | None = None , date_to : datetime | int | None = None , group : str | None = None , ticket : int | None = None , position : int | None = None , ) -> tuple [ Any , ... ] Get deals from trading history within the specified interval with the ability to filter by ticket or position. Parameters: Name Type Description Default date_from datetime | int | None Start date or timestamp. None date_to datetime | int | None End date or timestamp. None group str | None Group filter. None ticket int | None Order ticket filter. None position int | None Position ticket filter. None Returns: Type Description tuple [ Any , ...] Tuple of historical deal info structures or None. Source code in pdmt5/mt5.py 914 915 916 917 918 919 920 921 922 923 924 925 926 927 928 929 930 931 932 933 934 935 936 937 938 939 940 941 942 943 944 945 946 947 948 949 950 951 952 953 954 955 956 957 958 959 960 961 962 963 964 965 966 @_log_mt5_last_status_code def history_deals_get ( self , date_from : datetime | int | None = None , date_to : datetime | int | None = None , group : str | None = None , ticket : int | None = None , position : int | None = None , ) -> tuple [ Any , ... ]: \"\"\"Get deals from trading history within the specified interval with the ability to filter by ticket or position. Args: date_from: Start date or timestamp. date_to: End date or timestamp. group: Group filter. ticket: Order ticket filter. position: Position ticket filter. Returns: Tuple of historical deal info structures or None. \"\"\" # noqa: E501 self . _initialize_if_needed () if ticket is not None : self . logger . info ( \"Retrieving deal with ticket: %d \" , ticket ) response = self . mt5 . history_deals_get ( ticket = ticket ) context = f \"ticket= { ticket } \" elif position is not None : self . logger . info ( \"Retrieving deal for position: %d \" , position ) response = self . mt5 . history_deals_get ( position = position ) context = f \"position= { position } \" elif group is not None : self . logger . info ( \"Retrieving deals for group: %s , date_from: %s , date_to: %s \" , group , date_from , date_to , ) response = self . mt5 . history_deals_get ( date_from , date_to , group = group ) context = f \"date_from= { date_from } , date_to= { date_to } , group= { group } \" else : self . logger . info ( \"Retrieving all historical deals from %s to %s \" , date_from , date_to , ) response = self . mt5 . history_deals_get ( date_from , date_to ) context = f \"date_from= { date_from } , date_to= { date_to } \" self . _validate_mt5_response_is_not_none ( response = response , operation = \"history_deals_get\" , context = context , ) return response history_deals_total \u00b6 history_deals_total ( date_from : datetime | int , date_to : datetime | int ) -> int Get the number of deals in trading history within the specified interval. Parameters: Name Type Description Default date_from datetime | int Start date or timestamp. required date_to datetime | int End date or timestamp. required Returns: Type Description int Number of historical deals. Source code in pdmt5/mt5.py 891 892 893 894 895 896 897 898 899 900 901 902 903 904 905 906 907 908 909 910 911 912 @_log_mt5_last_status_code def history_deals_total ( self , date_from : datetime | int , date_to : datetime | int , ) -> int : \"\"\"Get the number of deals in trading history within the specified interval. Args: date_from: Start date or timestamp. date_to: End date or timestamp. Returns: Number of historical deals. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of historical deals from %s to %s \" , date_from , date_to , ) return self . mt5 . history_deals_total ( date_from , date_to ) history_orders_get \u00b6 history_orders_get ( date_from : datetime | int | None = None , date_to : datetime | int | None = None , group : str | None = None , ticket : int | None = None , position : int | None = None , ) -> tuple [ Any , ... ] Get orders from trading history with the ability to filter by ticket or position. Parameters: Name Type Description Default date_from datetime | int | None Start date or timestamp. None date_to datetime | int | None End date or timestamp. None group str | None Group filter. None ticket int | None Order ticket filter. None position int | None Position ticket filter. None Returns: Type Description tuple [ Any , ...] Tuple of historical order info structures or None. Source code in pdmt5/mt5.py 837 838 839 840 841 842 843 844 845 846 847 848 849 850 851 852 853 854 855 856 857 858 859 860 861 862 863 864 865 866 867 868 869 870 871 872 873 874 875 876 877 878 879 880 881 882 883 884 885 886 887 888 889 @_log_mt5_last_status_code def history_orders_get ( self , date_from : datetime | int | None = None , date_to : datetime | int | None = None , group : str | None = None , ticket : int | None = None , position : int | None = None , ) -> tuple [ Any , ... ]: \"\"\"Get orders from trading history with the ability to filter by ticket or position. Args: date_from: Start date or timestamp. date_to: End date or timestamp. group: Group filter. ticket: Order ticket filter. position: Position ticket filter. Returns: Tuple of historical order info structures or None. \"\"\" # noqa: E501 self . _initialize_if_needed () if ticket is not None : self . logger . info ( \"Retrieving order with ticket: %d \" , ticket ) response = self . mt5 . history_orders_get ( ticket = ticket ) context = f \"ticket= { ticket } \" elif position is not None : self . logger . info ( \"Retrieving order for position: %d \" , position ) response = self . mt5 . history_orders_get ( position = position ) context = f \"position= { position } \" elif group is not None : self . logger . info ( \"Retrieving orders for group: %s , date_from: %s , date_to: %s \" , group , date_from , date_to , ) response = self . mt5 . history_orders_get ( date_from , date_to , group = group ) context = f \"date_from= { date_from } , date_to= { date_to } , group= { group } \" else : self . logger . info ( \"Retrieving all historical orders from %s to %s \" , date_from , date_to , ) response = self . mt5 . history_orders_get ( date_from , date_to ) context = f \"date_from= { date_from } , date_to= { date_to } \" self . _validate_mt5_response_is_not_none ( response = response , operation = \"history_orders_get\" , context = context , ) return response history_orders_total \u00b6 history_orders_total ( date_from : datetime | int , date_to : datetime | int ) -> int Get the number of orders in trading history within the specified interval. Parameters: Name Type Description Default date_from datetime | int Start date or timestamp. required date_to datetime | int End date or timestamp. required Returns: Type Description int Number of historical orders. Source code in pdmt5/mt5.py 814 815 816 817 818 819 820 821 822 823 824 825 826 827 828 829 830 831 832 833 834 835 @_log_mt5_last_status_code def history_orders_total ( self , date_from : datetime | int , date_to : datetime | int , ) -> int : \"\"\"Get the number of orders in trading history within the specified interval. Args: date_from: Start date or timestamp. date_to: End date or timestamp. Returns: Number of historical orders. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of historical orders from %s to %s \" , date_from , date_to , ) return self . mt5 . history_orders_total ( date_from , date_to ) initialize \u00b6 initialize ( path : str | None = None , login : int | None = None , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> bool Establish a connection with the MetaTrader 5 terminal. Parameters: Name Type Description Default path str | None Path to the MetaTrader 5 terminal EXE file. None login int | None Trading account number. None password str | None Trading account password. None server str | None Trade server address. None timeout int | None Connection timeout in milliseconds. None Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 @_log_mt5_last_status_code def initialize ( self , path : str | None = None , login : int | None = None , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> bool : \"\"\"Establish a connection with the MetaTrader 5 terminal. Args: path: Path to the MetaTrader 5 terminal EXE file. login: Trading account number. password: Trading account password. server: Trade server address. timeout: Connection timeout in milliseconds. Returns: True if successful, False otherwise. \"\"\" if path is not None : self . logger . info ( \"Initializing MT5 connection with path: %s \" , path , ) self . _is_initialized = self . mt5 . initialize ( path , ** { k : v for k , v in { \"login\" : login , \"password\" : password , \"server\" : server , \"timeout\" : timeout , } . items () if v is not None }, ) else : self . logger . info ( \"Initializing MT5 connection.\" ) self . _is_initialized = self . mt5 . initialize () return self . _is_initialized last_error \u00b6 last_error () -> tuple [ int , str ] Return data on the last error. Returns: Type Description tuple [ int , str ] Tuple of (error_code, error_description). Source code in pdmt5/mt5.py 198 199 200 201 202 203 204 205 206 @_log_mt5_last_status_code def last_error ( self ) -> tuple [ int , str ]: \"\"\"Return data on the last error. Returns: Tuple of (error_code, error_description). \"\"\" self . logger . info ( \"Retrieving last MT5 error\" ) return self . mt5 . last_error () login \u00b6 login ( login : int , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> bool Connect to a trading account using specified parameters. Parameters: Name Type Description Default login int Trading account number. required password str | None Trading account password. None server str | None Trade server address. None timeout int | None Connection timeout in milliseconds. None Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 @_log_mt5_last_status_code def login ( self , login : int , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> bool : \"\"\"Connect to a trading account using specified parameters. Args: login: Trading account number. password: Trading account password. server: Trade server address. timeout: Connection timeout in milliseconds. Returns: True if successful, False otherwise. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Logging in to MT5 account: %d \" , login ) return self . mt5 . login ( login , ** { k : v for k , v in { \"password\" : password , \"server\" : server , \"timeout\" : timeout , } . items () if v is not None }, ) market_book_add \u00b6 market_book_add ( symbol : str ) -> bool Subscribe the terminal to the Market Depth change events for a specified symbol. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 @_log_mt5_last_status_code def market_book_add ( self , symbol : str ) -> bool : \"\"\"Subscribe the terminal to the Market Depth change events for a specified symbol. Args: symbol: Symbol name. Returns: True if successful, False otherwise. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Adding market book for symbol: %s \" , symbol ) response = self . mt5 . market_book_add ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"market_book_add\" , context = f \"symbol= { symbol } \" , ) return response market_book_get \u00b6 market_book_get ( symbol : str ) -> tuple [ Any , ... ] Return a tuple from BookInfo featuring Market Depth entries for the specified symbol. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description tuple [ Any , ...] Tuple of BookInfo structures or None. Source code in pdmt5/mt5.py 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 @_log_mt5_last_status_code def market_book_get ( self , symbol : str ) -> tuple [ Any , ... ]: \"\"\"Return a tuple from BookInfo featuring Market Depth entries for the specified symbol. Args: symbol: Symbol name. Returns: Tuple of BookInfo structures or None. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Retrieving market book for symbol: %s \" , symbol ) response = self . mt5 . market_book_get ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"market_book_get\" , context = f \"symbol= { symbol } \" , ) return response market_book_release \u00b6 market_book_release ( symbol : str ) -> bool Cancels subscription of the terminal to the Market Depth change events for a specified symbol. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 @_log_mt5_last_status_code def market_book_release ( self , symbol : str ) -> bool : \"\"\"Cancels subscription of the terminal to the Market Depth change events for a specified symbol. Args: symbol: Symbol name. Returns: True if successful, False otherwise. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Releasing market book for symbol: %s \" , symbol ) response = self . mt5 . market_book_release ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"market_book_release\" , context = f \"symbol= { symbol } \" , ) return response order_calc_margin \u00b6 order_calc_margin ( action : int , symbol : str , volume : float , price : float ) -> float Return margin in the account currency to perform a specified trading operation. Parameters: Name Type Description Default action int Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL). required symbol str Symbol name. required volume float Volume in lots. required price float Open price. required Returns: Type Description float Required margin amount or None. Source code in pdmt5/mt5.py 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 657 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 @_log_mt5_last_status_code def order_calc_margin ( self , action : int , symbol : str , volume : float , price : float , ) -> float : \"\"\"Return margin in the account currency to perform a specified trading operation. Args: action: Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL). symbol: Symbol name. volume: Volume in lots. price: Open price. Returns: Required margin amount or None. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Calculating margin: action= %d , symbol= %s , volume= %.2f , price= %.5f \" , action , symbol , volume , price , ) response = self . mt5 . order_calc_margin ( action , symbol , volume , price ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"order_calc_margin\" , context = f \"action= { action } , symbol= { symbol } , volume= { volume } , price= { price } \" , ) return response order_calc_profit \u00b6 order_calc_profit ( action : int , symbol : str , volume : float , price_open : float , price_close : float , ) -> float Return profit in the account currency for a specified trading operation. Parameters: Name Type Description Default action int Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL). required symbol str Symbol name. required volume float Volume in lots. required price_open float Open price. required price_close float Close price. required Returns: Type Description float Calculated profit or None. Source code in pdmt5/mt5.py 676 677 678 679 680 681 682 683 684 685 686 687 688 689 690 691 692 693 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 712 713 714 715 716 717 718 719 720 @_log_mt5_last_status_code def order_calc_profit ( self , action : int , symbol : str , volume : float , price_open : float , price_close : float , ) -> float : \"\"\"Return profit in the account currency for a specified trading operation. Args: action: Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL). symbol: Symbol name. volume: Volume in lots. price_open: Open price. price_close: Close price. Returns: Calculated profit or None. \"\"\" self . _initialize_if_needed () self . logger . info ( ( \"Calculating profit: action= %d , symbol= %s , volume= %.2f ,\" \" price_open= %.5f , price_close= %.5f \" ), action , symbol , volume , price_open , price_close , ) response = self . mt5 . order_calc_profit ( action , symbol , volume , price_open , price_close ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"order_calc_profit\" , context = ( f \"action= { action } , symbol= { symbol } , volume= { volume } ,\" f \" price_open= { price_open } , price_close= { price_close } \" ), ) return response order_check \u00b6 order_check ( request : dict [ str , Any ]) -> Any Check funds sufficiency for performing a required trading operation. Parameters: Name Type Description Default request dict [ str , Any ] Trade request dictionary. required Returns: Type Description Any OrderCheckResult structure or None. Source code in pdmt5/mt5.py 722 723 724 725 726 727 728 729 730 731 732 733 734 735 736 737 738 739 740 @_log_mt5_last_status_code def order_check ( self , request : dict [ str , Any ]) -> Any : \"\"\"Check funds sufficiency for performing a required trading operation. Args: request: Trade request dictionary. Returns: OrderCheckResult structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Checking order with request: %s \" , request ) response = self . mt5 . order_check ( request ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"order_check\" , context = f \"request= { request } \" , ) return response order_send \u00b6 order_send ( request : dict [ str , Any ]) -> Any Send a request to perform a trading operation from the terminal to the trade server. Parameters: Name Type Description Default request dict [ str , Any ] Trade request dictionary. required Returns: Type Description Any OrderSendResult structure or None. Source code in pdmt5/mt5.py 742 743 744 745 746 747 748 749 750 751 752 753 754 755 756 757 758 759 760 @_log_mt5_last_status_code def order_send ( self , request : dict [ str , Any ]) -> Any : \"\"\"Send a request to perform a trading operation from the terminal to the trade server. Args: request: Trade request dictionary. Returns: OrderSendResult structure or None. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Sending order with request: %s \" , request ) response = self . mt5 . order_send ( request ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"order_send\" , context = f \"request= { request } \" , ) return response orders_get \u00b6 orders_get ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , ) -> tuple [ Any , ... ] Get active orders with the ability to filter by symbol or ticket. Parameters: Name Type Description Default symbol str | None Symbol name filter. None group str | None Group filter. None ticket int | None Order ticket filter. None Returns: Type Description tuple [ Any , ...] Tuple of order info structures or None. Source code in pdmt5/mt5.py 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 623 624 625 626 627 628 629 630 631 632 633 634 635 636 637 638 639 @_log_mt5_last_status_code def orders_get ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , ) -> tuple [ Any , ... ]: \"\"\"Get active orders with the ability to filter by symbol or ticket. Args: symbol: Symbol name filter. group: Group filter. ticket: Order ticket filter. Returns: Tuple of order info structures or None. \"\"\" self . _initialize_if_needed () if ticket is not None : self . logger . info ( \"Retrieving order with ticket: %d \" , ticket ) response = self . mt5 . orders_get ( ticket = ticket ) context = f \"ticket= { ticket } \" elif group is not None : self . logger . info ( \"Retrieving orders for group: %s \" , group ) response = self . mt5 . orders_get ( group = group ) context = f \"group= { group } \" elif symbol is not None : self . logger . info ( \"Retrieving orders for symbol: %s \" , symbol ) response = self . mt5 . orders_get ( symbol = symbol ) context = f \"symbol= { symbol } \" else : self . logger . info ( \"Retrieving all active orders.\" ) response = self . mt5 . orders_get () context = None self . _validate_mt5_response_is_not_none ( response = response , operation = \"orders_get\" , context = context , ) return response orders_total \u00b6 orders_total () -> int Get the number of active orders. Returns: Type Description int Number of active orders. Source code in pdmt5/mt5.py 589 590 591 592 593 594 595 596 597 598 @_log_mt5_last_status_code def orders_total ( self ) -> int : \"\"\"Get the number of active orders. Returns: Number of active orders. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of active orders.\" ) return self . mt5 . orders_total () positions_get \u00b6 positions_get ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , ) -> tuple [ Any , ... ] Get open positions with the ability to filter by symbol or ticket. Parameters: Name Type Description Default symbol str | None Symbol name filter. None group str | None Group filter. None ticket int | None Position ticket filter. None Returns: Type Description tuple [ Any , ...] Tuple of position info structures or None. Source code in pdmt5/mt5.py 773 774 775 776 777 778 779 780 781 782 783 784 785 786 787 788 789 790 791 792 793 794 795 796 797 798 799 800 801 802 803 804 805 806 807 808 809 810 811 812 @_log_mt5_last_status_code def positions_get ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , ) -> tuple [ Any , ... ]: \"\"\"Get open positions with the ability to filter by symbol or ticket. Args: symbol: Symbol name filter. group: Group filter. ticket: Position ticket filter. Returns: Tuple of position info structures or None. \"\"\" self . _initialize_if_needed () if ticket is not None : self . logger . info ( \"Retrieving position with ticket: %d \" , ticket ) response = self . mt5 . positions_get ( ticket = ticket ) context = f \"ticket= { ticket } \" elif group is not None : self . logger . info ( \"Retrieving positions for group: %s \" , group ) response = self . mt5 . positions_get ( group = group ) context = f \"group= { group } \" elif symbol is not None : self . logger . info ( \"Retrieving positions for symbol: %s \" , symbol ) response = self . mt5 . positions_get ( symbol = symbol ) context = f \"symbol= { symbol } \" else : self . logger . info ( \"Retrieving all open positions.\" ) response = self . mt5 . positions_get () context = None self . _validate_mt5_response_is_not_none ( response = response , operation = \"positions_get\" , context = context , ) return response positions_total \u00b6 positions_total () -> int Get the number of open positions. Returns: Type Description int Number of open positions. Source code in pdmt5/mt5.py 762 763 764 765 766 767 768 769 770 771 @_log_mt5_last_status_code def positions_total ( self ) -> int : \"\"\"Get the number of open positions. Returns: Number of open positions. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of open positions.\" ) return self . mt5 . positions_total () shutdown \u00b6 shutdown () -> None Close the previously established connection to the MetaTrader 5 terminal. Source code in pdmt5/mt5.py 179 180 181 182 183 184 185 @_log_mt5_last_status_code def shutdown ( self ) -> None : \"\"\"Close the previously established connection to the MetaTrader 5 terminal.\"\"\" self . logger . info ( \"Shutting down MT5 connection.\" ) response = self . mt5 . shutdown () self . _is_initialized = False return response symbol_info \u00b6 symbol_info ( symbol : str ) -> Any Get data on the specified financial instrument. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description Any Symbol info structure or None. Source code in pdmt5/mt5.py 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 @_log_mt5_last_status_code def symbol_info ( self , symbol : str ) -> Any : \"\"\"Get data on the specified financial instrument. Args: symbol: Symbol name. Returns: Symbol info structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving information for symbol: %s \" , symbol ) response = self . mt5 . symbol_info ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"symbol_info\" , context = f \"symbol= { symbol } \" , ) return response symbol_info_tick \u00b6 symbol_info_tick ( symbol : str ) -> Any Get the last tick for the specified financial instrument. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description Any Tick info structure or None. Source code in pdmt5/mt5.py 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 @_log_mt5_last_status_code def symbol_info_tick ( self , symbol : str ) -> Any : \"\"\"Get the last tick for the specified financial instrument. Args: symbol: Symbol name. Returns: Tick info structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving last tick for symbol: %s \" , symbol ) response = self . mt5 . symbol_info_tick ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"symbol_info_tick\" , context = f \"symbol= { symbol } \" , ) return response symbol_select \u00b6 symbol_select ( symbol : str , enable : bool = True ) -> bool Select a symbol in the MarketWatch window or remove a symbol from the window. Parameters: Name Type Description Default symbol str Symbol name. required enable bool True to show, False to hide. True Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 @_log_mt5_last_status_code def symbol_select ( self , symbol : str , enable : bool = True ) -> bool : \"\"\"Select a symbol in the MarketWatch window or remove a symbol from the window. Args: symbol: Symbol name. enable: True to show, False to hide. Returns: True if successful, False otherwise. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Selecting symbol: %s , enable= %s \" , symbol , enable ) response = self . mt5 . symbol_select ( symbol , enable ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"symbol_select\" , context = f \"symbol= { symbol } , enable= { enable } \" , ) return response symbols_get \u00b6 symbols_get ( group : str | None = None ) -> tuple [ Any , ... ] Get all financial instruments from the terminal. Parameters: Name Type Description Default group str | None Symbol group filter. None Returns: Type Description tuple [ Any , ...] Tuple of symbol info structures or None. Source code in pdmt5/mt5.py 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 @_log_mt5_last_status_code def symbols_get ( self , group : str | None = None ) -> tuple [ Any , ... ]: \"\"\"Get all financial instruments from the terminal. Args: group: Symbol group filter. Returns: Tuple of symbol info structures or None. \"\"\" self . _initialize_if_needed () if group is not None : self . logger . info ( \"Retrieving symbols for group: %s \" , group ) response = self . mt5 . symbols_get ( group = group ) context = f \"group= { group } \" else : self . logger . info ( \"Retrieving all symbols.\" ) response = self . mt5 . symbols_get () context = None self . _validate_mt5_response_is_not_none ( response = response , operation = \"symbols_get\" , context = context , ) return response symbols_total \u00b6 symbols_total () -> int Get the number of all financial instruments in the terminal. Returns: Type Description int Total number of symbols. Source code in pdmt5/mt5.py 239 240 241 242 243 244 245 246 247 248 @_log_mt5_last_status_code def symbols_total ( self ) -> int : \"\"\"Get the number of all financial instruments in the terminal. Returns: Total number of symbols. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of symbols.\" ) return self . mt5 . symbols_total () terminal_info \u00b6 terminal_info () -> Any Get the connected MetaTrader 5 client terminal status and settings. Returns: Type Description Any TerminalInfo structure or None. Source code in pdmt5/mt5.py 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 @_log_mt5_last_status_code def terminal_info ( self ) -> Any : \"\"\"Get the connected MetaTrader 5 client terminal status and settings. Returns: TerminalInfo structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving terminal information.\" ) response = self . mt5 . terminal_info () self . _validate_mt5_response_is_not_none ( response = response , operation = \"terminal_info\" , ) return response version \u00b6 version () -> tuple [ int , int , str ] Return the MetaTrader 5 terminal version. Returns: Type Description tuple [ int , int , str ] Tuple of (terminal_version, build, release_date). Source code in pdmt5/mt5.py 187 188 189 190 191 192 193 194 195 196 @_log_mt5_last_status_code def version ( self ) -> tuple [ int , int , str ]: \"\"\"Return the MetaTrader 5 terminal version. Returns: Tuple of (terminal_version, build, release_date). \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving MT5 version information.\" ) return self . mt5 . version () Mt5RuntimeError \u00b6 Bases: RuntimeError MetaTrader5 specific runtime error. Raised when MetaTrader5 operations fail or when the client is used incorrectly (e.g., calling methods before initialization). Overview \u00b6 The Mt5Client module provides the base client class for connecting to MetaTrader 5 and performing core operations. This is the foundation class that handles the low-level MT5 API interactions and provides basic error handling and connection management. Classes \u00b6 Mt5Client \u00b6 pdmt5.mt5.Mt5Client \u00b6 Bases: BaseModel MetaTrader5 client class. This class provides a wrapper interface to all MetaTrader5 functions, delegating calls to the underlying MetaTrader5 module while providing error handling and logging capabilities. logger class-attribute instance-attribute \u00b6 logger : Logger = Field ( default_factory = lambda : getLogger ( __name__ ), description = \"Logger instance for MetaTrader5 operations\" , ) model_config class-attribute instance-attribute \u00b6 model_config = ConfigDict ( arbitrary_types_allowed = True ) mt5 class-attribute instance-attribute \u00b6 mt5 : ModuleType = Field ( default_factory = lambda : import_module ( \"MetaTrader5\" ), description = \"MetaTrader5 module instance\" , ) __enter__ \u00b6 __enter__ () -> Self Context manager entry. Returns: Name Type Description Mt5Client Self The client instance. Source code in pdmt5/mt5.py 83 84 85 86 87 88 89 90 def __enter__ ( self ) -> Self : \"\"\"Context manager entry. Returns: Mt5Client: The client instance. \"\"\" self . initialize () return self __exit__ \u00b6 __exit__ ( exc_type : type [ BaseException ] | None , exc_val : BaseException | None , exc_tb : TracebackType | None , ) -> None Context manager exit. Source code in pdmt5/mt5.py 92 93 94 95 96 97 98 99 def __exit__ ( self , exc_type : type [ BaseException ] | None , exc_val : BaseException | None , exc_tb : TracebackType | None , ) -> None : \"\"\"Context manager exit.\"\"\" self . shutdown () account_info \u00b6 account_info () -> Any Get info on the current trading account. Returns: Type Description Any AccountInfo structure or None. Source code in pdmt5/mt5.py 208 209 210 211 212 213 214 215 216 217 218 219 220 221 @_log_mt5_last_status_code def account_info ( self ) -> Any : \"\"\"Get info on the current trading account. Returns: AccountInfo structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving account information.\" ) response = self . mt5 . account_info () self . _validate_mt5_response_is_not_none ( response = response , operation = \"account_info\" ) return response copy_rates_from \u00b6 copy_rates_from ( symbol : str , timeframe : int , date_from : datetime | int , count : int , ) -> Any Get bars from the terminal starting from the specified date. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime | int Start date or timestamp. required count int Number of bars to retrieve. required Returns: Type Description Any Array of rates or None. Source code in pdmt5/mt5.py 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 433 @_log_mt5_last_status_code def copy_rates_from ( self , symbol : str , timeframe : int , date_from : datetime | int , count : int , ) -> Any : \"\"\"Get bars from the terminal starting from the specified date. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date or timestamp. count: Number of bars to retrieve. Returns: Array of rates or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Copying rates from symbol: %s , timeframe: %d , date_from: %s , count: %d \" , symbol , timeframe , date_from , count , ) response = self . mt5 . copy_rates_from ( symbol , timeframe , date_from , count ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_rates_from\" , context = ( f \"symbol= { symbol } , timeframe= { timeframe } ,\" f \" date_from= { date_from } , count= { count } \" ), ) return response copy_rates_from_pos \u00b6 copy_rates_from_pos ( symbol : str , timeframe : int , start_pos : int , count : int ) -> Any Get bars from the terminal starting from the specified index. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required start_pos int Starting position. required count int Number of bars to retrieve. required Returns: Type Description Any Array of rates or None. Source code in pdmt5/mt5.py 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 @_log_mt5_last_status_code def copy_rates_from_pos ( self , symbol : str , timeframe : int , start_pos : int , count : int , ) -> Any : \"\"\"Get bars from the terminal starting from the specified index. Args: symbol: Symbol name. timeframe: Timeframe constant. start_pos: Starting position. count: Number of bars to retrieve. Returns: Array of rates or None. \"\"\" self . _initialize_if_needed () self . logger . info ( ( \"Copying rates from position:\" \" symbol= %s , timeframe= %d , start_pos= %d , count= %d \" ), symbol , timeframe , start_pos , count , ) response = self . mt5 . copy_rates_from_pos ( symbol , timeframe , start_pos , count ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_rates_from_pos\" , context = ( f \"symbol= { symbol } , timeframe= { timeframe } ,\" f \" start_pos= { start_pos } , count= { count } \" ), ) return response copy_rates_range \u00b6 copy_rates_range ( symbol : str , timeframe : int , date_from : datetime | int , date_to : datetime | int , ) -> Any Get bars in the specified date range from the terminal. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime | int Start date or timestamp. required date_to datetime | int End date or timestamp. required Returns: Type Description Any Array of rates or None. Source code in pdmt5/mt5.py 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 @_log_mt5_last_status_code def copy_rates_range ( self , symbol : str , timeframe : int , date_from : datetime | int , date_to : datetime | int , ) -> Any : \"\"\"Get bars in the specified date range from the terminal. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date or timestamp. date_to: End date or timestamp. Returns: Array of rates or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Copying rates range: symbol= %s , timeframe= %d , date_from= %s , date_to= %s \" , symbol , timeframe , date_from , date_to , ) response = self . mt5 . copy_rates_range ( symbol , timeframe , date_from , date_to ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_rates_range\" , context = ( f \"symbol= { symbol } , timeframe= { timeframe } ,\" f \" date_from= { date_from } , date_to= { date_to } \" ), ) return response copy_ticks_from \u00b6 copy_ticks_from ( symbol : str , date_from : datetime | int , count : int , flags : int , ) -> Any Get ticks from the terminal starting from the specified date. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime | int Start date or timestamp. required count int Number of ticks to retrieve. required flags int Tick flags. required Returns: Type Description Any Array of ticks or None. Source code in pdmt5/mt5.py 514 515 516 517 518 519 520 521 522 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 @_log_mt5_last_status_code def copy_ticks_from ( self , symbol : str , date_from : datetime | int , count : int , flags : int , ) -> Any : \"\"\"Get ticks from the terminal starting from the specified date. Args: symbol: Symbol name. date_from: Start date or timestamp. count: Number of ticks to retrieve. flags: Tick flags. Returns: Array of ticks or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Copying ticks from symbol: %s , date_from: %s , count: %d , flags: %d \" , symbol , date_from , count , flags , ) response = self . mt5 . copy_ticks_from ( symbol , date_from , count , flags ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_ticks_from\" , context = ( f \"symbol= { symbol } , date_from= { date_from } , count= { count } , flags= { flags } \" ), ) return response copy_ticks_range \u00b6 copy_ticks_range ( symbol : str , date_from : datetime | int , date_to : datetime | int , flags : int , ) -> Any Get ticks for the specified date range from the terminal. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime | int Start date or timestamp. required date_to datetime | int End date or timestamp. required flags int Tick flags. required Returns: Type Description Any Array of ticks or None. Source code in pdmt5/mt5.py 551 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 @_log_mt5_last_status_code def copy_ticks_range ( self , symbol : str , date_from : datetime | int , date_to : datetime | int , flags : int , ) -> Any : \"\"\"Get ticks for the specified date range from the terminal. Args: symbol: Symbol name. date_from: Start date or timestamp. date_to: End date or timestamp. flags: Tick flags. Returns: Array of ticks or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Copying ticks range: symbol= %s , date_from= %s , date_to= %s , flags= %d \" , symbol , date_from , date_to , flags , ) response = self . mt5 . copy_ticks_range ( symbol , date_from , date_to , flags ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_ticks_range\" , context = ( f \"symbol= { symbol } , date_from= { date_from } ,\" f \" date_to= { date_to } , flags= { flags } \" ), ) return response history_deals_get \u00b6 history_deals_get ( date_from : datetime | int | None = None , date_to : datetime | int | None = None , group : str | None = None , ticket : int | None = None , position : int | None = None , ) -> tuple [ Any , ... ] Get deals from trading history within the specified interval with the ability to filter by ticket or position. Parameters: Name Type Description Default date_from datetime | int | None Start date or timestamp. None date_to datetime | int | None End date or timestamp. None group str | None Group filter. None ticket int | None Order ticket filter. None position int | None Position ticket filter. None Returns: Type Description tuple [ Any , ...] Tuple of historical deal info structures or None. Source code in pdmt5/mt5.py 914 915 916 917 918 919 920 921 922 923 924 925 926 927 928 929 930 931 932 933 934 935 936 937 938 939 940 941 942 943 944 945 946 947 948 949 950 951 952 953 954 955 956 957 958 959 960 961 962 963 964 965 966 @_log_mt5_last_status_code def history_deals_get ( self , date_from : datetime | int | None = None , date_to : datetime | int | None = None , group : str | None = None , ticket : int | None = None , position : int | None = None , ) -> tuple [ Any , ... ]: \"\"\"Get deals from trading history within the specified interval with the ability to filter by ticket or position. Args: date_from: Start date or timestamp. date_to: End date or timestamp. group: Group filter. ticket: Order ticket filter. position: Position ticket filter. Returns: Tuple of historical deal info structures or None. \"\"\" # noqa: E501 self . _initialize_if_needed () if ticket is not None : self . logger . info ( \"Retrieving deal with ticket: %d \" , ticket ) response = self . mt5 . history_deals_get ( ticket = ticket ) context = f \"ticket= { ticket } \" elif position is not None : self . logger . info ( \"Retrieving deal for position: %d \" , position ) response = self . mt5 . history_deals_get ( position = position ) context = f \"position= { position } \" elif group is not None : self . logger . info ( \"Retrieving deals for group: %s , date_from: %s , date_to: %s \" , group , date_from , date_to , ) response = self . mt5 . history_deals_get ( date_from , date_to , group = group ) context = f \"date_from= { date_from } , date_to= { date_to } , group= { group } \" else : self . logger . info ( \"Retrieving all historical deals from %s to %s \" , date_from , date_to , ) response = self . mt5 . history_deals_get ( date_from , date_to ) context = f \"date_from= { date_from } , date_to= { date_to } \" self . _validate_mt5_response_is_not_none ( response = response , operation = \"history_deals_get\" , context = context , ) return response history_deals_total \u00b6 history_deals_total ( date_from : datetime | int , date_to : datetime | int ) -> int Get the number of deals in trading history within the specified interval. Parameters: Name Type Description Default date_from datetime | int Start date or timestamp. required date_to datetime | int End date or timestamp. required Returns: Type Description int Number of historical deals. Source code in pdmt5/mt5.py 891 892 893 894 895 896 897 898 899 900 901 902 903 904 905 906 907 908 909 910 911 912 @_log_mt5_last_status_code def history_deals_total ( self , date_from : datetime | int , date_to : datetime | int , ) -> int : \"\"\"Get the number of deals in trading history within the specified interval. Args: date_from: Start date or timestamp. date_to: End date or timestamp. Returns: Number of historical deals. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of historical deals from %s to %s \" , date_from , date_to , ) return self . mt5 . history_deals_total ( date_from , date_to ) history_orders_get \u00b6 history_orders_get ( date_from : datetime | int | None = None , date_to : datetime | int | None = None , group : str | None = None , ticket : int | None = None , position : int | None = None , ) -> tuple [ Any , ... ] Get orders from trading history with the ability to filter by ticket or position. Parameters: Name Type Description Default date_from datetime | int | None Start date or timestamp. None date_to datetime | int | None End date or timestamp. None group str | None Group filter. None ticket int | None Order ticket filter. None position int | None Position ticket filter. None Returns: Type Description tuple [ Any , ...] Tuple of historical order info structures or None. Source code in pdmt5/mt5.py 837 838 839 840 841 842 843 844 845 846 847 848 849 850 851 852 853 854 855 856 857 858 859 860 861 862 863 864 865 866 867 868 869 870 871 872 873 874 875 876 877 878 879 880 881 882 883 884 885 886 887 888 889 @_log_mt5_last_status_code def history_orders_get ( self , date_from : datetime | int | None = None , date_to : datetime | int | None = None , group : str | None = None , ticket : int | None = None , position : int | None = None , ) -> tuple [ Any , ... ]: \"\"\"Get orders from trading history with the ability to filter by ticket or position. Args: date_from: Start date or timestamp. date_to: End date or timestamp. group: Group filter. ticket: Order ticket filter. position: Position ticket filter. Returns: Tuple of historical order info structures or None. \"\"\" # noqa: E501 self . _initialize_if_needed () if ticket is not None : self . logger . info ( \"Retrieving order with ticket: %d \" , ticket ) response = self . mt5 . history_orders_get ( ticket = ticket ) context = f \"ticket= { ticket } \" elif position is not None : self . logger . info ( \"Retrieving order for position: %d \" , position ) response = self . mt5 . history_orders_get ( position = position ) context = f \"position= { position } \" elif group is not None : self . logger . info ( \"Retrieving orders for group: %s , date_from: %s , date_to: %s \" , group , date_from , date_to , ) response = self . mt5 . history_orders_get ( date_from , date_to , group = group ) context = f \"date_from= { date_from } , date_to= { date_to } , group= { group } \" else : self . logger . info ( \"Retrieving all historical orders from %s to %s \" , date_from , date_to , ) response = self . mt5 . history_orders_get ( date_from , date_to ) context = f \"date_from= { date_from } , date_to= { date_to } \" self . _validate_mt5_response_is_not_none ( response = response , operation = \"history_orders_get\" , context = context , ) return response history_orders_total \u00b6 history_orders_total ( date_from : datetime | int , date_to : datetime | int ) -> int Get the number of orders in trading history within the specified interval. Parameters: Name Type Description Default date_from datetime | int Start date or timestamp. required date_to datetime | int End date or timestamp. required Returns: Type Description int Number of historical orders. Source code in pdmt5/mt5.py 814 815 816 817 818 819 820 821 822 823 824 825 826 827 828 829 830 831 832 833 834 835 @_log_mt5_last_status_code def history_orders_total ( self , date_from : datetime | int , date_to : datetime | int , ) -> int : \"\"\"Get the number of orders in trading history within the specified interval. Args: date_from: Start date or timestamp. date_to: End date or timestamp. Returns: Number of historical orders. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of historical orders from %s to %s \" , date_from , date_to , ) return self . mt5 . history_orders_total ( date_from , date_to ) initialize \u00b6 initialize ( path : str | None = None , login : int | None = None , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> bool Establish a connection with the MetaTrader 5 terminal. Parameters: Name Type Description Default path str | None Path to the MetaTrader 5 terminal EXE file. None login int | None Trading account number. None password str | None Trading account password. None server str | None Trade server address. None timeout int | None Connection timeout in milliseconds. None Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 @_log_mt5_last_status_code def initialize ( self , path : str | None = None , login : int | None = None , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> bool : \"\"\"Establish a connection with the MetaTrader 5 terminal. Args: path: Path to the MetaTrader 5 terminal EXE file. login: Trading account number. password: Trading account password. server: Trade server address. timeout: Connection timeout in milliseconds. Returns: True if successful, False otherwise. \"\"\" if path is not None : self . logger . info ( \"Initializing MT5 connection with path: %s \" , path , ) self . _is_initialized = self . mt5 . initialize ( path , ** { k : v for k , v in { \"login\" : login , \"password\" : password , \"server\" : server , \"timeout\" : timeout , } . items () if v is not None }, ) else : self . logger . info ( \"Initializing MT5 connection.\" ) self . _is_initialized = self . mt5 . initialize () return self . _is_initialized last_error \u00b6 last_error () -> tuple [ int , str ] Return data on the last error. Returns: Type Description tuple [ int , str ] Tuple of (error_code, error_description). Source code in pdmt5/mt5.py 198 199 200 201 202 203 204 205 206 @_log_mt5_last_status_code def last_error ( self ) -> tuple [ int , str ]: \"\"\"Return data on the last error. Returns: Tuple of (error_code, error_description). \"\"\" self . logger . info ( \"Retrieving last MT5 error\" ) return self . mt5 . last_error () login \u00b6 login ( login : int , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> bool Connect to a trading account using specified parameters. Parameters: Name Type Description Default login int Trading account number. required password str | None Trading account password. None server str | None Trade server address. None timeout int | None Connection timeout in milliseconds. None Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 @_log_mt5_last_status_code def login ( self , login : int , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> bool : \"\"\"Connect to a trading account using specified parameters. Args: login: Trading account number. password: Trading account password. server: Trade server address. timeout: Connection timeout in milliseconds. Returns: True if successful, False otherwise. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Logging in to MT5 account: %d \" , login ) return self . mt5 . login ( login , ** { k : v for k , v in { \"password\" : password , \"server\" : server , \"timeout\" : timeout , } . items () if v is not None }, ) market_book_add \u00b6 market_book_add ( symbol : str ) -> bool Subscribe the terminal to the Market Depth change events for a specified symbol. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 @_log_mt5_last_status_code def market_book_add ( self , symbol : str ) -> bool : \"\"\"Subscribe the terminal to the Market Depth change events for a specified symbol. Args: symbol: Symbol name. Returns: True if successful, False otherwise. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Adding market book for symbol: %s \" , symbol ) response = self . mt5 . market_book_add ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"market_book_add\" , context = f \"symbol= { symbol } \" , ) return response market_book_get \u00b6 market_book_get ( symbol : str ) -> tuple [ Any , ... ] Return a tuple from BookInfo featuring Market Depth entries for the specified symbol. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description tuple [ Any , ...] Tuple of BookInfo structures or None. Source code in pdmt5/mt5.py 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 @_log_mt5_last_status_code def market_book_get ( self , symbol : str ) -> tuple [ Any , ... ]: \"\"\"Return a tuple from BookInfo featuring Market Depth entries for the specified symbol. Args: symbol: Symbol name. Returns: Tuple of BookInfo structures or None. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Retrieving market book for symbol: %s \" , symbol ) response = self . mt5 . market_book_get ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"market_book_get\" , context = f \"symbol= { symbol } \" , ) return response market_book_release \u00b6 market_book_release ( symbol : str ) -> bool Cancels subscription of the terminal to the Market Depth change events for a specified symbol. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 @_log_mt5_last_status_code def market_book_release ( self , symbol : str ) -> bool : \"\"\"Cancels subscription of the terminal to the Market Depth change events for a specified symbol. Args: symbol: Symbol name. Returns: True if successful, False otherwise. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Releasing market book for symbol: %s \" , symbol ) response = self . mt5 . market_book_release ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"market_book_release\" , context = f \"symbol= { symbol } \" , ) return response order_calc_margin \u00b6 order_calc_margin ( action : int , symbol : str , volume : float , price : float ) -> float Return margin in the account currency to perform a specified trading operation. Parameters: Name Type Description Default action int Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL). required symbol str Symbol name. required volume float Volume in lots. required price float Open price. required Returns: Type Description float Required margin amount or None. Source code in pdmt5/mt5.py 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 657 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 @_log_mt5_last_status_code def order_calc_margin ( self , action : int , symbol : str , volume : float , price : float , ) -> float : \"\"\"Return margin in the account currency to perform a specified trading operation. Args: action: Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL). symbol: Symbol name. volume: Volume in lots. price: Open price. Returns: Required margin amount or None. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Calculating margin: action= %d , symbol= %s , volume= %.2f , price= %.5f \" , action , symbol , volume , price , ) response = self . mt5 . order_calc_margin ( action , symbol , volume , price ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"order_calc_margin\" , context = f \"action= { action } , symbol= { symbol } , volume= { volume } , price= { price } \" , ) return response order_calc_profit \u00b6 order_calc_profit ( action : int , symbol : str , volume : float , price_open : float , price_close : float , ) -> float Return profit in the account currency for a specified trading operation. Parameters: Name Type Description Default action int Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL). required symbol str Symbol name. required volume float Volume in lots. required price_open float Open price. required price_close float Close price. required Returns: Type Description float Calculated profit or None. Source code in pdmt5/mt5.py 676 677 678 679 680 681 682 683 684 685 686 687 688 689 690 691 692 693 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 712 713 714 715 716 717 718 719 720 @_log_mt5_last_status_code def order_calc_profit ( self , action : int , symbol : str , volume : float , price_open : float , price_close : float , ) -> float : \"\"\"Return profit in the account currency for a specified trading operation. Args: action: Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL). symbol: Symbol name. volume: Volume in lots. price_open: Open price. price_close: Close price. Returns: Calculated profit or None. \"\"\" self . _initialize_if_needed () self . logger . info ( ( \"Calculating profit: action= %d , symbol= %s , volume= %.2f ,\" \" price_open= %.5f , price_close= %.5f \" ), action , symbol , volume , price_open , price_close , ) response = self . mt5 . order_calc_profit ( action , symbol , volume , price_open , price_close ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"order_calc_profit\" , context = ( f \"action= { action } , symbol= { symbol } , volume= { volume } ,\" f \" price_open= { price_open } , price_close= { price_close } \" ), ) return response order_check \u00b6 order_check ( request : dict [ str , Any ]) -> Any Check funds sufficiency for performing a required trading operation. Parameters: Name Type Description Default request dict [ str , Any ] Trade request dictionary. required Returns: Type Description Any OrderCheckResult structure or None. Source code in pdmt5/mt5.py 722 723 724 725 726 727 728 729 730 731 732 733 734 735 736 737 738 739 740 @_log_mt5_last_status_code def order_check ( self , request : dict [ str , Any ]) -> Any : \"\"\"Check funds sufficiency for performing a required trading operation. Args: request: Trade request dictionary. Returns: OrderCheckResult structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Checking order with request: %s \" , request ) response = self . mt5 . order_check ( request ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"order_check\" , context = f \"request= { request } \" , ) return response order_send \u00b6 order_send ( request : dict [ str , Any ]) -> Any Send a request to perform a trading operation from the terminal to the trade server. Parameters: Name Type Description Default request dict [ str , Any ] Trade request dictionary. required Returns: Type Description Any OrderSendResult structure or None. Source code in pdmt5/mt5.py 742 743 744 745 746 747 748 749 750 751 752 753 754 755 756 757 758 759 760 @_log_mt5_last_status_code def order_send ( self , request : dict [ str , Any ]) -> Any : \"\"\"Send a request to perform a trading operation from the terminal to the trade server. Args: request: Trade request dictionary. Returns: OrderSendResult structure or None. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Sending order with request: %s \" , request ) response = self . mt5 . order_send ( request ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"order_send\" , context = f \"request= { request } \" , ) return response orders_get \u00b6 orders_get ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , ) -> tuple [ Any , ... ] Get active orders with the ability to filter by symbol or ticket. Parameters: Name Type Description Default symbol str | None Symbol name filter. None group str | None Group filter. None ticket int | None Order ticket filter. None Returns: Type Description tuple [ Any , ...] Tuple of order info structures or None. Source code in pdmt5/mt5.py 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 623 624 625 626 627 628 629 630 631 632 633 634 635 636 637 638 639 @_log_mt5_last_status_code def orders_get ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , ) -> tuple [ Any , ... ]: \"\"\"Get active orders with the ability to filter by symbol or ticket. Args: symbol: Symbol name filter. group: Group filter. ticket: Order ticket filter. Returns: Tuple of order info structures or None. \"\"\" self . _initialize_if_needed () if ticket is not None : self . logger . info ( \"Retrieving order with ticket: %d \" , ticket ) response = self . mt5 . orders_get ( ticket = ticket ) context = f \"ticket= { ticket } \" elif group is not None : self . logger . info ( \"Retrieving orders for group: %s \" , group ) response = self . mt5 . orders_get ( group = group ) context = f \"group= { group } \" elif symbol is not None : self . logger . info ( \"Retrieving orders for symbol: %s \" , symbol ) response = self . mt5 . orders_get ( symbol = symbol ) context = f \"symbol= { symbol } \" else : self . logger . info ( \"Retrieving all active orders.\" ) response = self . mt5 . orders_get () context = None self . _validate_mt5_response_is_not_none ( response = response , operation = \"orders_get\" , context = context , ) return response orders_total \u00b6 orders_total () -> int Get the number of active orders. Returns: Type Description int Number of active orders. Source code in pdmt5/mt5.py 589 590 591 592 593 594 595 596 597 598 @_log_mt5_last_status_code def orders_total ( self ) -> int : \"\"\"Get the number of active orders. Returns: Number of active orders. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of active orders.\" ) return self . mt5 . orders_total () positions_get \u00b6 positions_get ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , ) -> tuple [ Any , ... ] Get open positions with the ability to filter by symbol or ticket. Parameters: Name Type Description Default symbol str | None Symbol name filter. None group str | None Group filter. None ticket int | None Position ticket filter. None Returns: Type Description tuple [ Any , ...] Tuple of position info structures or None. Source code in pdmt5/mt5.py 773 774 775 776 777 778 779 780 781 782 783 784 785 786 787 788 789 790 791 792 793 794 795 796 797 798 799 800 801 802 803 804 805 806 807 808 809 810 811 812 @_log_mt5_last_status_code def positions_get ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , ) -> tuple [ Any , ... ]: \"\"\"Get open positions with the ability to filter by symbol or ticket. Args: symbol: Symbol name filter. group: Group filter. ticket: Position ticket filter. Returns: Tuple of position info structures or None. \"\"\" self . _initialize_if_needed () if ticket is not None : self . logger . info ( \"Retrieving position with ticket: %d \" , ticket ) response = self . mt5 . positions_get ( ticket = ticket ) context = f \"ticket= { ticket } \" elif group is not None : self . logger . info ( \"Retrieving positions for group: %s \" , group ) response = self . mt5 . positions_get ( group = group ) context = f \"group= { group } \" elif symbol is not None : self . logger . info ( \"Retrieving positions for symbol: %s \" , symbol ) response = self . mt5 . positions_get ( symbol = symbol ) context = f \"symbol= { symbol } \" else : self . logger . info ( \"Retrieving all open positions.\" ) response = self . mt5 . positions_get () context = None self . _validate_mt5_response_is_not_none ( response = response , operation = \"positions_get\" , context = context , ) return response positions_total \u00b6 positions_total () -> int Get the number of open positions. Returns: Type Description int Number of open positions. Source code in pdmt5/mt5.py 762 763 764 765 766 767 768 769 770 771 @_log_mt5_last_status_code def positions_total ( self ) -> int : \"\"\"Get the number of open positions. Returns: Number of open positions. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of open positions.\" ) return self . mt5 . positions_total () shutdown \u00b6 shutdown () -> None Close the previously established connection to the MetaTrader 5 terminal. Source code in pdmt5/mt5.py 179 180 181 182 183 184 185 @_log_mt5_last_status_code def shutdown ( self ) -> None : \"\"\"Close the previously established connection to the MetaTrader 5 terminal.\"\"\" self . logger . info ( \"Shutting down MT5 connection.\" ) response = self . mt5 . shutdown () self . _is_initialized = False return response symbol_info \u00b6 symbol_info ( symbol : str ) -> Any Get data on the specified financial instrument. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description Any Symbol info structure or None. Source code in pdmt5/mt5.py 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 @_log_mt5_last_status_code def symbol_info ( self , symbol : str ) -> Any : \"\"\"Get data on the specified financial instrument. Args: symbol: Symbol name. Returns: Symbol info structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving information for symbol: %s \" , symbol ) response = self . mt5 . symbol_info ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"symbol_info\" , context = f \"symbol= { symbol } \" , ) return response symbol_info_tick \u00b6 symbol_info_tick ( symbol : str ) -> Any Get the last tick for the specified financial instrument. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description Any Tick info structure or None. Source code in pdmt5/mt5.py 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 @_log_mt5_last_status_code def symbol_info_tick ( self , symbol : str ) -> Any : \"\"\"Get the last tick for the specified financial instrument. Args: symbol: Symbol name. Returns: Tick info structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving last tick for symbol: %s \" , symbol ) response = self . mt5 . symbol_info_tick ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"symbol_info_tick\" , context = f \"symbol= { symbol } \" , ) return response symbol_select \u00b6 symbol_select ( symbol : str , enable : bool = True ) -> bool Select a symbol in the MarketWatch window or remove a symbol from the window. Parameters: Name Type Description Default symbol str Symbol name. required enable bool True to show, False to hide. True Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 @_log_mt5_last_status_code def symbol_select ( self , symbol : str , enable : bool = True ) -> bool : \"\"\"Select a symbol in the MarketWatch window or remove a symbol from the window. Args: symbol: Symbol name. enable: True to show, False to hide. Returns: True if successful, False otherwise. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Selecting symbol: %s , enable= %s \" , symbol , enable ) response = self . mt5 . symbol_select ( symbol , enable ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"symbol_select\" , context = f \"symbol= { symbol } , enable= { enable } \" , ) return response symbols_get \u00b6 symbols_get ( group : str | None = None ) -> tuple [ Any , ... ] Get all financial instruments from the terminal. Parameters: Name Type Description Default group str | None Symbol group filter. None Returns: Type Description tuple [ Any , ...] Tuple of symbol info structures or None. Source code in pdmt5/mt5.py 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 @_log_mt5_last_status_code def symbols_get ( self , group : str | None = None ) -> tuple [ Any , ... ]: \"\"\"Get all financial instruments from the terminal. Args: group: Symbol group filter. Returns: Tuple of symbol info structures or None. \"\"\" self . _initialize_if_needed () if group is not None : self . logger . info ( \"Retrieving symbols for group: %s \" , group ) response = self . mt5 . symbols_get ( group = group ) context = f \"group= { group } \" else : self . logger . info ( \"Retrieving all symbols.\" ) response = self . mt5 . symbols_get () context = None self . _validate_mt5_response_is_not_none ( response = response , operation = \"symbols_get\" , context = context , ) return response symbols_total \u00b6 symbols_total () -> int Get the number of all financial instruments in the terminal. Returns: Type Description int Total number of symbols. Source code in pdmt5/mt5.py 239 240 241 242 243 244 245 246 247 248 @_log_mt5_last_status_code def symbols_total ( self ) -> int : \"\"\"Get the number of all financial instruments in the terminal. Returns: Total number of symbols. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of symbols.\" ) return self . mt5 . symbols_total () terminal_info \u00b6 terminal_info () -> Any Get the connected MetaTrader 5 client terminal status and settings. Returns: Type Description Any TerminalInfo structure or None. Source code in pdmt5/mt5.py 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 @_log_mt5_last_status_code def terminal_info ( self ) -> Any : \"\"\"Get the connected MetaTrader 5 client terminal status and settings. Returns: TerminalInfo structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving terminal information.\" ) response = self . mt5 . terminal_info () self . _validate_mt5_response_is_not_none ( response = response , operation = \"terminal_info\" , ) return response version \u00b6 version () -> tuple [ int , int , str ] Return the MetaTrader 5 terminal version. Returns: Type Description tuple [ int , int , str ] Tuple of (terminal_version, build, release_date). Source code in pdmt5/mt5.py 187 188 189 190 191 192 193 194 195 196 @_log_mt5_last_status_code def version ( self ) -> tuple [ int , int , str ]: \"\"\"Return the MetaTrader 5 terminal version. Returns: Tuple of (terminal_version, build, release_date). \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving MT5 version information.\" ) return self . mt5 . version () options: show_bases: false Base client class for MetaTrader 5 operations with connection management and error handling. Mt5RuntimeError \u00b6 pdmt5.mt5.Mt5RuntimeError \u00b6 Bases: RuntimeError MetaTrader5 specific runtime error. Raised when MetaTrader5 operations fail or when the client is used incorrectly (e.g., calling methods before initialization). options: show_bases: false Custom runtime exception for MetaTrader 5 specific errors. Usage Examples \u00b6 Basic Connection \u00b6 import MetaTrader5 as mt5 from pdmt5.mt5 import Mt5Client # Create client client = Mt5Client ( mt5 = mt5 ) # Use as context manager with client : # Initialize connection success = client . initialize () if success : print ( \"Connected to MetaTrader 5\" ) # Get version info version = client . version () print ( f \"MT5 Version: { version } \" ) # Get account info account = client . account_info () print ( f \"Account: { account } \" ) Connection with Login \u00b6 with client : # Initialize with path client . initialize ( path = \"C: \\\\ Program Files \\\\ MetaTrader 5 \\\\ terminal64.exe\" ) # Login to specific account success = client . login ( login = 12345 , password = \"your_password\" , server = \"broker_server\" ) if success : print ( \"Logged in successfully\" ) Symbol Operations \u00b6 with client : client . initialize () # Get total number of symbols total = client . symbols_total () print ( f \"Total symbols: { total } \" ) # Get all symbols symbols = client . symbols_get () print ( f \"First 5 symbols: { symbols [: 5 ] } \" ) # Get symbols by group forex_symbols = client . symbols_get ( group = \"*USD*\" ) # Get specific symbol info symbol_info = client . symbol_info ( \"EURUSD\" ) print ( f \"EURUSD info: { symbol_info } \" ) # Get current tick tick = client . symbol_info_tick ( \"EURUSD\" ) print ( f \"Current EURUSD tick: { tick } \" ) Market Data Retrieval \u00b6 from datetime import datetime import MetaTrader5 as mt5 with client : client . initialize () # Get OHLCV rates from specific date rates = client . copy_rates_from ( symbol = \"EURUSD\" , timeframe = mt5 . TIMEFRAME_H1 , date_from = datetime ( 2024 , 1 , 1 ), count = 100 ) # Get rates within date range rates_range = client . copy_rates_range ( symbol = \"EURUSD\" , timeframe = mt5 . TIMEFRAME_D1 , date_from = datetime ( 2024 , 1 , 1 ), date_to = datetime ( 2024 , 1 , 31 ) ) # Get tick data ticks = client . copy_ticks_from ( symbol = \"EURUSD\" , date_from = datetime ( 2024 , 1 , 1 ), count = 1000 , flags = mt5 . COPY_TICKS_ALL ) Trading Operations \u00b6 with client : client . initialize () client . login ( 12345 , \"password\" , \"server\" ) # Get current positions positions = client . positions_get () print ( f \"Open positions: { len ( positions ) if positions else 0 } \" ) # Get current orders orders = client . orders_get () print ( f \"Pending orders: { len ( orders ) if orders else 0 } \" ) # Calculate margin requirement margin = client . order_calc_margin ( action = mt5 . ORDER_TYPE_BUY , symbol = \"EURUSD\" , volume = 1.0 , price = 1.1000 ) print ( f \"Required margin: { margin } \" ) # Calculate profit profit = client . order_calc_profit ( action = mt5 . ORDER_TYPE_BUY , symbol = \"EURUSD\" , volume = 1.0 , price_open = 1.1000 , price_close = 1.1050 ) print ( f \"Calculated profit: { profit } \" ) Historical Data \u00b6 from datetime import datetime with client : client . initialize () # Get historical orders history_orders = client . history_orders_get ( date_from = datetime ( 2024 , 1 , 1 ), date_to = datetime ( 2024 , 1 , 31 ) ) # Get historical deals history_deals = client . history_deals_get ( date_from = datetime ( 2024 , 1 , 1 ), date_to = datetime ( 2024 , 1 , 31 ) ) # Get specific order by ticket order = client . history_orders_get ( ticket = 123456 ) Market Book Operations \u00b6 with client : client . initialize () # Subscribe to market depth success = client . market_book_add ( \"EURUSD\" ) if success : print ( \"Subscribed to EURUSD market depth\" ) # Get market book book = client . market_book_get ( \"EURUSD\" ) print ( f \"Market book: { book } \" ) # Unsubscribe client . market_book_release ( \"EURUSD\" ) Connection Management \u00b6 The Mt5Client supports both explicit and context manager usage: # Explicit initialization client = Mt5Client ( mt5 = mt5 ) client . initialize () try : # Your trading operations account = client . account_info () finally : client . shutdown () # Context manager (recommended) with Mt5Client ( mt5 = mt5 ) as client : client . initialize () # Your trading operations account = client . account_info () Error Handling \u00b6 All methods include proper error handling and raise Mt5RuntimeError with detailed information when operations fail: from pdmt5.mt5 import Mt5RuntimeError try : with client : client . initialize () rates = client . copy_rates_from ( \"INVALID\" , mt5 . TIMEFRAME_H1 , datetime . now (), 100 ) except Mt5RuntimeError as e : print ( f \"MetaTrader 5 error: { e } \" ) Logging \u00b6 The client includes comprehensive logging for all operations: import logging # Enable debug logging to see all MT5 operations logging . basicConfig ( level = logging . DEBUG ) with client : client . initialize () # Will log initialization details account = client . account_info () # Will log account retrieval Method Categories \u00b6 Connection Management \u00b6 initialize() - Initialize MT5 connection login() - Login to trading account shutdown() - Close connection version() - Get MT5 version last_error() - Get last error details Account & Terminal \u00b6 account_info() - Get account information terminal_info() - Get terminal status and settings Symbol Management \u00b6 symbols_total() - Get total number of symbols symbols_get() - Get symbol list symbol_info() - Get symbol information symbol_info_tick() - Get current tick symbol_select() - Add/remove symbol from Market Watch Market Data \u00b6 copy_rates_from() - Get OHLCV rates from date copy_rates_from_pos() - Get OHLCV rates from position copy_rates_range() - Get OHLCV rates in date range copy_ticks_from() - Get ticks from date copy_ticks_range() - Get ticks in date range Market Book \u00b6 market_book_add() - Subscribe to market depth market_book_release() - Unsubscribe from market depth market_book_get() - Get market book data Trading \u00b6 orders_total() - Get number of pending orders orders_get() - Get pending orders positions_total() - Get number of open positions positions_get() - Get open positions order_calc_margin() - Calculate required margin order_calc_profit() - Calculate profit order_check() - Validate order request order_send() - Send trading order History \u00b6 history_orders_total() - Get historical orders count history_orders_get() - Get historical orders history_deals_total() - Get historical deals count history_deals_get() - Get historical deals Best Practices \u00b6 Always use context manager for automatic connection management Handle errors gracefully with try-except blocks Initialize before operations - call initialize() after creating the client Use logging to debug connection and operation issues Check return values - many methods return None on failure Use appropriate timeframes and date ranges for data requests Subscribe/unsubscribe to market book properly to avoid resource leaks","title":"MetaTrader5"},{"location":"api/mt5/#mt5client","text":"","title":"Mt5Client"},{"location":"api/mt5/#pdmt5.mt5","text":"MetaTrader5 client wrapper class.","title":"mt5"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client","text":"Bases: BaseModel MetaTrader5 client class. This class provides a wrapper interface to all MetaTrader5 functions, delegating calls to the underlying MetaTrader5 module while providing error handling and logging capabilities.","title":"Mt5Client"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.logger","text":"logger : Logger = Field ( default_factory = lambda : getLogger ( __name__ ), description = \"Logger instance for MetaTrader5 operations\" , )","title":"logger"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.model_config","text":"model_config = ConfigDict ( arbitrary_types_allowed = True )","title":"model_config"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.mt5","text":"mt5 : ModuleType = Field ( default_factory = lambda : import_module ( \"MetaTrader5\" ), description = \"MetaTrader5 module instance\" , )","title":"mt5"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.__enter__","text":"__enter__ () -> Self Context manager entry. Returns: Name Type Description Mt5Client Self The client instance. Source code in pdmt5/mt5.py 83 84 85 86 87 88 89 90 def __enter__ ( self ) -> Self : \"\"\"Context manager entry. Returns: Mt5Client: The client instance. \"\"\" self . initialize () return self","title":"__enter__"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.__exit__","text":"__exit__ ( exc_type : type [ BaseException ] | None , exc_val : BaseException | None , exc_tb : TracebackType | None , ) -> None Context manager exit. Source code in pdmt5/mt5.py 92 93 94 95 96 97 98 99 def __exit__ ( self , exc_type : type [ BaseException ] | None , exc_val : BaseException | None , exc_tb : TracebackType | None , ) -> None : \"\"\"Context manager exit.\"\"\" self . shutdown ()","title":"__exit__"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.account_info","text":"account_info () -> Any Get info on the current trading account. Returns: Type Description Any AccountInfo structure or None. Source code in pdmt5/mt5.py 208 209 210 211 212 213 214 215 216 217 218 219 220 221 @_log_mt5_last_status_code def account_info ( self ) -> Any : \"\"\"Get info on the current trading account. Returns: AccountInfo structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving account information.\" ) response = self . mt5 . account_info () self . _validate_mt5_response_is_not_none ( response = response , operation = \"account_info\" ) return response","title":"account_info"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_rates_from","text":"copy_rates_from ( symbol : str , timeframe : int , date_from : datetime | int , count : int , ) -> Any Get bars from the terminal starting from the specified date. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime | int Start date or timestamp. required count int Number of bars to retrieve. required Returns: Type Description Any Array of rates or None. Source code in pdmt5/mt5.py 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 433 @_log_mt5_last_status_code def copy_rates_from ( self , symbol : str , timeframe : int , date_from : datetime | int , count : int , ) -> Any : \"\"\"Get bars from the terminal starting from the specified date. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date or timestamp. count: Number of bars to retrieve. Returns: Array of rates or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Copying rates from symbol: %s , timeframe: %d , date_from: %s , count: %d \" , symbol , timeframe , date_from , count , ) response = self . mt5 . copy_rates_from ( symbol , timeframe , date_from , count ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_rates_from\" , context = ( f \"symbol= { symbol } , timeframe= { timeframe } ,\" f \" date_from= { date_from } , count= { count } \" ), ) return response","title":"copy_rates_from"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_rates_from_pos","text":"copy_rates_from_pos ( symbol : str , timeframe : int , start_pos : int , count : int ) -> Any Get bars from the terminal starting from the specified index. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required start_pos int Starting position. required count int Number of bars to retrieve. required Returns: Type Description Any Array of rates or None. Source code in pdmt5/mt5.py 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 @_log_mt5_last_status_code def copy_rates_from_pos ( self , symbol : str , timeframe : int , start_pos : int , count : int , ) -> Any : \"\"\"Get bars from the terminal starting from the specified index. Args: symbol: Symbol name. timeframe: Timeframe constant. start_pos: Starting position. count: Number of bars to retrieve. Returns: Array of rates or None. \"\"\" self . _initialize_if_needed () self . logger . info ( ( \"Copying rates from position:\" \" symbol= %s , timeframe= %d , start_pos= %d , count= %d \" ), symbol , timeframe , start_pos , count , ) response = self . mt5 . copy_rates_from_pos ( symbol , timeframe , start_pos , count ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_rates_from_pos\" , context = ( f \"symbol= { symbol } , timeframe= { timeframe } ,\" f \" start_pos= { start_pos } , count= { count } \" ), ) return response","title":"copy_rates_from_pos"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_rates_range","text":"copy_rates_range ( symbol : str , timeframe : int , date_from : datetime | int , date_to : datetime | int , ) -> Any Get bars in the specified date range from the terminal. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime | int Start date or timestamp. required date_to datetime | int End date or timestamp. required Returns: Type Description Any Array of rates or None. Source code in pdmt5/mt5.py 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 @_log_mt5_last_status_code def copy_rates_range ( self , symbol : str , timeframe : int , date_from : datetime | int , date_to : datetime | int , ) -> Any : \"\"\"Get bars in the specified date range from the terminal. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date or timestamp. date_to: End date or timestamp. Returns: Array of rates or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Copying rates range: symbol= %s , timeframe= %d , date_from= %s , date_to= %s \" , symbol , timeframe , date_from , date_to , ) response = self . mt5 . copy_rates_range ( symbol , timeframe , date_from , date_to ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_rates_range\" , context = ( f \"symbol= { symbol } , timeframe= { timeframe } ,\" f \" date_from= { date_from } , date_to= { date_to } \" ), ) return response","title":"copy_rates_range"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_ticks_from","text":"copy_ticks_from ( symbol : str , date_from : datetime | int , count : int , flags : int , ) -> Any Get ticks from the terminal starting from the specified date. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime | int Start date or timestamp. required count int Number of ticks to retrieve. required flags int Tick flags. required Returns: Type Description Any Array of ticks or None. Source code in pdmt5/mt5.py 514 515 516 517 518 519 520 521 522 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 @_log_mt5_last_status_code def copy_ticks_from ( self , symbol : str , date_from : datetime | int , count : int , flags : int , ) -> Any : \"\"\"Get ticks from the terminal starting from the specified date. Args: symbol: Symbol name. date_from: Start date or timestamp. count: Number of ticks to retrieve. flags: Tick flags. Returns: Array of ticks or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Copying ticks from symbol: %s , date_from: %s , count: %d , flags: %d \" , symbol , date_from , count , flags , ) response = self . mt5 . copy_ticks_from ( symbol , date_from , count , flags ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_ticks_from\" , context = ( f \"symbol= { symbol } , date_from= { date_from } , count= { count } , flags= { flags } \" ), ) return response","title":"copy_ticks_from"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_ticks_range","text":"copy_ticks_range ( symbol : str , date_from : datetime | int , date_to : datetime | int , flags : int , ) -> Any Get ticks for the specified date range from the terminal. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime | int Start date or timestamp. required date_to datetime | int End date or timestamp. required flags int Tick flags. required Returns: Type Description Any Array of ticks or None. Source code in pdmt5/mt5.py 551 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 @_log_mt5_last_status_code def copy_ticks_range ( self , symbol : str , date_from : datetime | int , date_to : datetime | int , flags : int , ) -> Any : \"\"\"Get ticks for the specified date range from the terminal. Args: symbol: Symbol name. date_from: Start date or timestamp. date_to: End date or timestamp. flags: Tick flags. Returns: Array of ticks or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Copying ticks range: symbol= %s , date_from= %s , date_to= %s , flags= %d \" , symbol , date_from , date_to , flags , ) response = self . mt5 . copy_ticks_range ( symbol , date_from , date_to , flags ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_ticks_range\" , context = ( f \"symbol= { symbol } , date_from= { date_from } ,\" f \" date_to= { date_to } , flags= { flags } \" ), ) return response","title":"copy_ticks_range"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.history_deals_get","text":"history_deals_get ( date_from : datetime | int | None = None , date_to : datetime | int | None = None , group : str | None = None , ticket : int | None = None , position : int | None = None , ) -> tuple [ Any , ... ] Get deals from trading history within the specified interval with the ability to filter by ticket or position. Parameters: Name Type Description Default date_from datetime | int | None Start date or timestamp. None date_to datetime | int | None End date or timestamp. None group str | None Group filter. None ticket int | None Order ticket filter. None position int | None Position ticket filter. None Returns: Type Description tuple [ Any , ...] Tuple of historical deal info structures or None. Source code in pdmt5/mt5.py 914 915 916 917 918 919 920 921 922 923 924 925 926 927 928 929 930 931 932 933 934 935 936 937 938 939 940 941 942 943 944 945 946 947 948 949 950 951 952 953 954 955 956 957 958 959 960 961 962 963 964 965 966 @_log_mt5_last_status_code def history_deals_get ( self , date_from : datetime | int | None = None , date_to : datetime | int | None = None , group : str | None = None , ticket : int | None = None , position : int | None = None , ) -> tuple [ Any , ... ]: \"\"\"Get deals from trading history within the specified interval with the ability to filter by ticket or position. Args: date_from: Start date or timestamp. date_to: End date or timestamp. group: Group filter. ticket: Order ticket filter. position: Position ticket filter. Returns: Tuple of historical deal info structures or None. \"\"\" # noqa: E501 self . _initialize_if_needed () if ticket is not None : self . logger . info ( \"Retrieving deal with ticket: %d \" , ticket ) response = self . mt5 . history_deals_get ( ticket = ticket ) context = f \"ticket= { ticket } \" elif position is not None : self . logger . info ( \"Retrieving deal for position: %d \" , position ) response = self . mt5 . history_deals_get ( position = position ) context = f \"position= { position } \" elif group is not None : self . logger . info ( \"Retrieving deals for group: %s , date_from: %s , date_to: %s \" , group , date_from , date_to , ) response = self . mt5 . history_deals_get ( date_from , date_to , group = group ) context = f \"date_from= { date_from } , date_to= { date_to } , group= { group } \" else : self . logger . info ( \"Retrieving all historical deals from %s to %s \" , date_from , date_to , ) response = self . mt5 . history_deals_get ( date_from , date_to ) context = f \"date_from= { date_from } , date_to= { date_to } \" self . _validate_mt5_response_is_not_none ( response = response , operation = \"history_deals_get\" , context = context , ) return response","title":"history_deals_get"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.history_deals_total","text":"history_deals_total ( date_from : datetime | int , date_to : datetime | int ) -> int Get the number of deals in trading history within the specified interval. Parameters: Name Type Description Default date_from datetime | int Start date or timestamp. required date_to datetime | int End date or timestamp. required Returns: Type Description int Number of historical deals. Source code in pdmt5/mt5.py 891 892 893 894 895 896 897 898 899 900 901 902 903 904 905 906 907 908 909 910 911 912 @_log_mt5_last_status_code def history_deals_total ( self , date_from : datetime | int , date_to : datetime | int , ) -> int : \"\"\"Get the number of deals in trading history within the specified interval. Args: date_from: Start date or timestamp. date_to: End date or timestamp. Returns: Number of historical deals. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of historical deals from %s to %s \" , date_from , date_to , ) return self . mt5 . history_deals_total ( date_from , date_to )","title":"history_deals_total"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.history_orders_get","text":"history_orders_get ( date_from : datetime | int | None = None , date_to : datetime | int | None = None , group : str | None = None , ticket : int | None = None , position : int | None = None , ) -> tuple [ Any , ... ] Get orders from trading history with the ability to filter by ticket or position. Parameters: Name Type Description Default date_from datetime | int | None Start date or timestamp. None date_to datetime | int | None End date or timestamp. None group str | None Group filter. None ticket int | None Order ticket filter. None position int | None Position ticket filter. None Returns: Type Description tuple [ Any , ...] Tuple of historical order info structures or None. Source code in pdmt5/mt5.py 837 838 839 840 841 842 843 844 845 846 847 848 849 850 851 852 853 854 855 856 857 858 859 860 861 862 863 864 865 866 867 868 869 870 871 872 873 874 875 876 877 878 879 880 881 882 883 884 885 886 887 888 889 @_log_mt5_last_status_code def history_orders_get ( self , date_from : datetime | int | None = None , date_to : datetime | int | None = None , group : str | None = None , ticket : int | None = None , position : int | None = None , ) -> tuple [ Any , ... ]: \"\"\"Get orders from trading history with the ability to filter by ticket or position. Args: date_from: Start date or timestamp. date_to: End date or timestamp. group: Group filter. ticket: Order ticket filter. position: Position ticket filter. Returns: Tuple of historical order info structures or None. \"\"\" # noqa: E501 self . _initialize_if_needed () if ticket is not None : self . logger . info ( \"Retrieving order with ticket: %d \" , ticket ) response = self . mt5 . history_orders_get ( ticket = ticket ) context = f \"ticket= { ticket } \" elif position is not None : self . logger . info ( \"Retrieving order for position: %d \" , position ) response = self . mt5 . history_orders_get ( position = position ) context = f \"position= { position } \" elif group is not None : self . logger . info ( \"Retrieving orders for group: %s , date_from: %s , date_to: %s \" , group , date_from , date_to , ) response = self . mt5 . history_orders_get ( date_from , date_to , group = group ) context = f \"date_from= { date_from } , date_to= { date_to } , group= { group } \" else : self . logger . info ( \"Retrieving all historical orders from %s to %s \" , date_from , date_to , ) response = self . mt5 . history_orders_get ( date_from , date_to ) context = f \"date_from= { date_from } , date_to= { date_to } \" self . _validate_mt5_response_is_not_none ( response = response , operation = \"history_orders_get\" , context = context , ) return response","title":"history_orders_get"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.history_orders_total","text":"history_orders_total ( date_from : datetime | int , date_to : datetime | int ) -> int Get the number of orders in trading history within the specified interval. Parameters: Name Type Description Default date_from datetime | int Start date or timestamp. required date_to datetime | int End date or timestamp. required Returns: Type Description int Number of historical orders. Source code in pdmt5/mt5.py 814 815 816 817 818 819 820 821 822 823 824 825 826 827 828 829 830 831 832 833 834 835 @_log_mt5_last_status_code def history_orders_total ( self , date_from : datetime | int , date_to : datetime | int , ) -> int : \"\"\"Get the number of orders in trading history within the specified interval. Args: date_from: Start date or timestamp. date_to: End date or timestamp. Returns: Number of historical orders. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of historical orders from %s to %s \" , date_from , date_to , ) return self . mt5 . history_orders_total ( date_from , date_to )","title":"history_orders_total"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.initialize","text":"initialize ( path : str | None = None , login : int | None = None , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> bool Establish a connection with the MetaTrader 5 terminal. Parameters: Name Type Description Default path str | None Path to the MetaTrader 5 terminal EXE file. None login int | None Trading account number. None password str | None Trading account password. None server str | None Trade server address. None timeout int | None Connection timeout in milliseconds. None Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 @_log_mt5_last_status_code def initialize ( self , path : str | None = None , login : int | None = None , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> bool : \"\"\"Establish a connection with the MetaTrader 5 terminal. Args: path: Path to the MetaTrader 5 terminal EXE file. login: Trading account number. password: Trading account password. server: Trade server address. timeout: Connection timeout in milliseconds. Returns: True if successful, False otherwise. \"\"\" if path is not None : self . logger . info ( \"Initializing MT5 connection with path: %s \" , path , ) self . _is_initialized = self . mt5 . initialize ( path , ** { k : v for k , v in { \"login\" : login , \"password\" : password , \"server\" : server , \"timeout\" : timeout , } . items () if v is not None }, ) else : self . logger . info ( \"Initializing MT5 connection.\" ) self . _is_initialized = self . mt5 . initialize () return self . _is_initialized","title":"initialize"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.last_error","text":"last_error () -> tuple [ int , str ] Return data on the last error. Returns: Type Description tuple [ int , str ] Tuple of (error_code, error_description). Source code in pdmt5/mt5.py 198 199 200 201 202 203 204 205 206 @_log_mt5_last_status_code def last_error ( self ) -> tuple [ int , str ]: \"\"\"Return data on the last error. Returns: Tuple of (error_code, error_description). \"\"\" self . logger . info ( \"Retrieving last MT5 error\" ) return self . mt5 . last_error ()","title":"last_error"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.login","text":"login ( login : int , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> bool Connect to a trading account using specified parameters. Parameters: Name Type Description Default login int Trading account number. required password str | None Trading account password. None server str | None Trade server address. None timeout int | None Connection timeout in milliseconds. None Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 @_log_mt5_last_status_code def login ( self , login : int , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> bool : \"\"\"Connect to a trading account using specified parameters. Args: login: Trading account number. password: Trading account password. server: Trade server address. timeout: Connection timeout in milliseconds. Returns: True if successful, False otherwise. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Logging in to MT5 account: %d \" , login ) return self . mt5 . login ( login , ** { k : v for k , v in { \"password\" : password , \"server\" : server , \"timeout\" : timeout , } . items () if v is not None }, )","title":"login"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.market_book_add","text":"market_book_add ( symbol : str ) -> bool Subscribe the terminal to the Market Depth change events for a specified symbol. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 @_log_mt5_last_status_code def market_book_add ( self , symbol : str ) -> bool : \"\"\"Subscribe the terminal to the Market Depth change events for a specified symbol. Args: symbol: Symbol name. Returns: True if successful, False otherwise. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Adding market book for symbol: %s \" , symbol ) response = self . mt5 . market_book_add ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"market_book_add\" , context = f \"symbol= { symbol } \" , ) return response","title":"market_book_add"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.market_book_get","text":"market_book_get ( symbol : str ) -> tuple [ Any , ... ] Return a tuple from BookInfo featuring Market Depth entries for the specified symbol. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description tuple [ Any , ...] Tuple of BookInfo structures or None. Source code in pdmt5/mt5.py 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 @_log_mt5_last_status_code def market_book_get ( self , symbol : str ) -> tuple [ Any , ... ]: \"\"\"Return a tuple from BookInfo featuring Market Depth entries for the specified symbol. Args: symbol: Symbol name. Returns: Tuple of BookInfo structures or None. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Retrieving market book for symbol: %s \" , symbol ) response = self . mt5 . market_book_get ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"market_book_get\" , context = f \"symbol= { symbol } \" , ) return response","title":"market_book_get"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.market_book_release","text":"market_book_release ( symbol : str ) -> bool Cancels subscription of the terminal to the Market Depth change events for a specified symbol. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 @_log_mt5_last_status_code def market_book_release ( self , symbol : str ) -> bool : \"\"\"Cancels subscription of the terminal to the Market Depth change events for a specified symbol. Args: symbol: Symbol name. Returns: True if successful, False otherwise. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Releasing market book for symbol: %s \" , symbol ) response = self . mt5 . market_book_release ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"market_book_release\" , context = f \"symbol= { symbol } \" , ) return response","title":"market_book_release"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.order_calc_margin","text":"order_calc_margin ( action : int , symbol : str , volume : float , price : float ) -> float Return margin in the account currency to perform a specified trading operation. Parameters: Name Type Description Default action int Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL). required symbol str Symbol name. required volume float Volume in lots. required price float Open price. required Returns: Type Description float Required margin amount or None. Source code in pdmt5/mt5.py 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 657 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 @_log_mt5_last_status_code def order_calc_margin ( self , action : int , symbol : str , volume : float , price : float , ) -> float : \"\"\"Return margin in the account currency to perform a specified trading operation. Args: action: Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL). symbol: Symbol name. volume: Volume in lots. price: Open price. Returns: Required margin amount or None. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Calculating margin: action= %d , symbol= %s , volume= %.2f , price= %.5f \" , action , symbol , volume , price , ) response = self . mt5 . order_calc_margin ( action , symbol , volume , price ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"order_calc_margin\" , context = f \"action= { action } , symbol= { symbol } , volume= { volume } , price= { price } \" , ) return response","title":"order_calc_margin"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.order_calc_profit","text":"order_calc_profit ( action : int , symbol : str , volume : float , price_open : float , price_close : float , ) -> float Return profit in the account currency for a specified trading operation. Parameters: Name Type Description Default action int Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL). required symbol str Symbol name. required volume float Volume in lots. required price_open float Open price. required price_close float Close price. required Returns: Type Description float Calculated profit or None. Source code in pdmt5/mt5.py 676 677 678 679 680 681 682 683 684 685 686 687 688 689 690 691 692 693 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 712 713 714 715 716 717 718 719 720 @_log_mt5_last_status_code def order_calc_profit ( self , action : int , symbol : str , volume : float , price_open : float , price_close : float , ) -> float : \"\"\"Return profit in the account currency for a specified trading operation. Args: action: Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL). symbol: Symbol name. volume: Volume in lots. price_open: Open price. price_close: Close price. Returns: Calculated profit or None. \"\"\" self . _initialize_if_needed () self . logger . info ( ( \"Calculating profit: action= %d , symbol= %s , volume= %.2f ,\" \" price_open= %.5f , price_close= %.5f \" ), action , symbol , volume , price_open , price_close , ) response = self . mt5 . order_calc_profit ( action , symbol , volume , price_open , price_close ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"order_calc_profit\" , context = ( f \"action= { action } , symbol= { symbol } , volume= { volume } ,\" f \" price_open= { price_open } , price_close= { price_close } \" ), ) return response","title":"order_calc_profit"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.order_check","text":"order_check ( request : dict [ str , Any ]) -> Any Check funds sufficiency for performing a required trading operation. Parameters: Name Type Description Default request dict [ str , Any ] Trade request dictionary. required Returns: Type Description Any OrderCheckResult structure or None. Source code in pdmt5/mt5.py 722 723 724 725 726 727 728 729 730 731 732 733 734 735 736 737 738 739 740 @_log_mt5_last_status_code def order_check ( self , request : dict [ str , Any ]) -> Any : \"\"\"Check funds sufficiency for performing a required trading operation. Args: request: Trade request dictionary. Returns: OrderCheckResult structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Checking order with request: %s \" , request ) response = self . mt5 . order_check ( request ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"order_check\" , context = f \"request= { request } \" , ) return response","title":"order_check"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.order_send","text":"order_send ( request : dict [ str , Any ]) -> Any Send a request to perform a trading operation from the terminal to the trade server. Parameters: Name Type Description Default request dict [ str , Any ] Trade request dictionary. required Returns: Type Description Any OrderSendResult structure or None. Source code in pdmt5/mt5.py 742 743 744 745 746 747 748 749 750 751 752 753 754 755 756 757 758 759 760 @_log_mt5_last_status_code def order_send ( self , request : dict [ str , Any ]) -> Any : \"\"\"Send a request to perform a trading operation from the terminal to the trade server. Args: request: Trade request dictionary. Returns: OrderSendResult structure or None. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Sending order with request: %s \" , request ) response = self . mt5 . order_send ( request ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"order_send\" , context = f \"request= { request } \" , ) return response","title":"order_send"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.orders_get","text":"orders_get ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , ) -> tuple [ Any , ... ] Get active orders with the ability to filter by symbol or ticket. Parameters: Name Type Description Default symbol str | None Symbol name filter. None group str | None Group filter. None ticket int | None Order ticket filter. None Returns: Type Description tuple [ Any , ...] Tuple of order info structures or None. Source code in pdmt5/mt5.py 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 623 624 625 626 627 628 629 630 631 632 633 634 635 636 637 638 639 @_log_mt5_last_status_code def orders_get ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , ) -> tuple [ Any , ... ]: \"\"\"Get active orders with the ability to filter by symbol or ticket. Args: symbol: Symbol name filter. group: Group filter. ticket: Order ticket filter. Returns: Tuple of order info structures or None. \"\"\" self . _initialize_if_needed () if ticket is not None : self . logger . info ( \"Retrieving order with ticket: %d \" , ticket ) response = self . mt5 . orders_get ( ticket = ticket ) context = f \"ticket= { ticket } \" elif group is not None : self . logger . info ( \"Retrieving orders for group: %s \" , group ) response = self . mt5 . orders_get ( group = group ) context = f \"group= { group } \" elif symbol is not None : self . logger . info ( \"Retrieving orders for symbol: %s \" , symbol ) response = self . mt5 . orders_get ( symbol = symbol ) context = f \"symbol= { symbol } \" else : self . logger . info ( \"Retrieving all active orders.\" ) response = self . mt5 . orders_get () context = None self . _validate_mt5_response_is_not_none ( response = response , operation = \"orders_get\" , context = context , ) return response","title":"orders_get"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.orders_total","text":"orders_total () -> int Get the number of active orders. Returns: Type Description int Number of active orders. Source code in pdmt5/mt5.py 589 590 591 592 593 594 595 596 597 598 @_log_mt5_last_status_code def orders_total ( self ) -> int : \"\"\"Get the number of active orders. Returns: Number of active orders. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of active orders.\" ) return self . mt5 . orders_total ()","title":"orders_total"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.positions_get","text":"positions_get ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , ) -> tuple [ Any , ... ] Get open positions with the ability to filter by symbol or ticket. Parameters: Name Type Description Default symbol str | None Symbol name filter. None group str | None Group filter. None ticket int | None Position ticket filter. None Returns: Type Description tuple [ Any , ...] Tuple of position info structures or None. Source code in pdmt5/mt5.py 773 774 775 776 777 778 779 780 781 782 783 784 785 786 787 788 789 790 791 792 793 794 795 796 797 798 799 800 801 802 803 804 805 806 807 808 809 810 811 812 @_log_mt5_last_status_code def positions_get ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , ) -> tuple [ Any , ... ]: \"\"\"Get open positions with the ability to filter by symbol or ticket. Args: symbol: Symbol name filter. group: Group filter. ticket: Position ticket filter. Returns: Tuple of position info structures or None. \"\"\" self . _initialize_if_needed () if ticket is not None : self . logger . info ( \"Retrieving position with ticket: %d \" , ticket ) response = self . mt5 . positions_get ( ticket = ticket ) context = f \"ticket= { ticket } \" elif group is not None : self . logger . info ( \"Retrieving positions for group: %s \" , group ) response = self . mt5 . positions_get ( group = group ) context = f \"group= { group } \" elif symbol is not None : self . logger . info ( \"Retrieving positions for symbol: %s \" , symbol ) response = self . mt5 . positions_get ( symbol = symbol ) context = f \"symbol= { symbol } \" else : self . logger . info ( \"Retrieving all open positions.\" ) response = self . mt5 . positions_get () context = None self . _validate_mt5_response_is_not_none ( response = response , operation = \"positions_get\" , context = context , ) return response","title":"positions_get"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.positions_total","text":"positions_total () -> int Get the number of open positions. Returns: Type Description int Number of open positions. Source code in pdmt5/mt5.py 762 763 764 765 766 767 768 769 770 771 @_log_mt5_last_status_code def positions_total ( self ) -> int : \"\"\"Get the number of open positions. Returns: Number of open positions. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of open positions.\" ) return self . mt5 . positions_total ()","title":"positions_total"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.shutdown","text":"shutdown () -> None Close the previously established connection to the MetaTrader 5 terminal. Source code in pdmt5/mt5.py 179 180 181 182 183 184 185 @_log_mt5_last_status_code def shutdown ( self ) -> None : \"\"\"Close the previously established connection to the MetaTrader 5 terminal.\"\"\" self . logger . info ( \"Shutting down MT5 connection.\" ) response = self . mt5 . shutdown () self . _is_initialized = False return response","title":"shutdown"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbol_info","text":"symbol_info ( symbol : str ) -> Any Get data on the specified financial instrument. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description Any Symbol info structure or None. Source code in pdmt5/mt5.py 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 @_log_mt5_last_status_code def symbol_info ( self , symbol : str ) -> Any : \"\"\"Get data on the specified financial instrument. Args: symbol: Symbol name. Returns: Symbol info structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving information for symbol: %s \" , symbol ) response = self . mt5 . symbol_info ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"symbol_info\" , context = f \"symbol= { symbol } \" , ) return response","title":"symbol_info"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbol_info_tick","text":"symbol_info_tick ( symbol : str ) -> Any Get the last tick for the specified financial instrument. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description Any Tick info structure or None. Source code in pdmt5/mt5.py 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 @_log_mt5_last_status_code def symbol_info_tick ( self , symbol : str ) -> Any : \"\"\"Get the last tick for the specified financial instrument. Args: symbol: Symbol name. Returns: Tick info structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving last tick for symbol: %s \" , symbol ) response = self . mt5 . symbol_info_tick ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"symbol_info_tick\" , context = f \"symbol= { symbol } \" , ) return response","title":"symbol_info_tick"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbol_select","text":"symbol_select ( symbol : str , enable : bool = True ) -> bool Select a symbol in the MarketWatch window or remove a symbol from the window. Parameters: Name Type Description Default symbol str Symbol name. required enable bool True to show, False to hide. True Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 @_log_mt5_last_status_code def symbol_select ( self , symbol : str , enable : bool = True ) -> bool : \"\"\"Select a symbol in the MarketWatch window or remove a symbol from the window. Args: symbol: Symbol name. enable: True to show, False to hide. Returns: True if successful, False otherwise. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Selecting symbol: %s , enable= %s \" , symbol , enable ) response = self . mt5 . symbol_select ( symbol , enable ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"symbol_select\" , context = f \"symbol= { symbol } , enable= { enable } \" , ) return response","title":"symbol_select"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbols_get","text":"symbols_get ( group : str | None = None ) -> tuple [ Any , ... ] Get all financial instruments from the terminal. Parameters: Name Type Description Default group str | None Symbol group filter. None Returns: Type Description tuple [ Any , ...] Tuple of symbol info structures or None. Source code in pdmt5/mt5.py 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 @_log_mt5_last_status_code def symbols_get ( self , group : str | None = None ) -> tuple [ Any , ... ]: \"\"\"Get all financial instruments from the terminal. Args: group: Symbol group filter. Returns: Tuple of symbol info structures or None. \"\"\" self . _initialize_if_needed () if group is not None : self . logger . info ( \"Retrieving symbols for group: %s \" , group ) response = self . mt5 . symbols_get ( group = group ) context = f \"group= { group } \" else : self . logger . info ( \"Retrieving all symbols.\" ) response = self . mt5 . symbols_get () context = None self . _validate_mt5_response_is_not_none ( response = response , operation = \"symbols_get\" , context = context , ) return response","title":"symbols_get"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbols_total","text":"symbols_total () -> int Get the number of all financial instruments in the terminal. Returns: Type Description int Total number of symbols. Source code in pdmt5/mt5.py 239 240 241 242 243 244 245 246 247 248 @_log_mt5_last_status_code def symbols_total ( self ) -> int : \"\"\"Get the number of all financial instruments in the terminal. Returns: Total number of symbols. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of symbols.\" ) return self . mt5 . symbols_total ()","title":"symbols_total"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.terminal_info","text":"terminal_info () -> Any Get the connected MetaTrader 5 client terminal status and settings. Returns: Type Description Any TerminalInfo structure or None. Source code in pdmt5/mt5.py 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 @_log_mt5_last_status_code def terminal_info ( self ) -> Any : \"\"\"Get the connected MetaTrader 5 client terminal status and settings. Returns: TerminalInfo structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving terminal information.\" ) response = self . mt5 . terminal_info () self . _validate_mt5_response_is_not_none ( response = response , operation = \"terminal_info\" , ) return response","title":"terminal_info"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.version","text":"version () -> tuple [ int , int , str ] Return the MetaTrader 5 terminal version. Returns: Type Description tuple [ int , int , str ] Tuple of (terminal_version, build, release_date). Source code in pdmt5/mt5.py 187 188 189 190 191 192 193 194 195 196 @_log_mt5_last_status_code def version ( self ) -> tuple [ int , int , str ]: \"\"\"Return the MetaTrader 5 terminal version. Returns: Tuple of (terminal_version, build, release_date). \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving MT5 version information.\" ) return self . mt5 . version ()","title":"version"},{"location":"api/mt5/#pdmt5.mt5.Mt5RuntimeError","text":"Bases: RuntimeError MetaTrader5 specific runtime error. Raised when MetaTrader5 operations fail or when the client is used incorrectly (e.g., calling methods before initialization).","title":"Mt5RuntimeError"},{"location":"api/mt5/#overview","text":"The Mt5Client module provides the base client class for connecting to MetaTrader 5 and performing core operations. This is the foundation class that handles the low-level MT5 API interactions and provides basic error handling and connection management.","title":"Overview"},{"location":"api/mt5/#classes","text":"","title":"Classes"},{"location":"api/mt5/#mt5client_1","text":"","title":"Mt5Client"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client","text":"Bases: BaseModel MetaTrader5 client class. This class provides a wrapper interface to all MetaTrader5 functions, delegating calls to the underlying MetaTrader5 module while providing error handling and logging capabilities.","title":"Mt5Client"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.logger","text":"logger : Logger = Field ( default_factory = lambda : getLogger ( __name__ ), description = \"Logger instance for MetaTrader5 operations\" , )","title":"logger"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.model_config","text":"model_config = ConfigDict ( arbitrary_types_allowed = True )","title":"model_config"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.mt5","text":"mt5 : ModuleType = Field ( default_factory = lambda : import_module ( \"MetaTrader5\" ), description = \"MetaTrader5 module instance\" , )","title":"mt5"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.__enter__","text":"__enter__ () -> Self Context manager entry. Returns: Name Type Description Mt5Client Self The client instance. Source code in pdmt5/mt5.py 83 84 85 86 87 88 89 90 def __enter__ ( self ) -> Self : \"\"\"Context manager entry. Returns: Mt5Client: The client instance. \"\"\" self . initialize () return self","title":"__enter__"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.__exit__","text":"__exit__ ( exc_type : type [ BaseException ] | None , exc_val : BaseException | None , exc_tb : TracebackType | None , ) -> None Context manager exit. Source code in pdmt5/mt5.py 92 93 94 95 96 97 98 99 def __exit__ ( self , exc_type : type [ BaseException ] | None , exc_val : BaseException | None , exc_tb : TracebackType | None , ) -> None : \"\"\"Context manager exit.\"\"\" self . shutdown ()","title":"__exit__"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.account_info","text":"account_info () -> Any Get info on the current trading account. Returns: Type Description Any AccountInfo structure or None. Source code in pdmt5/mt5.py 208 209 210 211 212 213 214 215 216 217 218 219 220 221 @_log_mt5_last_status_code def account_info ( self ) -> Any : \"\"\"Get info on the current trading account. Returns: AccountInfo structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving account information.\" ) response = self . mt5 . account_info () self . _validate_mt5_response_is_not_none ( response = response , operation = \"account_info\" ) return response","title":"account_info"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_rates_from","text":"copy_rates_from ( symbol : str , timeframe : int , date_from : datetime | int , count : int , ) -> Any Get bars from the terminal starting from the specified date. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime | int Start date or timestamp. required count int Number of bars to retrieve. required Returns: Type Description Any Array of rates or None. Source code in pdmt5/mt5.py 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 433 @_log_mt5_last_status_code def copy_rates_from ( self , symbol : str , timeframe : int , date_from : datetime | int , count : int , ) -> Any : \"\"\"Get bars from the terminal starting from the specified date. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date or timestamp. count: Number of bars to retrieve. Returns: Array of rates or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Copying rates from symbol: %s , timeframe: %d , date_from: %s , count: %d \" , symbol , timeframe , date_from , count , ) response = self . mt5 . copy_rates_from ( symbol , timeframe , date_from , count ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_rates_from\" , context = ( f \"symbol= { symbol } , timeframe= { timeframe } ,\" f \" date_from= { date_from } , count= { count } \" ), ) return response","title":"copy_rates_from"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_rates_from_pos","text":"copy_rates_from_pos ( symbol : str , timeframe : int , start_pos : int , count : int ) -> Any Get bars from the terminal starting from the specified index. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required start_pos int Starting position. required count int Number of bars to retrieve. required Returns: Type Description Any Array of rates or None. Source code in pdmt5/mt5.py 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 @_log_mt5_last_status_code def copy_rates_from_pos ( self , symbol : str , timeframe : int , start_pos : int , count : int , ) -> Any : \"\"\"Get bars from the terminal starting from the specified index. Args: symbol: Symbol name. timeframe: Timeframe constant. start_pos: Starting position. count: Number of bars to retrieve. Returns: Array of rates or None. \"\"\" self . _initialize_if_needed () self . logger . info ( ( \"Copying rates from position:\" \" symbol= %s , timeframe= %d , start_pos= %d , count= %d \" ), symbol , timeframe , start_pos , count , ) response = self . mt5 . copy_rates_from_pos ( symbol , timeframe , start_pos , count ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_rates_from_pos\" , context = ( f \"symbol= { symbol } , timeframe= { timeframe } ,\" f \" start_pos= { start_pos } , count= { count } \" ), ) return response","title":"copy_rates_from_pos"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_rates_range","text":"copy_rates_range ( symbol : str , timeframe : int , date_from : datetime | int , date_to : datetime | int , ) -> Any Get bars in the specified date range from the terminal. Parameters: Name Type Description Default symbol str Symbol name. required timeframe int Timeframe constant. required date_from datetime | int Start date or timestamp. required date_to datetime | int End date or timestamp. required Returns: Type Description Any Array of rates or None. Source code in pdmt5/mt5.py 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 @_log_mt5_last_status_code def copy_rates_range ( self , symbol : str , timeframe : int , date_from : datetime | int , date_to : datetime | int , ) -> Any : \"\"\"Get bars in the specified date range from the terminal. Args: symbol: Symbol name. timeframe: Timeframe constant. date_from: Start date or timestamp. date_to: End date or timestamp. Returns: Array of rates or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Copying rates range: symbol= %s , timeframe= %d , date_from= %s , date_to= %s \" , symbol , timeframe , date_from , date_to , ) response = self . mt5 . copy_rates_range ( symbol , timeframe , date_from , date_to ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_rates_range\" , context = ( f \"symbol= { symbol } , timeframe= { timeframe } ,\" f \" date_from= { date_from } , date_to= { date_to } \" ), ) return response","title":"copy_rates_range"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_ticks_from","text":"copy_ticks_from ( symbol : str , date_from : datetime | int , count : int , flags : int , ) -> Any Get ticks from the terminal starting from the specified date. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime | int Start date or timestamp. required count int Number of ticks to retrieve. required flags int Tick flags. required Returns: Type Description Any Array of ticks or None. Source code in pdmt5/mt5.py 514 515 516 517 518 519 520 521 522 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 @_log_mt5_last_status_code def copy_ticks_from ( self , symbol : str , date_from : datetime | int , count : int , flags : int , ) -> Any : \"\"\"Get ticks from the terminal starting from the specified date. Args: symbol: Symbol name. date_from: Start date or timestamp. count: Number of ticks to retrieve. flags: Tick flags. Returns: Array of ticks or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Copying ticks from symbol: %s , date_from: %s , count: %d , flags: %d \" , symbol , date_from , count , flags , ) response = self . mt5 . copy_ticks_from ( symbol , date_from , count , flags ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_ticks_from\" , context = ( f \"symbol= { symbol } , date_from= { date_from } , count= { count } , flags= { flags } \" ), ) return response","title":"copy_ticks_from"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.copy_ticks_range","text":"copy_ticks_range ( symbol : str , date_from : datetime | int , date_to : datetime | int , flags : int , ) -> Any Get ticks for the specified date range from the terminal. Parameters: Name Type Description Default symbol str Symbol name. required date_from datetime | int Start date or timestamp. required date_to datetime | int End date or timestamp. required flags int Tick flags. required Returns: Type Description Any Array of ticks or None. Source code in pdmt5/mt5.py 551 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 @_log_mt5_last_status_code def copy_ticks_range ( self , symbol : str , date_from : datetime | int , date_to : datetime | int , flags : int , ) -> Any : \"\"\"Get ticks for the specified date range from the terminal. Args: symbol: Symbol name. date_from: Start date or timestamp. date_to: End date or timestamp. flags: Tick flags. Returns: Array of ticks or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Copying ticks range: symbol= %s , date_from= %s , date_to= %s , flags= %d \" , symbol , date_from , date_to , flags , ) response = self . mt5 . copy_ticks_range ( symbol , date_from , date_to , flags ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"copy_ticks_range\" , context = ( f \"symbol= { symbol } , date_from= { date_from } ,\" f \" date_to= { date_to } , flags= { flags } \" ), ) return response","title":"copy_ticks_range"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.history_deals_get","text":"history_deals_get ( date_from : datetime | int | None = None , date_to : datetime | int | None = None , group : str | None = None , ticket : int | None = None , position : int | None = None , ) -> tuple [ Any , ... ] Get deals from trading history within the specified interval with the ability to filter by ticket or position. Parameters: Name Type Description Default date_from datetime | int | None Start date or timestamp. None date_to datetime | int | None End date or timestamp. None group str | None Group filter. None ticket int | None Order ticket filter. None position int | None Position ticket filter. None Returns: Type Description tuple [ Any , ...] Tuple of historical deal info structures or None. Source code in pdmt5/mt5.py 914 915 916 917 918 919 920 921 922 923 924 925 926 927 928 929 930 931 932 933 934 935 936 937 938 939 940 941 942 943 944 945 946 947 948 949 950 951 952 953 954 955 956 957 958 959 960 961 962 963 964 965 966 @_log_mt5_last_status_code def history_deals_get ( self , date_from : datetime | int | None = None , date_to : datetime | int | None = None , group : str | None = None , ticket : int | None = None , position : int | None = None , ) -> tuple [ Any , ... ]: \"\"\"Get deals from trading history within the specified interval with the ability to filter by ticket or position. Args: date_from: Start date or timestamp. date_to: End date or timestamp. group: Group filter. ticket: Order ticket filter. position: Position ticket filter. Returns: Tuple of historical deal info structures or None. \"\"\" # noqa: E501 self . _initialize_if_needed () if ticket is not None : self . logger . info ( \"Retrieving deal with ticket: %d \" , ticket ) response = self . mt5 . history_deals_get ( ticket = ticket ) context = f \"ticket= { ticket } \" elif position is not None : self . logger . info ( \"Retrieving deal for position: %d \" , position ) response = self . mt5 . history_deals_get ( position = position ) context = f \"position= { position } \" elif group is not None : self . logger . info ( \"Retrieving deals for group: %s , date_from: %s , date_to: %s \" , group , date_from , date_to , ) response = self . mt5 . history_deals_get ( date_from , date_to , group = group ) context = f \"date_from= { date_from } , date_to= { date_to } , group= { group } \" else : self . logger . info ( \"Retrieving all historical deals from %s to %s \" , date_from , date_to , ) response = self . mt5 . history_deals_get ( date_from , date_to ) context = f \"date_from= { date_from } , date_to= { date_to } \" self . _validate_mt5_response_is_not_none ( response = response , operation = \"history_deals_get\" , context = context , ) return response","title":"history_deals_get"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.history_deals_total","text":"history_deals_total ( date_from : datetime | int , date_to : datetime | int ) -> int Get the number of deals in trading history within the specified interval. Parameters: Name Type Description Default date_from datetime | int Start date or timestamp. required date_to datetime | int End date or timestamp. required Returns: Type Description int Number of historical deals. Source code in pdmt5/mt5.py 891 892 893 894 895 896 897 898 899 900 901 902 903 904 905 906 907 908 909 910 911 912 @_log_mt5_last_status_code def history_deals_total ( self , date_from : datetime | int , date_to : datetime | int , ) -> int : \"\"\"Get the number of deals in trading history within the specified interval. Args: date_from: Start date or timestamp. date_to: End date or timestamp. Returns: Number of historical deals. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of historical deals from %s to %s \" , date_from , date_to , ) return self . mt5 . history_deals_total ( date_from , date_to )","title":"history_deals_total"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.history_orders_get","text":"history_orders_get ( date_from : datetime | int | None = None , date_to : datetime | int | None = None , group : str | None = None , ticket : int | None = None , position : int | None = None , ) -> tuple [ Any , ... ] Get orders from trading history with the ability to filter by ticket or position. Parameters: Name Type Description Default date_from datetime | int | None Start date or timestamp. None date_to datetime | int | None End date or timestamp. None group str | None Group filter. None ticket int | None Order ticket filter. None position int | None Position ticket filter. None Returns: Type Description tuple [ Any , ...] Tuple of historical order info structures or None. Source code in pdmt5/mt5.py 837 838 839 840 841 842 843 844 845 846 847 848 849 850 851 852 853 854 855 856 857 858 859 860 861 862 863 864 865 866 867 868 869 870 871 872 873 874 875 876 877 878 879 880 881 882 883 884 885 886 887 888 889 @_log_mt5_last_status_code def history_orders_get ( self , date_from : datetime | int | None = None , date_to : datetime | int | None = None , group : str | None = None , ticket : int | None = None , position : int | None = None , ) -> tuple [ Any , ... ]: \"\"\"Get orders from trading history with the ability to filter by ticket or position. Args: date_from: Start date or timestamp. date_to: End date or timestamp. group: Group filter. ticket: Order ticket filter. position: Position ticket filter. Returns: Tuple of historical order info structures or None. \"\"\" # noqa: E501 self . _initialize_if_needed () if ticket is not None : self . logger . info ( \"Retrieving order with ticket: %d \" , ticket ) response = self . mt5 . history_orders_get ( ticket = ticket ) context = f \"ticket= { ticket } \" elif position is not None : self . logger . info ( \"Retrieving order for position: %d \" , position ) response = self . mt5 . history_orders_get ( position = position ) context = f \"position= { position } \" elif group is not None : self . logger . info ( \"Retrieving orders for group: %s , date_from: %s , date_to: %s \" , group , date_from , date_to , ) response = self . mt5 . history_orders_get ( date_from , date_to , group = group ) context = f \"date_from= { date_from } , date_to= { date_to } , group= { group } \" else : self . logger . info ( \"Retrieving all historical orders from %s to %s \" , date_from , date_to , ) response = self . mt5 . history_orders_get ( date_from , date_to ) context = f \"date_from= { date_from } , date_to= { date_to } \" self . _validate_mt5_response_is_not_none ( response = response , operation = \"history_orders_get\" , context = context , ) return response","title":"history_orders_get"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.history_orders_total","text":"history_orders_total ( date_from : datetime | int , date_to : datetime | int ) -> int Get the number of orders in trading history within the specified interval. Parameters: Name Type Description Default date_from datetime | int Start date or timestamp. required date_to datetime | int End date or timestamp. required Returns: Type Description int Number of historical orders. Source code in pdmt5/mt5.py 814 815 816 817 818 819 820 821 822 823 824 825 826 827 828 829 830 831 832 833 834 835 @_log_mt5_last_status_code def history_orders_total ( self , date_from : datetime | int , date_to : datetime | int , ) -> int : \"\"\"Get the number of orders in trading history within the specified interval. Args: date_from: Start date or timestamp. date_to: End date or timestamp. Returns: Number of historical orders. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of historical orders from %s to %s \" , date_from , date_to , ) return self . mt5 . history_orders_total ( date_from , date_to )","title":"history_orders_total"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.initialize","text":"initialize ( path : str | None = None , login : int | None = None , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> bool Establish a connection with the MetaTrader 5 terminal. Parameters: Name Type Description Default path str | None Path to the MetaTrader 5 terminal EXE file. None login int | None Trading account number. None password str | None Trading account password. None server str | None Trade server address. None timeout int | None Connection timeout in milliseconds. None Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 @_log_mt5_last_status_code def initialize ( self , path : str | None = None , login : int | None = None , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> bool : \"\"\"Establish a connection with the MetaTrader 5 terminal. Args: path: Path to the MetaTrader 5 terminal EXE file. login: Trading account number. password: Trading account password. server: Trade server address. timeout: Connection timeout in milliseconds. Returns: True if successful, False otherwise. \"\"\" if path is not None : self . logger . info ( \"Initializing MT5 connection with path: %s \" , path , ) self . _is_initialized = self . mt5 . initialize ( path , ** { k : v for k , v in { \"login\" : login , \"password\" : password , \"server\" : server , \"timeout\" : timeout , } . items () if v is not None }, ) else : self . logger . info ( \"Initializing MT5 connection.\" ) self . _is_initialized = self . mt5 . initialize () return self . _is_initialized","title":"initialize"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.last_error","text":"last_error () -> tuple [ int , str ] Return data on the last error. Returns: Type Description tuple [ int , str ] Tuple of (error_code, error_description). Source code in pdmt5/mt5.py 198 199 200 201 202 203 204 205 206 @_log_mt5_last_status_code def last_error ( self ) -> tuple [ int , str ]: \"\"\"Return data on the last error. Returns: Tuple of (error_code, error_description). \"\"\" self . logger . info ( \"Retrieving last MT5 error\" ) return self . mt5 . last_error ()","title":"last_error"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.login","text":"login ( login : int , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> bool Connect to a trading account using specified parameters. Parameters: Name Type Description Default login int Trading account number. required password str | None Trading account password. None server str | None Trade server address. None timeout int | None Connection timeout in milliseconds. None Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 @_log_mt5_last_status_code def login ( self , login : int , password : str | None = None , server : str | None = None , timeout : int | None = None , ) -> bool : \"\"\"Connect to a trading account using specified parameters. Args: login: Trading account number. password: Trading account password. server: Trade server address. timeout: Connection timeout in milliseconds. Returns: True if successful, False otherwise. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Logging in to MT5 account: %d \" , login ) return self . mt5 . login ( login , ** { k : v for k , v in { \"password\" : password , \"server\" : server , \"timeout\" : timeout , } . items () if v is not None }, )","title":"login"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.market_book_add","text":"market_book_add ( symbol : str ) -> bool Subscribe the terminal to the Market Depth change events for a specified symbol. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 @_log_mt5_last_status_code def market_book_add ( self , symbol : str ) -> bool : \"\"\"Subscribe the terminal to the Market Depth change events for a specified symbol. Args: symbol: Symbol name. Returns: True if successful, False otherwise. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Adding market book for symbol: %s \" , symbol ) response = self . mt5 . market_book_add ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"market_book_add\" , context = f \"symbol= { symbol } \" , ) return response","title":"market_book_add"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.market_book_get","text":"market_book_get ( symbol : str ) -> tuple [ Any , ... ] Return a tuple from BookInfo featuring Market Depth entries for the specified symbol. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description tuple [ Any , ...] Tuple of BookInfo structures or None. Source code in pdmt5/mt5.py 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 @_log_mt5_last_status_code def market_book_get ( self , symbol : str ) -> tuple [ Any , ... ]: \"\"\"Return a tuple from BookInfo featuring Market Depth entries for the specified symbol. Args: symbol: Symbol name. Returns: Tuple of BookInfo structures or None. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Retrieving market book for symbol: %s \" , symbol ) response = self . mt5 . market_book_get ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"market_book_get\" , context = f \"symbol= { symbol } \" , ) return response","title":"market_book_get"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.market_book_release","text":"market_book_release ( symbol : str ) -> bool Cancels subscription of the terminal to the Market Depth change events for a specified symbol. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 @_log_mt5_last_status_code def market_book_release ( self , symbol : str ) -> bool : \"\"\"Cancels subscription of the terminal to the Market Depth change events for a specified symbol. Args: symbol: Symbol name. Returns: True if successful, False otherwise. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Releasing market book for symbol: %s \" , symbol ) response = self . mt5 . market_book_release ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"market_book_release\" , context = f \"symbol= { symbol } \" , ) return response","title":"market_book_release"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.order_calc_margin","text":"order_calc_margin ( action : int , symbol : str , volume : float , price : float ) -> float Return margin in the account currency to perform a specified trading operation. Parameters: Name Type Description Default action int Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL). required symbol str Symbol name. required volume float Volume in lots. required price float Open price. required Returns: Type Description float Required margin amount or None. Source code in pdmt5/mt5.py 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 657 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 @_log_mt5_last_status_code def order_calc_margin ( self , action : int , symbol : str , volume : float , price : float , ) -> float : \"\"\"Return margin in the account currency to perform a specified trading operation. Args: action: Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL). symbol: Symbol name. volume: Volume in lots. price: Open price. Returns: Required margin amount or None. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Calculating margin: action= %d , symbol= %s , volume= %.2f , price= %.5f \" , action , symbol , volume , price , ) response = self . mt5 . order_calc_margin ( action , symbol , volume , price ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"order_calc_margin\" , context = f \"action= { action } , symbol= { symbol } , volume= { volume } , price= { price } \" , ) return response","title":"order_calc_margin"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.order_calc_profit","text":"order_calc_profit ( action : int , symbol : str , volume : float , price_open : float , price_close : float , ) -> float Return profit in the account currency for a specified trading operation. Parameters: Name Type Description Default action int Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL). required symbol str Symbol name. required volume float Volume in lots. required price_open float Open price. required price_close float Close price. required Returns: Type Description float Calculated profit or None. Source code in pdmt5/mt5.py 676 677 678 679 680 681 682 683 684 685 686 687 688 689 690 691 692 693 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 712 713 714 715 716 717 718 719 720 @_log_mt5_last_status_code def order_calc_profit ( self , action : int , symbol : str , volume : float , price_open : float , price_close : float , ) -> float : \"\"\"Return profit in the account currency for a specified trading operation. Args: action: Order type (ORDER_TYPE_BUY or ORDER_TYPE_SELL). symbol: Symbol name. volume: Volume in lots. price_open: Open price. price_close: Close price. Returns: Calculated profit or None. \"\"\" self . _initialize_if_needed () self . logger . info ( ( \"Calculating profit: action= %d , symbol= %s , volume= %.2f ,\" \" price_open= %.5f , price_close= %.5f \" ), action , symbol , volume , price_open , price_close , ) response = self . mt5 . order_calc_profit ( action , symbol , volume , price_open , price_close ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"order_calc_profit\" , context = ( f \"action= { action } , symbol= { symbol } , volume= { volume } ,\" f \" price_open= { price_open } , price_close= { price_close } \" ), ) return response","title":"order_calc_profit"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.order_check","text":"order_check ( request : dict [ str , Any ]) -> Any Check funds sufficiency for performing a required trading operation. Parameters: Name Type Description Default request dict [ str , Any ] Trade request dictionary. required Returns: Type Description Any OrderCheckResult structure or None. Source code in pdmt5/mt5.py 722 723 724 725 726 727 728 729 730 731 732 733 734 735 736 737 738 739 740 @_log_mt5_last_status_code def order_check ( self , request : dict [ str , Any ]) -> Any : \"\"\"Check funds sufficiency for performing a required trading operation. Args: request: Trade request dictionary. Returns: OrderCheckResult structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Checking order with request: %s \" , request ) response = self . mt5 . order_check ( request ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"order_check\" , context = f \"request= { request } \" , ) return response","title":"order_check"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.order_send","text":"order_send ( request : dict [ str , Any ]) -> Any Send a request to perform a trading operation from the terminal to the trade server. Parameters: Name Type Description Default request dict [ str , Any ] Trade request dictionary. required Returns: Type Description Any OrderSendResult structure or None. Source code in pdmt5/mt5.py 742 743 744 745 746 747 748 749 750 751 752 753 754 755 756 757 758 759 760 @_log_mt5_last_status_code def order_send ( self , request : dict [ str , Any ]) -> Any : \"\"\"Send a request to perform a trading operation from the terminal to the trade server. Args: request: Trade request dictionary. Returns: OrderSendResult structure or None. \"\"\" # noqa: E501 self . _initialize_if_needed () self . logger . info ( \"Sending order with request: %s \" , request ) response = self . mt5 . order_send ( request ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"order_send\" , context = f \"request= { request } \" , ) return response","title":"order_send"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.orders_get","text":"orders_get ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , ) -> tuple [ Any , ... ] Get active orders with the ability to filter by symbol or ticket. Parameters: Name Type Description Default symbol str | None Symbol name filter. None group str | None Group filter. None ticket int | None Order ticket filter. None Returns: Type Description tuple [ Any , ...] Tuple of order info structures or None. Source code in pdmt5/mt5.py 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 623 624 625 626 627 628 629 630 631 632 633 634 635 636 637 638 639 @_log_mt5_last_status_code def orders_get ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , ) -> tuple [ Any , ... ]: \"\"\"Get active orders with the ability to filter by symbol or ticket. Args: symbol: Symbol name filter. group: Group filter. ticket: Order ticket filter. Returns: Tuple of order info structures or None. \"\"\" self . _initialize_if_needed () if ticket is not None : self . logger . info ( \"Retrieving order with ticket: %d \" , ticket ) response = self . mt5 . orders_get ( ticket = ticket ) context = f \"ticket= { ticket } \" elif group is not None : self . logger . info ( \"Retrieving orders for group: %s \" , group ) response = self . mt5 . orders_get ( group = group ) context = f \"group= { group } \" elif symbol is not None : self . logger . info ( \"Retrieving orders for symbol: %s \" , symbol ) response = self . mt5 . orders_get ( symbol = symbol ) context = f \"symbol= { symbol } \" else : self . logger . info ( \"Retrieving all active orders.\" ) response = self . mt5 . orders_get () context = None self . _validate_mt5_response_is_not_none ( response = response , operation = \"orders_get\" , context = context , ) return response","title":"orders_get"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.orders_total","text":"orders_total () -> int Get the number of active orders. Returns: Type Description int Number of active orders. Source code in pdmt5/mt5.py 589 590 591 592 593 594 595 596 597 598 @_log_mt5_last_status_code def orders_total ( self ) -> int : \"\"\"Get the number of active orders. Returns: Number of active orders. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of active orders.\" ) return self . mt5 . orders_total ()","title":"orders_total"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.positions_get","text":"positions_get ( symbol : str | None = None , group : str | None = None , ticket : int | None = None , ) -> tuple [ Any , ... ] Get open positions with the ability to filter by symbol or ticket. Parameters: Name Type Description Default symbol str | None Symbol name filter. None group str | None Group filter. None ticket int | None Position ticket filter. None Returns: Type Description tuple [ Any , ...] Tuple of position info structures or None. Source code in pdmt5/mt5.py 773 774 775 776 777 778 779 780 781 782 783 784 785 786 787 788 789 790 791 792 793 794 795 796 797 798 799 800 801 802 803 804 805 806 807 808 809 810 811 812 @_log_mt5_last_status_code def positions_get ( self , symbol : str | None = None , group : str | None = None , ticket : int | None = None , ) -> tuple [ Any , ... ]: \"\"\"Get open positions with the ability to filter by symbol or ticket. Args: symbol: Symbol name filter. group: Group filter. ticket: Position ticket filter. Returns: Tuple of position info structures or None. \"\"\" self . _initialize_if_needed () if ticket is not None : self . logger . info ( \"Retrieving position with ticket: %d \" , ticket ) response = self . mt5 . positions_get ( ticket = ticket ) context = f \"ticket= { ticket } \" elif group is not None : self . logger . info ( \"Retrieving positions for group: %s \" , group ) response = self . mt5 . positions_get ( group = group ) context = f \"group= { group } \" elif symbol is not None : self . logger . info ( \"Retrieving positions for symbol: %s \" , symbol ) response = self . mt5 . positions_get ( symbol = symbol ) context = f \"symbol= { symbol } \" else : self . logger . info ( \"Retrieving all open positions.\" ) response = self . mt5 . positions_get () context = None self . _validate_mt5_response_is_not_none ( response = response , operation = \"positions_get\" , context = context , ) return response","title":"positions_get"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.positions_total","text":"positions_total () -> int Get the number of open positions. Returns: Type Description int Number of open positions. Source code in pdmt5/mt5.py 762 763 764 765 766 767 768 769 770 771 @_log_mt5_last_status_code def positions_total ( self ) -> int : \"\"\"Get the number of open positions. Returns: Number of open positions. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of open positions.\" ) return self . mt5 . positions_total ()","title":"positions_total"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.shutdown","text":"shutdown () -> None Close the previously established connection to the MetaTrader 5 terminal. Source code in pdmt5/mt5.py 179 180 181 182 183 184 185 @_log_mt5_last_status_code def shutdown ( self ) -> None : \"\"\"Close the previously established connection to the MetaTrader 5 terminal.\"\"\" self . logger . info ( \"Shutting down MT5 connection.\" ) response = self . mt5 . shutdown () self . _is_initialized = False return response","title":"shutdown"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbol_info","text":"symbol_info ( symbol : str ) -> Any Get data on the specified financial instrument. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description Any Symbol info structure or None. Source code in pdmt5/mt5.py 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 @_log_mt5_last_status_code def symbol_info ( self , symbol : str ) -> Any : \"\"\"Get data on the specified financial instrument. Args: symbol: Symbol name. Returns: Symbol info structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving information for symbol: %s \" , symbol ) response = self . mt5 . symbol_info ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"symbol_info\" , context = f \"symbol= { symbol } \" , ) return response","title":"symbol_info"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbol_info_tick","text":"symbol_info_tick ( symbol : str ) -> Any Get the last tick for the specified financial instrument. Parameters: Name Type Description Default symbol str Symbol name. required Returns: Type Description Any Tick info structure or None. Source code in pdmt5/mt5.py 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 @_log_mt5_last_status_code def symbol_info_tick ( self , symbol : str ) -> Any : \"\"\"Get the last tick for the specified financial instrument. Args: symbol: Symbol name. Returns: Tick info structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving last tick for symbol: %s \" , symbol ) response = self . mt5 . symbol_info_tick ( symbol ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"symbol_info_tick\" , context = f \"symbol= { symbol } \" , ) return response","title":"symbol_info_tick"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbol_select","text":"symbol_select ( symbol : str , enable : bool = True ) -> bool Select a symbol in the MarketWatch window or remove a symbol from the window. Parameters: Name Type Description Default symbol str Symbol name. required enable bool True to show, False to hide. True Returns: Type Description bool True if successful, False otherwise. Source code in pdmt5/mt5.py 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 @_log_mt5_last_status_code def symbol_select ( self , symbol : str , enable : bool = True ) -> bool : \"\"\"Select a symbol in the MarketWatch window or remove a symbol from the window. Args: symbol: Symbol name. enable: True to show, False to hide. Returns: True if successful, False otherwise. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Selecting symbol: %s , enable= %s \" , symbol , enable ) response = self . mt5 . symbol_select ( symbol , enable ) self . _validate_mt5_response_is_not_none ( response = response , operation = \"symbol_select\" , context = f \"symbol= { symbol } , enable= { enable } \" , ) return response","title":"symbol_select"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbols_get","text":"symbols_get ( group : str | None = None ) -> tuple [ Any , ... ] Get all financial instruments from the terminal. Parameters: Name Type Description Default group str | None Symbol group filter. None Returns: Type Description tuple [ Any , ...] Tuple of symbol info structures or None. Source code in pdmt5/mt5.py 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 @_log_mt5_last_status_code def symbols_get ( self , group : str | None = None ) -> tuple [ Any , ... ]: \"\"\"Get all financial instruments from the terminal. Args: group: Symbol group filter. Returns: Tuple of symbol info structures or None. \"\"\" self . _initialize_if_needed () if group is not None : self . logger . info ( \"Retrieving symbols for group: %s \" , group ) response = self . mt5 . symbols_get ( group = group ) context = f \"group= { group } \" else : self . logger . info ( \"Retrieving all symbols.\" ) response = self . mt5 . symbols_get () context = None self . _validate_mt5_response_is_not_none ( response = response , operation = \"symbols_get\" , context = context , ) return response","title":"symbols_get"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.symbols_total","text":"symbols_total () -> int Get the number of all financial instruments in the terminal. Returns: Type Description int Total number of symbols. Source code in pdmt5/mt5.py 239 240 241 242 243 244 245 246 247 248 @_log_mt5_last_status_code def symbols_total ( self ) -> int : \"\"\"Get the number of all financial instruments in the terminal. Returns: Total number of symbols. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving total number of symbols.\" ) return self . mt5 . symbols_total ()","title":"symbols_total"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.terminal_info","text":"terminal_info () -> Any Get the connected MetaTrader 5 client terminal status and settings. Returns: Type Description Any TerminalInfo structure or None. Source code in pdmt5/mt5.py 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 @_log_mt5_last_status_code def terminal_info ( self ) -> Any : \"\"\"Get the connected MetaTrader 5 client terminal status and settings. Returns: TerminalInfo structure or None. \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving terminal information.\" ) response = self . mt5 . terminal_info () self . _validate_mt5_response_is_not_none ( response = response , operation = \"terminal_info\" , ) return response","title":"terminal_info"},{"location":"api/mt5/#pdmt5.mt5.Mt5Client.version","text":"version () -> tuple [ int , int , str ] Return the MetaTrader 5 terminal version. Returns: Type Description tuple [ int , int , str ] Tuple of (terminal_version, build, release_date). Source code in pdmt5/mt5.py 187 188 189 190 191 192 193 194 195 196 @_log_mt5_last_status_code def version ( self ) -> tuple [ int , int , str ]: \"\"\"Return the MetaTrader 5 terminal version. Returns: Tuple of (terminal_version, build, release_date). \"\"\" self . _initialize_if_needed () self . logger . info ( \"Retrieving MT5 version information.\" ) return self . mt5 . version () options: show_bases: false Base client class for MetaTrader 5 operations with connection management and error handling.","title":"version"},{"location":"api/mt5/#mt5runtimeerror","text":"","title":"Mt5RuntimeError"},{"location":"api/mt5/#pdmt5.mt5.Mt5RuntimeError","text":"Bases: RuntimeError MetaTrader5 specific runtime error. Raised when MetaTrader5 operations fail or when the client is used incorrectly (e.g., calling methods before initialization). options: show_bases: false Custom runtime exception for MetaTrader 5 specific errors.","title":"Mt5RuntimeError"},{"location":"api/mt5/#usage-examples","text":"","title":"Usage Examples"},{"location":"api/mt5/#basic-connection","text":"import MetaTrader5 as mt5 from pdmt5.mt5 import Mt5Client # Create client client = Mt5Client ( mt5 = mt5 ) # Use as context manager with client : # Initialize connection success = client . initialize () if success : print ( \"Connected to MetaTrader 5\" ) # Get version info version = client . version () print ( f \"MT5 Version: { version } \" ) # Get account info account = client . account_info () print ( f \"Account: { account } \" )","title":"Basic Connection"},{"location":"api/mt5/#connection-with-login","text":"with client : # Initialize with path client . initialize ( path = \"C: \\\\ Program Files \\\\ MetaTrader 5 \\\\ terminal64.exe\" ) # Login to specific account success = client . login ( login = 12345 , password = \"your_password\" , server = \"broker_server\" ) if success : print ( \"Logged in successfully\" )","title":"Connection with Login"},{"location":"api/mt5/#symbol-operations","text":"with client : client . initialize () # Get total number of symbols total = client . symbols_total () print ( f \"Total symbols: { total } \" ) # Get all symbols symbols = client . symbols_get () print ( f \"First 5 symbols: { symbols [: 5 ] } \" ) # Get symbols by group forex_symbols = client . symbols_get ( group = \"*USD*\" ) # Get specific symbol info symbol_info = client . symbol_info ( \"EURUSD\" ) print ( f \"EURUSD info: { symbol_info } \" ) # Get current tick tick = client . symbol_info_tick ( \"EURUSD\" ) print ( f \"Current EURUSD tick: { tick } \" )","title":"Symbol Operations"},{"location":"api/mt5/#market-data-retrieval","text":"from datetime import datetime import MetaTrader5 as mt5 with client : client . initialize () # Get OHLCV rates from specific date rates = client . copy_rates_from ( symbol = \"EURUSD\" , timeframe = mt5 . TIMEFRAME_H1 , date_from = datetime ( 2024 , 1 , 1 ), count = 100 ) # Get rates within date range rates_range = client . copy_rates_range ( symbol = \"EURUSD\" , timeframe = mt5 . TIMEFRAME_D1 , date_from = datetime ( 2024 , 1 , 1 ), date_to = datetime ( 2024 , 1 , 31 ) ) # Get tick data ticks = client . copy_ticks_from ( symbol = \"EURUSD\" , date_from = datetime ( 2024 , 1 , 1 ), count = 1000 , flags = mt5 . COPY_TICKS_ALL )","title":"Market Data Retrieval"},{"location":"api/mt5/#trading-operations","text":"with client : client . initialize () client . login ( 12345 , \"password\" , \"server\" ) # Get current positions positions = client . positions_get () print ( f \"Open positions: { len ( positions ) if positions else 0 } \" ) # Get current orders orders = client . orders_get () print ( f \"Pending orders: { len ( orders ) if orders else 0 } \" ) # Calculate margin requirement margin = client . order_calc_margin ( action = mt5 . ORDER_TYPE_BUY , symbol = \"EURUSD\" , volume = 1.0 , price = 1.1000 ) print ( f \"Required margin: { margin } \" ) # Calculate profit profit = client . order_calc_profit ( action = mt5 . ORDER_TYPE_BUY , symbol = \"EURUSD\" , volume = 1.0 , price_open = 1.1000 , price_close = 1.1050 ) print ( f \"Calculated profit: { profit } \" )","title":"Trading Operations"},{"location":"api/mt5/#historical-data","text":"from datetime import datetime with client : client . initialize () # Get historical orders history_orders = client . history_orders_get ( date_from = datetime ( 2024 , 1 , 1 ), date_to = datetime ( 2024 , 1 , 31 ) ) # Get historical deals history_deals = client . history_deals_get ( date_from = datetime ( 2024 , 1 , 1 ), date_to = datetime ( 2024 , 1 , 31 ) ) # Get specific order by ticket order = client . history_orders_get ( ticket = 123456 )","title":"Historical Data"},{"location":"api/mt5/#market-book-operations","text":"with client : client . initialize () # Subscribe to market depth success = client . market_book_add ( \"EURUSD\" ) if success : print ( \"Subscribed to EURUSD market depth\" ) # Get market book book = client . market_book_get ( \"EURUSD\" ) print ( f \"Market book: { book } \" ) # Unsubscribe client . market_book_release ( \"EURUSD\" )","title":"Market Book Operations"},{"location":"api/mt5/#connection-management","text":"The Mt5Client supports both explicit and context manager usage: # Explicit initialization client = Mt5Client ( mt5 = mt5 ) client . initialize () try : # Your trading operations account = client . account_info () finally : client . shutdown () # Context manager (recommended) with Mt5Client ( mt5 = mt5 ) as client : client . initialize () # Your trading operations account = client . account_info ()","title":"Connection Management"},{"location":"api/mt5/#error-handling","text":"All methods include proper error handling and raise Mt5RuntimeError with detailed information when operations fail: from pdmt5.mt5 import Mt5RuntimeError try : with client : client . initialize () rates = client . copy_rates_from ( \"INVALID\" , mt5 . TIMEFRAME_H1 , datetime . now (), 100 ) except Mt5RuntimeError as e : print ( f \"MetaTrader 5 error: { e } \" )","title":"Error Handling"},{"location":"api/mt5/#logging","text":"The client includes comprehensive logging for all operations: import logging # Enable debug logging to see all MT5 operations logging . basicConfig ( level = logging . DEBUG ) with client : client . initialize () # Will log initialization details account = client . account_info () # Will log account retrieval","title":"Logging"},{"location":"api/mt5/#method-categories","text":"","title":"Method Categories"},{"location":"api/mt5/#connection-management_1","text":"initialize() - Initialize MT5 connection login() - Login to trading account shutdown() - Close connection version() - Get MT5 version last_error() - Get last error details","title":"Connection Management"},{"location":"api/mt5/#account-terminal","text":"account_info() - Get account information terminal_info() - Get terminal status and settings","title":"Account &amp; Terminal"},{"location":"api/mt5/#symbol-management","text":"symbols_total() - Get total number of symbols symbols_get() - Get symbol list symbol_info() - Get symbol information symbol_info_tick() - Get current tick symbol_select() - Add/remove symbol from Market Watch","title":"Symbol Management"},{"location":"api/mt5/#market-data","text":"copy_rates_from() - Get OHLCV rates from date copy_rates_from_pos() - Get OHLCV rates from position copy_rates_range() - Get OHLCV rates in date range copy_ticks_from() - Get ticks from date copy_ticks_range() - Get ticks in date range","title":"Market Data"},{"location":"api/mt5/#market-book","text":"market_book_add() - Subscribe to market depth market_book_release() - Unsubscribe from market depth market_book_get() - Get market book data","title":"Market Book"},{"location":"api/mt5/#trading","text":"orders_total() - Get number of pending orders orders_get() - Get pending orders positions_total() - Get number of open positions positions_get() - Get open positions order_calc_margin() - Calculate required margin order_calc_profit() - Calculate profit order_check() - Validate order request order_send() - Send trading order","title":"Trading"},{"location":"api/mt5/#history","text":"history_orders_total() - Get historical orders count history_orders_get() - Get historical orders history_deals_total() - Get historical deals count history_deals_get() - Get historical deals","title":"History"},{"location":"api/mt5/#best-practices","text":"Always use context manager for automatic connection management Handle errors gracefully with try-except blocks Initialize before operations - call initialize() after creating the client Use logging to debug connection and operation issues Check return values - many methods return None on failure Use appropriate timeframes and date ranges for data requests Subscribe/unsubscribe to market book properly to avoid resource leaks","title":"Best Practices"},{"location":"api/rest-api/","text":"REST API \u00b6 The pdmt5 REST API exposes read-only MetaTrader 5 data via FastAPI. It supports JSON and Apache Parquet responses for efficient analytics workflows. Installation \u00b6 Install pdmt5 with API dependencies: pip install pdmt5 [ api ] Configuration \u00b6 Set the API key and optional limits via environment variables: export MT5_API_KEY = \"your-secret-api-key\" export API_LOG_LEVEL = \"INFO\" export API_RATE_LIMIT = \"100\" export API_CORS_ORIGINS = \"*\" Running the API \u00b6 uvicorn pdmt5.api.main:app --host 0 .0.0.0 --port 8000 Access the docs at: Swagger UI: http://localhost:8000/docs OpenAPI JSON: http://localhost:8000/openapi.json Authentication \u00b6 All endpoints except /api/v1/health require an API key header: curl -H \"X-API-Key: your-secret-api-key\" \\ http://localhost:8000/api/v1/symbols Format Negotiation \u00b6 Use Accept header or format query parameter: curl -H \"X-API-Key: your-secret-api-key\" \\ -H \"Accept: application/parquet\" \\ \"http://localhost:8000/api/v1/rates/from?symbol=EURUSD&timeframe=1&date_from=2024-01-01T00:00:00Z&count=100\" curl -H \"X-API-Key: your-secret-api-key\" \\ \"http://localhost:8000/api/v1/symbols?format=json\" Response Formatter Utilities \u00b6 If you are extending the API with custom endpoints, use the formatter helpers in pdmt5.api.formatters to keep JSON and Parquet responses consistent: format_response(data, response_format) : Unified formatter for DataFrame or dict data. format_dataframe_to_json(dataframe) : Convert DataFrame to JSON response. format_dataframe_to_parquet(dataframe) : Convert DataFrame to Parquet response. format_dict_to_json(data) : Convert dict to JSON response. format_dict_to_parquet(data) : Convert dict to Parquet response. Example Requests \u00b6 Health Check (No Auth) \u00b6 curl http://localhost:8000/api/v1/health MT5 Version \u00b6 curl -H \"X-API-Key: your-secret-api-key\" \\ http://localhost:8000/api/v1/version Symbols \u00b6 curl -H \"X-API-Key: your-secret-api-key\" \\ http://localhost:8000/api/v1/symbols curl -H \"X-API-Key: your-secret-api-key\" \\ \"http://localhost:8000/api/v1/symbols?group=*USD*\" Symbol Details \u00b6 curl -H \"X-API-Key: your-secret-api-key\" \\ http://localhost:8000/api/v1/symbols/EURUSD Rates (OHLCV) \u00b6 curl -H \"X-API-Key: your-secret-api-key\" \\ \"http://localhost:8000/api/v1/rates/from?symbol=EURUSD&timeframe=1&date_from=2024-01-01T00:00:00Z&count=100\" Account Info \u00b6 curl -H \"X-API-Key: your-secret-api-key\" \\ http://localhost:8000/api/v1/account History Orders \u00b6 curl -H \"X-API-Key: your-secret-api-key\" \\ \"http://localhost:8000/api/v1/history/orders?date_from=2024-01-01T00:00:00Z&date_to=2024-01-02T00:00:00Z\" Error Responses \u00b6 Errors follow RFC 7807 Problem Details: { \"type\" : \"/errors/validation-error\" , \"title\" : \"Request Validation Failed\" , \"status\" : 400 , \"detail\" : \"count must be positive (got: -10)\" , \"instance\" : \"/api/v1/rates/from\" } Performance Benchmarks \u00b6 Target benchmarks for production readiness: Health check latency < 500ms under normal load Market data queries < 2s for typical datasets (<1000 records) 100 concurrent requests without significant degradation Security Checklist \u00b6 Minimum security posture for deployments: API key authentication enabled ( MT5_API_KEY ) Rate limiting enabled ( API_RATE_LIMIT ) Run behind HTTPS in production Restrict CORS origins ( API_CORS_ORIGINS ) for public deployments","title":"REST API"},{"location":"api/rest-api/#rest-api","text":"The pdmt5 REST API exposes read-only MetaTrader 5 data via FastAPI. It supports JSON and Apache Parquet responses for efficient analytics workflows.","title":"REST API"},{"location":"api/rest-api/#installation","text":"Install pdmt5 with API dependencies: pip install pdmt5 [ api ]","title":"Installation"},{"location":"api/rest-api/#configuration","text":"Set the API key and optional limits via environment variables: export MT5_API_KEY = \"your-secret-api-key\" export API_LOG_LEVEL = \"INFO\" export API_RATE_LIMIT = \"100\" export API_CORS_ORIGINS = \"*\"","title":"Configuration"},{"location":"api/rest-api/#running-the-api","text":"uvicorn pdmt5.api.main:app --host 0 .0.0.0 --port 8000 Access the docs at: Swagger UI: http://localhost:8000/docs OpenAPI JSON: http://localhost:8000/openapi.json","title":"Running the API"},{"location":"api/rest-api/#authentication","text":"All endpoints except /api/v1/health require an API key header: curl -H \"X-API-Key: your-secret-api-key\" \\ http://localhost:8000/api/v1/symbols","title":"Authentication"},{"location":"api/rest-api/#format-negotiation","text":"Use Accept header or format query parameter: curl -H \"X-API-Key: your-secret-api-key\" \\ -H \"Accept: application/parquet\" \\ \"http://localhost:8000/api/v1/rates/from?symbol=EURUSD&timeframe=1&date_from=2024-01-01T00:00:00Z&count=100\" curl -H \"X-API-Key: your-secret-api-key\" \\ \"http://localhost:8000/api/v1/symbols?format=json\"","title":"Format Negotiation"},{"location":"api/rest-api/#response-formatter-utilities","text":"If you are extending the API with custom endpoints, use the formatter helpers in pdmt5.api.formatters to keep JSON and Parquet responses consistent: format_response(data, response_format) : Unified formatter for DataFrame or dict data. format_dataframe_to_json(dataframe) : Convert DataFrame to JSON response. format_dataframe_to_parquet(dataframe) : Convert DataFrame to Parquet response. format_dict_to_json(data) : Convert dict to JSON response. format_dict_to_parquet(data) : Convert dict to Parquet response.","title":"Response Formatter Utilities"},{"location":"api/rest-api/#example-requests","text":"","title":"Example Requests"},{"location":"api/rest-api/#health-check-no-auth","text":"curl http://localhost:8000/api/v1/health","title":"Health Check (No Auth)"},{"location":"api/rest-api/#mt5-version","text":"curl -H \"X-API-Key: your-secret-api-key\" \\ http://localhost:8000/api/v1/version","title":"MT5 Version"},{"location":"api/rest-api/#symbols","text":"curl -H \"X-API-Key: your-secret-api-key\" \\ http://localhost:8000/api/v1/symbols curl -H \"X-API-Key: your-secret-api-key\" \\ \"http://localhost:8000/api/v1/symbols?group=*USD*\"","title":"Symbols"},{"location":"api/rest-api/#symbol-details","text":"curl -H \"X-API-Key: your-secret-api-key\" \\ http://localhost:8000/api/v1/symbols/EURUSD","title":"Symbol Details"},{"location":"api/rest-api/#rates-ohlcv","text":"curl -H \"X-API-Key: your-secret-api-key\" \\ \"http://localhost:8000/api/v1/rates/from?symbol=EURUSD&timeframe=1&date_from=2024-01-01T00:00:00Z&count=100\"","title":"Rates (OHLCV)"},{"location":"api/rest-api/#account-info","text":"curl -H \"X-API-Key: your-secret-api-key\" \\ http://localhost:8000/api/v1/account","title":"Account Info"},{"location":"api/rest-api/#history-orders","text":"curl -H \"X-API-Key: your-secret-api-key\" \\ \"http://localhost:8000/api/v1/history/orders?date_from=2024-01-01T00:00:00Z&date_to=2024-01-02T00:00:00Z\"","title":"History Orders"},{"location":"api/rest-api/#error-responses","text":"Errors follow RFC 7807 Problem Details: { \"type\" : \"/errors/validation-error\" , \"title\" : \"Request Validation Failed\" , \"status\" : 400 , \"detail\" : \"count must be positive (got: -10)\" , \"instance\" : \"/api/v1/rates/from\" }","title":"Error Responses"},{"location":"api/rest-api/#performance-benchmarks","text":"Target benchmarks for production readiness: Health check latency < 500ms under normal load Market data queries < 2s for typical datasets (<1000 records) 100 concurrent requests without significant degradation","title":"Performance Benchmarks"},{"location":"api/rest-api/#security-checklist","text":"Minimum security posture for deployments: API key authentication enabled ( MT5_API_KEY ) Rate limiting enabled ( API_RATE_LIMIT ) Run behind HTTPS in production Restrict CORS origins ( API_CORS_ORIGINS ) for public deployments","title":"Security Checklist"},{"location":"api/trading/","text":"Trading \u00b6 pdmt5.trading \u00b6 Trading operations module with advanced MetaTrader5 functionality. Mt5TradingClient \u00b6 Bases: Mt5DataClient MetaTrader5 trading client with advanced trading operations. This class extends Mt5DataClient to provide specialized trading functionality including position management, order analysis, and trading performance metrics. model_config class-attribute instance-attribute \u00b6 model_config = ConfigDict ( frozen = True ) mt5_failed_trade_retcodes cached property \u00b6 mt5_failed_trade_retcodes : set [ int ] Set of failed trade return codes. Returns: Type Description set [ int ] Set of failed trade return codes. mt5_successful_trade_retcodes cached property \u00b6 mt5_successful_trade_retcodes : set [ int ] Set of successful trade return codes. Returns: Type Description set [ int ] Set of successful trade return codes. calculate_minimum_order_margin \u00b6 calculate_minimum_order_margin ( symbol : str , order_side : Literal [ \"BUY\" , \"SELL\" ] ) -> dict [ str , float ] Calculate the minimum order margins for a given symbol. Parameters: Name Type Description Default symbol str Symbol for which to calculate the minimum order margins. required order_side Literal ['BUY', 'SELL'] Optional side of the order, either \"BUY\" or \"SELL\". required Returns: Type Description dict [ str , float ] Dictionary with minimum volume and margin for the specified order side. Source code in pdmt5/trading.py 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 def calculate_minimum_order_margin ( self , symbol : str , order_side : Literal [ \"BUY\" , \"SELL\" ], ) -> dict [ str , float ]: \"\"\"Calculate the minimum order margins for a given symbol. Args: symbol: Symbol for which to calculate the minimum order margins. order_side: Optional side of the order, either \"BUY\" or \"SELL\". Returns: Dictionary with minimum volume and margin for the specified order side. \"\"\" symbol_info = self . symbol_info_as_dict ( symbol = symbol ) symbol_info_tick = self . symbol_info_tick_as_dict ( symbol = symbol ) margin = self . order_calc_margin ( action = getattr ( self . mt5 , f \"ORDER_TYPE_ { order_side . upper () } \" ), symbol = symbol , volume = symbol_info [ \"volume_min\" ], price = ( symbol_info_tick [ \"bid\" ] if order_side == \"SELL\" else symbol_info_tick [ \"ask\" ] ), ) result = { \"volume\" : symbol_info [ \"volume_min\" ], \"margin\" : margin } if margin : self . logger . info ( \"Calculated minimum %s order margin for %s : %s \" , order_side , symbol , result , ) else : self . logger . warning ( \"Calculated minimum order margin to %s %s : %s \" , order_side , symbol , result , ) return result calculate_new_position_margin_ratio \u00b6 calculate_new_position_margin_ratio ( symbol : str , new_position_side : Literal [ \"BUY\" , \"SELL\" ] | None = None , new_position_volume : float = 0 , ) -> float Calculate the margin ratio for a new position. Parameters: Name Type Description Default symbol str Symbol for which to calculate the margin ratio. required new_position_side Literal ['BUY', 'SELL'] | None Side of the new position, either \"BUY\" or \"SELL\". None new_position_volume float Volume of the new position. 0 Returns: Name Type Description float float Margin ratio for the new position as a fraction of account equity. Source code in pdmt5/trading.py 629 630 631 632 633 634 635 636 637 638 639 640 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 657 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 675 676 677 678 679 680 def calculate_new_position_margin_ratio ( self , symbol : str , new_position_side : Literal [ \"BUY\" , \"SELL\" ] | None = None , new_position_volume : float = 0 , ) -> float : \"\"\"Calculate the margin ratio for a new position. Args: symbol: Symbol for which to calculate the margin ratio. new_position_side: Side of the new position, either \"BUY\" or \"SELL\". new_position_volume: Volume of the new position. Returns: float: Margin ratio for the new position as a fraction of account equity. \"\"\" account_info = self . account_info_as_dict () if not account_info [ \"equity\" ]: result = 0.0 else : positions_df = self . fetch_positions_with_metrics_as_df ( symbol = symbol ) current_signed_margin = ( positions_df [ \"signed_margin\" ] . sum () if positions_df . size else 0 ) symbol_info_tick = self . symbol_info_tick_as_dict ( symbol = symbol ) if not ( new_position_side and new_position_volume ): new_signed_margin = 0 elif new_position_side . upper () == \"BUY\" : new_signed_margin = self . order_calc_margin ( action = self . mt5 . ORDER_TYPE_BUY , symbol = symbol , volume = new_position_volume , price = symbol_info_tick [ \"ask\" ], ) elif new_position_side . upper () == \"SELL\" : new_signed_margin = - self . order_calc_margin ( action = self . mt5 . ORDER_TYPE_SELL , symbol = symbol , volume = new_position_volume , price = symbol_info_tick [ \"bid\" ], ) else : new_signed_margin = 0 result = abs ( ( new_signed_margin + current_signed_margin ) / account_info [ \"equity\" ] ) self . logger . info ( \"Calculated new position margin ratio for %s : %s \" , symbol , result , ) return result calculate_spread_ratio \u00b6 calculate_spread_ratio ( symbol : str ) -> float Calculate the spread ratio for a given symbol. Parameters: Name Type Description Default symbol str Symbol for which to calculate the spread ratio. required Returns: Type Description float Spread ratio as a float. Source code in pdmt5/trading.py 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 def calculate_spread_ratio ( self , symbol : str , ) -> float : \"\"\"Calculate the spread ratio for a given symbol. Args: symbol: Symbol for which to calculate the spread ratio. Returns: Spread ratio as a float. \"\"\" symbol_info_tick = self . symbol_info_tick_as_dict ( symbol = symbol ) result = ( ( symbol_info_tick [ \"ask\" ] - symbol_info_tick [ \"bid\" ]) / ( symbol_info_tick [ \"ask\" ] + symbol_info_tick [ \"bid\" ]) * 2 ) self . logger . info ( \"Calculated spread ratio for %s : %s \" , symbol , result ) return result calculate_volume_by_margin \u00b6 calculate_volume_by_margin ( symbol : str , margin : float , order_side : Literal [ \"BUY\" , \"SELL\" ], ) -> float Calculate volume based on margin for a given symbol and order side. Parameters: Name Type Description Default symbol str Symbol for which to calculate the volume. required margin float Margin amount to use for the calculation. required order_side Literal ['BUY', 'SELL'] Side of the order, either \"BUY\" or \"SELL\". required Returns: Type Description float Calculated volume as a float. Source code in pdmt5/trading.py 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 def calculate_volume_by_margin ( self , symbol : str , margin : float , order_side : Literal [ \"BUY\" , \"SELL\" ], ) -> float : \"\"\"Calculate volume based on margin for a given symbol and order side. Args: symbol: Symbol for which to calculate the volume. margin: Margin amount to use for the calculation. order_side: Side of the order, either \"BUY\" or \"SELL\". Returns: Calculated volume as a float. \"\"\" min_order_margin_dict = self . calculate_minimum_order_margin ( symbol = symbol , order_side = order_side , ) if min_order_margin_dict [ \"margin\" ]: result = ( floor ( margin / min_order_margin_dict [ \"margin\" ]) * min_order_margin_dict [ \"volume\" ] ) else : result = 0.0 self . logger . info ( \"Calculated volume by margin to %s %s : %s \" , order_side , symbol , result , ) return result close_open_positions \u00b6 close_open_positions ( symbols : str | list [ str ] | tuple [ str , ... ] | None = None , order_filling_mode : Literal [ \"IOC\" , \"FOK\" , \"RETURN\" ] = \"IOC\" , dry_run : bool = False , ** kwargs : Any , ) -> dict [ str , list [ dict [ str , Any ]]] Close all open positions for specified symbols. Parameters: Name Type Description Default symbols str | list [ str ] | tuple [ str , ...] | None Optional symbol or list of symbols to filter positions. If None, all symbols will be considered. None order_filling_mode Literal ['IOC', 'FOK', 'RETURN'] Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\". 'IOC' dry_run bool If True, only check the order without sending it. False **kwargs Any Additional keyword arguments for request parameters. {} Returns: Type Description dict [ str , list [ dict [ str , Any ]]] Dictionary with symbols as keys and lists of dictionaries containing operation results for each closed position as values. Source code in pdmt5/trading.py 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 def close_open_positions ( self , symbols : str | list [ str ] | tuple [ str , ... ] | None = None , order_filling_mode : Literal [ \"IOC\" , \"FOK\" , \"RETURN\" ] = \"IOC\" , dry_run : bool = False , ** kwargs : Any , # noqa: ANN401 ) -> dict [ str , list [ dict [ str , Any ]]]: \"\"\"Close all open positions for specified symbols. Args: symbols: Optional symbol or list of symbols to filter positions. If None, all symbols will be considered. order_filling_mode: Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\". dry_run: If True, only check the order without sending it. **kwargs: Additional keyword arguments for request parameters. Returns: Dictionary with symbols as keys and lists of dictionaries containing operation results for each closed position as values. \"\"\" if isinstance ( symbols , str ): symbol_list = [ symbols ] elif isinstance ( symbols , ( list , tuple )): symbol_list = symbols else : symbol_list = self . symbols_get () self . logger . info ( \"Fetching and closing positions for symbols: %s \" , symbol_list ) return { s : self . _fetch_and_close_position ( symbol = s , order_filling_mode = order_filling_mode , dry_run = dry_run , ** kwargs , ) for s in symbol_list } collect_entry_deals_as_df \u00b6 collect_entry_deals_as_df ( symbol : str , history_seconds : int = 3600 , index_keys : str | None = \"ticket\" , ) -> DataFrame Collect entry deals as a DataFrame. Parameters: Name Type Description Default symbol str Symbol to collect entry deals for. required history_seconds int Time range in seconds to fetch deals around the last tick. 3600 index_keys str | None Optional index keys for the DataFrame. 'ticket' Returns: Type Description DataFrame pd.DataFrame: Entry deals with time index. Source code in pdmt5/trading.py 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557 558 559 560 def collect_entry_deals_as_df ( self , symbol : str , history_seconds : int = 3600 , index_keys : str | None = \"ticket\" , ) -> pd . DataFrame : \"\"\"Collect entry deals as a DataFrame. Args: symbol: Symbol to collect entry deals for. history_seconds: Time range in seconds to fetch deals around the last tick. index_keys: Optional index keys for the DataFrame. Returns: pd.DataFrame: Entry deals with time index. \"\"\" last_tick_time = self . symbol_info_tick_as_dict ( symbol = symbol )[ \"time\" ] deals_df = self . history_deals_get_as_df ( date_from = ( last_tick_time - timedelta ( seconds = history_seconds )), date_to = ( last_tick_time + timedelta ( seconds = history_seconds )), symbol = symbol , index_keys = index_keys , ) if deals_df . empty : result = deals_df else : result = deals_df . pipe ( lambda d : d [ d [ \"entry\" ] & d [ \"type\" ] . isin ({ self . mt5 . DEAL_TYPE_BUY , self . mt5 . DEAL_TYPE_SELL }) ] ) self . logger . info ( \"Collected entry deals for %s : %d rows\" , symbol , result . shape [ 0 ], ) return result fetch_latest_rates_as_df \u00b6 fetch_latest_rates_as_df ( symbol : str , granularity : str = \"M1\" , count : int = 1440 , index_keys : str | None = \"time\" , ) -> DataFrame Fetch rate (OHLC) data as a DataFrame. Parameters: Name Type Description Default symbol str Symbol to fetch data for. required granularity str Time granularity as a timeframe suffix (e.g., \"M1\", \"H1\"). 'M1' count int Number of bars to fetch. 1440 index_keys str | None Optional index keys for the DataFrame. 'time' Returns: Type Description DataFrame pd.DataFrame: OHLC data with time index. Raises: Type Description Mt5TradingError If the granularity is not supported by MetaTrader5. Source code in pdmt5/trading.py 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 def fetch_latest_rates_as_df ( self , symbol : str , granularity : str = \"M1\" , count : int = 1440 , index_keys : str | None = \"time\" , ) -> pd . DataFrame : \"\"\"Fetch rate (OHLC) data as a DataFrame. Args: symbol: Symbol to fetch data for. granularity: Time granularity as a timeframe suffix (e.g., \"M1\", \"H1\"). count: Number of bars to fetch. index_keys: Optional index keys for the DataFrame. Returns: pd.DataFrame: OHLC data with time index. Raises: Mt5TradingError: If the granularity is not supported by MetaTrader5. \"\"\" try : timeframe = getattr ( self . mt5 , f \"TIMEFRAME_ { granularity . upper () } \" ) except AttributeError as e : error_message = ( f \"MetaTrader5 does not support the given granularity: { granularity } \" ) raise Mt5TradingError ( error_message ) from e else : result = self . copy_rates_from_pos_as_df ( symbol = symbol , timeframe = timeframe , start_pos = 0 , count = count , index_keys = index_keys , ) self . logger . info ( \"Fetched latest %s rates for %s : %d rows\" , granularity , symbol , result . shape [ 0 ], ) return result fetch_latest_ticks_as_df \u00b6 fetch_latest_ticks_as_df ( symbol : str , seconds : int = 300 , index_keys : str | None = \"time_msc\" , ) -> DataFrame Fetch tick data as a DataFrame. Parameters: Name Type Description Default symbol str Symbol to fetch tick data for. required seconds int Time range in seconds to fetch ticks around the last tick time. 300 index_keys str | None Optional index keys for the DataFrame. 'time_msc' Returns: Type Description DataFrame pd.DataFrame: Tick data with time index. Source code in pdmt5/trading.py 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521 def fetch_latest_ticks_as_df ( self , symbol : str , seconds : int = 300 , index_keys : str | None = \"time_msc\" , ) -> pd . DataFrame : \"\"\"Fetch tick data as a DataFrame. Args: symbol: Symbol to fetch tick data for. seconds: Time range in seconds to fetch ticks around the last tick time. index_keys: Optional index keys for the DataFrame. Returns: pd.DataFrame: Tick data with time index. \"\"\" last_tick_time = self . symbol_info_tick_as_dict ( symbol = symbol )[ \"time\" ] result = self . copy_ticks_range_as_df ( symbol = symbol , date_from = ( last_tick_time - timedelta ( seconds = seconds )), date_to = ( last_tick_time + timedelta ( seconds = seconds )), flags = self . mt5 . COPY_TICKS_ALL , index_keys = index_keys , ) self . logger . info ( \"Fetched latest ticks for %s : %d rows\" , symbol , result . shape [ 0 ], ) return result fetch_positions_with_metrics_as_df \u00b6 fetch_positions_with_metrics_as_df ( symbol : str , ) -> DataFrame Fetch open positions as a DataFrame with additional metrics. Parameters: Name Type Description Default symbol str Symbol to fetch positions for. required Returns: Type Description DataFrame pd.DataFrame: DataFrame containing open positions with additional metrics. Source code in pdmt5/trading.py 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 588 589 590 591 592 593 594 595 596 597 598 599 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 623 624 625 626 627 def fetch_positions_with_metrics_as_df ( self , symbol : str , ) -> pd . DataFrame : \"\"\"Fetch open positions as a DataFrame with additional metrics. Args: symbol: Symbol to fetch positions for. Returns: pd.DataFrame: DataFrame containing open positions with additional metrics. \"\"\" positions_df = self . positions_get_as_df ( symbol = symbol ) if positions_df . empty : result = positions_df else : symbol_info_tick = self . symbol_info_tick_as_dict ( symbol = symbol ) ask_margin = self . order_calc_margin ( action = self . mt5 . ORDER_TYPE_BUY , symbol = symbol , volume = 1 , price = symbol_info_tick [ \"ask\" ], ) bid_margin = self . order_calc_margin ( action = self . mt5 . ORDER_TYPE_SELL , symbol = symbol , volume = 1 , price = symbol_info_tick [ \"bid\" ], ) result = ( positions_df . assign ( elapsed_seconds = lambda d : ( symbol_info_tick [ \"time\" ] - d [ \"time\" ] ) . dt . total_seconds (), underlier_increase_ratio = lambda d : ( d [ \"price_current\" ] / d [ \"price_open\" ] - 1 ), buy = lambda d : ( d [ \"type\" ] == self . mt5 . POSITION_TYPE_BUY ), sell = lambda d : ( d [ \"type\" ] == self . mt5 . POSITION_TYPE_SELL ), ) . assign ( buy_i = lambda d : d [ \"buy\" ] . astype ( int ), sell_i = lambda d : d [ \"sell\" ] . astype ( int ), ) . assign ( sign = lambda d : ( d [ \"buy_i\" ] - d [ \"sell_i\" ]), margin = lambda d : ( ( d [ \"buy_i\" ] * ask_margin + d [ \"sell_i\" ] * bid_margin ) * d [ \"volume\" ] ), ) . assign ( signed_volume = lambda d : ( d [ \"volume\" ] * d [ \"sign\" ]), signed_margin = lambda d : ( d [ \"margin\" ] * d [ \"sign\" ]), underlier_profit_ratio = lambda d : ( d [ \"underlier_increase_ratio\" ] * d [ \"sign\" ] ), ) . drop ( columns = [ \"buy_i\" , \"sell_i\" , \"sign\" , \"underlier_increase_ratio\" ]) ) self . logger . info ( \"Fetched positions with metrics for %s : %d rows\" , symbol , result . shape [ 0 ], ) return result place_market_order \u00b6 place_market_order ( symbol : str , volume : float , order_side : Literal [ \"BUY\" , \"SELL\" ], order_filling_mode : Literal [ \"IOC\" , \"FOK\" , \"RETURN\" ] = \"IOC\" , order_time_mode : Literal [ \"GTC\" , \"DAY\" , \"SPECIFIED\" , \"SPECIFIED_DAY\" ] = \"GTC\" , raise_on_error : bool = False , dry_run : bool = False , ** kwargs : Any , ) -> dict [ str , Any ] Send or check an order request to place a market order. Parameters: Name Type Description Default symbol str Symbol for the order. required volume float Volume of the order. required order_side Literal ['BUY', 'SELL'] Side of the order, either \"BUY\" or \"SELL\". required order_filling_mode Literal ['IOC', 'FOK', 'RETURN'] Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\". 'IOC' order_time_mode Literal ['GTC', 'DAY', 'SPECIFIED', 'SPECIFIED_DAY'] Order time mode, either \"GTC\", \"DAY\", \"SPECIFIED\", or \"SPECIFIED_DAY\". 'GTC' raise_on_error bool If True, raise an error on operation failure. False dry_run bool If True, only check the order without sending it. False **kwargs Any Additional keyword arguments for request parameters. {} Returns: Type Description dict [ str , Any ] Dictionary with operation result. Source code in pdmt5/trading.py 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 def place_market_order ( self , symbol : str , volume : float , order_side : Literal [ \"BUY\" , \"SELL\" ], order_filling_mode : Literal [ \"IOC\" , \"FOK\" , \"RETURN\" ] = \"IOC\" , order_time_mode : Literal [ \"GTC\" , \"DAY\" , \"SPECIFIED\" , \"SPECIFIED_DAY\" ] = \"GTC\" , raise_on_error : bool = False , dry_run : bool = False , ** kwargs : Any , # noqa: ANN401 ) -> dict [ str , Any ]: \"\"\"Send or check an order request to place a market order. Args: symbol: Symbol for the order. volume: Volume of the order. order_side: Side of the order, either \"BUY\" or \"SELL\". order_filling_mode: Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\". order_time_mode: Order time mode, either \"GTC\", \"DAY\", \"SPECIFIED\", or \"SPECIFIED_DAY\". raise_on_error: If True, raise an error on operation failure. dry_run: If True, only check the order without sending it. **kwargs: Additional keyword arguments for request parameters. Returns: Dictionary with operation result. \"\"\" self . logger . info ( \"Placing market order: %s %s %s \" , order_side , volume , symbol ) return self . _send_or_check_order ( request = { \"action\" : self . mt5 . TRADE_ACTION_DEAL , \"symbol\" : symbol , \"volume\" : volume , \"type\" : getattr ( self . mt5 , f \"ORDER_TYPE_ { order_side . upper () } \" ), \"type_filling\" : getattr ( self . mt5 , f \"ORDER_FILLING_ { order_filling_mode . upper () } \" ), \"type_time\" : getattr ( self . mt5 , f \"ORDER_TIME_ { order_time_mode . upper () } \" ), ** kwargs , }, raise_on_error = raise_on_error , dry_run = dry_run , ) update_sltp_for_open_positions \u00b6 update_sltp_for_open_positions ( symbol : str , stop_loss : float | None = None , take_profit : float | None = None , tickets : list [ int ] | None = None , raise_on_error : bool = False , dry_run : bool = False , ** kwargs : Any , ) -> list [ dict [ str , Any ]] Change Stop Loss and Take Profit for open positions. Parameters: Name Type Description Default symbol str Symbol for the position. required stop_loss float | None New Stop Loss price. If None, it will not be changed. None take_profit float | None New Take Profit price. If None, it will not be changed. None tickets list [ int ] | None List of position tickets to filter positions. If None, all open positions for the symbol will be considered. None raise_on_error bool If True, raise an error on operation failure. False dry_run bool If True, only check the order without sending it. False **kwargs Any Additional keyword arguments for request parameters. {} Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with operation results for each updated position. Source code in pdmt5/trading.py 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 def update_sltp_for_open_positions ( self , symbol : str , stop_loss : float | None = None , take_profit : float | None = None , tickets : list [ int ] | None = None , raise_on_error : bool = False , dry_run : bool = False , ** kwargs : Any , # noqa: ANN401 ) -> list [ dict [ str , Any ]]: \"\"\"Change Stop Loss and Take Profit for open positions. Args: symbol: Symbol for the position. stop_loss: New Stop Loss price. If None, it will not be changed. take_profit: New Take Profit price. If None, it will not be changed. tickets: List of position tickets to filter positions. If None, all open positions for the symbol will be considered. raise_on_error: If True, raise an error on operation failure. dry_run: If True, only check the order without sending it. **kwargs: Additional keyword arguments for request parameters. Returns: List of dictionaries with operation results for each updated position. \"\"\" positions_df = self . positions_get_as_df ( symbol = symbol ) if positions_df . empty : self . logger . warning ( \"No open positions found for symbol: %s \" , symbol ) return [] elif tickets : filtered_positions_df = positions_df . pipe ( lambda d : d [ d [ \"ticket\" ] . isin ( tickets )] ) else : filtered_positions_df = positions_df if filtered_positions_df . empty : self . logger . warning ( \"No open positions found for symbol: %s with specified tickets: %s \" , symbol , tickets , ) return [] else : symbol_info = self . symbol_info_as_dict ( symbol = symbol ) sl = round ( stop_loss , symbol_info [ \"digits\" ]) if stop_loss else None tp = round ( take_profit , symbol_info [ \"digits\" ]) if take_profit else None order_requests = [ { \"action\" : self . mt5 . TRADE_ACTION_SLTP , \"symbol\" : p [ \"symbol\" ], \"position\" : p [ \"ticket\" ], \"sl\" : ( sl or p [ \"sl\" ]), \"tp\" : ( tp or p [ \"tp\" ]), ** kwargs , } for _ , p in filtered_positions_df . iterrows () if sl != p [ \"sl\" ] or tp != p [ \"tp\" ] ] if order_requests : self . logger . info ( \"Updating SL/TP for %d positions for %s : %s / %s \" , len ( order_requests ), symbol , sl , tp , ) return [ self . _send_or_check_order ( request = r , raise_on_error = raise_on_error , dry_run = dry_run ) for r in order_requests ] else : self . logger . info ( \"No positions to update for symbol: %s with SL: %s and TP: %s \" , symbol , sl , tp , ) return [] Mt5TradingError \u00b6 Bases: Mt5RuntimeError MetaTrader5 trading error. Overview \u00b6 The trading module extends Mt5DataClient with advanced trading operations including position management, order execution, and dry run support for testing trading strategies without actual execution. Classes \u00b6 Mt5TradingClient \u00b6 pdmt5.trading.Mt5TradingClient \u00b6 Bases: Mt5DataClient MetaTrader5 trading client with advanced trading operations. This class extends Mt5DataClient to provide specialized trading functionality including position management, order analysis, and trading performance metrics. model_config class-attribute instance-attribute \u00b6 model_config = ConfigDict ( frozen = True ) mt5_failed_trade_retcodes cached property \u00b6 mt5_failed_trade_retcodes : set [ int ] Set of failed trade return codes. Returns: Type Description set [ int ] Set of failed trade return codes. mt5_successful_trade_retcodes cached property \u00b6 mt5_successful_trade_retcodes : set [ int ] Set of successful trade return codes. Returns: Type Description set [ int ] Set of successful trade return codes. calculate_minimum_order_margin \u00b6 calculate_minimum_order_margin ( symbol : str , order_side : Literal [ \"BUY\" , \"SELL\" ] ) -> dict [ str , float ] Calculate the minimum order margins for a given symbol. Parameters: Name Type Description Default symbol str Symbol for which to calculate the minimum order margins. required order_side Literal ['BUY', 'SELL'] Optional side of the order, either \"BUY\" or \"SELL\". required Returns: Type Description dict [ str , float ] Dictionary with minimum volume and margin for the specified order side. Source code in pdmt5/trading.py 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 def calculate_minimum_order_margin ( self , symbol : str , order_side : Literal [ \"BUY\" , \"SELL\" ], ) -> dict [ str , float ]: \"\"\"Calculate the minimum order margins for a given symbol. Args: symbol: Symbol for which to calculate the minimum order margins. order_side: Optional side of the order, either \"BUY\" or \"SELL\". Returns: Dictionary with minimum volume and margin for the specified order side. \"\"\" symbol_info = self . symbol_info_as_dict ( symbol = symbol ) symbol_info_tick = self . symbol_info_tick_as_dict ( symbol = symbol ) margin = self . order_calc_margin ( action = getattr ( self . mt5 , f \"ORDER_TYPE_ { order_side . upper () } \" ), symbol = symbol , volume = symbol_info [ \"volume_min\" ], price = ( symbol_info_tick [ \"bid\" ] if order_side == \"SELL\" else symbol_info_tick [ \"ask\" ] ), ) result = { \"volume\" : symbol_info [ \"volume_min\" ], \"margin\" : margin } if margin : self . logger . info ( \"Calculated minimum %s order margin for %s : %s \" , order_side , symbol , result , ) else : self . logger . warning ( \"Calculated minimum order margin to %s %s : %s \" , order_side , symbol , result , ) return result calculate_new_position_margin_ratio \u00b6 calculate_new_position_margin_ratio ( symbol : str , new_position_side : Literal [ \"BUY\" , \"SELL\" ] | None = None , new_position_volume : float = 0 , ) -> float Calculate the margin ratio for a new position. Parameters: Name Type Description Default symbol str Symbol for which to calculate the margin ratio. required new_position_side Literal ['BUY', 'SELL'] | None Side of the new position, either \"BUY\" or \"SELL\". None new_position_volume float Volume of the new position. 0 Returns: Name Type Description float float Margin ratio for the new position as a fraction of account equity. Source code in pdmt5/trading.py 629 630 631 632 633 634 635 636 637 638 639 640 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 657 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 675 676 677 678 679 680 def calculate_new_position_margin_ratio ( self , symbol : str , new_position_side : Literal [ \"BUY\" , \"SELL\" ] | None = None , new_position_volume : float = 0 , ) -> float : \"\"\"Calculate the margin ratio for a new position. Args: symbol: Symbol for which to calculate the margin ratio. new_position_side: Side of the new position, either \"BUY\" or \"SELL\". new_position_volume: Volume of the new position. Returns: float: Margin ratio for the new position as a fraction of account equity. \"\"\" account_info = self . account_info_as_dict () if not account_info [ \"equity\" ]: result = 0.0 else : positions_df = self . fetch_positions_with_metrics_as_df ( symbol = symbol ) current_signed_margin = ( positions_df [ \"signed_margin\" ] . sum () if positions_df . size else 0 ) symbol_info_tick = self . symbol_info_tick_as_dict ( symbol = symbol ) if not ( new_position_side and new_position_volume ): new_signed_margin = 0 elif new_position_side . upper () == \"BUY\" : new_signed_margin = self . order_calc_margin ( action = self . mt5 . ORDER_TYPE_BUY , symbol = symbol , volume = new_position_volume , price = symbol_info_tick [ \"ask\" ], ) elif new_position_side . upper () == \"SELL\" : new_signed_margin = - self . order_calc_margin ( action = self . mt5 . ORDER_TYPE_SELL , symbol = symbol , volume = new_position_volume , price = symbol_info_tick [ \"bid\" ], ) else : new_signed_margin = 0 result = abs ( ( new_signed_margin + current_signed_margin ) / account_info [ \"equity\" ] ) self . logger . info ( \"Calculated new position margin ratio for %s : %s \" , symbol , result , ) return result calculate_spread_ratio \u00b6 calculate_spread_ratio ( symbol : str ) -> float Calculate the spread ratio for a given symbol. Parameters: Name Type Description Default symbol str Symbol for which to calculate the spread ratio. required Returns: Type Description float Spread ratio as a float. Source code in pdmt5/trading.py 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 def calculate_spread_ratio ( self , symbol : str , ) -> float : \"\"\"Calculate the spread ratio for a given symbol. Args: symbol: Symbol for which to calculate the spread ratio. Returns: Spread ratio as a float. \"\"\" symbol_info_tick = self . symbol_info_tick_as_dict ( symbol = symbol ) result = ( ( symbol_info_tick [ \"ask\" ] - symbol_info_tick [ \"bid\" ]) / ( symbol_info_tick [ \"ask\" ] + symbol_info_tick [ \"bid\" ]) * 2 ) self . logger . info ( \"Calculated spread ratio for %s : %s \" , symbol , result ) return result calculate_volume_by_margin \u00b6 calculate_volume_by_margin ( symbol : str , margin : float , order_side : Literal [ \"BUY\" , \"SELL\" ], ) -> float Calculate volume based on margin for a given symbol and order side. Parameters: Name Type Description Default symbol str Symbol for which to calculate the volume. required margin float Margin amount to use for the calculation. required order_side Literal ['BUY', 'SELL'] Side of the order, either \"BUY\" or \"SELL\". required Returns: Type Description float Calculated volume as a float. Source code in pdmt5/trading.py 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 def calculate_volume_by_margin ( self , symbol : str , margin : float , order_side : Literal [ \"BUY\" , \"SELL\" ], ) -> float : \"\"\"Calculate volume based on margin for a given symbol and order side. Args: symbol: Symbol for which to calculate the volume. margin: Margin amount to use for the calculation. order_side: Side of the order, either \"BUY\" or \"SELL\". Returns: Calculated volume as a float. \"\"\" min_order_margin_dict = self . calculate_minimum_order_margin ( symbol = symbol , order_side = order_side , ) if min_order_margin_dict [ \"margin\" ]: result = ( floor ( margin / min_order_margin_dict [ \"margin\" ]) * min_order_margin_dict [ \"volume\" ] ) else : result = 0.0 self . logger . info ( \"Calculated volume by margin to %s %s : %s \" , order_side , symbol , result , ) return result close_open_positions \u00b6 close_open_positions ( symbols : str | list [ str ] | tuple [ str , ... ] | None = None , order_filling_mode : Literal [ \"IOC\" , \"FOK\" , \"RETURN\" ] = \"IOC\" , dry_run : bool = False , ** kwargs : Any , ) -> dict [ str , list [ dict [ str , Any ]]] Close all open positions for specified symbols. Parameters: Name Type Description Default symbols str | list [ str ] | tuple [ str , ...] | None Optional symbol or list of symbols to filter positions. If None, all symbols will be considered. None order_filling_mode Literal ['IOC', 'FOK', 'RETURN'] Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\". 'IOC' dry_run bool If True, only check the order without sending it. False **kwargs Any Additional keyword arguments for request parameters. {} Returns: Type Description dict [ str , list [ dict [ str , Any ]]] Dictionary with symbols as keys and lists of dictionaries containing operation results for each closed position as values. Source code in pdmt5/trading.py 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 def close_open_positions ( self , symbols : str | list [ str ] | tuple [ str , ... ] | None = None , order_filling_mode : Literal [ \"IOC\" , \"FOK\" , \"RETURN\" ] = \"IOC\" , dry_run : bool = False , ** kwargs : Any , # noqa: ANN401 ) -> dict [ str , list [ dict [ str , Any ]]]: \"\"\"Close all open positions for specified symbols. Args: symbols: Optional symbol or list of symbols to filter positions. If None, all symbols will be considered. order_filling_mode: Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\". dry_run: If True, only check the order without sending it. **kwargs: Additional keyword arguments for request parameters. Returns: Dictionary with symbols as keys and lists of dictionaries containing operation results for each closed position as values. \"\"\" if isinstance ( symbols , str ): symbol_list = [ symbols ] elif isinstance ( symbols , ( list , tuple )): symbol_list = symbols else : symbol_list = self . symbols_get () self . logger . info ( \"Fetching and closing positions for symbols: %s \" , symbol_list ) return { s : self . _fetch_and_close_position ( symbol = s , order_filling_mode = order_filling_mode , dry_run = dry_run , ** kwargs , ) for s in symbol_list } collect_entry_deals_as_df \u00b6 collect_entry_deals_as_df ( symbol : str , history_seconds : int = 3600 , index_keys : str | None = \"ticket\" , ) -> DataFrame Collect entry deals as a DataFrame. Parameters: Name Type Description Default symbol str Symbol to collect entry deals for. required history_seconds int Time range in seconds to fetch deals around the last tick. 3600 index_keys str | None Optional index keys for the DataFrame. 'ticket' Returns: Type Description DataFrame pd.DataFrame: Entry deals with time index. Source code in pdmt5/trading.py 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557 558 559 560 def collect_entry_deals_as_df ( self , symbol : str , history_seconds : int = 3600 , index_keys : str | None = \"ticket\" , ) -> pd . DataFrame : \"\"\"Collect entry deals as a DataFrame. Args: symbol: Symbol to collect entry deals for. history_seconds: Time range in seconds to fetch deals around the last tick. index_keys: Optional index keys for the DataFrame. Returns: pd.DataFrame: Entry deals with time index. \"\"\" last_tick_time = self . symbol_info_tick_as_dict ( symbol = symbol )[ \"time\" ] deals_df = self . history_deals_get_as_df ( date_from = ( last_tick_time - timedelta ( seconds = history_seconds )), date_to = ( last_tick_time + timedelta ( seconds = history_seconds )), symbol = symbol , index_keys = index_keys , ) if deals_df . empty : result = deals_df else : result = deals_df . pipe ( lambda d : d [ d [ \"entry\" ] & d [ \"type\" ] . isin ({ self . mt5 . DEAL_TYPE_BUY , self . mt5 . DEAL_TYPE_SELL }) ] ) self . logger . info ( \"Collected entry deals for %s : %d rows\" , symbol , result . shape [ 0 ], ) return result fetch_latest_rates_as_df \u00b6 fetch_latest_rates_as_df ( symbol : str , granularity : str = \"M1\" , count : int = 1440 , index_keys : str | None = \"time\" , ) -> DataFrame Fetch rate (OHLC) data as a DataFrame. Parameters: Name Type Description Default symbol str Symbol to fetch data for. required granularity str Time granularity as a timeframe suffix (e.g., \"M1\", \"H1\"). 'M1' count int Number of bars to fetch. 1440 index_keys str | None Optional index keys for the DataFrame. 'time' Returns: Type Description DataFrame pd.DataFrame: OHLC data with time index. Raises: Type Description Mt5TradingError If the granularity is not supported by MetaTrader5. Source code in pdmt5/trading.py 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 def fetch_latest_rates_as_df ( self , symbol : str , granularity : str = \"M1\" , count : int = 1440 , index_keys : str | None = \"time\" , ) -> pd . DataFrame : \"\"\"Fetch rate (OHLC) data as a DataFrame. Args: symbol: Symbol to fetch data for. granularity: Time granularity as a timeframe suffix (e.g., \"M1\", \"H1\"). count: Number of bars to fetch. index_keys: Optional index keys for the DataFrame. Returns: pd.DataFrame: OHLC data with time index. Raises: Mt5TradingError: If the granularity is not supported by MetaTrader5. \"\"\" try : timeframe = getattr ( self . mt5 , f \"TIMEFRAME_ { granularity . upper () } \" ) except AttributeError as e : error_message = ( f \"MetaTrader5 does not support the given granularity: { granularity } \" ) raise Mt5TradingError ( error_message ) from e else : result = self . copy_rates_from_pos_as_df ( symbol = symbol , timeframe = timeframe , start_pos = 0 , count = count , index_keys = index_keys , ) self . logger . info ( \"Fetched latest %s rates for %s : %d rows\" , granularity , symbol , result . shape [ 0 ], ) return result fetch_latest_ticks_as_df \u00b6 fetch_latest_ticks_as_df ( symbol : str , seconds : int = 300 , index_keys : str | None = \"time_msc\" , ) -> DataFrame Fetch tick data as a DataFrame. Parameters: Name Type Description Default symbol str Symbol to fetch tick data for. required seconds int Time range in seconds to fetch ticks around the last tick time. 300 index_keys str | None Optional index keys for the DataFrame. 'time_msc' Returns: Type Description DataFrame pd.DataFrame: Tick data with time index. Source code in pdmt5/trading.py 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521 def fetch_latest_ticks_as_df ( self , symbol : str , seconds : int = 300 , index_keys : str | None = \"time_msc\" , ) -> pd . DataFrame : \"\"\"Fetch tick data as a DataFrame. Args: symbol: Symbol to fetch tick data for. seconds: Time range in seconds to fetch ticks around the last tick time. index_keys: Optional index keys for the DataFrame. Returns: pd.DataFrame: Tick data with time index. \"\"\" last_tick_time = self . symbol_info_tick_as_dict ( symbol = symbol )[ \"time\" ] result = self . copy_ticks_range_as_df ( symbol = symbol , date_from = ( last_tick_time - timedelta ( seconds = seconds )), date_to = ( last_tick_time + timedelta ( seconds = seconds )), flags = self . mt5 . COPY_TICKS_ALL , index_keys = index_keys , ) self . logger . info ( \"Fetched latest ticks for %s : %d rows\" , symbol , result . shape [ 0 ], ) return result fetch_positions_with_metrics_as_df \u00b6 fetch_positions_with_metrics_as_df ( symbol : str , ) -> DataFrame Fetch open positions as a DataFrame with additional metrics. Parameters: Name Type Description Default symbol str Symbol to fetch positions for. required Returns: Type Description DataFrame pd.DataFrame: DataFrame containing open positions with additional metrics. Source code in pdmt5/trading.py 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 588 589 590 591 592 593 594 595 596 597 598 599 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 623 624 625 626 627 def fetch_positions_with_metrics_as_df ( self , symbol : str , ) -> pd . DataFrame : \"\"\"Fetch open positions as a DataFrame with additional metrics. Args: symbol: Symbol to fetch positions for. Returns: pd.DataFrame: DataFrame containing open positions with additional metrics. \"\"\" positions_df = self . positions_get_as_df ( symbol = symbol ) if positions_df . empty : result = positions_df else : symbol_info_tick = self . symbol_info_tick_as_dict ( symbol = symbol ) ask_margin = self . order_calc_margin ( action = self . mt5 . ORDER_TYPE_BUY , symbol = symbol , volume = 1 , price = symbol_info_tick [ \"ask\" ], ) bid_margin = self . order_calc_margin ( action = self . mt5 . ORDER_TYPE_SELL , symbol = symbol , volume = 1 , price = symbol_info_tick [ \"bid\" ], ) result = ( positions_df . assign ( elapsed_seconds = lambda d : ( symbol_info_tick [ \"time\" ] - d [ \"time\" ] ) . dt . total_seconds (), underlier_increase_ratio = lambda d : ( d [ \"price_current\" ] / d [ \"price_open\" ] - 1 ), buy = lambda d : ( d [ \"type\" ] == self . mt5 . POSITION_TYPE_BUY ), sell = lambda d : ( d [ \"type\" ] == self . mt5 . POSITION_TYPE_SELL ), ) . assign ( buy_i = lambda d : d [ \"buy\" ] . astype ( int ), sell_i = lambda d : d [ \"sell\" ] . astype ( int ), ) . assign ( sign = lambda d : ( d [ \"buy_i\" ] - d [ \"sell_i\" ]), margin = lambda d : ( ( d [ \"buy_i\" ] * ask_margin + d [ \"sell_i\" ] * bid_margin ) * d [ \"volume\" ] ), ) . assign ( signed_volume = lambda d : ( d [ \"volume\" ] * d [ \"sign\" ]), signed_margin = lambda d : ( d [ \"margin\" ] * d [ \"sign\" ]), underlier_profit_ratio = lambda d : ( d [ \"underlier_increase_ratio\" ] * d [ \"sign\" ] ), ) . drop ( columns = [ \"buy_i\" , \"sell_i\" , \"sign\" , \"underlier_increase_ratio\" ]) ) self . logger . info ( \"Fetched positions with metrics for %s : %d rows\" , symbol , result . shape [ 0 ], ) return result place_market_order \u00b6 place_market_order ( symbol : str , volume : float , order_side : Literal [ \"BUY\" , \"SELL\" ], order_filling_mode : Literal [ \"IOC\" , \"FOK\" , \"RETURN\" ] = \"IOC\" , order_time_mode : Literal [ \"GTC\" , \"DAY\" , \"SPECIFIED\" , \"SPECIFIED_DAY\" ] = \"GTC\" , raise_on_error : bool = False , dry_run : bool = False , ** kwargs : Any , ) -> dict [ str , Any ] Send or check an order request to place a market order. Parameters: Name Type Description Default symbol str Symbol for the order. required volume float Volume of the order. required order_side Literal ['BUY', 'SELL'] Side of the order, either \"BUY\" or \"SELL\". required order_filling_mode Literal ['IOC', 'FOK', 'RETURN'] Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\". 'IOC' order_time_mode Literal ['GTC', 'DAY', 'SPECIFIED', 'SPECIFIED_DAY'] Order time mode, either \"GTC\", \"DAY\", \"SPECIFIED\", or \"SPECIFIED_DAY\". 'GTC' raise_on_error bool If True, raise an error on operation failure. False dry_run bool If True, only check the order without sending it. False **kwargs Any Additional keyword arguments for request parameters. {} Returns: Type Description dict [ str , Any ] Dictionary with operation result. Source code in pdmt5/trading.py 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 def place_market_order ( self , symbol : str , volume : float , order_side : Literal [ \"BUY\" , \"SELL\" ], order_filling_mode : Literal [ \"IOC\" , \"FOK\" , \"RETURN\" ] = \"IOC\" , order_time_mode : Literal [ \"GTC\" , \"DAY\" , \"SPECIFIED\" , \"SPECIFIED_DAY\" ] = \"GTC\" , raise_on_error : bool = False , dry_run : bool = False , ** kwargs : Any , # noqa: ANN401 ) -> dict [ str , Any ]: \"\"\"Send or check an order request to place a market order. Args: symbol: Symbol for the order. volume: Volume of the order. order_side: Side of the order, either \"BUY\" or \"SELL\". order_filling_mode: Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\". order_time_mode: Order time mode, either \"GTC\", \"DAY\", \"SPECIFIED\", or \"SPECIFIED_DAY\". raise_on_error: If True, raise an error on operation failure. dry_run: If True, only check the order without sending it. **kwargs: Additional keyword arguments for request parameters. Returns: Dictionary with operation result. \"\"\" self . logger . info ( \"Placing market order: %s %s %s \" , order_side , volume , symbol ) return self . _send_or_check_order ( request = { \"action\" : self . mt5 . TRADE_ACTION_DEAL , \"symbol\" : symbol , \"volume\" : volume , \"type\" : getattr ( self . mt5 , f \"ORDER_TYPE_ { order_side . upper () } \" ), \"type_filling\" : getattr ( self . mt5 , f \"ORDER_FILLING_ { order_filling_mode . upper () } \" ), \"type_time\" : getattr ( self . mt5 , f \"ORDER_TIME_ { order_time_mode . upper () } \" ), ** kwargs , }, raise_on_error = raise_on_error , dry_run = dry_run , ) update_sltp_for_open_positions \u00b6 update_sltp_for_open_positions ( symbol : str , stop_loss : float | None = None , take_profit : float | None = None , tickets : list [ int ] | None = None , raise_on_error : bool = False , dry_run : bool = False , ** kwargs : Any , ) -> list [ dict [ str , Any ]] Change Stop Loss and Take Profit for open positions. Parameters: Name Type Description Default symbol str Symbol for the position. required stop_loss float | None New Stop Loss price. If None, it will not be changed. None take_profit float | None New Take Profit price. If None, it will not be changed. None tickets list [ int ] | None List of position tickets to filter positions. If None, all open positions for the symbol will be considered. None raise_on_error bool If True, raise an error on operation failure. False dry_run bool If True, only check the order without sending it. False **kwargs Any Additional keyword arguments for request parameters. {} Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with operation results for each updated position. Source code in pdmt5/trading.py 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 def update_sltp_for_open_positions ( self , symbol : str , stop_loss : float | None = None , take_profit : float | None = None , tickets : list [ int ] | None = None , raise_on_error : bool = False , dry_run : bool = False , ** kwargs : Any , # noqa: ANN401 ) -> list [ dict [ str , Any ]]: \"\"\"Change Stop Loss and Take Profit for open positions. Args: symbol: Symbol for the position. stop_loss: New Stop Loss price. If None, it will not be changed. take_profit: New Take Profit price. If None, it will not be changed. tickets: List of position tickets to filter positions. If None, all open positions for the symbol will be considered. raise_on_error: If True, raise an error on operation failure. dry_run: If True, only check the order without sending it. **kwargs: Additional keyword arguments for request parameters. Returns: List of dictionaries with operation results for each updated position. \"\"\" positions_df = self . positions_get_as_df ( symbol = symbol ) if positions_df . empty : self . logger . warning ( \"No open positions found for symbol: %s \" , symbol ) return [] elif tickets : filtered_positions_df = positions_df . pipe ( lambda d : d [ d [ \"ticket\" ] . isin ( tickets )] ) else : filtered_positions_df = positions_df if filtered_positions_df . empty : self . logger . warning ( \"No open positions found for symbol: %s with specified tickets: %s \" , symbol , tickets , ) return [] else : symbol_info = self . symbol_info_as_dict ( symbol = symbol ) sl = round ( stop_loss , symbol_info [ \"digits\" ]) if stop_loss else None tp = round ( take_profit , symbol_info [ \"digits\" ]) if take_profit else None order_requests = [ { \"action\" : self . mt5 . TRADE_ACTION_SLTP , \"symbol\" : p [ \"symbol\" ], \"position\" : p [ \"ticket\" ], \"sl\" : ( sl or p [ \"sl\" ]), \"tp\" : ( tp or p [ \"tp\" ]), ** kwargs , } for _ , p in filtered_positions_df . iterrows () if sl != p [ \"sl\" ] or tp != p [ \"tp\" ] ] if order_requests : self . logger . info ( \"Updating SL/TP for %d positions for %s : %s / %s \" , len ( order_requests ), symbol , sl , tp , ) return [ self . _send_or_check_order ( request = r , raise_on_error = raise_on_error , dry_run = dry_run ) for r in order_requests ] else : self . logger . info ( \"No positions to update for symbol: %s with SL: %s and TP: %s \" , symbol , sl , tp , ) return [] options: show_bases: false Advanced trading client class that inherits from Mt5DataClient and provides specialized trading functionality. Mt5TradingError \u00b6 pdmt5.trading.Mt5TradingError \u00b6 Bases: Mt5RuntimeError MetaTrader5 trading error. options: show_bases: false Custom runtime exception for trading-specific errors. Usage Examples \u00b6 Basic Trading Operations \u00b6 import MetaTrader5 as mt5 from pdmt5 import Mt5TradingClient , Mt5Config # Create configuration config = Mt5Config ( login = 123456 , password = \"your_password\" , server = \"broker_server\" , timeout = 60000 , portable = False ) # Create client with dry run mode for testing client = Mt5TradingClient ( config = config , dry_run = True ) # Use as context manager with client : # Get current positions as DataFrame positions_df = client . get_positions_as_df () print ( f \"Open positions: { len ( positions_df ) } \" ) # Close positions for specific symbol results = client . close_open_positions ( \"EURUSD\" ) print ( f \"Closed positions: { results } \" ) Production Trading \u00b6 # Create client for live trading (dry_run=False) client = Mt5TradingClient ( config = config , dry_run = False ) with client : # Close all positions for multiple symbols results = client . close_open_positions ([ \"EURUSD\" , \"GBPUSD\" , \"USDJPY\" ]) # Close all positions (all symbols) all_results = client . close_open_positions () Order Filling Modes \u00b6 with Mt5TradingClient ( config = config ) as client : # Use IOC (Immediate or Cancel) - default results_ioc = client . close_open_positions ( symbols = \"EURUSD\" , order_filling_mode = \"IOC\" ) # Use FOK (Fill or Kill) results_fok = client . close_open_positions ( symbols = \"GBPUSD\" , order_filling_mode = \"FOK\" ) # Use RETURN (Return if not filled) results_return = client . close_open_positions ( symbols = \"USDJPY\" , order_filling_mode = \"RETURN\" ) Custom Order Parameters \u00b6 with client : # Close positions with custom parameters and order filling mode results = client . close_open_positions ( \"EURUSD\" , order_filling_mode = \"IOC\" , # Specify per method call comment = \"Closing all EURUSD positions\" , deviation = 10 # Maximum price deviation ) Error Handling \u00b6 from pdmt5.trading import Mt5TradingError try : with client : results = client . close_open_positions ( \"EURUSD\" ) except Mt5TradingError as e : print ( f \"Trading error: { e } \" ) # Handle specific trading errors Checking Order Status \u00b6 with client : # Check order (note: send_or_check_order is an internal method) # For trading operations, use the provided methods like close_open_positions # Example: Check if we can close a position positions = client . get_positions_as_df () if not positions . empty : # Close specific position results = client . close_open_positions ( \"EURUSD\" ) Position Management Features \u00b6 The Mt5TradingClient provides intelligent position management: Automatic Position Reversal : Automatically determines the correct order type to close positions Batch Operations : Close multiple positions for one or more symbols Dry Run Support : Test trading logic without executing real trades Flexible Filtering : Close positions by symbol, group, or all positions Custom Parameters : Support for additional order parameters like comment, deviation, etc. Dry Run Mode \u00b6 Dry run mode is essential for testing trading strategies: # Test mode - validates orders without execution test_client = Mt5TradingClient ( config = config , dry_run = True ) # Production mode - executes real orders prod_client = Mt5TradingClient ( config = config , dry_run = False ) In dry run mode: Orders are validated using order_check() instead of order_send() No actual trades are executed Full validation of margin requirements and order parameters Same return structure as live trading for easy testing Return Values \u00b6 The close_open_positions() method returns a dictionary with symbols as keys: { \"EURUSD\" : [ { \"retcode\" : 10009 , # Trade done \"deal\" : 123456 , \"order\" : 789012 , \"volume\" : 1.0 , \"price\" : 1.1000 , \"comment\" : \"Request executed\" , ... } ], \"GBPUSD\" : [ ... ] } Best Practices \u00b6 Always use dry run mode first to test your trading logic Handle Mt5TradingError exceptions for proper error management Check return codes to verify successful execution Use context managers for automatic connection handling Log trading operations for audit trails Validate positions exist before attempting to close them Consider market hours and trading session times Common Return Codes \u00b6 TRADE_RETCODE_DONE (10009): Trade operation completed successfully TRADE_RETCODE_TRADE_DISABLED : Trading disabled for the account TRADE_RETCODE_MARKET_CLOSED : Market is closed TRADE_RETCODE_NO_MONEY : Insufficient funds TRADE_RETCODE_INVALID_VOLUME : Invalid trade volume Margin Calculation Methods \u00b6 The trading client provides advanced margin calculation capabilities: Calculate Minimum Order Margin \u00b6 with client : # Calculate minimum margin required for BUY order min_margin_buy = client . calculate_minimum_order_margin ( \"EURUSD\" , \"BUY\" ) print ( f \"Minimum volume: { min_margin_buy [ 'volume' ] } \" ) print ( f \"Minimum margin: { min_margin_buy [ 'margin' ] } \" ) # Calculate minimum margin required for SELL order min_margin_sell = client . calculate_minimum_order_margin ( \"EURUSD\" , \"SELL\" ) Calculate Volume by Margin \u00b6 with client : # Calculate maximum volume for given margin amount available_margin = 1000.0 # USD max_volume_buy = client . calculate_volume_by_margin ( \"EURUSD\" , available_margin , \"BUY\" ) max_volume_sell = client . calculate_volume_by_margin ( \"EURUSD\" , available_margin , \"SELL\" ) print ( f \"Max BUY volume for $ { available_margin } : { max_volume_buy } \" ) print ( f \"Max SELL volume for $ { available_margin } : { max_volume_sell } \" ) Calculate New Position Margin Ratio \u00b6 with client : # Calculate margin ratio for potential new position margin_ratio = client . calculate_new_position_margin_ratio ( symbol = \"EURUSD\" , new_position_side = \"BUY\" , new_position_volume = 1.0 ) print ( f \"New position would use { margin_ratio : .2% } of account equity\" ) # Check if adding position would exceed risk limits if margin_ratio > 0.1 : # 10% risk limit print ( \"Position size too large for risk management\" ) Market Order Placement \u00b6 Place market orders with flexible configuration: with client : # Place a BUY market order result = client . place_market_order ( symbol = \"EURUSD\" , volume = 1.0 , order_side = \"BUY\" , order_filling_mode = \"IOC\" , # Immediate or Cancel order_time_mode = \"GTC\" , # Good Till Cancelled dry_run = False , # Set to True for testing comment = \"My buy order\" ) # Place a SELL market order with FOK filling result = client . place_market_order ( symbol = \"EURUSD\" , volume = 0.5 , order_side = \"SELL\" , order_filling_mode = \"FOK\" , # Fill or Kill dry_run = True # Test mode ) print ( f \"Order result: { result } \" ) Stop Loss and Take Profit Management \u00b6 Update SL/TP for existing positions: with client : # Update SL/TP for all EURUSD positions results = client . update_sltp_for_open_positions ( symbol = \"EURUSD\" , stop_loss = 1.0950 , take_profit = 1.1100 , dry_run = False ) # Update only specific positions by ticket results = client . update_sltp_for_open_positions ( symbol = \"EURUSD\" , stop_loss = 1.0950 , tickets = [ 123456 , 789012 ], # Specific position tickets dry_run = True ) Market Data and Analysis Methods \u00b6 Spread Analysis \u00b6 with client : # Calculate spread ratio for symbol spread_ratio = client . calculate_spread_ratio ( \"EURUSD\" ) print ( f \"EURUSD spread ratio: { spread_ratio : .6f } \" ) OHLC Data Retrieval \u00b6 with client : # Fetch latest rate data as DataFrame rates_df = client . fetch_latest_rates_as_df ( symbol = \"EURUSD\" , granularity = \"M1\" , # 1-minute bars count = 1440 , # Last 24 hours index_keys = \"time\" ) print ( f \"Latest rates: { rates_df . tail () } \" ) Tick Data Analysis \u00b6 with client : # Fetch recent tick data ticks_df = client . fetch_latest_ticks_as_df ( symbol = \"EURUSD\" , seconds = 300 , # Last 5 minutes index_keys = \"time_msc\" ) print ( f \"Tick count: { len ( ticks_df ) } \" ) Position Analytics with Enhanced Metrics \u00b6 with client : # Get positions with additional calculated metrics positions_df = client . fetch_positions_with_metrics_as_df ( \"EURUSD\" ) if not positions_df . empty : print ( \"Position metrics:\" ) print ( f \"Total signed volume: { positions_df [ 'signed_volume' ] . sum () } \" ) print ( f \"Total signed margin: { positions_df [ 'signed_margin' ] . sum () } \" ) print ( f \"Average profit ratio: { positions_df [ 'underlier_profit_ratio' ] . mean () : .4f } \" ) Deal History Analysis \u00b6 with client : # Collect entry deals for analysis deals_df = client . collect_entry_deals_as_df ( symbol = \"EURUSD\" , history_seconds = 3600 , # Last hour index_keys = \"ticket\" ) if not deals_df . empty : print ( f \"Entry deals found: { len ( deals_df ) } \" ) print ( f \"Deal types: { deals_df [ 'type' ] . value_counts () } \" ) Integration with Mt5DataClient \u00b6 Since Mt5TradingClient inherits from Mt5DataClient, all data retrieval methods are available: with Mt5TradingClient ( config = config ) as client : # Get current positions as DataFrame positions_df = client . get_positions_as_df () # Analyze positions if not positions_df . empty : # Calculate total exposure total_volume = positions_df [ 'volume' ] . sum () # Close losing positions losing_positions = positions_df [ positions_df [ 'profit' ] < 0 ] for symbol in losing_positions [ 'symbol' ] . unique (): client . close_open_positions ( symbol ) # Risk management with margin calculations for symbol in [ \"EURUSD\" , \"GBPUSD\" , \"USDJPY\" ]: # Calculate current margin usage current_ratio = client . calculate_new_position_margin_ratio ( symbol ) print ( f \" { symbol } current margin ratio: { current_ratio : .2% } \" ) # Calculate maximum safe position size safe_margin = 500.0 # USD max_safe_volume = client . calculate_volume_by_margin ( symbol , safe_margin , \"BUY\" ) print ( f \" { symbol } max safe volume: { max_safe_volume } \" )","title":"Trading"},{"location":"api/trading/#trading","text":"","title":"Trading"},{"location":"api/trading/#pdmt5.trading","text":"Trading operations module with advanced MetaTrader5 functionality.","title":"trading"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient","text":"Bases: Mt5DataClient MetaTrader5 trading client with advanced trading operations. This class extends Mt5DataClient to provide specialized trading functionality including position management, order analysis, and trading performance metrics.","title":"Mt5TradingClient"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.model_config","text":"model_config = ConfigDict ( frozen = True )","title":"model_config"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.mt5_failed_trade_retcodes","text":"mt5_failed_trade_retcodes : set [ int ] Set of failed trade return codes. Returns: Type Description set [ int ] Set of failed trade return codes.","title":"mt5_failed_trade_retcodes"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.mt5_successful_trade_retcodes","text":"mt5_successful_trade_retcodes : set [ int ] Set of successful trade return codes. Returns: Type Description set [ int ] Set of successful trade return codes.","title":"mt5_successful_trade_retcodes"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.calculate_minimum_order_margin","text":"calculate_minimum_order_margin ( symbol : str , order_side : Literal [ \"BUY\" , \"SELL\" ] ) -> dict [ str , float ] Calculate the minimum order margins for a given symbol. Parameters: Name Type Description Default symbol str Symbol for which to calculate the minimum order margins. required order_side Literal ['BUY', 'SELL'] Optional side of the order, either \"BUY\" or \"SELL\". required Returns: Type Description dict [ str , float ] Dictionary with minimum volume and margin for the specified order side. Source code in pdmt5/trading.py 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 def calculate_minimum_order_margin ( self , symbol : str , order_side : Literal [ \"BUY\" , \"SELL\" ], ) -> dict [ str , float ]: \"\"\"Calculate the minimum order margins for a given symbol. Args: symbol: Symbol for which to calculate the minimum order margins. order_side: Optional side of the order, either \"BUY\" or \"SELL\". Returns: Dictionary with minimum volume and margin for the specified order side. \"\"\" symbol_info = self . symbol_info_as_dict ( symbol = symbol ) symbol_info_tick = self . symbol_info_tick_as_dict ( symbol = symbol ) margin = self . order_calc_margin ( action = getattr ( self . mt5 , f \"ORDER_TYPE_ { order_side . upper () } \" ), symbol = symbol , volume = symbol_info [ \"volume_min\" ], price = ( symbol_info_tick [ \"bid\" ] if order_side == \"SELL\" else symbol_info_tick [ \"ask\" ] ), ) result = { \"volume\" : symbol_info [ \"volume_min\" ], \"margin\" : margin } if margin : self . logger . info ( \"Calculated minimum %s order margin for %s : %s \" , order_side , symbol , result , ) else : self . logger . warning ( \"Calculated minimum order margin to %s %s : %s \" , order_side , symbol , result , ) return result","title":"calculate_minimum_order_margin"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.calculate_new_position_margin_ratio","text":"calculate_new_position_margin_ratio ( symbol : str , new_position_side : Literal [ \"BUY\" , \"SELL\" ] | None = None , new_position_volume : float = 0 , ) -> float Calculate the margin ratio for a new position. Parameters: Name Type Description Default symbol str Symbol for which to calculate the margin ratio. required new_position_side Literal ['BUY', 'SELL'] | None Side of the new position, either \"BUY\" or \"SELL\". None new_position_volume float Volume of the new position. 0 Returns: Name Type Description float float Margin ratio for the new position as a fraction of account equity. Source code in pdmt5/trading.py 629 630 631 632 633 634 635 636 637 638 639 640 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 657 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 675 676 677 678 679 680 def calculate_new_position_margin_ratio ( self , symbol : str , new_position_side : Literal [ \"BUY\" , \"SELL\" ] | None = None , new_position_volume : float = 0 , ) -> float : \"\"\"Calculate the margin ratio for a new position. Args: symbol: Symbol for which to calculate the margin ratio. new_position_side: Side of the new position, either \"BUY\" or \"SELL\". new_position_volume: Volume of the new position. Returns: float: Margin ratio for the new position as a fraction of account equity. \"\"\" account_info = self . account_info_as_dict () if not account_info [ \"equity\" ]: result = 0.0 else : positions_df = self . fetch_positions_with_metrics_as_df ( symbol = symbol ) current_signed_margin = ( positions_df [ \"signed_margin\" ] . sum () if positions_df . size else 0 ) symbol_info_tick = self . symbol_info_tick_as_dict ( symbol = symbol ) if not ( new_position_side and new_position_volume ): new_signed_margin = 0 elif new_position_side . upper () == \"BUY\" : new_signed_margin = self . order_calc_margin ( action = self . mt5 . ORDER_TYPE_BUY , symbol = symbol , volume = new_position_volume , price = symbol_info_tick [ \"ask\" ], ) elif new_position_side . upper () == \"SELL\" : new_signed_margin = - self . order_calc_margin ( action = self . mt5 . ORDER_TYPE_SELL , symbol = symbol , volume = new_position_volume , price = symbol_info_tick [ \"bid\" ], ) else : new_signed_margin = 0 result = abs ( ( new_signed_margin + current_signed_margin ) / account_info [ \"equity\" ] ) self . logger . info ( \"Calculated new position margin ratio for %s : %s \" , symbol , result , ) return result","title":"calculate_new_position_margin_ratio"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.calculate_spread_ratio","text":"calculate_spread_ratio ( symbol : str ) -> float Calculate the spread ratio for a given symbol. Parameters: Name Type Description Default symbol str Symbol for which to calculate the spread ratio. required Returns: Type Description float Spread ratio as a float. Source code in pdmt5/trading.py 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 def calculate_spread_ratio ( self , symbol : str , ) -> float : \"\"\"Calculate the spread ratio for a given symbol. Args: symbol: Symbol for which to calculate the spread ratio. Returns: Spread ratio as a float. \"\"\" symbol_info_tick = self . symbol_info_tick_as_dict ( symbol = symbol ) result = ( ( symbol_info_tick [ \"ask\" ] - symbol_info_tick [ \"bid\" ]) / ( symbol_info_tick [ \"ask\" ] + symbol_info_tick [ \"bid\" ]) * 2 ) self . logger . info ( \"Calculated spread ratio for %s : %s \" , symbol , result ) return result","title":"calculate_spread_ratio"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.calculate_volume_by_margin","text":"calculate_volume_by_margin ( symbol : str , margin : float , order_side : Literal [ \"BUY\" , \"SELL\" ], ) -> float Calculate volume based on margin for a given symbol and order side. Parameters: Name Type Description Default symbol str Symbol for which to calculate the volume. required margin float Margin amount to use for the calculation. required order_side Literal ['BUY', 'SELL'] Side of the order, either \"BUY\" or \"SELL\". required Returns: Type Description float Calculated volume as a float. Source code in pdmt5/trading.py 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 def calculate_volume_by_margin ( self , symbol : str , margin : float , order_side : Literal [ \"BUY\" , \"SELL\" ], ) -> float : \"\"\"Calculate volume based on margin for a given symbol and order side. Args: symbol: Symbol for which to calculate the volume. margin: Margin amount to use for the calculation. order_side: Side of the order, either \"BUY\" or \"SELL\". Returns: Calculated volume as a float. \"\"\" min_order_margin_dict = self . calculate_minimum_order_margin ( symbol = symbol , order_side = order_side , ) if min_order_margin_dict [ \"margin\" ]: result = ( floor ( margin / min_order_margin_dict [ \"margin\" ]) * min_order_margin_dict [ \"volume\" ] ) else : result = 0.0 self . logger . info ( \"Calculated volume by margin to %s %s : %s \" , order_side , symbol , result , ) return result","title":"calculate_volume_by_margin"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.close_open_positions","text":"close_open_positions ( symbols : str | list [ str ] | tuple [ str , ... ] | None = None , order_filling_mode : Literal [ \"IOC\" , \"FOK\" , \"RETURN\" ] = \"IOC\" , dry_run : bool = False , ** kwargs : Any , ) -> dict [ str , list [ dict [ str , Any ]]] Close all open positions for specified symbols. Parameters: Name Type Description Default symbols str | list [ str ] | tuple [ str , ...] | None Optional symbol or list of symbols to filter positions. If None, all symbols will be considered. None order_filling_mode Literal ['IOC', 'FOK', 'RETURN'] Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\". 'IOC' dry_run bool If True, only check the order without sending it. False **kwargs Any Additional keyword arguments for request parameters. {} Returns: Type Description dict [ str , list [ dict [ str , Any ]]] Dictionary with symbols as keys and lists of dictionaries containing operation results for each closed position as values. Source code in pdmt5/trading.py 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 def close_open_positions ( self , symbols : str | list [ str ] | tuple [ str , ... ] | None = None , order_filling_mode : Literal [ \"IOC\" , \"FOK\" , \"RETURN\" ] = \"IOC\" , dry_run : bool = False , ** kwargs : Any , # noqa: ANN401 ) -> dict [ str , list [ dict [ str , Any ]]]: \"\"\"Close all open positions for specified symbols. Args: symbols: Optional symbol or list of symbols to filter positions. If None, all symbols will be considered. order_filling_mode: Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\". dry_run: If True, only check the order without sending it. **kwargs: Additional keyword arguments for request parameters. Returns: Dictionary with symbols as keys and lists of dictionaries containing operation results for each closed position as values. \"\"\" if isinstance ( symbols , str ): symbol_list = [ symbols ] elif isinstance ( symbols , ( list , tuple )): symbol_list = symbols else : symbol_list = self . symbols_get () self . logger . info ( \"Fetching and closing positions for symbols: %s \" , symbol_list ) return { s : self . _fetch_and_close_position ( symbol = s , order_filling_mode = order_filling_mode , dry_run = dry_run , ** kwargs , ) for s in symbol_list }","title":"close_open_positions"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.collect_entry_deals_as_df","text":"collect_entry_deals_as_df ( symbol : str , history_seconds : int = 3600 , index_keys : str | None = \"ticket\" , ) -> DataFrame Collect entry deals as a DataFrame. Parameters: Name Type Description Default symbol str Symbol to collect entry deals for. required history_seconds int Time range in seconds to fetch deals around the last tick. 3600 index_keys str | None Optional index keys for the DataFrame. 'ticket' Returns: Type Description DataFrame pd.DataFrame: Entry deals with time index. Source code in pdmt5/trading.py 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557 558 559 560 def collect_entry_deals_as_df ( self , symbol : str , history_seconds : int = 3600 , index_keys : str | None = \"ticket\" , ) -> pd . DataFrame : \"\"\"Collect entry deals as a DataFrame. Args: symbol: Symbol to collect entry deals for. history_seconds: Time range in seconds to fetch deals around the last tick. index_keys: Optional index keys for the DataFrame. Returns: pd.DataFrame: Entry deals with time index. \"\"\" last_tick_time = self . symbol_info_tick_as_dict ( symbol = symbol )[ \"time\" ] deals_df = self . history_deals_get_as_df ( date_from = ( last_tick_time - timedelta ( seconds = history_seconds )), date_to = ( last_tick_time + timedelta ( seconds = history_seconds )), symbol = symbol , index_keys = index_keys , ) if deals_df . empty : result = deals_df else : result = deals_df . pipe ( lambda d : d [ d [ \"entry\" ] & d [ \"type\" ] . isin ({ self . mt5 . DEAL_TYPE_BUY , self . mt5 . DEAL_TYPE_SELL }) ] ) self . logger . info ( \"Collected entry deals for %s : %d rows\" , symbol , result . shape [ 0 ], ) return result","title":"collect_entry_deals_as_df"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.fetch_latest_rates_as_df","text":"fetch_latest_rates_as_df ( symbol : str , granularity : str = \"M1\" , count : int = 1440 , index_keys : str | None = \"time\" , ) -> DataFrame Fetch rate (OHLC) data as a DataFrame. Parameters: Name Type Description Default symbol str Symbol to fetch data for. required granularity str Time granularity as a timeframe suffix (e.g., \"M1\", \"H1\"). 'M1' count int Number of bars to fetch. 1440 index_keys str | None Optional index keys for the DataFrame. 'time' Returns: Type Description DataFrame pd.DataFrame: OHLC data with time index. Raises: Type Description Mt5TradingError If the granularity is not supported by MetaTrader5. Source code in pdmt5/trading.py 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 def fetch_latest_rates_as_df ( self , symbol : str , granularity : str = \"M1\" , count : int = 1440 , index_keys : str | None = \"time\" , ) -> pd . DataFrame : \"\"\"Fetch rate (OHLC) data as a DataFrame. Args: symbol: Symbol to fetch data for. granularity: Time granularity as a timeframe suffix (e.g., \"M1\", \"H1\"). count: Number of bars to fetch. index_keys: Optional index keys for the DataFrame. Returns: pd.DataFrame: OHLC data with time index. Raises: Mt5TradingError: If the granularity is not supported by MetaTrader5. \"\"\" try : timeframe = getattr ( self . mt5 , f \"TIMEFRAME_ { granularity . upper () } \" ) except AttributeError as e : error_message = ( f \"MetaTrader5 does not support the given granularity: { granularity } \" ) raise Mt5TradingError ( error_message ) from e else : result = self . copy_rates_from_pos_as_df ( symbol = symbol , timeframe = timeframe , start_pos = 0 , count = count , index_keys = index_keys , ) self . logger . info ( \"Fetched latest %s rates for %s : %d rows\" , granularity , symbol , result . shape [ 0 ], ) return result","title":"fetch_latest_rates_as_df"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.fetch_latest_ticks_as_df","text":"fetch_latest_ticks_as_df ( symbol : str , seconds : int = 300 , index_keys : str | None = \"time_msc\" , ) -> DataFrame Fetch tick data as a DataFrame. Parameters: Name Type Description Default symbol str Symbol to fetch tick data for. required seconds int Time range in seconds to fetch ticks around the last tick time. 300 index_keys str | None Optional index keys for the DataFrame. 'time_msc' Returns: Type Description DataFrame pd.DataFrame: Tick data with time index. Source code in pdmt5/trading.py 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521 def fetch_latest_ticks_as_df ( self , symbol : str , seconds : int = 300 , index_keys : str | None = \"time_msc\" , ) -> pd . DataFrame : \"\"\"Fetch tick data as a DataFrame. Args: symbol: Symbol to fetch tick data for. seconds: Time range in seconds to fetch ticks around the last tick time. index_keys: Optional index keys for the DataFrame. Returns: pd.DataFrame: Tick data with time index. \"\"\" last_tick_time = self . symbol_info_tick_as_dict ( symbol = symbol )[ \"time\" ] result = self . copy_ticks_range_as_df ( symbol = symbol , date_from = ( last_tick_time - timedelta ( seconds = seconds )), date_to = ( last_tick_time + timedelta ( seconds = seconds )), flags = self . mt5 . COPY_TICKS_ALL , index_keys = index_keys , ) self . logger . info ( \"Fetched latest ticks for %s : %d rows\" , symbol , result . shape [ 0 ], ) return result","title":"fetch_latest_ticks_as_df"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.fetch_positions_with_metrics_as_df","text":"fetch_positions_with_metrics_as_df ( symbol : str , ) -> DataFrame Fetch open positions as a DataFrame with additional metrics. Parameters: Name Type Description Default symbol str Symbol to fetch positions for. required Returns: Type Description DataFrame pd.DataFrame: DataFrame containing open positions with additional metrics. Source code in pdmt5/trading.py 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 588 589 590 591 592 593 594 595 596 597 598 599 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 623 624 625 626 627 def fetch_positions_with_metrics_as_df ( self , symbol : str , ) -> pd . DataFrame : \"\"\"Fetch open positions as a DataFrame with additional metrics. Args: symbol: Symbol to fetch positions for. Returns: pd.DataFrame: DataFrame containing open positions with additional metrics. \"\"\" positions_df = self . positions_get_as_df ( symbol = symbol ) if positions_df . empty : result = positions_df else : symbol_info_tick = self . symbol_info_tick_as_dict ( symbol = symbol ) ask_margin = self . order_calc_margin ( action = self . mt5 . ORDER_TYPE_BUY , symbol = symbol , volume = 1 , price = symbol_info_tick [ \"ask\" ], ) bid_margin = self . order_calc_margin ( action = self . mt5 . ORDER_TYPE_SELL , symbol = symbol , volume = 1 , price = symbol_info_tick [ \"bid\" ], ) result = ( positions_df . assign ( elapsed_seconds = lambda d : ( symbol_info_tick [ \"time\" ] - d [ \"time\" ] ) . dt . total_seconds (), underlier_increase_ratio = lambda d : ( d [ \"price_current\" ] / d [ \"price_open\" ] - 1 ), buy = lambda d : ( d [ \"type\" ] == self . mt5 . POSITION_TYPE_BUY ), sell = lambda d : ( d [ \"type\" ] == self . mt5 . POSITION_TYPE_SELL ), ) . assign ( buy_i = lambda d : d [ \"buy\" ] . astype ( int ), sell_i = lambda d : d [ \"sell\" ] . astype ( int ), ) . assign ( sign = lambda d : ( d [ \"buy_i\" ] - d [ \"sell_i\" ]), margin = lambda d : ( ( d [ \"buy_i\" ] * ask_margin + d [ \"sell_i\" ] * bid_margin ) * d [ \"volume\" ] ), ) . assign ( signed_volume = lambda d : ( d [ \"volume\" ] * d [ \"sign\" ]), signed_margin = lambda d : ( d [ \"margin\" ] * d [ \"sign\" ]), underlier_profit_ratio = lambda d : ( d [ \"underlier_increase_ratio\" ] * d [ \"sign\" ] ), ) . drop ( columns = [ \"buy_i\" , \"sell_i\" , \"sign\" , \"underlier_increase_ratio\" ]) ) self . logger . info ( \"Fetched positions with metrics for %s : %d rows\" , symbol , result . shape [ 0 ], ) return result","title":"fetch_positions_with_metrics_as_df"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.place_market_order","text":"place_market_order ( symbol : str , volume : float , order_side : Literal [ \"BUY\" , \"SELL\" ], order_filling_mode : Literal [ \"IOC\" , \"FOK\" , \"RETURN\" ] = \"IOC\" , order_time_mode : Literal [ \"GTC\" , \"DAY\" , \"SPECIFIED\" , \"SPECIFIED_DAY\" ] = \"GTC\" , raise_on_error : bool = False , dry_run : bool = False , ** kwargs : Any , ) -> dict [ str , Any ] Send or check an order request to place a market order. Parameters: Name Type Description Default symbol str Symbol for the order. required volume float Volume of the order. required order_side Literal ['BUY', 'SELL'] Side of the order, either \"BUY\" or \"SELL\". required order_filling_mode Literal ['IOC', 'FOK', 'RETURN'] Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\". 'IOC' order_time_mode Literal ['GTC', 'DAY', 'SPECIFIED', 'SPECIFIED_DAY'] Order time mode, either \"GTC\", \"DAY\", \"SPECIFIED\", or \"SPECIFIED_DAY\". 'GTC' raise_on_error bool If True, raise an error on operation failure. False dry_run bool If True, only check the order without sending it. False **kwargs Any Additional keyword arguments for request parameters. {} Returns: Type Description dict [ str , Any ] Dictionary with operation result. Source code in pdmt5/trading.py 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 def place_market_order ( self , symbol : str , volume : float , order_side : Literal [ \"BUY\" , \"SELL\" ], order_filling_mode : Literal [ \"IOC\" , \"FOK\" , \"RETURN\" ] = \"IOC\" , order_time_mode : Literal [ \"GTC\" , \"DAY\" , \"SPECIFIED\" , \"SPECIFIED_DAY\" ] = \"GTC\" , raise_on_error : bool = False , dry_run : bool = False , ** kwargs : Any , # noqa: ANN401 ) -> dict [ str , Any ]: \"\"\"Send or check an order request to place a market order. Args: symbol: Symbol for the order. volume: Volume of the order. order_side: Side of the order, either \"BUY\" or \"SELL\". order_filling_mode: Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\". order_time_mode: Order time mode, either \"GTC\", \"DAY\", \"SPECIFIED\", or \"SPECIFIED_DAY\". raise_on_error: If True, raise an error on operation failure. dry_run: If True, only check the order without sending it. **kwargs: Additional keyword arguments for request parameters. Returns: Dictionary with operation result. \"\"\" self . logger . info ( \"Placing market order: %s %s %s \" , order_side , volume , symbol ) return self . _send_or_check_order ( request = { \"action\" : self . mt5 . TRADE_ACTION_DEAL , \"symbol\" : symbol , \"volume\" : volume , \"type\" : getattr ( self . mt5 , f \"ORDER_TYPE_ { order_side . upper () } \" ), \"type_filling\" : getattr ( self . mt5 , f \"ORDER_FILLING_ { order_filling_mode . upper () } \" ), \"type_time\" : getattr ( self . mt5 , f \"ORDER_TIME_ { order_time_mode . upper () } \" ), ** kwargs , }, raise_on_error = raise_on_error , dry_run = dry_run , )","title":"place_market_order"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.update_sltp_for_open_positions","text":"update_sltp_for_open_positions ( symbol : str , stop_loss : float | None = None , take_profit : float | None = None , tickets : list [ int ] | None = None , raise_on_error : bool = False , dry_run : bool = False , ** kwargs : Any , ) -> list [ dict [ str , Any ]] Change Stop Loss and Take Profit for open positions. Parameters: Name Type Description Default symbol str Symbol for the position. required stop_loss float | None New Stop Loss price. If None, it will not be changed. None take_profit float | None New Take Profit price. If None, it will not be changed. None tickets list [ int ] | None List of position tickets to filter positions. If None, all open positions for the symbol will be considered. None raise_on_error bool If True, raise an error on operation failure. False dry_run bool If True, only check the order without sending it. False **kwargs Any Additional keyword arguments for request parameters. {} Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with operation results for each updated position. Source code in pdmt5/trading.py 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 def update_sltp_for_open_positions ( self , symbol : str , stop_loss : float | None = None , take_profit : float | None = None , tickets : list [ int ] | None = None , raise_on_error : bool = False , dry_run : bool = False , ** kwargs : Any , # noqa: ANN401 ) -> list [ dict [ str , Any ]]: \"\"\"Change Stop Loss and Take Profit for open positions. Args: symbol: Symbol for the position. stop_loss: New Stop Loss price. If None, it will not be changed. take_profit: New Take Profit price. If None, it will not be changed. tickets: List of position tickets to filter positions. If None, all open positions for the symbol will be considered. raise_on_error: If True, raise an error on operation failure. dry_run: If True, only check the order without sending it. **kwargs: Additional keyword arguments for request parameters. Returns: List of dictionaries with operation results for each updated position. \"\"\" positions_df = self . positions_get_as_df ( symbol = symbol ) if positions_df . empty : self . logger . warning ( \"No open positions found for symbol: %s \" , symbol ) return [] elif tickets : filtered_positions_df = positions_df . pipe ( lambda d : d [ d [ \"ticket\" ] . isin ( tickets )] ) else : filtered_positions_df = positions_df if filtered_positions_df . empty : self . logger . warning ( \"No open positions found for symbol: %s with specified tickets: %s \" , symbol , tickets , ) return [] else : symbol_info = self . symbol_info_as_dict ( symbol = symbol ) sl = round ( stop_loss , symbol_info [ \"digits\" ]) if stop_loss else None tp = round ( take_profit , symbol_info [ \"digits\" ]) if take_profit else None order_requests = [ { \"action\" : self . mt5 . TRADE_ACTION_SLTP , \"symbol\" : p [ \"symbol\" ], \"position\" : p [ \"ticket\" ], \"sl\" : ( sl or p [ \"sl\" ]), \"tp\" : ( tp or p [ \"tp\" ]), ** kwargs , } for _ , p in filtered_positions_df . iterrows () if sl != p [ \"sl\" ] or tp != p [ \"tp\" ] ] if order_requests : self . logger . info ( \"Updating SL/TP for %d positions for %s : %s / %s \" , len ( order_requests ), symbol , sl , tp , ) return [ self . _send_or_check_order ( request = r , raise_on_error = raise_on_error , dry_run = dry_run ) for r in order_requests ] else : self . logger . info ( \"No positions to update for symbol: %s with SL: %s and TP: %s \" , symbol , sl , tp , ) return []","title":"update_sltp_for_open_positions"},{"location":"api/trading/#pdmt5.trading.Mt5TradingError","text":"Bases: Mt5RuntimeError MetaTrader5 trading error.","title":"Mt5TradingError"},{"location":"api/trading/#overview","text":"The trading module extends Mt5DataClient with advanced trading operations including position management, order execution, and dry run support for testing trading strategies without actual execution.","title":"Overview"},{"location":"api/trading/#classes","text":"","title":"Classes"},{"location":"api/trading/#mt5tradingclient","text":"","title":"Mt5TradingClient"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient","text":"Bases: Mt5DataClient MetaTrader5 trading client with advanced trading operations. This class extends Mt5DataClient to provide specialized trading functionality including position management, order analysis, and trading performance metrics.","title":"Mt5TradingClient"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.model_config","text":"model_config = ConfigDict ( frozen = True )","title":"model_config"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.mt5_failed_trade_retcodes","text":"mt5_failed_trade_retcodes : set [ int ] Set of failed trade return codes. Returns: Type Description set [ int ] Set of failed trade return codes.","title":"mt5_failed_trade_retcodes"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.mt5_successful_trade_retcodes","text":"mt5_successful_trade_retcodes : set [ int ] Set of successful trade return codes. Returns: Type Description set [ int ] Set of successful trade return codes.","title":"mt5_successful_trade_retcodes"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.calculate_minimum_order_margin","text":"calculate_minimum_order_margin ( symbol : str , order_side : Literal [ \"BUY\" , \"SELL\" ] ) -> dict [ str , float ] Calculate the minimum order margins for a given symbol. Parameters: Name Type Description Default symbol str Symbol for which to calculate the minimum order margins. required order_side Literal ['BUY', 'SELL'] Optional side of the order, either \"BUY\" or \"SELL\". required Returns: Type Description dict [ str , float ] Dictionary with minimum volume and margin for the specified order side. Source code in pdmt5/trading.py 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 def calculate_minimum_order_margin ( self , symbol : str , order_side : Literal [ \"BUY\" , \"SELL\" ], ) -> dict [ str , float ]: \"\"\"Calculate the minimum order margins for a given symbol. Args: symbol: Symbol for which to calculate the minimum order margins. order_side: Optional side of the order, either \"BUY\" or \"SELL\". Returns: Dictionary with minimum volume and margin for the specified order side. \"\"\" symbol_info = self . symbol_info_as_dict ( symbol = symbol ) symbol_info_tick = self . symbol_info_tick_as_dict ( symbol = symbol ) margin = self . order_calc_margin ( action = getattr ( self . mt5 , f \"ORDER_TYPE_ { order_side . upper () } \" ), symbol = symbol , volume = symbol_info [ \"volume_min\" ], price = ( symbol_info_tick [ \"bid\" ] if order_side == \"SELL\" else symbol_info_tick [ \"ask\" ] ), ) result = { \"volume\" : symbol_info [ \"volume_min\" ], \"margin\" : margin } if margin : self . logger . info ( \"Calculated minimum %s order margin for %s : %s \" , order_side , symbol , result , ) else : self . logger . warning ( \"Calculated minimum order margin to %s %s : %s \" , order_side , symbol , result , ) return result","title":"calculate_minimum_order_margin"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.calculate_new_position_margin_ratio","text":"calculate_new_position_margin_ratio ( symbol : str , new_position_side : Literal [ \"BUY\" , \"SELL\" ] | None = None , new_position_volume : float = 0 , ) -> float Calculate the margin ratio for a new position. Parameters: Name Type Description Default symbol str Symbol for which to calculate the margin ratio. required new_position_side Literal ['BUY', 'SELL'] | None Side of the new position, either \"BUY\" or \"SELL\". None new_position_volume float Volume of the new position. 0 Returns: Name Type Description float float Margin ratio for the new position as a fraction of account equity. Source code in pdmt5/trading.py 629 630 631 632 633 634 635 636 637 638 639 640 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 657 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 675 676 677 678 679 680 def calculate_new_position_margin_ratio ( self , symbol : str , new_position_side : Literal [ \"BUY\" , \"SELL\" ] | None = None , new_position_volume : float = 0 , ) -> float : \"\"\"Calculate the margin ratio for a new position. Args: symbol: Symbol for which to calculate the margin ratio. new_position_side: Side of the new position, either \"BUY\" or \"SELL\". new_position_volume: Volume of the new position. Returns: float: Margin ratio for the new position as a fraction of account equity. \"\"\" account_info = self . account_info_as_dict () if not account_info [ \"equity\" ]: result = 0.0 else : positions_df = self . fetch_positions_with_metrics_as_df ( symbol = symbol ) current_signed_margin = ( positions_df [ \"signed_margin\" ] . sum () if positions_df . size else 0 ) symbol_info_tick = self . symbol_info_tick_as_dict ( symbol = symbol ) if not ( new_position_side and new_position_volume ): new_signed_margin = 0 elif new_position_side . upper () == \"BUY\" : new_signed_margin = self . order_calc_margin ( action = self . mt5 . ORDER_TYPE_BUY , symbol = symbol , volume = new_position_volume , price = symbol_info_tick [ \"ask\" ], ) elif new_position_side . upper () == \"SELL\" : new_signed_margin = - self . order_calc_margin ( action = self . mt5 . ORDER_TYPE_SELL , symbol = symbol , volume = new_position_volume , price = symbol_info_tick [ \"bid\" ], ) else : new_signed_margin = 0 result = abs ( ( new_signed_margin + current_signed_margin ) / account_info [ \"equity\" ] ) self . logger . info ( \"Calculated new position margin ratio for %s : %s \" , symbol , result , ) return result","title":"calculate_new_position_margin_ratio"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.calculate_spread_ratio","text":"calculate_spread_ratio ( symbol : str ) -> float Calculate the spread ratio for a given symbol. Parameters: Name Type Description Default symbol str Symbol for which to calculate the spread ratio. required Returns: Type Description float Spread ratio as a float. Source code in pdmt5/trading.py 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 def calculate_spread_ratio ( self , symbol : str , ) -> float : \"\"\"Calculate the spread ratio for a given symbol. Args: symbol: Symbol for which to calculate the spread ratio. Returns: Spread ratio as a float. \"\"\" symbol_info_tick = self . symbol_info_tick_as_dict ( symbol = symbol ) result = ( ( symbol_info_tick [ \"ask\" ] - symbol_info_tick [ \"bid\" ]) / ( symbol_info_tick [ \"ask\" ] + symbol_info_tick [ \"bid\" ]) * 2 ) self . logger . info ( \"Calculated spread ratio for %s : %s \" , symbol , result ) return result","title":"calculate_spread_ratio"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.calculate_volume_by_margin","text":"calculate_volume_by_margin ( symbol : str , margin : float , order_side : Literal [ \"BUY\" , \"SELL\" ], ) -> float Calculate volume based on margin for a given symbol and order side. Parameters: Name Type Description Default symbol str Symbol for which to calculate the volume. required margin float Margin amount to use for the calculation. required order_side Literal ['BUY', 'SELL'] Side of the order, either \"BUY\" or \"SELL\". required Returns: Type Description float Calculated volume as a float. Source code in pdmt5/trading.py 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 def calculate_volume_by_margin ( self , symbol : str , margin : float , order_side : Literal [ \"BUY\" , \"SELL\" ], ) -> float : \"\"\"Calculate volume based on margin for a given symbol and order side. Args: symbol: Symbol for which to calculate the volume. margin: Margin amount to use for the calculation. order_side: Side of the order, either \"BUY\" or \"SELL\". Returns: Calculated volume as a float. \"\"\" min_order_margin_dict = self . calculate_minimum_order_margin ( symbol = symbol , order_side = order_side , ) if min_order_margin_dict [ \"margin\" ]: result = ( floor ( margin / min_order_margin_dict [ \"margin\" ]) * min_order_margin_dict [ \"volume\" ] ) else : result = 0.0 self . logger . info ( \"Calculated volume by margin to %s %s : %s \" , order_side , symbol , result , ) return result","title":"calculate_volume_by_margin"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.close_open_positions","text":"close_open_positions ( symbols : str | list [ str ] | tuple [ str , ... ] | None = None , order_filling_mode : Literal [ \"IOC\" , \"FOK\" , \"RETURN\" ] = \"IOC\" , dry_run : bool = False , ** kwargs : Any , ) -> dict [ str , list [ dict [ str , Any ]]] Close all open positions for specified symbols. Parameters: Name Type Description Default symbols str | list [ str ] | tuple [ str , ...] | None Optional symbol or list of symbols to filter positions. If None, all symbols will be considered. None order_filling_mode Literal ['IOC', 'FOK', 'RETURN'] Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\". 'IOC' dry_run bool If True, only check the order without sending it. False **kwargs Any Additional keyword arguments for request parameters. {} Returns: Type Description dict [ str , list [ dict [ str , Any ]]] Dictionary with symbols as keys and lists of dictionaries containing operation results for each closed position as values. Source code in pdmt5/trading.py 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 def close_open_positions ( self , symbols : str | list [ str ] | tuple [ str , ... ] | None = None , order_filling_mode : Literal [ \"IOC\" , \"FOK\" , \"RETURN\" ] = \"IOC\" , dry_run : bool = False , ** kwargs : Any , # noqa: ANN401 ) -> dict [ str , list [ dict [ str , Any ]]]: \"\"\"Close all open positions for specified symbols. Args: symbols: Optional symbol or list of symbols to filter positions. If None, all symbols will be considered. order_filling_mode: Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\". dry_run: If True, only check the order without sending it. **kwargs: Additional keyword arguments for request parameters. Returns: Dictionary with symbols as keys and lists of dictionaries containing operation results for each closed position as values. \"\"\" if isinstance ( symbols , str ): symbol_list = [ symbols ] elif isinstance ( symbols , ( list , tuple )): symbol_list = symbols else : symbol_list = self . symbols_get () self . logger . info ( \"Fetching and closing positions for symbols: %s \" , symbol_list ) return { s : self . _fetch_and_close_position ( symbol = s , order_filling_mode = order_filling_mode , dry_run = dry_run , ** kwargs , ) for s in symbol_list }","title":"close_open_positions"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.collect_entry_deals_as_df","text":"collect_entry_deals_as_df ( symbol : str , history_seconds : int = 3600 , index_keys : str | None = \"ticket\" , ) -> DataFrame Collect entry deals as a DataFrame. Parameters: Name Type Description Default symbol str Symbol to collect entry deals for. required history_seconds int Time range in seconds to fetch deals around the last tick. 3600 index_keys str | None Optional index keys for the DataFrame. 'ticket' Returns: Type Description DataFrame pd.DataFrame: Entry deals with time index. Source code in pdmt5/trading.py 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557 558 559 560 def collect_entry_deals_as_df ( self , symbol : str , history_seconds : int = 3600 , index_keys : str | None = \"ticket\" , ) -> pd . DataFrame : \"\"\"Collect entry deals as a DataFrame. Args: symbol: Symbol to collect entry deals for. history_seconds: Time range in seconds to fetch deals around the last tick. index_keys: Optional index keys for the DataFrame. Returns: pd.DataFrame: Entry deals with time index. \"\"\" last_tick_time = self . symbol_info_tick_as_dict ( symbol = symbol )[ \"time\" ] deals_df = self . history_deals_get_as_df ( date_from = ( last_tick_time - timedelta ( seconds = history_seconds )), date_to = ( last_tick_time + timedelta ( seconds = history_seconds )), symbol = symbol , index_keys = index_keys , ) if deals_df . empty : result = deals_df else : result = deals_df . pipe ( lambda d : d [ d [ \"entry\" ] & d [ \"type\" ] . isin ({ self . mt5 . DEAL_TYPE_BUY , self . mt5 . DEAL_TYPE_SELL }) ] ) self . logger . info ( \"Collected entry deals for %s : %d rows\" , symbol , result . shape [ 0 ], ) return result","title":"collect_entry_deals_as_df"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.fetch_latest_rates_as_df","text":"fetch_latest_rates_as_df ( symbol : str , granularity : str = \"M1\" , count : int = 1440 , index_keys : str | None = \"time\" , ) -> DataFrame Fetch rate (OHLC) data as a DataFrame. Parameters: Name Type Description Default symbol str Symbol to fetch data for. required granularity str Time granularity as a timeframe suffix (e.g., \"M1\", \"H1\"). 'M1' count int Number of bars to fetch. 1440 index_keys str | None Optional index keys for the DataFrame. 'time' Returns: Type Description DataFrame pd.DataFrame: OHLC data with time index. Raises: Type Description Mt5TradingError If the granularity is not supported by MetaTrader5. Source code in pdmt5/trading.py 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 def fetch_latest_rates_as_df ( self , symbol : str , granularity : str = \"M1\" , count : int = 1440 , index_keys : str | None = \"time\" , ) -> pd . DataFrame : \"\"\"Fetch rate (OHLC) data as a DataFrame. Args: symbol: Symbol to fetch data for. granularity: Time granularity as a timeframe suffix (e.g., \"M1\", \"H1\"). count: Number of bars to fetch. index_keys: Optional index keys for the DataFrame. Returns: pd.DataFrame: OHLC data with time index. Raises: Mt5TradingError: If the granularity is not supported by MetaTrader5. \"\"\" try : timeframe = getattr ( self . mt5 , f \"TIMEFRAME_ { granularity . upper () } \" ) except AttributeError as e : error_message = ( f \"MetaTrader5 does not support the given granularity: { granularity } \" ) raise Mt5TradingError ( error_message ) from e else : result = self . copy_rates_from_pos_as_df ( symbol = symbol , timeframe = timeframe , start_pos = 0 , count = count , index_keys = index_keys , ) self . logger . info ( \"Fetched latest %s rates for %s : %d rows\" , granularity , symbol , result . shape [ 0 ], ) return result","title":"fetch_latest_rates_as_df"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.fetch_latest_ticks_as_df","text":"fetch_latest_ticks_as_df ( symbol : str , seconds : int = 300 , index_keys : str | None = \"time_msc\" , ) -> DataFrame Fetch tick data as a DataFrame. Parameters: Name Type Description Default symbol str Symbol to fetch tick data for. required seconds int Time range in seconds to fetch ticks around the last tick time. 300 index_keys str | None Optional index keys for the DataFrame. 'time_msc' Returns: Type Description DataFrame pd.DataFrame: Tick data with time index. Source code in pdmt5/trading.py 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521 def fetch_latest_ticks_as_df ( self , symbol : str , seconds : int = 300 , index_keys : str | None = \"time_msc\" , ) -> pd . DataFrame : \"\"\"Fetch tick data as a DataFrame. Args: symbol: Symbol to fetch tick data for. seconds: Time range in seconds to fetch ticks around the last tick time. index_keys: Optional index keys for the DataFrame. Returns: pd.DataFrame: Tick data with time index. \"\"\" last_tick_time = self . symbol_info_tick_as_dict ( symbol = symbol )[ \"time\" ] result = self . copy_ticks_range_as_df ( symbol = symbol , date_from = ( last_tick_time - timedelta ( seconds = seconds )), date_to = ( last_tick_time + timedelta ( seconds = seconds )), flags = self . mt5 . COPY_TICKS_ALL , index_keys = index_keys , ) self . logger . info ( \"Fetched latest ticks for %s : %d rows\" , symbol , result . shape [ 0 ], ) return result","title":"fetch_latest_ticks_as_df"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.fetch_positions_with_metrics_as_df","text":"fetch_positions_with_metrics_as_df ( symbol : str , ) -> DataFrame Fetch open positions as a DataFrame with additional metrics. Parameters: Name Type Description Default symbol str Symbol to fetch positions for. required Returns: Type Description DataFrame pd.DataFrame: DataFrame containing open positions with additional metrics. Source code in pdmt5/trading.py 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 588 589 590 591 592 593 594 595 596 597 598 599 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 623 624 625 626 627 def fetch_positions_with_metrics_as_df ( self , symbol : str , ) -> pd . DataFrame : \"\"\"Fetch open positions as a DataFrame with additional metrics. Args: symbol: Symbol to fetch positions for. Returns: pd.DataFrame: DataFrame containing open positions with additional metrics. \"\"\" positions_df = self . positions_get_as_df ( symbol = symbol ) if positions_df . empty : result = positions_df else : symbol_info_tick = self . symbol_info_tick_as_dict ( symbol = symbol ) ask_margin = self . order_calc_margin ( action = self . mt5 . ORDER_TYPE_BUY , symbol = symbol , volume = 1 , price = symbol_info_tick [ \"ask\" ], ) bid_margin = self . order_calc_margin ( action = self . mt5 . ORDER_TYPE_SELL , symbol = symbol , volume = 1 , price = symbol_info_tick [ \"bid\" ], ) result = ( positions_df . assign ( elapsed_seconds = lambda d : ( symbol_info_tick [ \"time\" ] - d [ \"time\" ] ) . dt . total_seconds (), underlier_increase_ratio = lambda d : ( d [ \"price_current\" ] / d [ \"price_open\" ] - 1 ), buy = lambda d : ( d [ \"type\" ] == self . mt5 . POSITION_TYPE_BUY ), sell = lambda d : ( d [ \"type\" ] == self . mt5 . POSITION_TYPE_SELL ), ) . assign ( buy_i = lambda d : d [ \"buy\" ] . astype ( int ), sell_i = lambda d : d [ \"sell\" ] . astype ( int ), ) . assign ( sign = lambda d : ( d [ \"buy_i\" ] - d [ \"sell_i\" ]), margin = lambda d : ( ( d [ \"buy_i\" ] * ask_margin + d [ \"sell_i\" ] * bid_margin ) * d [ \"volume\" ] ), ) . assign ( signed_volume = lambda d : ( d [ \"volume\" ] * d [ \"sign\" ]), signed_margin = lambda d : ( d [ \"margin\" ] * d [ \"sign\" ]), underlier_profit_ratio = lambda d : ( d [ \"underlier_increase_ratio\" ] * d [ \"sign\" ] ), ) . drop ( columns = [ \"buy_i\" , \"sell_i\" , \"sign\" , \"underlier_increase_ratio\" ]) ) self . logger . info ( \"Fetched positions with metrics for %s : %d rows\" , symbol , result . shape [ 0 ], ) return result","title":"fetch_positions_with_metrics_as_df"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.place_market_order","text":"place_market_order ( symbol : str , volume : float , order_side : Literal [ \"BUY\" , \"SELL\" ], order_filling_mode : Literal [ \"IOC\" , \"FOK\" , \"RETURN\" ] = \"IOC\" , order_time_mode : Literal [ \"GTC\" , \"DAY\" , \"SPECIFIED\" , \"SPECIFIED_DAY\" ] = \"GTC\" , raise_on_error : bool = False , dry_run : bool = False , ** kwargs : Any , ) -> dict [ str , Any ] Send or check an order request to place a market order. Parameters: Name Type Description Default symbol str Symbol for the order. required volume float Volume of the order. required order_side Literal ['BUY', 'SELL'] Side of the order, either \"BUY\" or \"SELL\". required order_filling_mode Literal ['IOC', 'FOK', 'RETURN'] Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\". 'IOC' order_time_mode Literal ['GTC', 'DAY', 'SPECIFIED', 'SPECIFIED_DAY'] Order time mode, either \"GTC\", \"DAY\", \"SPECIFIED\", or \"SPECIFIED_DAY\". 'GTC' raise_on_error bool If True, raise an error on operation failure. False dry_run bool If True, only check the order without sending it. False **kwargs Any Additional keyword arguments for request parameters. {} Returns: Type Description dict [ str , Any ] Dictionary with operation result. Source code in pdmt5/trading.py 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 def place_market_order ( self , symbol : str , volume : float , order_side : Literal [ \"BUY\" , \"SELL\" ], order_filling_mode : Literal [ \"IOC\" , \"FOK\" , \"RETURN\" ] = \"IOC\" , order_time_mode : Literal [ \"GTC\" , \"DAY\" , \"SPECIFIED\" , \"SPECIFIED_DAY\" ] = \"GTC\" , raise_on_error : bool = False , dry_run : bool = False , ** kwargs : Any , # noqa: ANN401 ) -> dict [ str , Any ]: \"\"\"Send or check an order request to place a market order. Args: symbol: Symbol for the order. volume: Volume of the order. order_side: Side of the order, either \"BUY\" or \"SELL\". order_filling_mode: Order filling mode, either \"IOC\", \"FOK\", or \"RETURN\". order_time_mode: Order time mode, either \"GTC\", \"DAY\", \"SPECIFIED\", or \"SPECIFIED_DAY\". raise_on_error: If True, raise an error on operation failure. dry_run: If True, only check the order without sending it. **kwargs: Additional keyword arguments for request parameters. Returns: Dictionary with operation result. \"\"\" self . logger . info ( \"Placing market order: %s %s %s \" , order_side , volume , symbol ) return self . _send_or_check_order ( request = { \"action\" : self . mt5 . TRADE_ACTION_DEAL , \"symbol\" : symbol , \"volume\" : volume , \"type\" : getattr ( self . mt5 , f \"ORDER_TYPE_ { order_side . upper () } \" ), \"type_filling\" : getattr ( self . mt5 , f \"ORDER_FILLING_ { order_filling_mode . upper () } \" ), \"type_time\" : getattr ( self . mt5 , f \"ORDER_TIME_ { order_time_mode . upper () } \" ), ** kwargs , }, raise_on_error = raise_on_error , dry_run = dry_run , )","title":"place_market_order"},{"location":"api/trading/#pdmt5.trading.Mt5TradingClient.update_sltp_for_open_positions","text":"update_sltp_for_open_positions ( symbol : str , stop_loss : float | None = None , take_profit : float | None = None , tickets : list [ int ] | None = None , raise_on_error : bool = False , dry_run : bool = False , ** kwargs : Any , ) -> list [ dict [ str , Any ]] Change Stop Loss and Take Profit for open positions. Parameters: Name Type Description Default symbol str Symbol for the position. required stop_loss float | None New Stop Loss price. If None, it will not be changed. None take_profit float | None New Take Profit price. If None, it will not be changed. None tickets list [ int ] | None List of position tickets to filter positions. If None, all open positions for the symbol will be considered. None raise_on_error bool If True, raise an error on operation failure. False dry_run bool If True, only check the order without sending it. False **kwargs Any Additional keyword arguments for request parameters. {} Returns: Type Description list [ dict [ str , Any ]] List of dictionaries with operation results for each updated position. Source code in pdmt5/trading.py 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 def update_sltp_for_open_positions ( self , symbol : str , stop_loss : float | None = None , take_profit : float | None = None , tickets : list [ int ] | None = None , raise_on_error : bool = False , dry_run : bool = False , ** kwargs : Any , # noqa: ANN401 ) -> list [ dict [ str , Any ]]: \"\"\"Change Stop Loss and Take Profit for open positions. Args: symbol: Symbol for the position. stop_loss: New Stop Loss price. If None, it will not be changed. take_profit: New Take Profit price. If None, it will not be changed. tickets: List of position tickets to filter positions. If None, all open positions for the symbol will be considered. raise_on_error: If True, raise an error on operation failure. dry_run: If True, only check the order without sending it. **kwargs: Additional keyword arguments for request parameters. Returns: List of dictionaries with operation results for each updated position. \"\"\" positions_df = self . positions_get_as_df ( symbol = symbol ) if positions_df . empty : self . logger . warning ( \"No open positions found for symbol: %s \" , symbol ) return [] elif tickets : filtered_positions_df = positions_df . pipe ( lambda d : d [ d [ \"ticket\" ] . isin ( tickets )] ) else : filtered_positions_df = positions_df if filtered_positions_df . empty : self . logger . warning ( \"No open positions found for symbol: %s with specified tickets: %s \" , symbol , tickets , ) return [] else : symbol_info = self . symbol_info_as_dict ( symbol = symbol ) sl = round ( stop_loss , symbol_info [ \"digits\" ]) if stop_loss else None tp = round ( take_profit , symbol_info [ \"digits\" ]) if take_profit else None order_requests = [ { \"action\" : self . mt5 . TRADE_ACTION_SLTP , \"symbol\" : p [ \"symbol\" ], \"position\" : p [ \"ticket\" ], \"sl\" : ( sl or p [ \"sl\" ]), \"tp\" : ( tp or p [ \"tp\" ]), ** kwargs , } for _ , p in filtered_positions_df . iterrows () if sl != p [ \"sl\" ] or tp != p [ \"tp\" ] ] if order_requests : self . logger . info ( \"Updating SL/TP for %d positions for %s : %s / %s \" , len ( order_requests ), symbol , sl , tp , ) return [ self . _send_or_check_order ( request = r , raise_on_error = raise_on_error , dry_run = dry_run ) for r in order_requests ] else : self . logger . info ( \"No positions to update for symbol: %s with SL: %s and TP: %s \" , symbol , sl , tp , ) return [] options: show_bases: false Advanced trading client class that inherits from Mt5DataClient and provides specialized trading functionality.","title":"update_sltp_for_open_positions"},{"location":"api/trading/#mt5tradingerror","text":"","title":"Mt5TradingError"},{"location":"api/trading/#pdmt5.trading.Mt5TradingError","text":"Bases: Mt5RuntimeError MetaTrader5 trading error. options: show_bases: false Custom runtime exception for trading-specific errors.","title":"Mt5TradingError"},{"location":"api/trading/#usage-examples","text":"","title":"Usage Examples"},{"location":"api/trading/#basic-trading-operations","text":"import MetaTrader5 as mt5 from pdmt5 import Mt5TradingClient , Mt5Config # Create configuration config = Mt5Config ( login = 123456 , password = \"your_password\" , server = \"broker_server\" , timeout = 60000 , portable = False ) # Create client with dry run mode for testing client = Mt5TradingClient ( config = config , dry_run = True ) # Use as context manager with client : # Get current positions as DataFrame positions_df = client . get_positions_as_df () print ( f \"Open positions: { len ( positions_df ) } \" ) # Close positions for specific symbol results = client . close_open_positions ( \"EURUSD\" ) print ( f \"Closed positions: { results } \" )","title":"Basic Trading Operations"},{"location":"api/trading/#production-trading","text":"# Create client for live trading (dry_run=False) client = Mt5TradingClient ( config = config , dry_run = False ) with client : # Close all positions for multiple symbols results = client . close_open_positions ([ \"EURUSD\" , \"GBPUSD\" , \"USDJPY\" ]) # Close all positions (all symbols) all_results = client . close_open_positions ()","title":"Production Trading"},{"location":"api/trading/#order-filling-modes","text":"with Mt5TradingClient ( config = config ) as client : # Use IOC (Immediate or Cancel) - default results_ioc = client . close_open_positions ( symbols = \"EURUSD\" , order_filling_mode = \"IOC\" ) # Use FOK (Fill or Kill) results_fok = client . close_open_positions ( symbols = \"GBPUSD\" , order_filling_mode = \"FOK\" ) # Use RETURN (Return if not filled) results_return = client . close_open_positions ( symbols = \"USDJPY\" , order_filling_mode = \"RETURN\" )","title":"Order Filling Modes"},{"location":"api/trading/#custom-order-parameters","text":"with client : # Close positions with custom parameters and order filling mode results = client . close_open_positions ( \"EURUSD\" , order_filling_mode = \"IOC\" , # Specify per method call comment = \"Closing all EURUSD positions\" , deviation = 10 # Maximum price deviation )","title":"Custom Order Parameters"},{"location":"api/trading/#error-handling","text":"from pdmt5.trading import Mt5TradingError try : with client : results = client . close_open_positions ( \"EURUSD\" ) except Mt5TradingError as e : print ( f \"Trading error: { e } \" ) # Handle specific trading errors","title":"Error Handling"},{"location":"api/trading/#checking-order-status","text":"with client : # Check order (note: send_or_check_order is an internal method) # For trading operations, use the provided methods like close_open_positions # Example: Check if we can close a position positions = client . get_positions_as_df () if not positions . empty : # Close specific position results = client . close_open_positions ( \"EURUSD\" )","title":"Checking Order Status"},{"location":"api/trading/#position-management-features","text":"The Mt5TradingClient provides intelligent position management: Automatic Position Reversal : Automatically determines the correct order type to close positions Batch Operations : Close multiple positions for one or more symbols Dry Run Support : Test trading logic without executing real trades Flexible Filtering : Close positions by symbol, group, or all positions Custom Parameters : Support for additional order parameters like comment, deviation, etc.","title":"Position Management Features"},{"location":"api/trading/#dry-run-mode","text":"Dry run mode is essential for testing trading strategies: # Test mode - validates orders without execution test_client = Mt5TradingClient ( config = config , dry_run = True ) # Production mode - executes real orders prod_client = Mt5TradingClient ( config = config , dry_run = False ) In dry run mode: Orders are validated using order_check() instead of order_send() No actual trades are executed Full validation of margin requirements and order parameters Same return structure as live trading for easy testing","title":"Dry Run Mode"},{"location":"api/trading/#return-values","text":"The close_open_positions() method returns a dictionary with symbols as keys: { \"EURUSD\" : [ { \"retcode\" : 10009 , # Trade done \"deal\" : 123456 , \"order\" : 789012 , \"volume\" : 1.0 , \"price\" : 1.1000 , \"comment\" : \"Request executed\" , ... } ], \"GBPUSD\" : [ ... ] }","title":"Return Values"},{"location":"api/trading/#best-practices","text":"Always use dry run mode first to test your trading logic Handle Mt5TradingError exceptions for proper error management Check return codes to verify successful execution Use context managers for automatic connection handling Log trading operations for audit trails Validate positions exist before attempting to close them Consider market hours and trading session times","title":"Best Practices"},{"location":"api/trading/#common-return-codes","text":"TRADE_RETCODE_DONE (10009): Trade operation completed successfully TRADE_RETCODE_TRADE_DISABLED : Trading disabled for the account TRADE_RETCODE_MARKET_CLOSED : Market is closed TRADE_RETCODE_NO_MONEY : Insufficient funds TRADE_RETCODE_INVALID_VOLUME : Invalid trade volume","title":"Common Return Codes"},{"location":"api/trading/#margin-calculation-methods","text":"The trading client provides advanced margin calculation capabilities:","title":"Margin Calculation Methods"},{"location":"api/trading/#calculate-minimum-order-margin","text":"with client : # Calculate minimum margin required for BUY order min_margin_buy = client . calculate_minimum_order_margin ( \"EURUSD\" , \"BUY\" ) print ( f \"Minimum volume: { min_margin_buy [ 'volume' ] } \" ) print ( f \"Minimum margin: { min_margin_buy [ 'margin' ] } \" ) # Calculate minimum margin required for SELL order min_margin_sell = client . calculate_minimum_order_margin ( \"EURUSD\" , \"SELL\" )","title":"Calculate Minimum Order Margin"},{"location":"api/trading/#calculate-volume-by-margin","text":"with client : # Calculate maximum volume for given margin amount available_margin = 1000.0 # USD max_volume_buy = client . calculate_volume_by_margin ( \"EURUSD\" , available_margin , \"BUY\" ) max_volume_sell = client . calculate_volume_by_margin ( \"EURUSD\" , available_margin , \"SELL\" ) print ( f \"Max BUY volume for $ { available_margin } : { max_volume_buy } \" ) print ( f \"Max SELL volume for $ { available_margin } : { max_volume_sell } \" )","title":"Calculate Volume by Margin"},{"location":"api/trading/#calculate-new-position-margin-ratio","text":"with client : # Calculate margin ratio for potential new position margin_ratio = client . calculate_new_position_margin_ratio ( symbol = \"EURUSD\" , new_position_side = \"BUY\" , new_position_volume = 1.0 ) print ( f \"New position would use { margin_ratio : .2% } of account equity\" ) # Check if adding position would exceed risk limits if margin_ratio > 0.1 : # 10% risk limit print ( \"Position size too large for risk management\" )","title":"Calculate New Position Margin Ratio"},{"location":"api/trading/#market-order-placement","text":"Place market orders with flexible configuration: with client : # Place a BUY market order result = client . place_market_order ( symbol = \"EURUSD\" , volume = 1.0 , order_side = \"BUY\" , order_filling_mode = \"IOC\" , # Immediate or Cancel order_time_mode = \"GTC\" , # Good Till Cancelled dry_run = False , # Set to True for testing comment = \"My buy order\" ) # Place a SELL market order with FOK filling result = client . place_market_order ( symbol = \"EURUSD\" , volume = 0.5 , order_side = \"SELL\" , order_filling_mode = \"FOK\" , # Fill or Kill dry_run = True # Test mode ) print ( f \"Order result: { result } \" )","title":"Market Order Placement"},{"location":"api/trading/#stop-loss-and-take-profit-management","text":"Update SL/TP for existing positions: with client : # Update SL/TP for all EURUSD positions results = client . update_sltp_for_open_positions ( symbol = \"EURUSD\" , stop_loss = 1.0950 , take_profit = 1.1100 , dry_run = False ) # Update only specific positions by ticket results = client . update_sltp_for_open_positions ( symbol = \"EURUSD\" , stop_loss = 1.0950 , tickets = [ 123456 , 789012 ], # Specific position tickets dry_run = True )","title":"Stop Loss and Take Profit Management"},{"location":"api/trading/#market-data-and-analysis-methods","text":"","title":"Market Data and Analysis Methods"},{"location":"api/trading/#spread-analysis","text":"with client : # Calculate spread ratio for symbol spread_ratio = client . calculate_spread_ratio ( \"EURUSD\" ) print ( f \"EURUSD spread ratio: { spread_ratio : .6f } \" )","title":"Spread Analysis"},{"location":"api/trading/#ohlc-data-retrieval","text":"with client : # Fetch latest rate data as DataFrame rates_df = client . fetch_latest_rates_as_df ( symbol = \"EURUSD\" , granularity = \"M1\" , # 1-minute bars count = 1440 , # Last 24 hours index_keys = \"time\" ) print ( f \"Latest rates: { rates_df . tail () } \" )","title":"OHLC Data Retrieval"},{"location":"api/trading/#tick-data-analysis","text":"with client : # Fetch recent tick data ticks_df = client . fetch_latest_ticks_as_df ( symbol = \"EURUSD\" , seconds = 300 , # Last 5 minutes index_keys = \"time_msc\" ) print ( f \"Tick count: { len ( ticks_df ) } \" )","title":"Tick Data Analysis"},{"location":"api/trading/#position-analytics-with-enhanced-metrics","text":"with client : # Get positions with additional calculated metrics positions_df = client . fetch_positions_with_metrics_as_df ( \"EURUSD\" ) if not positions_df . empty : print ( \"Position metrics:\" ) print ( f \"Total signed volume: { positions_df [ 'signed_volume' ] . sum () } \" ) print ( f \"Total signed margin: { positions_df [ 'signed_margin' ] . sum () } \" ) print ( f \"Average profit ratio: { positions_df [ 'underlier_profit_ratio' ] . mean () : .4f } \" )","title":"Position Analytics with Enhanced Metrics"},{"location":"api/trading/#deal-history-analysis","text":"with client : # Collect entry deals for analysis deals_df = client . collect_entry_deals_as_df ( symbol = \"EURUSD\" , history_seconds = 3600 , # Last hour index_keys = \"ticket\" ) if not deals_df . empty : print ( f \"Entry deals found: { len ( deals_df ) } \" ) print ( f \"Deal types: { deals_df [ 'type' ] . value_counts () } \" )","title":"Deal History Analysis"},{"location":"api/trading/#integration-with-mt5dataclient","text":"Since Mt5TradingClient inherits from Mt5DataClient, all data retrieval methods are available: with Mt5TradingClient ( config = config ) as client : # Get current positions as DataFrame positions_df = client . get_positions_as_df () # Analyze positions if not positions_df . empty : # Calculate total exposure total_volume = positions_df [ 'volume' ] . sum () # Close losing positions losing_positions = positions_df [ positions_df [ 'profit' ] < 0 ] for symbol in losing_positions [ 'symbol' ] . unique (): client . close_open_positions ( symbol ) # Risk management with margin calculations for symbol in [ \"EURUSD\" , \"GBPUSD\" , \"USDJPY\" ]: # Calculate current margin usage current_ratio = client . calculate_new_position_margin_ratio ( symbol ) print ( f \" { symbol } current margin ratio: { current_ratio : .2% } \" ) # Calculate maximum safe position size safe_margin = 500.0 # USD max_safe_volume = client . calculate_volume_by_margin ( symbol , safe_margin , \"BUY\" ) print ( f \" { symbol } max safe volume: { max_safe_volume } \" )","title":"Integration with Mt5DataClient"},{"location":"api/utils/","text":"Utilities \u00b6 pdmt5.utils \u00b6 Utility functions for the pdmt5 package. detect_and_convert_time_to_datetime \u00b6 detect_and_convert_time_to_datetime ( skip_toggle : str | None = None , ) -> Callable [ ... , Any ] Decorator to convert time values/columns to datetime based on result type. Automatically detects result type and applies appropriate time conversion: - dict: converts time values in the dictionary - list: converts time values in each dictionary item - DataFrame: converts time columns Parameters: Name Type Description Default skip_toggle str | None Name of the parameter to skip conversion if set to False. None Returns: Type Description Callable [..., Any ] Decorator function. Source code in pdmt5/utils.py 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 def detect_and_convert_time_to_datetime ( skip_toggle : str | None = None , ) -> Callable [ ... , Any ]: \"\"\"Decorator to convert time values/columns to datetime based on result type. Automatically detects result type and applies appropriate time conversion: - dict: converts time values in the dictionary - list: converts time values in each dictionary item - DataFrame: converts time columns Args: skip_toggle: Name of the parameter to skip conversion if set to False. Returns: Decorator function. \"\"\" def decorator ( func : Callable [ ... , Any ]) -> Callable [ ... , Any ]: @wraps ( func ) def wrapper ( * args : Any , ** kwargs : Any ) -> Any : # noqa: ANN401 result = func ( * args , ** kwargs ) if skip_toggle and kwargs . get ( skip_toggle ): return result elif isinstance ( result , dict ): return _convert_time_values_in_dict ( dictionary = result ) elif isinstance ( result , list ): return [ ( _convert_time_values_in_dict ( dictionary = d ) if isinstance ( d , dict ) else d ) for d in result ] elif isinstance ( result , pd . DataFrame ): return _convert_time_columns_in_df ( result ) else : return result return wrapper return decorator set_index_if_possible \u00b6 set_index_if_possible ( index_parameters : str | None = None , ) -> Callable [ ... , Any ] Decorator to set index on DataFrame results if not empty. Parameters: Name Type Description Default index_parameters str | None Name of the parameter to use as index if provided. None Returns: Type Description Callable [..., Any ] Decorator function. Source code in pdmt5/utils.py 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 def set_index_if_possible ( index_parameters : str | None = None ) -> Callable [ ... , Any ]: \"\"\"Decorator to set index on DataFrame results if not empty. Args: index_parameters: Name of the parameter to use as index if provided. Returns: Decorator function. \"\"\" def decorator ( func : Callable [ ... , Any ]) -> Callable [ ... , Any ]: @wraps ( func ) def wrapper ( * args : Any , ** kwargs : Any ) -> Any : # noqa: ANN401 result = func ( * args , ** kwargs ) if not isinstance ( result , pd . DataFrame ): error_message = ( f \"Function { func . __name__ } returned non-DataFrame result: \" f \" { type ( result ) . __name__ } . Expected DataFrame.\" ) raise TypeError ( error_message ) elif index_parameters and kwargs . get ( index_parameters ) and not result . empty : return result . set_index ( kwargs [ index_parameters ]) else : return result return wrapper return decorator Overview \u00b6 The utils module provides internal utility functions and decorators used throughout the pdmt5 package for data transformation and DataFrame manipulation. Functions \u00b6 detect_and_convert_time_to_datetime \u00b6 pdmt5.utils.detect_and_convert_time_to_datetime \u00b6 detect_and_convert_time_to_datetime ( skip_toggle : str | None = None , ) -> Callable [ ... , Any ] Decorator to convert time values/columns to datetime based on result type. Automatically detects result type and applies appropriate time conversion: - dict: converts time values in the dictionary - list: converts time values in each dictionary item - DataFrame: converts time columns Parameters: Name Type Description Default skip_toggle str | None Name of the parameter to skip conversion if set to False. None Returns: Type Description Callable [..., Any ] Decorator function. Source code in pdmt5/utils.py 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 def detect_and_convert_time_to_datetime ( skip_toggle : str | None = None , ) -> Callable [ ... , Any ]: \"\"\"Decorator to convert time values/columns to datetime based on result type. Automatically detects result type and applies appropriate time conversion: - dict: converts time values in the dictionary - list: converts time values in each dictionary item - DataFrame: converts time columns Args: skip_toggle: Name of the parameter to skip conversion if set to False. Returns: Decorator function. \"\"\" def decorator ( func : Callable [ ... , Any ]) -> Callable [ ... , Any ]: @wraps ( func ) def wrapper ( * args : Any , ** kwargs : Any ) -> Any : # noqa: ANN401 result = func ( * args , ** kwargs ) if skip_toggle and kwargs . get ( skip_toggle ): return result elif isinstance ( result , dict ): return _convert_time_values_in_dict ( dictionary = result ) elif isinstance ( result , list ): return [ ( _convert_time_values_in_dict ( dictionary = d ) if isinstance ( d , dict ) else d ) for d in result ] elif isinstance ( result , pd . DataFrame ): return _convert_time_columns_in_df ( result ) else : return result return wrapper return decorator options: show_bases: false Decorator that automatically converts time values to datetime objects based on the result type. set_index_if_possible \u00b6 pdmt5.utils.set_index_if_possible \u00b6 set_index_if_possible ( index_parameters : str | None = None , ) -> Callable [ ... , Any ] Decorator to set index on DataFrame results if not empty. Parameters: Name Type Description Default index_parameters str | None Name of the parameter to use as index if provided. None Returns: Type Description Callable [..., Any ] Decorator function. Source code in pdmt5/utils.py 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 def set_index_if_possible ( index_parameters : str | None = None ) -> Callable [ ... , Any ]: \"\"\"Decorator to set index on DataFrame results if not empty. Args: index_parameters: Name of the parameter to use as index if provided. Returns: Decorator function. \"\"\" def decorator ( func : Callable [ ... , Any ]) -> Callable [ ... , Any ]: @wraps ( func ) def wrapper ( * args : Any , ** kwargs : Any ) -> Any : # noqa: ANN401 result = func ( * args , ** kwargs ) if not isinstance ( result , pd . DataFrame ): error_message = ( f \"Function { func . __name__ } returned non-DataFrame result: \" f \" { type ( result ) . __name__ } . Expected DataFrame.\" ) raise TypeError ( error_message ) elif index_parameters and kwargs . get ( index_parameters ) and not result . empty : return result . set_index ( kwargs [ index_parameters ]) else : return result return wrapper return decorator options: show_bases: false Decorator that sets DataFrame index if specified and the DataFrame is not empty. Internal Functions \u00b6 These functions are used internally by the decorators: _convert_time_values_in_dict \u00b6 Converts Unix timestamp values in dictionaries to pandas datetime objects. Handles both seconds and milliseconds based on field naming conventions. _convert_time_columns_in_df \u00b6 Converts time columns in pandas DataFrames to datetime format. Automatically detects time columns by name patterns. Usage \u00b6 These utilities are primarily used internally by Mt5DataClient methods through decorators: # Example of how decorators are applied internally @detect_and_convert_time_to_datetime ( skip_toggle = \"convert_time\" ) @set_index_if_possible ( index_parameters = \"index_keys\" ) def some_method ( self , convert_time : bool = True , index_keys : str | None = None ): # Method implementation pass Time Conversion Rules \u00b6 The time conversion follows these rules: Millisecond Timestamps : Fields ending with _msc are converted using pd.to_datetime(value, unit=\"ms\") Second Timestamps : Fields named time or starting with time_ are converted using pd.to_datetime(value, unit=\"s\") Automatic Detection : Conversion happens automatically unless explicitly disabled DataFrame Index Setting \u00b6 The index setting decorator: Only sets index if DataFrame is not empty Uses the specified column name as index Validates that the result is a DataFrame Preserves original DataFrame if no index column specified Integration with Mt5DataClient \u00b6 These utilities enable Mt5DataClient to provide user-friendly data: # Time values are automatically converted df = client . get_symbols_as_df ( convert_time = True ) # Returns DataFrame with datetime objects instead of Unix timestamps # DataFrames can have custom indexes df = client . copy_rates_from_as_df ( symbol = \"EURUSD\" , timeframe = mt5 . TIMEFRAME_H1 , date_from = datetime . now (), count = 100 , index_keys = \"time\" # Sets 'time' column as index ) Design Philosophy \u00b6 The utilities module follows these principles: Automatic Conversion : Time values should be human-readable by default Opt-out Capability : Users can disable conversion when needed Type Safety : Decorators validate input and output types Non-intrusive : Original data is never modified, only copies Consistent Behavior : Same conversion rules across all methods Implementation Details \u00b6 Time Detection Patterns \u00b6 time : Base time field (seconds) time_* : Time-prefixed fields (seconds) time_*_msc : Millisecond timestamp fields Error Handling \u00b6 Invalid DataFrame types raise TypeError Empty DataFrames are returned as-is Non-time fields are ignored during conversion Performance Considerations \u00b6 Conversions only happen when requested Dictionary operations use shallow copies DataFrame operations use efficient pandas methods Decorators add minimal overhead","title":"Utilities"},{"location":"api/utils/#utilities","text":"","title":"Utilities"},{"location":"api/utils/#pdmt5.utils","text":"Utility functions for the pdmt5 package.","title":"utils"},{"location":"api/utils/#pdmt5.utils.detect_and_convert_time_to_datetime","text":"detect_and_convert_time_to_datetime ( skip_toggle : str | None = None , ) -> Callable [ ... , Any ] Decorator to convert time values/columns to datetime based on result type. Automatically detects result type and applies appropriate time conversion: - dict: converts time values in the dictionary - list: converts time values in each dictionary item - DataFrame: converts time columns Parameters: Name Type Description Default skip_toggle str | None Name of the parameter to skip conversion if set to False. None Returns: Type Description Callable [..., Any ] Decorator function. Source code in pdmt5/utils.py 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 def detect_and_convert_time_to_datetime ( skip_toggle : str | None = None , ) -> Callable [ ... , Any ]: \"\"\"Decorator to convert time values/columns to datetime based on result type. Automatically detects result type and applies appropriate time conversion: - dict: converts time values in the dictionary - list: converts time values in each dictionary item - DataFrame: converts time columns Args: skip_toggle: Name of the parameter to skip conversion if set to False. Returns: Decorator function. \"\"\" def decorator ( func : Callable [ ... , Any ]) -> Callable [ ... , Any ]: @wraps ( func ) def wrapper ( * args : Any , ** kwargs : Any ) -> Any : # noqa: ANN401 result = func ( * args , ** kwargs ) if skip_toggle and kwargs . get ( skip_toggle ): return result elif isinstance ( result , dict ): return _convert_time_values_in_dict ( dictionary = result ) elif isinstance ( result , list ): return [ ( _convert_time_values_in_dict ( dictionary = d ) if isinstance ( d , dict ) else d ) for d in result ] elif isinstance ( result , pd . DataFrame ): return _convert_time_columns_in_df ( result ) else : return result return wrapper return decorator","title":"detect_and_convert_time_to_datetime"},{"location":"api/utils/#pdmt5.utils.set_index_if_possible","text":"set_index_if_possible ( index_parameters : str | None = None , ) -> Callable [ ... , Any ] Decorator to set index on DataFrame results if not empty. Parameters: Name Type Description Default index_parameters str | None Name of the parameter to use as index if provided. None Returns: Type Description Callable [..., Any ] Decorator function. Source code in pdmt5/utils.py 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 def set_index_if_possible ( index_parameters : str | None = None ) -> Callable [ ... , Any ]: \"\"\"Decorator to set index on DataFrame results if not empty. Args: index_parameters: Name of the parameter to use as index if provided. Returns: Decorator function. \"\"\" def decorator ( func : Callable [ ... , Any ]) -> Callable [ ... , Any ]: @wraps ( func ) def wrapper ( * args : Any , ** kwargs : Any ) -> Any : # noqa: ANN401 result = func ( * args , ** kwargs ) if not isinstance ( result , pd . DataFrame ): error_message = ( f \"Function { func . __name__ } returned non-DataFrame result: \" f \" { type ( result ) . __name__ } . Expected DataFrame.\" ) raise TypeError ( error_message ) elif index_parameters and kwargs . get ( index_parameters ) and not result . empty : return result . set_index ( kwargs [ index_parameters ]) else : return result return wrapper return decorator","title":"set_index_if_possible"},{"location":"api/utils/#overview","text":"The utils module provides internal utility functions and decorators used throughout the pdmt5 package for data transformation and DataFrame manipulation.","title":"Overview"},{"location":"api/utils/#functions","text":"","title":"Functions"},{"location":"api/utils/#detect_and_convert_time_to_datetime","text":"","title":"detect_and_convert_time_to_datetime"},{"location":"api/utils/#pdmt5.utils.detect_and_convert_time_to_datetime","text":"detect_and_convert_time_to_datetime ( skip_toggle : str | None = None , ) -> Callable [ ... , Any ] Decorator to convert time values/columns to datetime based on result type. Automatically detects result type and applies appropriate time conversion: - dict: converts time values in the dictionary - list: converts time values in each dictionary item - DataFrame: converts time columns Parameters: Name Type Description Default skip_toggle str | None Name of the parameter to skip conversion if set to False. None Returns: Type Description Callable [..., Any ] Decorator function. Source code in pdmt5/utils.py 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 def detect_and_convert_time_to_datetime ( skip_toggle : str | None = None , ) -> Callable [ ... , Any ]: \"\"\"Decorator to convert time values/columns to datetime based on result type. Automatically detects result type and applies appropriate time conversion: - dict: converts time values in the dictionary - list: converts time values in each dictionary item - DataFrame: converts time columns Args: skip_toggle: Name of the parameter to skip conversion if set to False. Returns: Decorator function. \"\"\" def decorator ( func : Callable [ ... , Any ]) -> Callable [ ... , Any ]: @wraps ( func ) def wrapper ( * args : Any , ** kwargs : Any ) -> Any : # noqa: ANN401 result = func ( * args , ** kwargs ) if skip_toggle and kwargs . get ( skip_toggle ): return result elif isinstance ( result , dict ): return _convert_time_values_in_dict ( dictionary = result ) elif isinstance ( result , list ): return [ ( _convert_time_values_in_dict ( dictionary = d ) if isinstance ( d , dict ) else d ) for d in result ] elif isinstance ( result , pd . DataFrame ): return _convert_time_columns_in_df ( result ) else : return result return wrapper return decorator options: show_bases: false Decorator that automatically converts time values to datetime objects based on the result type.","title":"detect_and_convert_time_to_datetime"},{"location":"api/utils/#set_index_if_possible","text":"","title":"set_index_if_possible"},{"location":"api/utils/#pdmt5.utils.set_index_if_possible","text":"set_index_if_possible ( index_parameters : str | None = None , ) -> Callable [ ... , Any ] Decorator to set index on DataFrame results if not empty. Parameters: Name Type Description Default index_parameters str | None Name of the parameter to use as index if provided. None Returns: Type Description Callable [..., Any ] Decorator function. Source code in pdmt5/utils.py 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 def set_index_if_possible ( index_parameters : str | None = None ) -> Callable [ ... , Any ]: \"\"\"Decorator to set index on DataFrame results if not empty. Args: index_parameters: Name of the parameter to use as index if provided. Returns: Decorator function. \"\"\" def decorator ( func : Callable [ ... , Any ]) -> Callable [ ... , Any ]: @wraps ( func ) def wrapper ( * args : Any , ** kwargs : Any ) -> Any : # noqa: ANN401 result = func ( * args , ** kwargs ) if not isinstance ( result , pd . DataFrame ): error_message = ( f \"Function { func . __name__ } returned non-DataFrame result: \" f \" { type ( result ) . __name__ } . Expected DataFrame.\" ) raise TypeError ( error_message ) elif index_parameters and kwargs . get ( index_parameters ) and not result . empty : return result . set_index ( kwargs [ index_parameters ]) else : return result return wrapper return decorator options: show_bases: false Decorator that sets DataFrame index if specified and the DataFrame is not empty.","title":"set_index_if_possible"},{"location":"api/utils/#internal-functions","text":"These functions are used internally by the decorators:","title":"Internal Functions"},{"location":"api/utils/#_convert_time_values_in_dict","text":"Converts Unix timestamp values in dictionaries to pandas datetime objects. Handles both seconds and milliseconds based on field naming conventions.","title":"_convert_time_values_in_dict"},{"location":"api/utils/#_convert_time_columns_in_df","text":"Converts time columns in pandas DataFrames to datetime format. Automatically detects time columns by name patterns.","title":"_convert_time_columns_in_df"},{"location":"api/utils/#usage","text":"These utilities are primarily used internally by Mt5DataClient methods through decorators: # Example of how decorators are applied internally @detect_and_convert_time_to_datetime ( skip_toggle = \"convert_time\" ) @set_index_if_possible ( index_parameters = \"index_keys\" ) def some_method ( self , convert_time : bool = True , index_keys : str | None = None ): # Method implementation pass","title":"Usage"},{"location":"api/utils/#time-conversion-rules","text":"The time conversion follows these rules: Millisecond Timestamps : Fields ending with _msc are converted using pd.to_datetime(value, unit=\"ms\") Second Timestamps : Fields named time or starting with time_ are converted using pd.to_datetime(value, unit=\"s\") Automatic Detection : Conversion happens automatically unless explicitly disabled","title":"Time Conversion Rules"},{"location":"api/utils/#dataframe-index-setting","text":"The index setting decorator: Only sets index if DataFrame is not empty Uses the specified column name as index Validates that the result is a DataFrame Preserves original DataFrame if no index column specified","title":"DataFrame Index Setting"},{"location":"api/utils/#integration-with-mt5dataclient","text":"These utilities enable Mt5DataClient to provide user-friendly data: # Time values are automatically converted df = client . get_symbols_as_df ( convert_time = True ) # Returns DataFrame with datetime objects instead of Unix timestamps # DataFrames can have custom indexes df = client . copy_rates_from_as_df ( symbol = \"EURUSD\" , timeframe = mt5 . TIMEFRAME_H1 , date_from = datetime . now (), count = 100 , index_keys = \"time\" # Sets 'time' column as index )","title":"Integration with Mt5DataClient"},{"location":"api/utils/#design-philosophy","text":"The utilities module follows these principles: Automatic Conversion : Time values should be human-readable by default Opt-out Capability : Users can disable conversion when needed Type Safety : Decorators validate input and output types Non-intrusive : Original data is never modified, only copies Consistent Behavior : Same conversion rules across all methods","title":"Design Philosophy"},{"location":"api/utils/#implementation-details","text":"","title":"Implementation Details"},{"location":"api/utils/#time-detection-patterns","text":"time : Base time field (seconds) time_* : Time-prefixed fields (seconds) time_*_msc : Millisecond timestamp fields","title":"Time Detection Patterns"},{"location":"api/utils/#error-handling","text":"Invalid DataFrame types raise TypeError Empty DataFrames are returned as-is Non-time fields are ignored during conversion","title":"Error Handling"},{"location":"api/utils/#performance-considerations","text":"Conversions only happen when requested Dictionary operations use shallow copies DataFrame operations use efficient pandas methods Decorators add minimal overhead","title":"Performance Considerations"}]}